"use strict";(()=>{var NI=Object.create;var qy=Object.defineProperty;var AI=Object.getOwnPropertyDescriptor;var MI=Object.getOwnPropertyNames;var DI=Object.getPrototypeOf,SI=Object.prototype.hasOwnProperty;var LI=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(r,i)=>(typeof require<"u"?require:r)[i]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var me=(t,r)=>()=>(r||t((r={exports:{}}).exports,r),r.exports);var PI=(t,r,i,l)=>{if(r&&typeof r=="object"||typeof r=="function")for(let u of MI(r))!SI.call(t,u)&&u!==i&&qy(t,u,{get:()=>r[u],enumerable:!(l=AI(r,u))||l.enumerable});return t};var Uy=(t,r,i)=>(i=t!=null?NI(DI(t)):{},PI(r||!t||!t.__esModule?qy(i,"default",{value:t,enumerable:!0}):i,t));var Zy=me(Si=>{"use strict";var OI=Si&&Si.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Si,"__esModule",{value:!0});Si.DebugBridge=void 0;var xh=Ul(),RI=OI(Th()),ln=class{get version(){return ln.version}get disableDebugBridgePassword(){return this._disableDebugBridgePassword}set disableDebugBridgePassword(r){this._disableDebugBridgePassword=r}get password(){return xh.BasicTool.getZotero().Prefs.get(ln.passwordPref,!0)}set password(r){xh.BasicTool.getZotero().Prefs.set(ln.passwordPref,r,!0)}constructor(){this._disableDebugBridgePassword=!1,this.initializeDebugBridge()}static setModule(r){var i;(!(!((i=r.debugBridge)===null||i===void 0)&&i.version)||r.debugBridge.version<ln.version)&&(r.debugBridge=new ln)}initializeDebugBridge(){let r={noContent:!0,doAction:async i=>{var l;let u=xh.BasicTool.getZotero(),d=i.spec.split("//").pop();if(!d)return;let g={};if((l=d.split("?").pop())===null||l===void 0||l.split("&").forEach(m=>{g[m.split("=")[0]]=m.split("=")[1]}),RI.default.getInstance().debugBridge.disableDebugBridgePassword||g.password===this.password){if(g.run)try{let m=Object.getPrototypeOf(async function(){}).constructor;await new m("Zotero,window",decodeURIComponent(g.run))(u,u.getMainWindow())}catch(m){u.debug(m),u.getMainWindow().console.log(m)}if(g.file)try{Services.scriptloader.loadSubScript(decodeURIComponent(g.file),{Zotero:u,window:u.getMainWindow()})}catch(m){u.debug(m),u.getMainWindow().console.log(m)}}},newChannel:function(i){this.doAction(i)}};Services.io.getProtocolHandler("zotero").wrappedJSObject._extensions["zotero://ztoolkit-debug"]=r}};Si.DebugBridge=ln;ln.version=1;ln.passwordPref="extensions.zotero.debug-bridge.password"});var Th=me(Ca=>{"use strict";Object.defineProperty(Ca,"__esModule",{value:!0});Ca.ToolkitGlobal=void 0;var FI=Ul(),BI=Zy(),Pi=class{constructor(){jy(this)}static getInstance(){let r=FI.BasicTool.getZotero();return"_toolkitGlobal"in r?jy(r._toolkitGlobal):r._toolkitGlobal=new Pi,r._toolkitGlobal}};Ca.ToolkitGlobal=Pi;function jy(t){Li(t,"fieldHooks",{_ready:!1,getFieldHooks:{},setFieldHooks:{},isFieldOfBaseHooks:{}}),Li(t,"itemTree",{_ready:!1,columns:[],renderCellHooks:{}}),Li(t,"itemBox",{_ready:!1,fieldOptions:{}}),Li(t,"shortcut",{_ready:!1,eventKeys:[]}),Li(t,"prompt",{_ready:!1,instance:void 0}),Li(t,"readerInstance",{_ready:!1,initializedHooks:{}}),BI.DebugBridge.setModule(t)}function Li(t,r,i){var l,u;if(i){t[r]||(t[r]=i);for(let d in i)(l=(u=t[r])[d])!==null&&l!==void 0||(u[d]=i[d])}}Ca.default=Pi});var Ul=me(xn=>{"use strict";var zI=xn&&xn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(xn,"__esModule",{value:!0});xn.unregister=xn.ManagerTool=xn.BasicTool=void 0;var qI=zI(Th()),Oi=class{get basicOptions(){return this._basicOptions}constructor(r){this.patchSign="zotero-plugin-toolkit@2.0.0",this._basicOptions={log:{_type:"toolkitlog",disableConsole:!1,disableZLog:!1,prefix:""},debug:qI.default.getInstance().debugBridge},this.updateOptions(r)}getGlobal(r){let i=typeof Zotero<"u"?Zotero:Components.classes["@zotero.org/Zotero;1"].getService(Components.interfaces.nsISupports).wrappedJSObject,l=i.getMainWindow();switch(r){case"Zotero":case"zotero":return i;case"window":return l;case"document":return l.document;case"ZoteroPane":case"ZoteroPane_Local":return i.getActiveZoteroPane();default:return l[r]}}isZotero7(){return Zotero.platformMajorVersion>=102}getDOMParser(){if(this.isZotero7())return new(this.getGlobal("DOMParser"));try{return new(this.getGlobal("DOMParser"))}catch{return Components.classes["@mozilla.org/xmlextras/domparser;1"].createInstance(Components.interfaces.nsIDOMParser)}}isXULElement(r){return r.namespaceURI==="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"}createXULElement(r,i){return this.isZotero7()?r.createXULElement(i):r.createElementNS("http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul",i)}log(...r){var i;if(r.length===0)return;let l=this.getGlobal("Zotero"),u=this.getGlobal("console"),d;((i=r[r.length-1])===null||i===void 0?void 0:i._type)==="toolkitlog"?d=r.pop():d=this._basicOptions.log;try{d.prefix&&r.splice(0,0,d.prefix),d.disableConsole||(u.groupCollapsed(...r),u.trace(),u.groupEnd()),d.disableZLog||l.debug(r.map(g=>{try{return typeof g=="object"?JSON.stringify(g):String(g)}catch{return l.debug(g),""}}).join(`
`))}catch(g){u.error(g),l.logError(g)}}patch(r,i,l,u){if(r[i][l])throw new Error(`${String(i)} re-patched`);this.log("patching",i,`by ${l}`),r[i]=u(r[i]),r[i][l]=!0}updateOptions(r){r&&(r instanceof Oi?this._basicOptions=r._basicOptions:this._basicOptions=r)}static getZotero(){return typeof Zotero<"u"?Zotero:Components.classes["@zotero.org/Zotero;1"].getService(Components.interfaces.nsISupports).wrappedJSObject}};xn.BasicTool=Oi;var Zl=class extends Oi{};xn.ManagerTool=Zl;function UI(t){Object.values(t).forEach(r=>{(r instanceof Zl||typeof r.unregisterAll=="function")&&r.unregisterAll()})}xn.unregister=UI});var jl=me(Eh=>{(function(){Eh.defaults={"0.1":{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},"0.2":{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:`
`},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(Eh)});var Tn=me((Wy,dr)=>{(function(){var t,r,i,l,u,d,g,m=[].slice,x={}.hasOwnProperty;t=function(){var v,I,S,M,E,C;if(C=arguments[0],E=2<=arguments.length?m.call(arguments,1):[],u(Object.assign))Object.assign.apply(null,arguments);else for(v=0,S=E.length;v<S;v++)if(M=E[v],M!=null)for(I in M)x.call(M,I)&&(C[I]=M[I]);return C},u=function(v){return!!v&&Object.prototype.toString.call(v)==="[object Function]"},d=function(v){var I;return!!v&&((I=typeof v)=="function"||I==="object")},i=function(v){return u(Array.isArray)?Array.isArray(v):Object.prototype.toString.call(v)==="[object Array]"},l=function(v){var I;if(i(v))return!v.length;for(I in v)if(x.call(v,I))return!1;return!0},g=function(v){var I,S;return d(v)&&(S=Object.getPrototypeOf(v))&&(I=S.constructor)&&typeof I=="function"&&I instanceof I&&Function.prototype.toString.call(I)===Function.prototype.toString.call(Object)},r=function(v){return u(v.valueOf)?v.valueOf():v},dr.exports.assign=t,dr.exports.isFunction=u,dr.exports.isObject=d,dr.exports.isArray=i,dr.exports.isEmpty=l,dr.exports.isPlainObject=g,dr.exports.getValue=r}).call(Wy)});var kh=me((Gy,Xy)=>{(function(){var t;Xy.exports=t=function(){function r(){}return r.prototype.hasFeature=function(i,l){return!0},r.prototype.createDocumentType=function(i,l,u){throw new Error("This DOM method is not implemented.")},r.prototype.createDocument=function(i,l,u){throw new Error("This DOM method is not implemented.")},r.prototype.createHTMLDocument=function(i){throw new Error("This DOM method is not implemented.")},r.prototype.getFeature=function(i,l){throw new Error("This DOM method is not implemented.")},r}()}).call(Gy)});var Yy=me((Ky,Jy)=>{(function(){var t;Jy.exports=t=function(){function r(){}return r.prototype.handleError=function(i){throw new Error(i)},r}()}).call(Ky)});var tb=me((Qy,eb)=>{(function(){var t;eb.exports=t=function(){function r(i){this.arr=i||[]}return Object.defineProperty(r.prototype,"length",{get:function(){return this.arr.length}}),r.prototype.item=function(i){return this.arr[i]||null},r.prototype.contains=function(i){return this.arr.indexOf(i)!==-1},r}()}).call(Qy)});var ib=me((nb,rb)=>{(function(){var t,r,i;r=Yy(),i=tb(),rb.exports=t=function(){function l(){var u;this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new r,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=u=Object.create(this.defaultParams)}return Object.defineProperty(l.prototype,"parameterNames",{get:function(){return new i(Object.keys(this.defaultParams))}}),l.prototype.getParameter=function(u){return this.params.hasOwnProperty(u)?this.params[u]:null},l.prototype.canSetParameter=function(u,d){return!0},l.prototype.setParameter=function(u,d){return d!=null?this.params[u]=d:delete this.params[u]},l}()}).call(nb)});var st=me((ob,ab)=>{(function(){ab.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(ob)});var Ch=me((sb,lb)=>{(function(){var t,r,i;t=st(),i=jt(),lb.exports=r=function(){function l(u,d,g){if(this.parent=u,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),d==null)throw new Error("Missing attribute name. "+this.debugInfo(d));this.name=this.stringify.name(d),this.value=this.stringify.attValue(g),this.type=t.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(l.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(l.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(l.prototype,"textContent",{get:function(){return this.value},set:function(u){return this.value=u||""}}),Object.defineProperty(l.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(l.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(l.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(l.prototype,"specified",{get:function(){return!0}}),l.prototype.clone=function(){return Object.create(this)},l.prototype.toString=function(u){return this.options.writer.attribute(this,this.options.writer.filterOptions(u))},l.prototype.debugInfo=function(u){return u=u||this.name,u==null?"parent: <"+this.parent.name+">":"attribute: {"+u+"}, parent: <"+this.parent.name+">"},l.prototype.isEqualNode=function(u){return!(u.namespaceURI!==this.namespaceURI||u.prefix!==this.prefix||u.localName!==this.localName||u.value!==this.value)},l}()}).call(sb)});var Hl=me((cb,ub)=>{(function(){var t;ub.exports=t=function(){function r(i){this.nodes=i}return Object.defineProperty(r.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),r.prototype.clone=function(){return this.nodes=null},r.prototype.getNamedItem=function(i){return this.nodes[i]},r.prototype.setNamedItem=function(i){var l;return l=this.nodes[i.nodeName],this.nodes[i.nodeName]=i,l||null},r.prototype.removeNamedItem=function(i){var l;return l=this.nodes[i],delete this.nodes[i],l||null},r.prototype.item=function(i){return this.nodes[Object.keys(this.nodes)[i]]||null},r.prototype.getNamedItemNS=function(i,l){throw new Error("This DOM method is not implemented.")},r.prototype.setNamedItemNS=function(i){throw new Error("This DOM method is not implemented.")},r.prototype.removeNamedItemNS=function(i,l){throw new Error("This DOM method is not implemented.")},r}()}).call(cb)});var $l=me((fb,hb)=>{(function(){var t,r,i,l,u,d,g,m,x,v=function(S,M){for(var E in M)I.call(M,E)&&(S[E]=M[E]);function C(){this.constructor=S}return C.prototype=M.prototype,S.prototype=new C,S.__super__=M.prototype,S},I={}.hasOwnProperty;x=Tn(),m=x.isObject,g=x.isFunction,d=x.getValue,u=jt(),t=st(),r=Ch(),l=Hl(),hb.exports=i=function(S){v(M,S);function M(E,C,B){var $,V,te,R;if(M.__super__.constructor.call(this,E),C==null)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(C),this.type=t.Element,this.attribs={},this.schemaTypeInfo=null,B!=null&&this.attribute(B),E.type===t.Document&&(this.isRoot=!0,this.documentObject=E,E.rootObject=this,E.children)){for(R=E.children,V=0,te=R.length;V<te;V++)if($=R[V],$.type===t.DocType){$.name=this.name;break}}}return Object.defineProperty(M.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(M.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(M.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(M.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(M.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(M.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(M.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(M.prototype,"attributes",{get:function(){return(!this.attributeMap||!this.attributeMap.nodes)&&(this.attributeMap=new l(this.attribs)),this.attributeMap}}),M.prototype.clone=function(){var E,C,B,$;B=Object.create(this),B.isRoot&&(B.documentObject=null),B.attribs={},$=this.attribs;for(C in $)I.call($,C)&&(E=$[C],B.attribs[C]=E.clone());return B.children=[],this.children.forEach(function(V){var te;return te=V.clone(),te.parent=B,B.children.push(te)}),B},M.prototype.attribute=function(E,C){var B,$;if(E!=null&&(E=d(E)),m(E))for(B in E)I.call(E,B)&&($=E[B],this.attribute(B,$));else g(C)&&(C=C.apply()),this.options.keepNullAttributes&&C==null?this.attribs[E]=new r(this,E,""):C!=null&&(this.attribs[E]=new r(this,E,C));return this},M.prototype.removeAttribute=function(E){var C,B,$;if(E==null)throw new Error("Missing attribute name. "+this.debugInfo());if(E=d(E),Array.isArray(E))for(B=0,$=E.length;B<$;B++)C=E[B],delete this.attribs[C];else delete this.attribs[E];return this},M.prototype.toString=function(E){return this.options.writer.element(this,this.options.writer.filterOptions(E))},M.prototype.att=function(E,C){return this.attribute(E,C)},M.prototype.a=function(E,C){return this.attribute(E,C)},M.prototype.getAttribute=function(E){return this.attribs.hasOwnProperty(E)?this.attribs[E].value:null},M.prototype.setAttribute=function(E,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},M.prototype.getAttributeNode=function(E){return this.attribs.hasOwnProperty(E)?this.attribs[E]:null},M.prototype.setAttributeNode=function(E){throw new Error("This DOM method is not implemented."+this.debugInfo())},M.prototype.removeAttributeNode=function(E){throw new Error("This DOM method is not implemented."+this.debugInfo())},M.prototype.getElementsByTagName=function(E){throw new Error("This DOM method is not implemented."+this.debugInfo())},M.prototype.getAttributeNS=function(E,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},M.prototype.setAttributeNS=function(E,C,B){throw new Error("This DOM method is not implemented."+this.debugInfo())},M.prototype.removeAttributeNS=function(E,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},M.prototype.getAttributeNodeNS=function(E,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},M.prototype.setAttributeNodeNS=function(E){throw new Error("This DOM method is not implemented."+this.debugInfo())},M.prototype.getElementsByTagNameNS=function(E,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},M.prototype.hasAttribute=function(E){return this.attribs.hasOwnProperty(E)},M.prototype.hasAttributeNS=function(E,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},M.prototype.setIdAttribute=function(E,C){return this.attribs.hasOwnProperty(E)?this.attribs[E].isId:C},M.prototype.setIdAttributeNS=function(E,C,B){throw new Error("This DOM method is not implemented."+this.debugInfo())},M.prototype.setIdAttributeNode=function(E,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},M.prototype.getElementsByTagName=function(E){throw new Error("This DOM method is not implemented."+this.debugInfo())},M.prototype.getElementsByTagNameNS=function(E,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},M.prototype.getElementsByClassName=function(E){throw new Error("This DOM method is not implemented."+this.debugInfo())},M.prototype.isEqualNode=function(E){var C,B,$;if(!M.__super__.isEqualNode.apply(this,arguments).isEqualNode(E)||E.namespaceURI!==this.namespaceURI||E.prefix!==this.prefix||E.localName!==this.localName||E.attribs.length!==this.attribs.length)return!1;for(C=B=0,$=this.attribs.length-1;0<=$?B<=$:B>=$;C=0<=$?++B:--B)if(!this.attribs[C].isEqualNode(E.attribs[C]))return!1;return!0},M}(u)}).call(fb)});var Na=me((db,pb)=>{(function(){var t,r,i=function(u,d){for(var g in d)l.call(d,g)&&(u[g]=d[g]);function m(){this.constructor=u}return m.prototype=d.prototype,u.prototype=new m,u.__super__=d.prototype,u},l={}.hasOwnProperty;r=jt(),pb.exports=t=function(u){i(d,u);function d(g){d.__super__.constructor.call(this,g),this.value=""}return Object.defineProperty(d.prototype,"data",{get:function(){return this.value},set:function(g){return this.value=g||""}}),Object.defineProperty(d.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(d.prototype,"textContent",{get:function(){return this.value},set:function(g){return this.value=g||""}}),d.prototype.clone=function(){return Object.create(this)},d.prototype.substringData=function(g,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.appendData=function(g){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.insertData=function(g,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.deleteData=function(g,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.replaceData=function(g,m,x){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.isEqualNode=function(g){return!(!d.__super__.isEqualNode.apply(this,arguments).isEqualNode(g)||g.data!==this.data)},d}(r)}).call(db)});var Vl=me((gb,mb)=>{(function(){var t,r,i,l=function(d,g){for(var m in g)u.call(g,m)&&(d[m]=g[m]);function x(){this.constructor=d}return x.prototype=g.prototype,d.prototype=new x,d.__super__=g.prototype,d},u={}.hasOwnProperty;t=st(),i=Na(),mb.exports=r=function(d){l(g,d);function g(m,x){if(g.__super__.constructor.call(this,m),x==null)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=t.CData,this.value=this.stringify.cdata(x)}return g.prototype.clone=function(){return Object.create(this)},g.prototype.toString=function(m){return this.options.writer.cdata(this,this.options.writer.filterOptions(m))},g}(i)}).call(gb)});var Wl=me((yb,bb)=>{(function(){var t,r,i,l=function(d,g){for(var m in g)u.call(g,m)&&(d[m]=g[m]);function x(){this.constructor=d}return x.prototype=g.prototype,d.prototype=new x,d.__super__=g.prototype,d},u={}.hasOwnProperty;t=st(),r=Na(),bb.exports=i=function(d){l(g,d);function g(m,x){if(g.__super__.constructor.call(this,m),x==null)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=t.Comment,this.value=this.stringify.comment(x)}return g.prototype.clone=function(){return Object.create(this)},g.prototype.toString=function(m){return this.options.writer.comment(this,this.options.writer.filterOptions(m))},g}(r)}).call(yb)});var Gl=me((wb,_b)=>{(function(){var t,r,i,l,u=function(g,m){for(var x in m)d.call(m,x)&&(g[x]=m[x]);function v(){this.constructor=g}return v.prototype=m.prototype,g.prototype=new v,g.__super__=m.prototype,g},d={}.hasOwnProperty;l=Tn().isObject,i=jt(),t=st(),_b.exports=r=function(g){u(m,g);function m(x,v,I,S){var M;m.__super__.constructor.call(this,x),l(v)&&(M=v,v=M.version,I=M.encoding,S=M.standalone),v||(v="1.0"),this.type=t.Declaration,this.version=this.stringify.xmlVersion(v),I!=null&&(this.encoding=this.stringify.xmlEncoding(I)),S!=null&&(this.standalone=this.stringify.xmlStandalone(S))}return m.prototype.toString=function(x){return this.options.writer.declaration(this,this.options.writer.filterOptions(x))},m}(i)}).call(wb)});var Xl=me((vb,xb)=>{(function(){var t,r,i,l=function(d,g){for(var m in g)u.call(g,m)&&(d[m]=g[m]);function x(){this.constructor=d}return x.prototype=g.prototype,d.prototype=new x,d.__super__=g.prototype,d},u={}.hasOwnProperty;i=jt(),t=st(),xb.exports=r=function(d){l(g,d);function g(m,x,v,I,S,M){if(g.__super__.constructor.call(this,m),x==null)throw new Error("Missing DTD element name. "+this.debugInfo());if(v==null)throw new Error("Missing DTD attribute name. "+this.debugInfo(x));if(!I)throw new Error("Missing DTD attribute type. "+this.debugInfo(x));if(!S)throw new Error("Missing DTD attribute default. "+this.debugInfo(x));if(S.indexOf("#")!==0&&(S="#"+S),!S.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(x));if(M&&!S.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(x));this.elementName=this.stringify.name(x),this.type=t.AttributeDeclaration,this.attributeName=this.stringify.name(v),this.attributeType=this.stringify.dtdAttType(I),M&&(this.defaultValue=this.stringify.dtdAttDefault(M)),this.defaultValueType=S}return g.prototype.toString=function(m){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(m))},g}(i)}).call(vb)});var Kl=me((Tb,Ib)=>{(function(){var t,r,i,l,u=function(g,m){for(var x in m)d.call(m,x)&&(g[x]=m[x]);function v(){this.constructor=g}return v.prototype=m.prototype,g.prototype=new v,g.__super__=m.prototype,g},d={}.hasOwnProperty;l=Tn().isObject,i=jt(),t=st(),Ib.exports=r=function(g){u(m,g);function m(x,v,I,S){if(m.__super__.constructor.call(this,x),I==null)throw new Error("Missing DTD entity name. "+this.debugInfo(I));if(S==null)throw new Error("Missing DTD entity value. "+this.debugInfo(I));if(this.pe=!!v,this.name=this.stringify.name(I),this.type=t.EntityDeclaration,!l(S))this.value=this.stringify.dtdEntityValue(S),this.internal=!0;else{if(!S.pubID&&!S.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(I));if(S.pubID&&!S.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(I));if(this.internal=!1,S.pubID!=null&&(this.pubID=this.stringify.dtdPubID(S.pubID)),S.sysID!=null&&(this.sysID=this.stringify.dtdSysID(S.sysID)),S.nData!=null&&(this.nData=this.stringify.dtdNData(S.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(I))}}return Object.defineProperty(m.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(m.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(m.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(m.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(m.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(m.prototype,"xmlVersion",{get:function(){return null}}),m.prototype.toString=function(x){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(x))},m}(i)}).call(Tb)});var Jl=me((Eb,kb)=>{(function(){var t,r,i,l=function(d,g){for(var m in g)u.call(g,m)&&(d[m]=g[m]);function x(){this.constructor=d}return x.prototype=g.prototype,d.prototype=new x,d.__super__=g.prototype,d},u={}.hasOwnProperty;i=jt(),t=st(),kb.exports=r=function(d){l(g,d);function g(m,x,v){if(g.__super__.constructor.call(this,m),x==null)throw new Error("Missing DTD element name. "+this.debugInfo());v||(v="(#PCDATA)"),Array.isArray(v)&&(v="("+v.join(",")+")"),this.name=this.stringify.name(x),this.type=t.ElementDeclaration,this.value=this.stringify.dtdElementValue(v)}return g.prototype.toString=function(m){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(m))},g}(i)}).call(Eb)});var Yl=me((Cb,Nb)=>{(function(){var t,r,i,l=function(d,g){for(var m in g)u.call(g,m)&&(d[m]=g[m]);function x(){this.constructor=d}return x.prototype=g.prototype,d.prototype=new x,d.__super__=g.prototype,d},u={}.hasOwnProperty;i=jt(),t=st(),Nb.exports=r=function(d){l(g,d);function g(m,x,v){if(g.__super__.constructor.call(this,m),x==null)throw new Error("Missing DTD notation name. "+this.debugInfo(x));if(!v.pubID&&!v.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(x));this.name=this.stringify.name(x),this.type=t.NotationDeclaration,v.pubID!=null&&(this.pubID=this.stringify.dtdPubID(v.pubID)),v.sysID!=null&&(this.sysID=this.stringify.dtdSysID(v.sysID))}return Object.defineProperty(g.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(g.prototype,"systemId",{get:function(){return this.sysID}}),g.prototype.toString=function(m){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(m))},g}(i)}).call(Cb)});var Ql=me((Ab,Mb)=>{(function(){var t,r,i,l,u,d,g,m,x,v=function(S,M){for(var E in M)I.call(M,E)&&(S[E]=M[E]);function C(){this.constructor=S}return C.prototype=M.prototype,S.prototype=new C,S.__super__=M.prototype,S},I={}.hasOwnProperty;x=Tn().isObject,m=jt(),t=st(),r=Xl(),l=Kl(),i=Jl(),u=Yl(),g=Hl(),Mb.exports=d=function(S){v(M,S);function M(E,C,B){var $,V,te,R,D,A;if(M.__super__.constructor.call(this,E),this.type=t.DocType,E.children){for(R=E.children,V=0,te=R.length;V<te;V++)if($=R[V],$.type===t.Element){this.name=$.name;break}}this.documentObject=E,x(C)&&(D=C,C=D.pubID,B=D.sysID),B==null&&(A=[C,B],B=A[0],C=A[1]),C!=null&&(this.pubID=this.stringify.dtdPubID(C)),B!=null&&(this.sysID=this.stringify.dtdSysID(B))}return Object.defineProperty(M.prototype,"entities",{get:function(){var E,C,B,$,V;for($={},V=this.children,C=0,B=V.length;C<B;C++)E=V[C],E.type===t.EntityDeclaration&&!E.pe&&($[E.name]=E);return new g($)}}),Object.defineProperty(M.prototype,"notations",{get:function(){var E,C,B,$,V;for($={},V=this.children,C=0,B=V.length;C<B;C++)E=V[C],E.type===t.NotationDeclaration&&($[E.name]=E);return new g($)}}),Object.defineProperty(M.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(M.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(M.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),M.prototype.element=function(E,C){var B;return B=new i(this,E,C),this.children.push(B),this},M.prototype.attList=function(E,C,B,$,V){var te;return te=new r(this,E,C,B,$,V),this.children.push(te),this},M.prototype.entity=function(E,C){var B;return B=new l(this,!1,E,C),this.children.push(B),this},M.prototype.pEntity=function(E,C){var B;return B=new l(this,!0,E,C),this.children.push(B),this},M.prototype.notation=function(E,C){var B;return B=new u(this,E,C),this.children.push(B),this},M.prototype.toString=function(E){return this.options.writer.docType(this,this.options.writer.filterOptions(E))},M.prototype.ele=function(E,C){return this.element(E,C)},M.prototype.att=function(E,C,B,$,V){return this.attList(E,C,B,$,V)},M.prototype.ent=function(E,C){return this.entity(E,C)},M.prototype.pent=function(E,C){return this.pEntity(E,C)},M.prototype.not=function(E,C){return this.notation(E,C)},M.prototype.up=function(){return this.root()||this.documentObject},M.prototype.isEqualNode=function(E){return!(!M.__super__.isEqualNode.apply(this,arguments).isEqualNode(E)||E.name!==this.name||E.publicId!==this.publicId||E.systemId!==this.systemId)},M}(m)}).call(Ab)});var ec=me((Db,Sb)=>{(function(){var t,r,i,l=function(d,g){for(var m in g)u.call(g,m)&&(d[m]=g[m]);function x(){this.constructor=d}return x.prototype=g.prototype,d.prototype=new x,d.__super__=g.prototype,d},u={}.hasOwnProperty;t=st(),r=jt(),Sb.exports=i=function(d){l(g,d);function g(m,x){if(g.__super__.constructor.call(this,m),x==null)throw new Error("Missing raw text. "+this.debugInfo());this.type=t.Raw,this.value=this.stringify.raw(x)}return g.prototype.clone=function(){return Object.create(this)},g.prototype.toString=function(m){return this.options.writer.raw(this,this.options.writer.filterOptions(m))},g}(r)}).call(Db)});var tc=me((Lb,Pb)=>{(function(){var t,r,i,l=function(d,g){for(var m in g)u.call(g,m)&&(d[m]=g[m]);function x(){this.constructor=d}return x.prototype=g.prototype,d.prototype=new x,d.__super__=g.prototype,d},u={}.hasOwnProperty;t=st(),r=Na(),Pb.exports=i=function(d){l(g,d);function g(m,x){if(g.__super__.constructor.call(this,m),x==null)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=t.Text,this.value=this.stringify.text(x)}return Object.defineProperty(g.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(g.prototype,"wholeText",{get:function(){var m,x,v;for(v="",x=this.previousSibling;x;)v=x.data+v,x=x.previousSibling;for(v+=this.data,m=this.nextSibling;m;)v=v+m.data,m=m.nextSibling;return v}}),g.prototype.clone=function(){return Object.create(this)},g.prototype.toString=function(m){return this.options.writer.text(this,this.options.writer.filterOptions(m))},g.prototype.splitText=function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())},g.prototype.replaceWholeText=function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())},g}(r)}).call(Lb)});var nc=me((Ob,Rb)=>{(function(){var t,r,i,l=function(d,g){for(var m in g)u.call(g,m)&&(d[m]=g[m]);function x(){this.constructor=d}return x.prototype=g.prototype,d.prototype=new x,d.__super__=g.prototype,d},u={}.hasOwnProperty;t=st(),r=Na(),Rb.exports=i=function(d){l(g,d);function g(m,x,v){if(g.__super__.constructor.call(this,m),x==null)throw new Error("Missing instruction target. "+this.debugInfo());this.type=t.ProcessingInstruction,this.target=this.stringify.insTarget(x),this.name=this.target,v&&(this.value=this.stringify.insValue(v))}return g.prototype.clone=function(){return Object.create(this)},g.prototype.toString=function(m){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(m))},g.prototype.isEqualNode=function(m){return!(!g.__super__.isEqualNode.apply(this,arguments).isEqualNode(m)||m.target!==this.target)},g}(r)}).call(Ob)});var Nh=me((Fb,Bb)=>{(function(){var t,r,i,l=function(d,g){for(var m in g)u.call(g,m)&&(d[m]=g[m]);function x(){this.constructor=d}return x.prototype=g.prototype,d.prototype=new x,d.__super__=g.prototype,d},u={}.hasOwnProperty;i=jt(),t=st(),Bb.exports=r=function(d){l(g,d);function g(m){g.__super__.constructor.call(this,m),this.type=t.Dummy}return g.prototype.clone=function(){return Object.create(this)},g.prototype.toString=function(m){return""},g}(i)}).call(Fb)});var Ub=me((zb,qb)=>{(function(){var t;qb.exports=t=function(){function r(i){this.nodes=i}return Object.defineProperty(r.prototype,"length",{get:function(){return this.nodes.length||0}}),r.prototype.clone=function(){return this.nodes=null},r.prototype.item=function(i){return this.nodes[i]||null},r}()}).call(zb)});var Hb=me((Zb,jb)=>{(function(){jb.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(Zb)});var jt=me(($b,Vb)=>{(function(){var t,r,i,l,u,d,g,m,x,v,I,S,M,E,C,B,$,V,te,R={}.hasOwnProperty;te=Tn(),V=te.isObject,$=te.isFunction,B=te.isEmpty,C=te.getValue,m=null,i=null,l=null,u=null,d=null,M=null,E=null,S=null,g=null,r=null,I=null,x=null,t=null,Vb.exports=v=function(){function D(A){this.parent=A,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,m||(m=$l(),i=Vl(),l=Wl(),u=Gl(),d=Ql(),M=ec(),E=tc(),S=nc(),g=Nh(),r=st(),I=Ub(),x=Hl(),t=Hb())}return Object.defineProperty(D.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(D.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(D.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(D.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(D.prototype,"childNodes",{get:function(){return(!this.childNodeList||!this.childNodeList.nodes)&&(this.childNodeList=new I(this.children)),this.childNodeList}}),Object.defineProperty(D.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(D.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(D.prototype,"previousSibling",{get:function(){var A;return A=this.parent.children.indexOf(this),this.parent.children[A-1]||null}}),Object.defineProperty(D.prototype,"nextSibling",{get:function(){var A;return A=this.parent.children.indexOf(this),this.parent.children[A+1]||null}}),Object.defineProperty(D.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(D.prototype,"textContent",{get:function(){var A,Z,X,H,J;if(this.nodeType===r.Element||this.nodeType===r.DocumentFragment){for(J="",H=this.children,Z=0,X=H.length;Z<X;Z++)A=H[Z],A.textContent&&(J+=A.textContent);return J}else return null},set:function(A){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),D.prototype.setParent=function(A){var Z,X,H,J,U;for(this.parent=A,A&&(this.options=A.options,this.stringify=A.stringify),J=this.children,U=[],X=0,H=J.length;X<H;X++)Z=J[X],U.push(Z.setParent(this));return U},D.prototype.element=function(A,Z,X){var H,J,U,K,se,de,_e,Ce,we,Ue,Ae;if(de=null,Z===null&&X==null&&(we=[{},null],Z=we[0],X=we[1]),Z==null&&(Z={}),Z=C(Z),V(Z)||(Ue=[Z,X],X=Ue[0],Z=Ue[1]),A!=null&&(A=C(A)),Array.isArray(A))for(U=0,_e=A.length;U<_e;U++)J=A[U],de=this.element(J);else if($(A))de=this.element(A.apply());else if(V(A)){for(se in A)if(R.call(A,se))if(Ae=A[se],$(Ae)&&(Ae=Ae.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&se.indexOf(this.stringify.convertAttKey)===0)de=this.attribute(se.substr(this.stringify.convertAttKey.length),Ae);else if(!this.options.separateArrayItems&&Array.isArray(Ae)&&B(Ae))de=this.dummy();else if(V(Ae)&&B(Ae))de=this.element(se);else if(!this.options.keepNullNodes&&Ae==null)de=this.dummy();else if(!this.options.separateArrayItems&&Array.isArray(Ae))for(K=0,Ce=Ae.length;K<Ce;K++)J=Ae[K],H={},H[se]=J,de=this.element(H);else V(Ae)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&se.indexOf(this.stringify.convertTextKey)===0?de=this.element(Ae):(de=this.element(se),de.element(Ae)):de=this.element(se,Ae)}else!this.options.keepNullNodes&&X===null?de=this.dummy():!this.options.ignoreDecorators&&this.stringify.convertTextKey&&A.indexOf(this.stringify.convertTextKey)===0?de=this.text(X):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&A.indexOf(this.stringify.convertCDataKey)===0?de=this.cdata(X):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&A.indexOf(this.stringify.convertCommentKey)===0?de=this.comment(X):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&A.indexOf(this.stringify.convertRawKey)===0?de=this.raw(X):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&A.indexOf(this.stringify.convertPIKey)===0?de=this.instruction(A.substr(this.stringify.convertPIKey.length),X):de=this.node(A,Z,X);if(de==null)throw new Error("Could not create any elements with: "+A+". "+this.debugInfo());return de},D.prototype.insertBefore=function(A,Z,X){var H,J,U,K,se;if(A?.type)return U=A,K=Z,U.setParent(this),K?(J=children.indexOf(K),se=children.splice(J),children.push(U),Array.prototype.push.apply(children,se)):children.push(U),U;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(A));return J=this.parent.children.indexOf(this),se=this.parent.children.splice(J),H=this.parent.element(A,Z,X),Array.prototype.push.apply(this.parent.children,se),H},D.prototype.insertAfter=function(A,Z,X){var H,J,U;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(A));return J=this.parent.children.indexOf(this),U=this.parent.children.splice(J+1),H=this.parent.element(A,Z,X),Array.prototype.push.apply(this.parent.children,U),H},D.prototype.remove=function(){var A,Z;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return A=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[A,A-A+1].concat(Z=[])),this.parent},D.prototype.node=function(A,Z,X){var H,J;return A!=null&&(A=C(A)),Z||(Z={}),Z=C(Z),V(Z)||(J=[Z,X],X=J[0],Z=J[1]),H=new m(this,A,Z),X!=null&&H.text(X),this.children.push(H),H},D.prototype.text=function(A){var Z;return V(A)&&this.element(A),Z=new E(this,A),this.children.push(Z),this},D.prototype.cdata=function(A){var Z;return Z=new i(this,A),this.children.push(Z),this},D.prototype.comment=function(A){var Z;return Z=new l(this,A),this.children.push(Z),this},D.prototype.commentBefore=function(A){var Z,X,H;return X=this.parent.children.indexOf(this),H=this.parent.children.splice(X),Z=this.parent.comment(A),Array.prototype.push.apply(this.parent.children,H),this},D.prototype.commentAfter=function(A){var Z,X,H;return X=this.parent.children.indexOf(this),H=this.parent.children.splice(X+1),Z=this.parent.comment(A),Array.prototype.push.apply(this.parent.children,H),this},D.prototype.raw=function(A){var Z;return Z=new M(this,A),this.children.push(Z),this},D.prototype.dummy=function(){var A;return A=new g(this),A},D.prototype.instruction=function(A,Z){var X,H,J,U,K;if(A!=null&&(A=C(A)),Z!=null&&(Z=C(Z)),Array.isArray(A))for(U=0,K=A.length;U<K;U++)X=A[U],this.instruction(X);else if(V(A))for(X in A)R.call(A,X)&&(H=A[X],this.instruction(X,H));else $(Z)&&(Z=Z.apply()),J=new S(this,A,Z),this.children.push(J);return this},D.prototype.instructionBefore=function(A,Z){var X,H,J;return H=this.parent.children.indexOf(this),J=this.parent.children.splice(H),X=this.parent.instruction(A,Z),Array.prototype.push.apply(this.parent.children,J),this},D.prototype.instructionAfter=function(A,Z){var X,H,J;return H=this.parent.children.indexOf(this),J=this.parent.children.splice(H+1),X=this.parent.instruction(A,Z),Array.prototype.push.apply(this.parent.children,J),this},D.prototype.declaration=function(A,Z,X){var H,J;return H=this.document(),J=new u(H,A,Z,X),H.children.length===0?H.children.unshift(J):H.children[0].type===r.Declaration?H.children[0]=J:H.children.unshift(J),H.root()||H},D.prototype.dtd=function(A,Z){var X,H,J,U,K,se,de,_e,Ce,we;for(H=this.document(),J=new d(H,A,Z),Ce=H.children,U=K=0,de=Ce.length;K<de;U=++K)if(X=Ce[U],X.type===r.DocType)return H.children[U]=J,J;for(we=H.children,U=se=0,_e=we.length;se<_e;U=++se)if(X=we[U],X.isRoot)return H.children.splice(U,0,J),J;return H.children.push(J),J},D.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},D.prototype.root=function(){var A;for(A=this;A;){if(A.type===r.Document)return A.rootObject;if(A.isRoot)return A;A=A.parent}},D.prototype.document=function(){var A;for(A=this;A;){if(A.type===r.Document)return A;A=A.parent}},D.prototype.end=function(A){return this.document().end(A)},D.prototype.prev=function(){var A;if(A=this.parent.children.indexOf(this),A<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[A-1]},D.prototype.next=function(){var A;if(A=this.parent.children.indexOf(this),A===-1||A===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[A+1]},D.prototype.importDocument=function(A){var Z;return Z=A.root().clone(),Z.parent=this,Z.isRoot=!1,this.children.push(Z),this},D.prototype.debugInfo=function(A){var Z,X;return A=A||this.name,A==null&&!((Z=this.parent)!=null&&Z.name)?"":A==null?"parent: <"+this.parent.name+">":(X=this.parent)!=null&&X.name?"node: <"+A+">, parent: <"+this.parent.name+">":"node: <"+A+">"},D.prototype.ele=function(A,Z,X){return this.element(A,Z,X)},D.prototype.nod=function(A,Z,X){return this.node(A,Z,X)},D.prototype.txt=function(A){return this.text(A)},D.prototype.dat=function(A){return this.cdata(A)},D.prototype.com=function(A){return this.comment(A)},D.prototype.ins=function(A,Z){return this.instruction(A,Z)},D.prototype.doc=function(){return this.document()},D.prototype.dec=function(A,Z,X){return this.declaration(A,Z,X)},D.prototype.e=function(A,Z,X){return this.element(A,Z,X)},D.prototype.n=function(A,Z,X){return this.node(A,Z,X)},D.prototype.t=function(A){return this.text(A)},D.prototype.d=function(A){return this.cdata(A)},D.prototype.c=function(A){return this.comment(A)},D.prototype.r=function(A){return this.raw(A)},D.prototype.i=function(A,Z){return this.instruction(A,Z)},D.prototype.u=function(){return this.up()},D.prototype.importXMLBuilder=function(A){return this.importDocument(A)},D.prototype.replaceChild=function(A,Z){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.removeChild=function(A){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.appendChild=function(A){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.hasChildNodes=function(){return this.children.length!==0},D.prototype.cloneNode=function(A){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.isSupported=function(A,Z){return!0},D.prototype.hasAttributes=function(){return this.attribs.length!==0},D.prototype.compareDocumentPosition=function(A){var Z,X;return Z=this,Z===A?0:this.document()!==A.document()?(X=t.Disconnected|t.ImplementationSpecific,Math.random()<.5?X|=t.Preceding:X|=t.Following,X):Z.isAncestor(A)?t.Contains|t.Preceding:Z.isDescendant(A)?t.Contains|t.Following:Z.isPreceding(A)?t.Preceding:t.Following},D.prototype.isSameNode=function(A){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.lookupPrefix=function(A){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.isDefaultNamespace=function(A){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.lookupNamespaceURI=function(A){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.isEqualNode=function(A){var Z,X,H;if(A.nodeType!==this.nodeType||A.children.length!==this.children.length)return!1;for(Z=X=0,H=this.children.length-1;0<=H?X<=H:X>=H;Z=0<=H?++X:--X)if(!this.children[Z].isEqualNode(A.children[Z]))return!1;return!0},D.prototype.getFeature=function(A,Z){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.setUserData=function(A,Z,X){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.getUserData=function(A){throw new Error("This DOM method is not implemented."+this.debugInfo())},D.prototype.contains=function(A){return A?A===this||this.isDescendant(A):!1},D.prototype.isDescendant=function(A){var Z,X,H,J,U;for(U=this.children,H=0,J=U.length;H<J;H++)if(Z=U[H],A===Z||(X=Z.isDescendant(A),X))return!0;return!1},D.prototype.isAncestor=function(A){return A.isDescendant(this)},D.prototype.isPreceding=function(A){var Z,X;return Z=this.treePosition(A),X=this.treePosition(this),Z===-1||X===-1?!1:Z<X},D.prototype.isFollowing=function(A){var Z,X;return Z=this.treePosition(A),X=this.treePosition(this),Z===-1||X===-1?!1:Z>X},D.prototype.treePosition=function(A){var Z,X;return X=0,Z=!1,this.foreachTreeNode(this.document(),function(H){if(X++,!Z&&H===A)return Z=!0}),Z?X:-1},D.prototype.foreachTreeNode=function(A,Z){var X,H,J,U,K;for(A||(A=this.document()),U=A.children,H=0,J=U.length;H<J;H++){if(X=U[H],K=Z(X))return K;if(K=this.foreachTreeNode(X,Z),K)return K}},D}()}).call($b)});var Ah=me((Wb,Gb)=>{(function(){var t,r=function(l,u){return function(){return l.apply(u,arguments)}},i={}.hasOwnProperty;Gb.exports=t=function(){function l(u){this.assertLegalName=r(this.assertLegalName,this),this.assertLegalChar=r(this.assertLegalChar,this);var d,g,m;u||(u={}),this.options=u,this.options.version||(this.options.version="1.0"),g=u.stringify||{};for(d in g)i.call(g,d)&&(m=g[d],this[d]=m)}return l.prototype.name=function(u){return this.options.noValidation?u:this.assertLegalName(""+u||"")},l.prototype.text=function(u){return this.options.noValidation?u:this.assertLegalChar(this.textEscape(""+u||""))},l.prototype.cdata=function(u){return this.options.noValidation?u:(u=""+u||"",u=u.replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(u))},l.prototype.comment=function(u){if(this.options.noValidation)return u;if(u=""+u||"",u.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+u);return this.assertLegalChar(u)},l.prototype.raw=function(u){return this.options.noValidation?u:""+u||""},l.prototype.attValue=function(u){return this.options.noValidation?u:this.assertLegalChar(this.attEscape(u=""+u||""))},l.prototype.insTarget=function(u){return this.options.noValidation?u:this.assertLegalChar(""+u||"")},l.prototype.insValue=function(u){if(this.options.noValidation)return u;if(u=""+u||"",u.match(/\?>/))throw new Error("Invalid processing instruction value: "+u);return this.assertLegalChar(u)},l.prototype.xmlVersion=function(u){if(this.options.noValidation)return u;if(u=""+u||"",!u.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+u);return u},l.prototype.xmlEncoding=function(u){if(this.options.noValidation)return u;if(u=""+u||"",!u.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+u);return this.assertLegalChar(u)},l.prototype.xmlStandalone=function(u){return this.options.noValidation?u:u?"yes":"no"},l.prototype.dtdPubID=function(u){return this.options.noValidation?u:this.assertLegalChar(""+u||"")},l.prototype.dtdSysID=function(u){return this.options.noValidation?u:this.assertLegalChar(""+u||"")},l.prototype.dtdElementValue=function(u){return this.options.noValidation?u:this.assertLegalChar(""+u||"")},l.prototype.dtdAttType=function(u){return this.options.noValidation?u:this.assertLegalChar(""+u||"")},l.prototype.dtdAttDefault=function(u){return this.options.noValidation?u:this.assertLegalChar(""+u||"")},l.prototype.dtdEntityValue=function(u){return this.options.noValidation?u:this.assertLegalChar(""+u||"")},l.prototype.dtdNData=function(u){return this.options.noValidation?u:this.assertLegalChar(""+u||"")},l.prototype.convertAttKey="@",l.prototype.convertPIKey="?",l.prototype.convertTextKey="#text",l.prototype.convertCDataKey="#cdata",l.prototype.convertCommentKey="#comment",l.prototype.convertRawKey="#raw",l.prototype.assertLegalChar=function(u){var d,g;if(this.options.noValidation)return u;if(d="",this.options.version==="1.0"){if(d=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,g=u.match(d))throw new Error("Invalid character in string: "+u+" at index "+g.index)}else if(this.options.version==="1.1"&&(d=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,g=u.match(d)))throw new Error("Invalid character in string: "+u+" at index "+g.index);return u},l.prototype.assertLegalName=function(u){var d;if(this.options.noValidation)return u;if(this.assertLegalChar(u),d=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!u.match(d))throw new Error("Invalid character in name");return u},l.prototype.textEscape=function(u){var d;return this.options.noValidation?u:(d=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,u.replace(d,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},l.prototype.attEscape=function(u){var d;return this.options.noValidation?u:(d=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,u.replace(d,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},l}()}).call(Wb)});var Aa=me((Xb,Kb)=>{(function(){Kb.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(Xb)});var Mh=me((Jb,Yb)=>{(function(){var t,r,i,l,u,d,g,m,x,v,I,S,M,E,C,B,$,V={}.hasOwnProperty;$=Tn().assign,t=st(),x=Gl(),v=Ql(),i=Vl(),l=Wl(),S=$l(),E=ec(),C=tc(),M=nc(),I=Nh(),u=Xl(),d=Jl(),g=Kl(),m=Yl(),r=Aa(),Yb.exports=B=function(){function te(R){var D,A,Z;R||(R={}),this.options=R,A=R.writer||{};for(D in A)V.call(A,D)&&(Z=A[D],this["_"+D]=this[D],this[D]=Z)}return te.prototype.filterOptions=function(R){var D,A,Z,X,H,J,U,K;return R||(R={}),R=$({},this.options,R),D={writer:this},D.pretty=R.pretty||!1,D.allowEmpty=R.allowEmpty||!1,D.indent=(A=R.indent)!=null?A:"  ",D.newline=(Z=R.newline)!=null?Z:`
`,D.offset=(X=R.offset)!=null?X:0,D.dontPrettyTextNodes=(H=(J=R.dontPrettyTextNodes)!=null?J:R.dontprettytextnodes)!=null?H:0,D.spaceBeforeSlash=(U=(K=R.spaceBeforeSlash)!=null?K:R.spacebeforeslash)!=null?U:"",D.spaceBeforeSlash===!0&&(D.spaceBeforeSlash=" "),D.suppressPrettyCount=0,D.user={},D.state=r.None,D},te.prototype.indent=function(R,D,A){var Z;return!D.pretty||D.suppressPrettyCount?"":D.pretty&&(Z=(A||0)+D.offset+1,Z>0)?new Array(Z).join(D.indent):""},te.prototype.endline=function(R,D,A){return!D.pretty||D.suppressPrettyCount?"":D.newline},te.prototype.attribute=function(R,D,A){var Z;return this.openAttribute(R,D,A),Z=" "+R.name+'="'+R.value+'"',this.closeAttribute(R,D,A),Z},te.prototype.cdata=function(R,D,A){var Z;return this.openNode(R,D,A),D.state=r.OpenTag,Z=this.indent(R,D,A)+"<![CDATA[",D.state=r.InsideTag,Z+=R.value,D.state=r.CloseTag,Z+="]]>"+this.endline(R,D,A),D.state=r.None,this.closeNode(R,D,A),Z},te.prototype.comment=function(R,D,A){var Z;return this.openNode(R,D,A),D.state=r.OpenTag,Z=this.indent(R,D,A)+"<!-- ",D.state=r.InsideTag,Z+=R.value,D.state=r.CloseTag,Z+=" -->"+this.endline(R,D,A),D.state=r.None,this.closeNode(R,D,A),Z},te.prototype.declaration=function(R,D,A){var Z;return this.openNode(R,D,A),D.state=r.OpenTag,Z=this.indent(R,D,A)+"<?xml",D.state=r.InsideTag,Z+=' version="'+R.version+'"',R.encoding!=null&&(Z+=' encoding="'+R.encoding+'"'),R.standalone!=null&&(Z+=' standalone="'+R.standalone+'"'),D.state=r.CloseTag,Z+=D.spaceBeforeSlash+"?>",Z+=this.endline(R,D,A),D.state=r.None,this.closeNode(R,D,A),Z},te.prototype.docType=function(R,D,A){var Z,X,H,J,U;if(A||(A=0),this.openNode(R,D,A),D.state=r.OpenTag,J=this.indent(R,D,A),J+="<!DOCTYPE "+R.root().name,R.pubID&&R.sysID?J+=' PUBLIC "'+R.pubID+'" "'+R.sysID+'"':R.sysID&&(J+=' SYSTEM "'+R.sysID+'"'),R.children.length>0){for(J+=" [",J+=this.endline(R,D,A),D.state=r.InsideTag,U=R.children,X=0,H=U.length;X<H;X++)Z=U[X],J+=this.writeChildNode(Z,D,A+1);D.state=r.CloseTag,J+="]"}return D.state=r.CloseTag,J+=D.spaceBeforeSlash+">",J+=this.endline(R,D,A),D.state=r.None,this.closeNode(R,D,A),J},te.prototype.element=function(R,D,A){var Z,X,H,J,U,K,se,de,_e,Ce,we,Ue,Ae,ge;A||(A=0),Ce=!1,we="",this.openNode(R,D,A),D.state=r.OpenTag,we+=this.indent(R,D,A)+"<"+R.name,Ue=R.attribs;for(_e in Ue)V.call(Ue,_e)&&(Z=Ue[_e],we+=this.attribute(Z,D,A));if(H=R.children.length,J=H===0?null:R.children[0],H===0||R.children.every(function(ye){return(ye.type===t.Text||ye.type===t.Raw)&&ye.value===""}))D.allowEmpty?(we+=">",D.state=r.CloseTag,we+="</"+R.name+">"+this.endline(R,D,A)):(D.state=r.CloseTag,we+=D.spaceBeforeSlash+"/>"+this.endline(R,D,A));else if(D.pretty&&H===1&&(J.type===t.Text||J.type===t.Raw)&&J.value!=null)we+=">",D.state=r.InsideTag,D.suppressPrettyCount++,Ce=!0,we+=this.writeChildNode(J,D,A+1),D.suppressPrettyCount--,Ce=!1,D.state=r.CloseTag,we+="</"+R.name+">"+this.endline(R,D,A);else{if(D.dontPrettyTextNodes){for(Ae=R.children,U=0,se=Ae.length;U<se;U++)if(X=Ae[U],(X.type===t.Text||X.type===t.Raw)&&X.value!=null){D.suppressPrettyCount++,Ce=!0;break}}for(we+=">"+this.endline(R,D,A),D.state=r.InsideTag,ge=R.children,K=0,de=ge.length;K<de;K++)X=ge[K],we+=this.writeChildNode(X,D,A+1);D.state=r.CloseTag,we+=this.indent(R,D,A)+"</"+R.name+">",Ce&&D.suppressPrettyCount--,we+=this.endline(R,D,A),D.state=r.None}return this.closeNode(R,D,A),we},te.prototype.writeChildNode=function(R,D,A){switch(R.type){case t.CData:return this.cdata(R,D,A);case t.Comment:return this.comment(R,D,A);case t.Element:return this.element(R,D,A);case t.Raw:return this.raw(R,D,A);case t.Text:return this.text(R,D,A);case t.ProcessingInstruction:return this.processingInstruction(R,D,A);case t.Dummy:return"";case t.Declaration:return this.declaration(R,D,A);case t.DocType:return this.docType(R,D,A);case t.AttributeDeclaration:return this.dtdAttList(R,D,A);case t.ElementDeclaration:return this.dtdElement(R,D,A);case t.EntityDeclaration:return this.dtdEntity(R,D,A);case t.NotationDeclaration:return this.dtdNotation(R,D,A);default:throw new Error("Unknown XML node type: "+R.constructor.name)}},te.prototype.processingInstruction=function(R,D,A){var Z;return this.openNode(R,D,A),D.state=r.OpenTag,Z=this.indent(R,D,A)+"<?",D.state=r.InsideTag,Z+=R.target,R.value&&(Z+=" "+R.value),D.state=r.CloseTag,Z+=D.spaceBeforeSlash+"?>",Z+=this.endline(R,D,A),D.state=r.None,this.closeNode(R,D,A),Z},te.prototype.raw=function(R,D,A){var Z;return this.openNode(R,D,A),D.state=r.OpenTag,Z=this.indent(R,D,A),D.state=r.InsideTag,Z+=R.value,D.state=r.CloseTag,Z+=this.endline(R,D,A),D.state=r.None,this.closeNode(R,D,A),Z},te.prototype.text=function(R,D,A){var Z;return this.openNode(R,D,A),D.state=r.OpenTag,Z=this.indent(R,D,A),D.state=r.InsideTag,Z+=R.value,D.state=r.CloseTag,Z+=this.endline(R,D,A),D.state=r.None,this.closeNode(R,D,A),Z},te.prototype.dtdAttList=function(R,D,A){var Z;return this.openNode(R,D,A),D.state=r.OpenTag,Z=this.indent(R,D,A)+"<!ATTLIST",D.state=r.InsideTag,Z+=" "+R.elementName+" "+R.attributeName+" "+R.attributeType,R.defaultValueType!=="#DEFAULT"&&(Z+=" "+R.defaultValueType),R.defaultValue&&(Z+=' "'+R.defaultValue+'"'),D.state=r.CloseTag,Z+=D.spaceBeforeSlash+">"+this.endline(R,D,A),D.state=r.None,this.closeNode(R,D,A),Z},te.prototype.dtdElement=function(R,D,A){var Z;return this.openNode(R,D,A),D.state=r.OpenTag,Z=this.indent(R,D,A)+"<!ELEMENT",D.state=r.InsideTag,Z+=" "+R.name+" "+R.value,D.state=r.CloseTag,Z+=D.spaceBeforeSlash+">"+this.endline(R,D,A),D.state=r.None,this.closeNode(R,D,A),Z},te.prototype.dtdEntity=function(R,D,A){var Z;return this.openNode(R,D,A),D.state=r.OpenTag,Z=this.indent(R,D,A)+"<!ENTITY",D.state=r.InsideTag,R.pe&&(Z+=" %"),Z+=" "+R.name,R.value?Z+=' "'+R.value+'"':(R.pubID&&R.sysID?Z+=' PUBLIC "'+R.pubID+'" "'+R.sysID+'"':R.sysID&&(Z+=' SYSTEM "'+R.sysID+'"'),R.nData&&(Z+=" NDATA "+R.nData)),D.state=r.CloseTag,Z+=D.spaceBeforeSlash+">"+this.endline(R,D,A),D.state=r.None,this.closeNode(R,D,A),Z},te.prototype.dtdNotation=function(R,D,A){var Z;return this.openNode(R,D,A),D.state=r.OpenTag,Z=this.indent(R,D,A)+"<!NOTATION",D.state=r.InsideTag,Z+=" "+R.name,R.pubID&&R.sysID?Z+=' PUBLIC "'+R.pubID+'" "'+R.sysID+'"':R.pubID?Z+=' PUBLIC "'+R.pubID+'"':R.sysID&&(Z+=' SYSTEM "'+R.sysID+'"'),D.state=r.CloseTag,Z+=D.spaceBeforeSlash+">"+this.endline(R,D,A),D.state=r.None,this.closeNode(R,D,A),Z},te.prototype.openNode=function(R,D,A){},te.prototype.closeNode=function(R,D,A){},te.prototype.openAttribute=function(R,D,A){},te.prototype.closeAttribute=function(R,D,A){},te}()}).call(Jb)});var rc=me((Qb,ew)=>{(function(){var t,r,i=function(u,d){for(var g in d)l.call(d,g)&&(u[g]=d[g]);function m(){this.constructor=u}return m.prototype=d.prototype,u.prototype=new m,u.__super__=d.prototype,u},l={}.hasOwnProperty;r=Mh(),ew.exports=t=function(u){i(d,u);function d(g){d.__super__.constructor.call(this,g)}return d.prototype.document=function(g,m){var x,v,I,S,M;for(m=this.filterOptions(m),S="",M=g.children,v=0,I=M.length;v<I;v++)x=M[v],S+=this.writeChildNode(x,m,0);return m.pretty&&S.slice(-m.newline.length)===m.newline&&(S=S.slice(0,-m.newline.length)),S},d}(r)}).call(Qb)});var Dh=me((tw,nw)=>{(function(){var t,r,i,l,u,d,g,m,x=function(I,S){for(var M in S)v.call(S,M)&&(I[M]=S[M]);function E(){this.constructor=I}return E.prototype=S.prototype,I.prototype=new E,I.__super__=S.prototype,I},v={}.hasOwnProperty;m=Tn().isPlainObject,i=kh(),r=ib(),u=jt(),t=st(),g=Ah(),d=rc(),nw.exports=l=function(I){x(S,I);function S(M){S.__super__.constructor.call(this,null),this.name="#document",this.type=t.Document,this.documentURI=null,this.domConfig=new r,M||(M={}),M.writer||(M.writer=new d),this.options=M,this.stringify=new g(M)}return Object.defineProperty(S.prototype,"implementation",{value:new i}),Object.defineProperty(S.prototype,"doctype",{get:function(){var M,E,C,B;for(B=this.children,E=0,C=B.length;E<C;E++)if(M=B[E],M.type===t.DocType)return M;return null}}),Object.defineProperty(S.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(S.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(S.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(S.prototype,"xmlEncoding",{get:function(){return this.children.length!==0&&this.children[0].type===t.Declaration?this.children[0].encoding:null}}),Object.defineProperty(S.prototype,"xmlStandalone",{get:function(){return this.children.length!==0&&this.children[0].type===t.Declaration?this.children[0].standalone==="yes":!1}}),Object.defineProperty(S.prototype,"xmlVersion",{get:function(){return this.children.length!==0&&this.children[0].type===t.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(S.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(S.prototype,"origin",{get:function(){return null}}),Object.defineProperty(S.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(S.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(S.prototype,"contentType",{get:function(){return null}}),S.prototype.end=function(M){var E;return E={},M?m(M)&&(E=M,M=this.options.writer):M=this.options.writer,M.document(this,M.filterOptions(E))},S.prototype.toString=function(M){return this.options.writer.document(this,this.options.writer.filterOptions(M))},S.prototype.createElement=function(M){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.createTextNode=function(M){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.createComment=function(M){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.createCDATASection=function(M){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.createProcessingInstruction=function(M,E){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.createAttribute=function(M){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.createEntityReference=function(M){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.getElementsByTagName=function(M){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.importNode=function(M,E){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.createElementNS=function(M,E){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.createAttributeNS=function(M,E){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.getElementsByTagNameNS=function(M,E){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.getElementById=function(M){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.adoptNode=function(M){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.renameNode=function(M,E,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.getElementsByClassName=function(M){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.createEvent=function(M){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.createNodeIterator=function(M,E,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},S.prototype.createTreeWalker=function(M,E,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},S}(u)}).call(tw)});var ow=me((rw,iw)=>{(function(){var t,r,i,l,u,d,g,m,x,v,I,S,M,E,C,B,$,V,te,R,D,A,Z,X,H={}.hasOwnProperty;X=Tn(),A=X.isObject,D=X.isFunction,Z=X.isPlainObject,R=X.getValue,t=st(),S=Dh(),E=$l(),l=Vl(),u=Wl(),B=ec(),te=tc(),C=nc(),v=Gl(),I=Ql(),d=Xl(),m=Kl(),g=Jl(),x=Yl(),i=Ch(),V=Ah(),$=rc(),r=Aa(),iw.exports=M=function(){function J(U,K,se){var de;this.name="?xml",this.type=t.Document,U||(U={}),de={},U.writer?Z(U.writer)&&(de=U.writer,U.writer=new $):U.writer=new $,this.options=U,this.writer=U.writer,this.writerOptions=this.writer.filterOptions(de),this.stringify=new V(U),this.onDataCallback=K||function(){},this.onEndCallback=se||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return J.prototype.createChildNode=function(U){var K,se,de,_e,Ce,we,Ue,Ae;switch(U.type){case t.CData:this.cdata(U.value);break;case t.Comment:this.comment(U.value);break;case t.Element:de={},Ue=U.attribs;for(se in Ue)H.call(Ue,se)&&(K=Ue[se],de[se]=K.value);this.node(U.name,de);break;case t.Dummy:this.dummy();break;case t.Raw:this.raw(U.value);break;case t.Text:this.text(U.value);break;case t.ProcessingInstruction:this.instruction(U.target,U.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+U.constructor.name)}for(Ae=U.children,Ce=0,we=Ae.length;Ce<we;Ce++)_e=Ae[Ce],this.createChildNode(_e),_e.type===t.Element&&this.up();return this},J.prototype.dummy=function(){return this},J.prototype.node=function(U,K,se){var de;if(U==null)throw new Error("Missing node name.");if(this.root&&this.currentLevel===-1)throw new Error("Document can only have one root node. "+this.debugInfo(U));return this.openCurrent(),U=R(U),K==null&&(K={}),K=R(K),A(K)||(de=[K,se],se=de[0],K=de[1]),this.currentNode=new E(this,U,K),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,se!=null&&this.text(se),this},J.prototype.element=function(U,K,se){var de,_e,Ce,we,Ue,Ae;if(this.currentNode&&this.currentNode.type===t.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(U)||A(U)||D(U))for(we=this.options.noValidation,this.options.noValidation=!0,Ae=new S(this.options).element("TEMP_ROOT"),Ae.element(U),this.options.noValidation=we,Ue=Ae.children,_e=0,Ce=Ue.length;_e<Ce;_e++)de=Ue[_e],this.createChildNode(de),de.type===t.Element&&this.up();else this.node(U,K,se);return this},J.prototype.attribute=function(U,K){var se,de;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(U));if(U!=null&&(U=R(U)),A(U))for(se in U)H.call(U,se)&&(de=U[se],this.attribute(se,de));else D(K)&&(K=K.apply()),this.options.keepNullAttributes&&K==null?this.currentNode.attribs[U]=new i(this,U,""):K!=null&&(this.currentNode.attribs[U]=new i(this,U,K));return this},J.prototype.text=function(U){var K;return this.openCurrent(),K=new te(this,U),this.onData(this.writer.text(K,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},J.prototype.cdata=function(U){var K;return this.openCurrent(),K=new l(this,U),this.onData(this.writer.cdata(K,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},J.prototype.comment=function(U){var K;return this.openCurrent(),K=new u(this,U),this.onData(this.writer.comment(K,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},J.prototype.raw=function(U){var K;return this.openCurrent(),K=new B(this,U),this.onData(this.writer.raw(K,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},J.prototype.instruction=function(U,K){var se,de,_e,Ce,we;if(this.openCurrent(),U!=null&&(U=R(U)),K!=null&&(K=R(K)),Array.isArray(U))for(se=0,Ce=U.length;se<Ce;se++)de=U[se],this.instruction(de);else if(A(U))for(de in U)H.call(U,de)&&(_e=U[de],this.instruction(de,_e));else D(K)&&(K=K.apply()),we=new C(this,U,K),this.onData(this.writer.processingInstruction(we,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},J.prototype.declaration=function(U,K,se){var de;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return de=new v(this,U,K,se),this.onData(this.writer.declaration(de,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},J.prototype.doctype=function(U,K,se){if(this.openCurrent(),U==null)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new I(this,K,se),this.currentNode.rootNodeName=U,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},J.prototype.dtdElement=function(U,K){var se;return this.openCurrent(),se=new g(this,U,K),this.onData(this.writer.dtdElement(se,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},J.prototype.attList=function(U,K,se,de,_e){var Ce;return this.openCurrent(),Ce=new d(this,U,K,se,de,_e),this.onData(this.writer.dtdAttList(Ce,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},J.prototype.entity=function(U,K){var se;return this.openCurrent(),se=new m(this,!1,U,K),this.onData(this.writer.dtdEntity(se,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},J.prototype.pEntity=function(U,K){var se;return this.openCurrent(),se=new m(this,!0,U,K),this.onData(this.writer.dtdEntity(se,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},J.prototype.notation=function(U,K){var se;return this.openCurrent(),se=new x(this,U,K),this.onData(this.writer.dtdNotation(se,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},J.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},J.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},J.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},J.prototype.openNode=function(U){var K,se,de,_e;if(!U.isOpen){if(!this.root&&this.currentLevel===0&&U.type===t.Element&&(this.root=U),se="",U.type===t.Element){this.writerOptions.state=r.OpenTag,se=this.writer.indent(U,this.writerOptions,this.currentLevel)+"<"+U.name,_e=U.attribs;for(de in _e)H.call(_e,de)&&(K=_e[de],se+=this.writer.attribute(K,this.writerOptions,this.currentLevel));se+=(U.children?">":"/>")+this.writer.endline(U,this.writerOptions,this.currentLevel),this.writerOptions.state=r.InsideTag}else this.writerOptions.state=r.OpenTag,se=this.writer.indent(U,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+U.rootNodeName,U.pubID&&U.sysID?se+=' PUBLIC "'+U.pubID+'" "'+U.sysID+'"':U.sysID&&(se+=' SYSTEM "'+U.sysID+'"'),U.children?(se+=" [",this.writerOptions.state=r.InsideTag):(this.writerOptions.state=r.CloseTag,se+=">"),se+=this.writer.endline(U,this.writerOptions,this.currentLevel);return this.onData(se,this.currentLevel),U.isOpen=!0}},J.prototype.closeNode=function(U){var K;if(!U.isClosed)return K="",this.writerOptions.state=r.CloseTag,U.type===t.Element?K=this.writer.indent(U,this.writerOptions,this.currentLevel)+"</"+U.name+">"+this.writer.endline(U,this.writerOptions,this.currentLevel):K=this.writer.indent(U,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(U,this.writerOptions,this.currentLevel),this.writerOptions.state=r.None,this.onData(K,this.currentLevel),U.isClosed=!0},J.prototype.onData=function(U,K){return this.documentStarted=!0,this.onDataCallback(U,K+1)},J.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},J.prototype.debugInfo=function(U){return U==null?"":"node: <"+U+">"},J.prototype.ele=function(){return this.element.apply(this,arguments)},J.prototype.nod=function(U,K,se){return this.node(U,K,se)},J.prototype.txt=function(U){return this.text(U)},J.prototype.dat=function(U){return this.cdata(U)},J.prototype.com=function(U){return this.comment(U)},J.prototype.ins=function(U,K){return this.instruction(U,K)},J.prototype.dec=function(U,K,se){return this.declaration(U,K,se)},J.prototype.dtd=function(U,K,se){return this.doctype(U,K,se)},J.prototype.e=function(U,K,se){return this.element(U,K,se)},J.prototype.n=function(U,K,se){return this.node(U,K,se)},J.prototype.t=function(U){return this.text(U)},J.prototype.d=function(U){return this.cdata(U)},J.prototype.c=function(U){return this.comment(U)},J.prototype.r=function(U){return this.raw(U)},J.prototype.i=function(U,K){return this.instruction(U,K)},J.prototype.att=function(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},J.prototype.a=function(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},J.prototype.ent=function(U,K){return this.entity(U,K)},J.prototype.pent=function(U,K){return this.pEntity(U,K)},J.prototype.not=function(U,K){return this.notation(U,K)},J}()}).call(rw)});var lw=me((aw,sw)=>{(function(){var t,r,i,l,u=function(g,m){for(var x in m)d.call(m,x)&&(g[x]=m[x]);function v(){this.constructor=g}return v.prototype=m.prototype,g.prototype=new v,g.__super__=m.prototype,g},d={}.hasOwnProperty;t=st(),l=Mh(),r=Aa(),sw.exports=i=function(g){u(m,g);function m(x,v){this.stream=x,m.__super__.constructor.call(this,v)}return m.prototype.endline=function(x,v,I){return x.isLastRootNode&&v.state===r.CloseTag?"":m.__super__.endline.call(this,x,v,I)},m.prototype.document=function(x,v){var I,S,M,E,C,B,$,V,te;for($=x.children,S=M=0,C=$.length;M<C;S=++M)I=$[S],I.isLastRootNode=S===x.children.length-1;for(v=this.filterOptions(v),V=x.children,te=[],E=0,B=V.length;E<B;E++)I=V[E],te.push(this.writeChildNode(I,v,0));return te},m.prototype.attribute=function(x,v,I){return this.stream.write(m.__super__.attribute.call(this,x,v,I))},m.prototype.cdata=function(x,v,I){return this.stream.write(m.__super__.cdata.call(this,x,v,I))},m.prototype.comment=function(x,v,I){return this.stream.write(m.__super__.comment.call(this,x,v,I))},m.prototype.declaration=function(x,v,I){return this.stream.write(m.__super__.declaration.call(this,x,v,I))},m.prototype.docType=function(x,v,I){var S,M,E,C;if(I||(I=0),this.openNode(x,v,I),v.state=r.OpenTag,this.stream.write(this.indent(x,v,I)),this.stream.write("<!DOCTYPE "+x.root().name),x.pubID&&x.sysID?this.stream.write(' PUBLIC "'+x.pubID+'" "'+x.sysID+'"'):x.sysID&&this.stream.write(' SYSTEM "'+x.sysID+'"'),x.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(x,v,I)),v.state=r.InsideTag,C=x.children,M=0,E=C.length;M<E;M++)S=C[M],this.writeChildNode(S,v,I+1);v.state=r.CloseTag,this.stream.write("]")}return v.state=r.CloseTag,this.stream.write(v.spaceBeforeSlash+">"),this.stream.write(this.endline(x,v,I)),v.state=r.None,this.closeNode(x,v,I)},m.prototype.element=function(x,v,I){var S,M,E,C,B,$,V,te,R,D;I||(I=0),this.openNode(x,v,I),v.state=r.OpenTag,this.stream.write(this.indent(x,v,I)+"<"+x.name),R=x.attribs;for(V in R)d.call(R,V)&&(S=R[V],this.attribute(S,v,I));if(E=x.children.length,C=E===0?null:x.children[0],E===0||x.children.every(function(A){return(A.type===t.Text||A.type===t.Raw)&&A.value===""}))v.allowEmpty?(this.stream.write(">"),v.state=r.CloseTag,this.stream.write("</"+x.name+">")):(v.state=r.CloseTag,this.stream.write(v.spaceBeforeSlash+"/>"));else if(v.pretty&&E===1&&(C.type===t.Text||C.type===t.Raw)&&C.value!=null)this.stream.write(">"),v.state=r.InsideTag,v.suppressPrettyCount++,te=!0,this.writeChildNode(C,v,I+1),v.suppressPrettyCount--,te=!1,v.state=r.CloseTag,this.stream.write("</"+x.name+">");else{for(this.stream.write(">"+this.endline(x,v,I)),v.state=r.InsideTag,D=x.children,B=0,$=D.length;B<$;B++)M=D[B],this.writeChildNode(M,v,I+1);v.state=r.CloseTag,this.stream.write(this.indent(x,v,I)+"</"+x.name+">")}return this.stream.write(this.endline(x,v,I)),v.state=r.None,this.closeNode(x,v,I)},m.prototype.processingInstruction=function(x,v,I){return this.stream.write(m.__super__.processingInstruction.call(this,x,v,I))},m.prototype.raw=function(x,v,I){return this.stream.write(m.__super__.raw.call(this,x,v,I))},m.prototype.text=function(x,v,I){return this.stream.write(m.__super__.text.call(this,x,v,I))},m.prototype.dtdAttList=function(x,v,I){return this.stream.write(m.__super__.dtdAttList.call(this,x,v,I))},m.prototype.dtdElement=function(x,v,I){return this.stream.write(m.__super__.dtdElement.call(this,x,v,I))},m.prototype.dtdEntity=function(x,v,I){return this.stream.write(m.__super__.dtdEntity.call(this,x,v,I))},m.prototype.dtdNotation=function(x,v,I){return this.stream.write(m.__super__.dtdNotation.call(this,x,v,I))},m}(l)}).call(aw)});var uw=me((cw,pr)=>{(function(){var t,r,i,l,u,d,g,m,x,v;v=Tn(),m=v.assign,x=v.isFunction,i=kh(),l=Dh(),u=ow(),g=rc(),d=lw(),t=st(),r=Aa(),pr.exports.create=function(I,S,M,E){var C,B;if(I==null)throw new Error("Root element needs a name.");return E=m({},S,M,E),C=new l(E),B=C.element(I),E.headless||(C.declaration(E),(E.pubID!=null||E.sysID!=null)&&C.dtd(E)),B},pr.exports.begin=function(I,S,M){var E;return x(I)&&(E=[I,S],S=E[0],M=E[1],I={}),S?new u(I,S,M):new l(I)},pr.exports.stringWriter=function(I){return new g(I)},pr.exports.streamWriter=function(I,S){return new d(I,S)},pr.exports.implementation=new i,pr.exports.nodeType=t,pr.exports.writerState=r}).call(cw)});var fw=me(Sh=>{(function(){"use strict";var t,r,i,l,u,d={}.hasOwnProperty;t=uw(),r=jl().defaults,l=function(g){return typeof g=="string"&&(g.indexOf("&")>=0||g.indexOf(">")>=0||g.indexOf("<")>=0)},u=function(g){return"<![CDATA["+i(g)+"]]>"},i=function(g){return g.replace("]]>","]]]]><![CDATA[>")},Sh.Builder=function(){function g(m){var x,v,I;this.options={},v=r["0.2"];for(x in v)d.call(v,x)&&(I=v[x],this.options[x]=I);for(x in m)d.call(m,x)&&(I=m[x],this.options[x]=I)}return g.prototype.buildObject=function(m){var x,v,I,S,M;return x=this.options.attrkey,v=this.options.charkey,Object.keys(m).length===1&&this.options.rootName===r["0.2"].rootName?(M=Object.keys(m)[0],m=m[M]):M=this.options.rootName,I=function(E){return function(C,B){var $,V,te,R,D,A;if(typeof B!="object")E.options.cdata&&l(B)?C.raw(u(B)):C.txt(B);else if(Array.isArray(B)){for(R in B)if(d.call(B,R)){V=B[R];for(D in V)te=V[D],C=I(C.ele(D),te).up()}}else for(D in B)if(d.call(B,D))if(V=B[D],D===x){if(typeof V=="object")for($ in V)A=V[$],C=C.att($,A)}else if(D===v)E.options.cdata&&l(V)?C=C.raw(u(V)):C=C.txt(V);else if(Array.isArray(V))for(R in V)d.call(V,R)&&(te=V[R],typeof te=="string"?E.options.cdata&&l(te)?C=C.ele(D).raw(u(te)).up():C=C.ele(D,te).up():C=I(C.ele(D),te).up());else typeof V=="object"?C=I(C.ele(D),V).up():typeof V=="string"&&E.options.cdata&&l(V)?C=C.ele(D).raw(u(V)).up():(V==null&&(V=""),C=C.ele(D,V.toString()).up());return C}}(this),S=t.create(M,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),I(S,m).end(this.options.renderOpts)},g}()}).call(Sh)});var pw=me(ic=>{"use strict";ic.byteLength=HI;ic.toByteArray=VI;ic.fromByteArray=XI;var In=[],Jt=[],jI=typeof Uint8Array<"u"?Uint8Array:Array,Lh="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for($r=0,hw=Lh.length;$r<hw;++$r)In[$r]=Lh[$r],Jt[Lh.charCodeAt($r)]=$r;var $r,hw;Jt["-".charCodeAt(0)]=62;Jt["_".charCodeAt(0)]=63;function dw(t){var r=t.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");i===-1&&(i=r);var l=i===r?0:4-i%4;return[i,l]}function HI(t){var r=dw(t),i=r[0],l=r[1];return(i+l)*3/4-l}function $I(t,r,i){return(r+i)*3/4-i}function VI(t){var r,i=dw(t),l=i[0],u=i[1],d=new jI($I(t,l,u)),g=0,m=u>0?l-4:l,x;for(x=0;x<m;x+=4)r=Jt[t.charCodeAt(x)]<<18|Jt[t.charCodeAt(x+1)]<<12|Jt[t.charCodeAt(x+2)]<<6|Jt[t.charCodeAt(x+3)],d[g++]=r>>16&255,d[g++]=r>>8&255,d[g++]=r&255;return u===2&&(r=Jt[t.charCodeAt(x)]<<2|Jt[t.charCodeAt(x+1)]>>4,d[g++]=r&255),u===1&&(r=Jt[t.charCodeAt(x)]<<10|Jt[t.charCodeAt(x+1)]<<4|Jt[t.charCodeAt(x+2)]>>2,d[g++]=r>>8&255,d[g++]=r&255),d}function WI(t){return In[t>>18&63]+In[t>>12&63]+In[t>>6&63]+In[t&63]}function GI(t,r,i){for(var l,u=[],d=r;d<i;d+=3)l=(t[d]<<16&16711680)+(t[d+1]<<8&65280)+(t[d+2]&255),u.push(WI(l));return u.join("")}function XI(t){for(var r,i=t.length,l=i%3,u=[],d=16383,g=0,m=i-l;g<m;g+=d)u.push(GI(t,g,g+d>m?m:g+d));return l===1?(r=t[i-1],u.push(In[r>>2]+In[r<<4&63]+"==")):l===2&&(r=(t[i-2]<<8)+t[i-1],u.push(In[r>>10]+In[r>>4&63]+In[r<<2&63]+"=")),u.join("")}});var gw=me(Ph=>{Ph.read=function(t,r,i,l,u){var d,g,m=u*8-l-1,x=(1<<m)-1,v=x>>1,I=-7,S=i?u-1:0,M=i?-1:1,E=t[r+S];for(S+=M,d=E&(1<<-I)-1,E>>=-I,I+=m;I>0;d=d*256+t[r+S],S+=M,I-=8);for(g=d&(1<<-I)-1,d>>=-I,I+=l;I>0;g=g*256+t[r+S],S+=M,I-=8);if(d===0)d=1-v;else{if(d===x)return g?NaN:(E?-1:1)*(1/0);g=g+Math.pow(2,l),d=d-v}return(E?-1:1)*g*Math.pow(2,d-l)};Ph.write=function(t,r,i,l,u,d){var g,m,x,v=d*8-u-1,I=(1<<v)-1,S=I>>1,M=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=l?0:d-1,C=l?1:-1,B=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(m=isNaN(r)?1:0,g=I):(g=Math.floor(Math.log(r)/Math.LN2),r*(x=Math.pow(2,-g))<1&&(g--,x*=2),g+S>=1?r+=M/x:r+=M*Math.pow(2,1-S),r*x>=2&&(g++,x/=2),g+S>=I?(m=0,g=I):g+S>=1?(m=(r*x-1)*Math.pow(2,u),g=g+S):(m=r*Math.pow(2,S-1)*Math.pow(2,u),g=0));u>=8;t[i+E]=m&255,E+=C,m/=256,u-=8);for(g=g<<u|m,v+=u;v>0;t[i+E]=g&255,E+=C,g/=256,v-=8);t[i+E-C]|=B*128}});var Sw=me(zi=>{"use strict";var Oh=pw(),Fi=gw(),mw=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;zi.Buffer=le;zi.SlowBuffer=t5;zi.INSPECT_MAX_BYTES=50;var oc=2147483647;zi.kMaxLength=oc;le.TYPED_ARRAY_SUPPORT=KI();!le.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function KI(){try{let t=new Uint8Array(1),r={foo:function(){return 42}};return Object.setPrototypeOf(r,Uint8Array.prototype),Object.setPrototypeOf(t,r),t.foo()===42}catch{return!1}}Object.defineProperty(le.prototype,"parent",{enumerable:!0,get:function(){if(le.isBuffer(this))return this.buffer}});Object.defineProperty(le.prototype,"offset",{enumerable:!0,get:function(){if(le.isBuffer(this))return this.byteOffset}});function $n(t){if(t>oc)throw new RangeError('The value "'+t+'" is invalid for option "size"');let r=new Uint8Array(t);return Object.setPrototypeOf(r,le.prototype),r}function le(t,r,i){if(typeof t=="number"){if(typeof r=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return zh(t)}return _w(t,r,i)}le.poolSize=8192;function _w(t,r,i){if(typeof t=="string")return YI(t,r);if(ArrayBuffer.isView(t))return QI(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(En(t,ArrayBuffer)||t&&En(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(En(t,SharedArrayBuffer)||t&&En(t.buffer,SharedArrayBuffer)))return Fh(t,r,i);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let l=t.valueOf&&t.valueOf();if(l!=null&&l!==t)return le.from(l,r,i);let u=e5(t);if(u)return u;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return le.from(t[Symbol.toPrimitive]("string"),r,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}le.from=function(t,r,i){return _w(t,r,i)};Object.setPrototypeOf(le.prototype,Uint8Array.prototype);Object.setPrototypeOf(le,Uint8Array);function vw(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function JI(t,r,i){return vw(t),t<=0?$n(t):r!==void 0?typeof i=="string"?$n(t).fill(r,i):$n(t).fill(r):$n(t)}le.alloc=function(t,r,i){return JI(t,r,i)};function zh(t){return vw(t),$n(t<0?0:qh(t)|0)}le.allocUnsafe=function(t){return zh(t)};le.allocUnsafeSlow=function(t){return zh(t)};function YI(t,r){if((typeof r!="string"||r==="")&&(r="utf8"),!le.isEncoding(r))throw new TypeError("Unknown encoding: "+r);let i=xw(t,r)|0,l=$n(i),u=l.write(t,r);return u!==i&&(l=l.slice(0,u)),l}function Rh(t){let r=t.length<0?0:qh(t.length)|0,i=$n(r);for(let l=0;l<r;l+=1)i[l]=t[l]&255;return i}function QI(t){if(En(t,Uint8Array)){let r=new Uint8Array(t);return Fh(r.buffer,r.byteOffset,r.byteLength)}return Rh(t)}function Fh(t,r,i){if(r<0||t.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<r+(i||0))throw new RangeError('"length" is outside of buffer bounds');let l;return r===void 0&&i===void 0?l=new Uint8Array(t):i===void 0?l=new Uint8Array(t,r):l=new Uint8Array(t,r,i),Object.setPrototypeOf(l,le.prototype),l}function e5(t){if(le.isBuffer(t)){let r=qh(t.length)|0,i=$n(r);return i.length===0||t.copy(i,0,0,r),i}if(t.length!==void 0)return typeof t.length!="number"||Zh(t.length)?$n(0):Rh(t);if(t.type==="Buffer"&&Array.isArray(t.data))return Rh(t.data)}function qh(t){if(t>=oc)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+oc.toString(16)+" bytes");return t|0}function t5(t){return+t!=t&&(t=0),le.alloc(+t)}le.isBuffer=function(r){return r!=null&&r._isBuffer===!0&&r!==le.prototype};le.compare=function(r,i){if(En(r,Uint8Array)&&(r=le.from(r,r.offset,r.byteLength)),En(i,Uint8Array)&&(i=le.from(i,i.offset,i.byteLength)),!le.isBuffer(r)||!le.isBuffer(i))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(r===i)return 0;let l=r.length,u=i.length;for(let d=0,g=Math.min(l,u);d<g;++d)if(r[d]!==i[d]){l=r[d],u=i[d];break}return l<u?-1:u<l?1:0};le.isEncoding=function(r){switch(String(r).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};le.concat=function(r,i){if(!Array.isArray(r))throw new TypeError('"list" argument must be an Array of Buffers');if(r.length===0)return le.alloc(0);let l;if(i===void 0)for(i=0,l=0;l<r.length;++l)i+=r[l].length;let u=le.allocUnsafe(i),d=0;for(l=0;l<r.length;++l){let g=r[l];if(En(g,Uint8Array))d+g.length>u.length?(le.isBuffer(g)||(g=le.from(g)),g.copy(u,d)):Uint8Array.prototype.set.call(u,g,d);else if(le.isBuffer(g))g.copy(u,d);else throw new TypeError('"list" argument must be an Array of Buffers');d+=g.length}return u};function xw(t,r){if(le.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||En(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let i=t.length,l=arguments.length>2&&arguments[2]===!0;if(!l&&i===0)return 0;let u=!1;for(;;)switch(r){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return Bh(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return i*2;case"hex":return i>>>1;case"base64":return Dw(t).length;default:if(u)return l?-1:Bh(t).length;r=(""+r).toLowerCase(),u=!0}}le.byteLength=xw;function n5(t,r,i){let l=!1;if((r===void 0||r<0)&&(r=0),r>this.length||((i===void 0||i>this.length)&&(i=this.length),i<=0)||(i>>>=0,r>>>=0,i<=r))return"";for(t||(t="utf8");;)switch(t){case"hex":return h5(this,r,i);case"utf8":case"utf-8":return Iw(this,r,i);case"ascii":return u5(this,r,i);case"latin1":case"binary":return f5(this,r,i);case"base64":return l5(this,r,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return d5(this,r,i);default:if(l)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),l=!0}}le.prototype._isBuffer=!0;function Vr(t,r,i){let l=t[r];t[r]=t[i],t[i]=l}le.prototype.swap16=function(){let r=this.length;if(r%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let i=0;i<r;i+=2)Vr(this,i,i+1);return this};le.prototype.swap32=function(){let r=this.length;if(r%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let i=0;i<r;i+=4)Vr(this,i,i+3),Vr(this,i+1,i+2);return this};le.prototype.swap64=function(){let r=this.length;if(r%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let i=0;i<r;i+=8)Vr(this,i,i+7),Vr(this,i+1,i+6),Vr(this,i+2,i+5),Vr(this,i+3,i+4);return this};le.prototype.toString=function(){let r=this.length;return r===0?"":arguments.length===0?Iw(this,0,r):n5.apply(this,arguments)};le.prototype.toLocaleString=le.prototype.toString;le.prototype.equals=function(r){if(!le.isBuffer(r))throw new TypeError("Argument must be a Buffer");return this===r?!0:le.compare(this,r)===0};le.prototype.inspect=function(){let r="",i=zi.INSPECT_MAX_BYTES;return r=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(r+=" ... "),"<Buffer "+r+">"};mw&&(le.prototype[mw]=le.prototype.inspect);le.prototype.compare=function(r,i,l,u,d){if(En(r,Uint8Array)&&(r=le.from(r,r.offset,r.byteLength)),!le.isBuffer(r))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof r);if(i===void 0&&(i=0),l===void 0&&(l=r?r.length:0),u===void 0&&(u=0),d===void 0&&(d=this.length),i<0||l>r.length||u<0||d>this.length)throw new RangeError("out of range index");if(u>=d&&i>=l)return 0;if(u>=d)return-1;if(i>=l)return 1;if(i>>>=0,l>>>=0,u>>>=0,d>>>=0,this===r)return 0;let g=d-u,m=l-i,x=Math.min(g,m),v=this.slice(u,d),I=r.slice(i,l);for(let S=0;S<x;++S)if(v[S]!==I[S]){g=v[S],m=I[S];break}return g<m?-1:m<g?1:0};function Tw(t,r,i,l,u){if(t.length===0)return-1;if(typeof i=="string"?(l=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,Zh(i)&&(i=u?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(u)return-1;i=t.length-1}else if(i<0)if(u)i=0;else return-1;if(typeof r=="string"&&(r=le.from(r,l)),le.isBuffer(r))return r.length===0?-1:yw(t,r,i,l,u);if(typeof r=="number")return r=r&255,typeof Uint8Array.prototype.indexOf=="function"?u?Uint8Array.prototype.indexOf.call(t,r,i):Uint8Array.prototype.lastIndexOf.call(t,r,i):yw(t,[r],i,l,u);throw new TypeError("val must be string, number or Buffer")}function yw(t,r,i,l,u){let d=1,g=t.length,m=r.length;if(l!==void 0&&(l=String(l).toLowerCase(),l==="ucs2"||l==="ucs-2"||l==="utf16le"||l==="utf-16le")){if(t.length<2||r.length<2)return-1;d=2,g/=2,m/=2,i/=2}function x(I,S){return d===1?I[S]:I.readUInt16BE(S*d)}let v;if(u){let I=-1;for(v=i;v<g;v++)if(x(t,v)===x(r,I===-1?0:v-I)){if(I===-1&&(I=v),v-I+1===m)return I*d}else I!==-1&&(v-=v-I),I=-1}else for(i+m>g&&(i=g-m),v=i;v>=0;v--){let I=!0;for(let S=0;S<m;S++)if(x(t,v+S)!==x(r,S)){I=!1;break}if(I)return v}return-1}le.prototype.includes=function(r,i,l){return this.indexOf(r,i,l)!==-1};le.prototype.indexOf=function(r,i,l){return Tw(this,r,i,l,!0)};le.prototype.lastIndexOf=function(r,i,l){return Tw(this,r,i,l,!1)};function r5(t,r,i,l){i=Number(i)||0;let u=t.length-i;l?(l=Number(l),l>u&&(l=u)):l=u;let d=r.length;l>d/2&&(l=d/2);let g;for(g=0;g<l;++g){let m=parseInt(r.substr(g*2,2),16);if(Zh(m))return g;t[i+g]=m}return g}function i5(t,r,i,l){return ac(Bh(r,t.length-i),t,i,l)}function o5(t,r,i,l){return ac(y5(r),t,i,l)}function a5(t,r,i,l){return ac(Dw(r),t,i,l)}function s5(t,r,i,l){return ac(b5(r,t.length-i),t,i,l)}le.prototype.write=function(r,i,l,u){if(i===void 0)u="utf8",l=this.length,i=0;else if(l===void 0&&typeof i=="string")u=i,l=this.length,i=0;else if(isFinite(i))i=i>>>0,isFinite(l)?(l=l>>>0,u===void 0&&(u="utf8")):(u=l,l=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let d=this.length-i;if((l===void 0||l>d)&&(l=d),r.length>0&&(l<0||i<0)||i>this.length)throw new RangeError("Attempt to write outside buffer bounds");u||(u="utf8");let g=!1;for(;;)switch(u){case"hex":return r5(this,r,i,l);case"utf8":case"utf-8":return i5(this,r,i,l);case"ascii":case"latin1":case"binary":return o5(this,r,i,l);case"base64":return a5(this,r,i,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return s5(this,r,i,l);default:if(g)throw new TypeError("Unknown encoding: "+u);u=(""+u).toLowerCase(),g=!0}};le.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function l5(t,r,i){return r===0&&i===t.length?Oh.fromByteArray(t):Oh.fromByteArray(t.slice(r,i))}function Iw(t,r,i){i=Math.min(t.length,i);let l=[],u=r;for(;u<i;){let d=t[u],g=null,m=d>239?4:d>223?3:d>191?2:1;if(u+m<=i){let x,v,I,S;switch(m){case 1:d<128&&(g=d);break;case 2:x=t[u+1],(x&192)===128&&(S=(d&31)<<6|x&63,S>127&&(g=S));break;case 3:x=t[u+1],v=t[u+2],(x&192)===128&&(v&192)===128&&(S=(d&15)<<12|(x&63)<<6|v&63,S>2047&&(S<55296||S>57343)&&(g=S));break;case 4:x=t[u+1],v=t[u+2],I=t[u+3],(x&192)===128&&(v&192)===128&&(I&192)===128&&(S=(d&15)<<18|(x&63)<<12|(v&63)<<6|I&63,S>65535&&S<1114112&&(g=S))}}g===null?(g=65533,m=1):g>65535&&(g-=65536,l.push(g>>>10&1023|55296),g=56320|g&1023),l.push(g),u+=m}return c5(l)}var bw=4096;function c5(t){let r=t.length;if(r<=bw)return String.fromCharCode.apply(String,t);let i="",l=0;for(;l<r;)i+=String.fromCharCode.apply(String,t.slice(l,l+=bw));return i}function u5(t,r,i){let l="";i=Math.min(t.length,i);for(let u=r;u<i;++u)l+=String.fromCharCode(t[u]&127);return l}function f5(t,r,i){let l="";i=Math.min(t.length,i);for(let u=r;u<i;++u)l+=String.fromCharCode(t[u]);return l}function h5(t,r,i){let l=t.length;(!r||r<0)&&(r=0),(!i||i<0||i>l)&&(i=l);let u="";for(let d=r;d<i;++d)u+=w5[t[d]];return u}function d5(t,r,i){let l=t.slice(r,i),u="";for(let d=0;d<l.length-1;d+=2)u+=String.fromCharCode(l[d]+l[d+1]*256);return u}le.prototype.slice=function(r,i){let l=this.length;r=~~r,i=i===void 0?l:~~i,r<0?(r+=l,r<0&&(r=0)):r>l&&(r=l),i<0?(i+=l,i<0&&(i=0)):i>l&&(i=l),i<r&&(i=r);let u=this.subarray(r,i);return Object.setPrototypeOf(u,le.prototype),u};function pt(t,r,i){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+r>i)throw new RangeError("Trying to access beyond buffer length")}le.prototype.readUintLE=le.prototype.readUIntLE=function(r,i,l){r=r>>>0,i=i>>>0,l||pt(r,i,this.length);let u=this[r],d=1,g=0;for(;++g<i&&(d*=256);)u+=this[r+g]*d;return u};le.prototype.readUintBE=le.prototype.readUIntBE=function(r,i,l){r=r>>>0,i=i>>>0,l||pt(r,i,this.length);let u=this[r+--i],d=1;for(;i>0&&(d*=256);)u+=this[r+--i]*d;return u};le.prototype.readUint8=le.prototype.readUInt8=function(r,i){return r=r>>>0,i||pt(r,1,this.length),this[r]};le.prototype.readUint16LE=le.prototype.readUInt16LE=function(r,i){return r=r>>>0,i||pt(r,2,this.length),this[r]|this[r+1]<<8};le.prototype.readUint16BE=le.prototype.readUInt16BE=function(r,i){return r=r>>>0,i||pt(r,2,this.length),this[r]<<8|this[r+1]};le.prototype.readUint32LE=le.prototype.readUInt32LE=function(r,i){return r=r>>>0,i||pt(r,4,this.length),(this[r]|this[r+1]<<8|this[r+2]<<16)+this[r+3]*16777216};le.prototype.readUint32BE=le.prototype.readUInt32BE=function(r,i){return r=r>>>0,i||pt(r,4,this.length),this[r]*16777216+(this[r+1]<<16|this[r+2]<<8|this[r+3])};le.prototype.readBigUInt64LE=gr(function(r){r=r>>>0,Bi(r,"offset");let i=this[r],l=this[r+7];(i===void 0||l===void 0)&&Ma(r,this.length-8);let u=i+this[++r]*2**8+this[++r]*2**16+this[++r]*2**24,d=this[++r]+this[++r]*2**8+this[++r]*2**16+l*2**24;return BigInt(u)+(BigInt(d)<<BigInt(32))});le.prototype.readBigUInt64BE=gr(function(r){r=r>>>0,Bi(r,"offset");let i=this[r],l=this[r+7];(i===void 0||l===void 0)&&Ma(r,this.length-8);let u=i*2**24+this[++r]*2**16+this[++r]*2**8+this[++r],d=this[++r]*2**24+this[++r]*2**16+this[++r]*2**8+l;return(BigInt(u)<<BigInt(32))+BigInt(d)});le.prototype.readIntLE=function(r,i,l){r=r>>>0,i=i>>>0,l||pt(r,i,this.length);let u=this[r],d=1,g=0;for(;++g<i&&(d*=256);)u+=this[r+g]*d;return d*=128,u>=d&&(u-=Math.pow(2,8*i)),u};le.prototype.readIntBE=function(r,i,l){r=r>>>0,i=i>>>0,l||pt(r,i,this.length);let u=i,d=1,g=this[r+--u];for(;u>0&&(d*=256);)g+=this[r+--u]*d;return d*=128,g>=d&&(g-=Math.pow(2,8*i)),g};le.prototype.readInt8=function(r,i){return r=r>>>0,i||pt(r,1,this.length),this[r]&128?(255-this[r]+1)*-1:this[r]};le.prototype.readInt16LE=function(r,i){r=r>>>0,i||pt(r,2,this.length);let l=this[r]|this[r+1]<<8;return l&32768?l|4294901760:l};le.prototype.readInt16BE=function(r,i){r=r>>>0,i||pt(r,2,this.length);let l=this[r+1]|this[r]<<8;return l&32768?l|4294901760:l};le.prototype.readInt32LE=function(r,i){return r=r>>>0,i||pt(r,4,this.length),this[r]|this[r+1]<<8|this[r+2]<<16|this[r+3]<<24};le.prototype.readInt32BE=function(r,i){return r=r>>>0,i||pt(r,4,this.length),this[r]<<24|this[r+1]<<16|this[r+2]<<8|this[r+3]};le.prototype.readBigInt64LE=gr(function(r){r=r>>>0,Bi(r,"offset");let i=this[r],l=this[r+7];(i===void 0||l===void 0)&&Ma(r,this.length-8);let u=this[r+4]+this[r+5]*2**8+this[r+6]*2**16+(l<<24);return(BigInt(u)<<BigInt(32))+BigInt(i+this[++r]*2**8+this[++r]*2**16+this[++r]*2**24)});le.prototype.readBigInt64BE=gr(function(r){r=r>>>0,Bi(r,"offset");let i=this[r],l=this[r+7];(i===void 0||l===void 0)&&Ma(r,this.length-8);let u=(i<<24)+this[++r]*2**16+this[++r]*2**8+this[++r];return(BigInt(u)<<BigInt(32))+BigInt(this[++r]*2**24+this[++r]*2**16+this[++r]*2**8+l)});le.prototype.readFloatLE=function(r,i){return r=r>>>0,i||pt(r,4,this.length),Fi.read(this,r,!0,23,4)};le.prototype.readFloatBE=function(r,i){return r=r>>>0,i||pt(r,4,this.length),Fi.read(this,r,!1,23,4)};le.prototype.readDoubleLE=function(r,i){return r=r>>>0,i||pt(r,8,this.length),Fi.read(this,r,!0,52,8)};le.prototype.readDoubleBE=function(r,i){return r=r>>>0,i||pt(r,8,this.length),Fi.read(this,r,!1,52,8)};function Ft(t,r,i,l,u,d){if(!le.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>u||r<d)throw new RangeError('"value" argument is out of bounds');if(i+l>t.length)throw new RangeError("Index out of range")}le.prototype.writeUintLE=le.prototype.writeUIntLE=function(r,i,l,u){if(r=+r,i=i>>>0,l=l>>>0,!u){let m=Math.pow(2,8*l)-1;Ft(this,r,i,l,m,0)}let d=1,g=0;for(this[i]=r&255;++g<l&&(d*=256);)this[i+g]=r/d&255;return i+l};le.prototype.writeUintBE=le.prototype.writeUIntBE=function(r,i,l,u){if(r=+r,i=i>>>0,l=l>>>0,!u){let m=Math.pow(2,8*l)-1;Ft(this,r,i,l,m,0)}let d=l-1,g=1;for(this[i+d]=r&255;--d>=0&&(g*=256);)this[i+d]=r/g&255;return i+l};le.prototype.writeUint8=le.prototype.writeUInt8=function(r,i,l){return r=+r,i=i>>>0,l||Ft(this,r,i,1,255,0),this[i]=r&255,i+1};le.prototype.writeUint16LE=le.prototype.writeUInt16LE=function(r,i,l){return r=+r,i=i>>>0,l||Ft(this,r,i,2,65535,0),this[i]=r&255,this[i+1]=r>>>8,i+2};le.prototype.writeUint16BE=le.prototype.writeUInt16BE=function(r,i,l){return r=+r,i=i>>>0,l||Ft(this,r,i,2,65535,0),this[i]=r>>>8,this[i+1]=r&255,i+2};le.prototype.writeUint32LE=le.prototype.writeUInt32LE=function(r,i,l){return r=+r,i=i>>>0,l||Ft(this,r,i,4,4294967295,0),this[i+3]=r>>>24,this[i+2]=r>>>16,this[i+1]=r>>>8,this[i]=r&255,i+4};le.prototype.writeUint32BE=le.prototype.writeUInt32BE=function(r,i,l){return r=+r,i=i>>>0,l||Ft(this,r,i,4,4294967295,0),this[i]=r>>>24,this[i+1]=r>>>16,this[i+2]=r>>>8,this[i+3]=r&255,i+4};function Ew(t,r,i,l,u){Mw(r,l,u,t,i,7);let d=Number(r&BigInt(4294967295));t[i++]=d,d=d>>8,t[i++]=d,d=d>>8,t[i++]=d,d=d>>8,t[i++]=d;let g=Number(r>>BigInt(32)&BigInt(4294967295));return t[i++]=g,g=g>>8,t[i++]=g,g=g>>8,t[i++]=g,g=g>>8,t[i++]=g,i}function kw(t,r,i,l,u){Mw(r,l,u,t,i,7);let d=Number(r&BigInt(4294967295));t[i+7]=d,d=d>>8,t[i+6]=d,d=d>>8,t[i+5]=d,d=d>>8,t[i+4]=d;let g=Number(r>>BigInt(32)&BigInt(4294967295));return t[i+3]=g,g=g>>8,t[i+2]=g,g=g>>8,t[i+1]=g,g=g>>8,t[i]=g,i+8}le.prototype.writeBigUInt64LE=gr(function(r,i=0){return Ew(this,r,i,BigInt(0),BigInt("0xffffffffffffffff"))});le.prototype.writeBigUInt64BE=gr(function(r,i=0){return kw(this,r,i,BigInt(0),BigInt("0xffffffffffffffff"))});le.prototype.writeIntLE=function(r,i,l,u){if(r=+r,i=i>>>0,!u){let x=Math.pow(2,8*l-1);Ft(this,r,i,l,x-1,-x)}let d=0,g=1,m=0;for(this[i]=r&255;++d<l&&(g*=256);)r<0&&m===0&&this[i+d-1]!==0&&(m=1),this[i+d]=(r/g>>0)-m&255;return i+l};le.prototype.writeIntBE=function(r,i,l,u){if(r=+r,i=i>>>0,!u){let x=Math.pow(2,8*l-1);Ft(this,r,i,l,x-1,-x)}let d=l-1,g=1,m=0;for(this[i+d]=r&255;--d>=0&&(g*=256);)r<0&&m===0&&this[i+d+1]!==0&&(m=1),this[i+d]=(r/g>>0)-m&255;return i+l};le.prototype.writeInt8=function(r,i,l){return r=+r,i=i>>>0,l||Ft(this,r,i,1,127,-128),r<0&&(r=255+r+1),this[i]=r&255,i+1};le.prototype.writeInt16LE=function(r,i,l){return r=+r,i=i>>>0,l||Ft(this,r,i,2,32767,-32768),this[i]=r&255,this[i+1]=r>>>8,i+2};le.prototype.writeInt16BE=function(r,i,l){return r=+r,i=i>>>0,l||Ft(this,r,i,2,32767,-32768),this[i]=r>>>8,this[i+1]=r&255,i+2};le.prototype.writeInt32LE=function(r,i,l){return r=+r,i=i>>>0,l||Ft(this,r,i,4,2147483647,-2147483648),this[i]=r&255,this[i+1]=r>>>8,this[i+2]=r>>>16,this[i+3]=r>>>24,i+4};le.prototype.writeInt32BE=function(r,i,l){return r=+r,i=i>>>0,l||Ft(this,r,i,4,2147483647,-2147483648),r<0&&(r=4294967295+r+1),this[i]=r>>>24,this[i+1]=r>>>16,this[i+2]=r>>>8,this[i+3]=r&255,i+4};le.prototype.writeBigInt64LE=gr(function(r,i=0){return Ew(this,r,i,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});le.prototype.writeBigInt64BE=gr(function(r,i=0){return kw(this,r,i,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Cw(t,r,i,l,u,d){if(i+l>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function Nw(t,r,i,l,u){return r=+r,i=i>>>0,u||Cw(t,r,i,4,34028234663852886e22,-34028234663852886e22),Fi.write(t,r,i,l,23,4),i+4}le.prototype.writeFloatLE=function(r,i,l){return Nw(this,r,i,!0,l)};le.prototype.writeFloatBE=function(r,i,l){return Nw(this,r,i,!1,l)};function Aw(t,r,i,l,u){return r=+r,i=i>>>0,u||Cw(t,r,i,8,17976931348623157e292,-17976931348623157e292),Fi.write(t,r,i,l,52,8),i+8}le.prototype.writeDoubleLE=function(r,i,l){return Aw(this,r,i,!0,l)};le.prototype.writeDoubleBE=function(r,i,l){return Aw(this,r,i,!1,l)};le.prototype.copy=function(r,i,l,u){if(!le.isBuffer(r))throw new TypeError("argument should be a Buffer");if(l||(l=0),!u&&u!==0&&(u=this.length),i>=r.length&&(i=r.length),i||(i=0),u>0&&u<l&&(u=l),u===l||r.length===0||this.length===0)return 0;if(i<0)throw new RangeError("targetStart out of bounds");if(l<0||l>=this.length)throw new RangeError("Index out of range");if(u<0)throw new RangeError("sourceEnd out of bounds");u>this.length&&(u=this.length),r.length-i<u-l&&(u=r.length-i+l);let d=u-l;return this===r&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(i,l,u):Uint8Array.prototype.set.call(r,this.subarray(l,u),i),d};le.prototype.fill=function(r,i,l,u){if(typeof r=="string"){if(typeof i=="string"?(u=i,i=0,l=this.length):typeof l=="string"&&(u=l,l=this.length),u!==void 0&&typeof u!="string")throw new TypeError("encoding must be a string");if(typeof u=="string"&&!le.isEncoding(u))throw new TypeError("Unknown encoding: "+u);if(r.length===1){let g=r.charCodeAt(0);(u==="utf8"&&g<128||u==="latin1")&&(r=g)}}else typeof r=="number"?r=r&255:typeof r=="boolean"&&(r=Number(r));if(i<0||this.length<i||this.length<l)throw new RangeError("Out of range index");if(l<=i)return this;i=i>>>0,l=l===void 0?this.length:l>>>0,r||(r=0);let d;if(typeof r=="number")for(d=i;d<l;++d)this[d]=r;else{let g=le.isBuffer(r)?r:le.from(r,u),m=g.length;if(m===0)throw new TypeError('The value "'+r+'" is invalid for argument "value"');for(d=0;d<l-i;++d)this[d+i]=g[d%m]}return this};var Ri={};function Uh(t,r,i){Ri[t]=class extends i{constructor(){super(),Object.defineProperty(this,"message",{value:r.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(u){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:u,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}Uh("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);Uh("ERR_INVALID_ARG_TYPE",function(t,r){return`The "${t}" argument must be of type number. Received type ${typeof r}`},TypeError);Uh("ERR_OUT_OF_RANGE",function(t,r,i){let l=`The value of "${t}" is out of range.`,u=i;return Number.isInteger(i)&&Math.abs(i)>2**32?u=ww(String(i)):typeof i=="bigint"&&(u=String(i),(i>BigInt(2)**BigInt(32)||i<-(BigInt(2)**BigInt(32)))&&(u=ww(u)),u+="n"),l+=` It must be ${r}. Received ${u}`,l},RangeError);function ww(t){let r="",i=t.length,l=t[0]==="-"?1:0;for(;i>=l+4;i-=3)r=`_${t.slice(i-3,i)}${r}`;return`${t.slice(0,i)}${r}`}function p5(t,r,i){Bi(r,"offset"),(t[r]===void 0||t[r+i]===void 0)&&Ma(r,t.length-(i+1))}function Mw(t,r,i,l,u,d){if(t>i||t<r){let g=typeof r=="bigint"?"n":"",m;throw d>3?r===0||r===BigInt(0)?m=`>= 0${g} and < 2${g} ** ${(d+1)*8}${g}`:m=`>= -(2${g} ** ${(d+1)*8-1}${g}) and < 2 ** ${(d+1)*8-1}${g}`:m=`>= ${r}${g} and <= ${i}${g}`,new Ri.ERR_OUT_OF_RANGE("value",m,t)}p5(l,u,d)}function Bi(t,r){if(typeof t!="number")throw new Ri.ERR_INVALID_ARG_TYPE(r,"number",t)}function Ma(t,r,i){throw Math.floor(t)!==t?(Bi(t,i),new Ri.ERR_OUT_OF_RANGE(i||"offset","an integer",t)):r<0?new Ri.ERR_BUFFER_OUT_OF_BOUNDS:new Ri.ERR_OUT_OF_RANGE(i||"offset",`>= ${i?1:0} and <= ${r}`,t)}var g5=/[^+/0-9A-Za-z-_]/g;function m5(t){if(t=t.split("=")[0],t=t.trim().replace(g5,""),t.length<2)return"";for(;t.length%4!==0;)t=t+"=";return t}function Bh(t,r){r=r||1/0;let i,l=t.length,u=null,d=[];for(let g=0;g<l;++g){if(i=t.charCodeAt(g),i>55295&&i<57344){if(!u){if(i>56319){(r-=3)>-1&&d.push(239,191,189);continue}else if(g+1===l){(r-=3)>-1&&d.push(239,191,189);continue}u=i;continue}if(i<56320){(r-=3)>-1&&d.push(239,191,189),u=i;continue}i=(u-55296<<10|i-56320)+65536}else u&&(r-=3)>-1&&d.push(239,191,189);if(u=null,i<128){if((r-=1)<0)break;d.push(i)}else if(i<2048){if((r-=2)<0)break;d.push(i>>6|192,i&63|128)}else if(i<65536){if((r-=3)<0)break;d.push(i>>12|224,i>>6&63|128,i&63|128)}else if(i<1114112){if((r-=4)<0)break;d.push(i>>18|240,i>>12&63|128,i>>6&63|128,i&63|128)}else throw new Error("Invalid code point")}return d}function y5(t){let r=[];for(let i=0;i<t.length;++i)r.push(t.charCodeAt(i)&255);return r}function b5(t,r){let i,l,u,d=[];for(let g=0;g<t.length&&!((r-=2)<0);++g)i=t.charCodeAt(g),l=i>>8,u=i%256,d.push(u),d.push(l);return d}function Dw(t){return Oh.toByteArray(m5(t))}function ac(t,r,i,l){let u;for(u=0;u<l&&!(u+i>=r.length||u>=t.length);++u)r[u+i]=t[u];return u}function En(t,r){return t instanceof r||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===r.name}function Zh(t){return t!==t}var w5=function(){let t="0123456789abcdef",r=new Array(256);for(let i=0;i<16;++i){let l=i*16;for(let u=0;u<16;++u)r[l+u]=t[i]+t[u]}return r}();function gr(t){return typeof BigInt>"u"?_5:t}function _5(){throw new Error("BigInt not supported")}});var Ow=me(Pw=>{var Lw=Sw().Buffer,v5=Lw.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function x5(t){if(t&&!v5(t))throw new Error("Unknown encoding: "+t)}var jh=Pw.StringDecoder=function(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),x5(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=I5;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=E5;break;default:this.write=T5;return}this.charBuffer=new Lw(6),this.charReceived=0,this.charLength=0};jh.prototype.write=function(t){for(var r="";this.charLength;){var i=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,0,i),this.charReceived+=i,this.charReceived<this.charLength)return"";t=t.slice(i,t.length),r=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var u=r.charCodeAt(r.length-1);if(u>=55296&&u<=56319){this.charLength+=this.surrogateSize,r="";continue}if(this.charReceived=this.charLength=0,t.length===0)return r;break}this.detectIncompleteChar(t);var l=t.length;this.charLength&&(t.copy(this.charBuffer,0,t.length-this.charReceived,l),l-=this.charReceived),r+=t.toString(this.encoding,0,l);var l=r.length-1,u=r.charCodeAt(l);if(u>=55296&&u<=56319){var d=this.surrogateSize;return this.charLength+=d,this.charReceived+=d,this.charBuffer.copy(this.charBuffer,d,0,d),t.copy(this.charBuffer,0,0,d),r.substring(0,l)}return r};jh.prototype.detectIncompleteChar=function(t){for(var r=t.length>=3?3:t.length;r>0;r--){var i=t[t.length-r];if(r==1&&i>>5==6){this.charLength=2;break}if(r<=2&&i>>4==14){this.charLength=3;break}if(r<=3&&i>>3==30){this.charLength=4;break}}this.charReceived=r};jh.prototype.end=function(t){var r="";if(t&&t.length&&(r=this.write(t)),this.charReceived){var i=this.charReceived,l=this.charBuffer,u=this.encoding;r+=l.slice(0,i).toString(u)}return r};function T5(t){return t.toString(this.encoding)}function I5(t){this.charReceived=t.length%2,this.charLength=this.charReceived?2:0}function E5(t){this.charReceived=t.length%3,this.charLength=this.charReceived?3:0}});var Rw=me(sc=>{(function(t){t.parser=function(j,O){return new i(j,O)},t.SAXParser=i,t.SAXStream=v,t.createStream=x,t.MAX_BUFFER_LENGTH=64*1024;var r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function i(j,O){if(!(this instanceof i))return new i(j,O);var fe=this;u(fe),fe.q=fe.c="",fe.bufferCheckPosition=t.MAX_BUFFER_LENGTH,fe.opt=O||{},fe.opt.lowercase=fe.opt.lowercase||fe.opt.lowercasetags,fe.looseCase=fe.opt.lowercase?"toLowerCase":"toUpperCase",fe.tags=[],fe.closed=fe.closedRoot=fe.sawRoot=!1,fe.tag=fe.error=null,fe.strict=!!j,fe.noscript=!!(j||fe.opt.noscript),fe.state=H.BEGIN,fe.strictEntities=fe.opt.strictEntities,fe.ENTITIES=fe.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),fe.attribList=[],fe.opt.xmlns&&(fe.ns=Object.create(C)),fe.trackPosition=fe.opt.position!==!1,fe.trackPosition&&(fe.position=fe.line=fe.column=0),U(fe,"onready")}Object.create||(Object.create=function(j){function O(){}O.prototype=j;var fe=new O;return fe}),Object.keys||(Object.keys=function(j){var O=[];for(var fe in j)j.hasOwnProperty(fe)&&O.push(fe);return O});function l(j){for(var O=Math.max(t.MAX_BUFFER_LENGTH,10),fe=0,re=0,Fe=r.length;re<Fe;re++){var tt=j[r[re]].length;if(tt>O)switch(r[re]){case"textNode":se(j);break;case"cdata":K(j,"oncdata",j.cdata),j.cdata="";break;case"script":K(j,"onscript",j.script),j.script="";break;default:_e(j,"Max buffer length exceeded: "+r[re])}fe=Math.max(fe,tt)}var Ye=t.MAX_BUFFER_LENGTH-fe;j.bufferCheckPosition=Ye+j.position}function u(j){for(var O=0,fe=r.length;O<fe;O++)j[r[O]]=""}function d(j){se(j),j.cdata!==""&&(K(j,"oncdata",j.cdata),j.cdata=""),j.script!==""&&(K(j,"onscript",j.script),j.script="")}i.prototype={end:function(){Ce(this)},write:fn,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){d(this)}};var g;try{g=LI("stream").Stream}catch{g=function(){}}var m=t.EVENTS.filter(function(j){return j!=="error"&&j!=="end"});function x(j,O){return new v(j,O)}function v(j,O){if(!(this instanceof v))return new v(j,O);g.apply(this),this._parser=new i(j,O),this.writable=!0,this.readable=!0;var fe=this;this._parser.onend=function(){fe.emit("end")},this._parser.onerror=function(re){fe.emit("error",re),fe._parser.error=null},this._decoder=null,m.forEach(function(re){Object.defineProperty(fe,"on"+re,{get:function(){return fe._parser["on"+re]},set:function(Fe){if(!Fe)return fe.removeAllListeners(re),fe._parser["on"+re]=Fe,Fe;fe.on(re,Fe)},enumerable:!0,configurable:!1})})}v.prototype=Object.create(g.prototype,{constructor:{value:v}}),v.prototype.write=function(j){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(j)){if(!this._decoder){var O=Ow().StringDecoder;this._decoder=new O("utf8")}j=this._decoder.write(j)}return this._parser.write(j.toString()),this.emit("data",j),!0},v.prototype.end=function(j){return j&&j.length&&this.write(j),this._parser.end(),!0},v.prototype.on=function(j,O){var fe=this;return!fe._parser["on"+j]&&m.indexOf(j)!==-1&&(fe._parser["on"+j]=function(){var re=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);re.splice(0,0,j),fe.emit.apply(fe,re)}),g.prototype.on.call(fe,j,O)};var I="[CDATA[",S="DOCTYPE",M="http://www.w3.org/XML/1998/namespace",E="http://www.w3.org/2000/xmlns/",C={xml:M,xmlns:E},B=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,$=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,V=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,te=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function R(j){return j===" "||j===`
`||j==="\r"||j==="	"}function D(j){return j==='"'||j==="'"}function A(j){return j===">"||R(j)}function Z(j,O){return j.test(O)}function X(j,O){return!Z(j,O)}var H=0;t.STATE={BEGIN:H++,BEGIN_WHITESPACE:H++,TEXT:H++,TEXT_ENTITY:H++,OPEN_WAKA:H++,SGML_DECL:H++,SGML_DECL_QUOTED:H++,DOCTYPE:H++,DOCTYPE_QUOTED:H++,DOCTYPE_DTD:H++,DOCTYPE_DTD_QUOTED:H++,COMMENT_STARTING:H++,COMMENT:H++,COMMENT_ENDING:H++,COMMENT_ENDED:H++,CDATA:H++,CDATA_ENDING:H++,CDATA_ENDING_2:H++,PROC_INST:H++,PROC_INST_BODY:H++,PROC_INST_ENDING:H++,OPEN_TAG:H++,OPEN_TAG_SLASH:H++,ATTRIB:H++,ATTRIB_NAME:H++,ATTRIB_NAME_SAW_WHITE:H++,ATTRIB_VALUE:H++,ATTRIB_VALUE_QUOTED:H++,ATTRIB_VALUE_CLOSED:H++,ATTRIB_VALUE_UNQUOTED:H++,ATTRIB_VALUE_ENTITY_Q:H++,ATTRIB_VALUE_ENTITY_U:H++,CLOSE_TAG:H++,CLOSE_TAG_SAW_WHITE:H++,SCRIPT:H++,SCRIPT_ENDING:H++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach(function(j){var O=t.ENTITIES[j],fe=typeof O=="number"?String.fromCharCode(O):O;t.ENTITIES[j]=fe});for(var J in t.STATE)t.STATE[t.STATE[J]]=J;H=t.STATE;function U(j,O,fe){j[O]&&j[O](fe)}function K(j,O,fe){j.textNode&&se(j),U(j,O,fe)}function se(j){j.textNode=de(j.opt,j.textNode),j.textNode&&U(j,"ontext",j.textNode),j.textNode=""}function de(j,O){return j.trim&&(O=O.trim()),j.normalize&&(O=O.replace(/\s+/g," ")),O}function _e(j,O){return se(j),j.trackPosition&&(O+=`
Line: `+j.line+`
Column: `+j.column+`
Char: `+j.c),O=new Error(O),j.error=O,U(j,"onerror",O),j}function Ce(j){return j.sawRoot&&!j.closedRoot&&we(j,"Unclosed root tag"),j.state!==H.BEGIN&&j.state!==H.BEGIN_WHITESPACE&&j.state!==H.TEXT&&_e(j,"Unexpected end"),se(j),j.c="",j.closed=!0,U(j,"onend"),i.call(j,j.strict,j.opt),j}function we(j,O){if(typeof j!="object"||!(j instanceof i))throw new Error("bad call to strictFail");j.strict&&_e(j,O)}function Ue(j){j.strict||(j.tagName=j.tagName[j.looseCase]());var O=j.tags[j.tags.length-1]||j,fe=j.tag={name:j.tagName,attributes:{}};j.opt.xmlns&&(fe.ns=O.ns),j.attribList.length=0,K(j,"onopentagstart",fe)}function Ae(j,O){var fe=j.indexOf(":"),re=fe<0?["",j]:j.split(":"),Fe=re[0],tt=re[1];return O&&j==="xmlns"&&(Fe="xmlns",tt=""),{prefix:Fe,local:tt}}function ge(j){if(j.strict||(j.attribName=j.attribName[j.looseCase]()),j.attribList.indexOf(j.attribName)!==-1||j.tag.attributes.hasOwnProperty(j.attribName)){j.attribName=j.attribValue="";return}if(j.opt.xmlns){var O=Ae(j.attribName,!0),fe=O.prefix,re=O.local;if(fe==="xmlns")if(re==="xml"&&j.attribValue!==M)we(j,"xml: prefix must be bound to "+M+`
Actual: `+j.attribValue);else if(re==="xmlns"&&j.attribValue!==E)we(j,"xmlns: prefix must be bound to "+E+`
Actual: `+j.attribValue);else{var Fe=j.tag,tt=j.tags[j.tags.length-1]||j;Fe.ns===tt.ns&&(Fe.ns=Object.create(tt.ns)),Fe.ns[re]=j.attribValue}j.attribList.push([j.attribName,j.attribValue])}else j.tag.attributes[j.attribName]=j.attribValue,K(j,"onattribute",{name:j.attribName,value:j.attribValue});j.attribName=j.attribValue=""}function ye(j,O){if(j.opt.xmlns){var fe=j.tag,re=Ae(j.tagName);fe.prefix=re.prefix,fe.local=re.local,fe.uri=fe.ns[re.prefix]||"",fe.prefix&&!fe.uri&&(we(j,"Unbound namespace prefix: "+JSON.stringify(j.tagName)),fe.uri=re.prefix);var Fe=j.tags[j.tags.length-1]||j;fe.ns&&Fe.ns!==fe.ns&&Object.keys(fe.ns).forEach(function(ho){K(j,"onopennamespace",{prefix:ho,uri:fe.ns[ho]})});for(var tt=0,Ye=j.attribList.length;tt<Ye;tt++){var ct=j.attribList[tt],Vt=ct[0],en=ct[1],ut=Ae(Vt,!0),zt=ut.prefix,uo=ut.local,fo=zt===""?"":fe.ns[zt]||"",er={name:Vt,value:en,prefix:zt,local:uo,uri:fo};zt&&zt!=="xmlns"&&!fo&&(we(j,"Unbound namespace prefix: "+JSON.stringify(zt)),er.uri=zt),j.tag.attributes[Vt]=er,K(j,"onattribute",er)}j.attribList.length=0}j.tag.isSelfClosing=!!O,j.sawRoot=!0,j.tags.push(j.tag),K(j,"onopentag",j.tag),O||(!j.noscript&&j.tagName.toLowerCase()==="script"?j.state=H.SCRIPT:j.state=H.TEXT,j.tag=null,j.tagName=""),j.attribName=j.attribValue="",j.attribList.length=0}function Oe(j){if(!j.tagName){we(j,"Weird empty close tag."),j.textNode+="</>",j.state=H.TEXT;return}if(j.script){if(j.tagName!=="script"){j.script+="</"+j.tagName+">",j.tagName="",j.state=H.SCRIPT;return}K(j,"onscript",j.script),j.script=""}var O=j.tags.length,fe=j.tagName;j.strict||(fe=fe[j.looseCase]());for(var re=fe;O--;){var Fe=j.tags[O];if(Fe.name!==re)we(j,"Unexpected close tag");else break}if(O<0){we(j,"Unmatched closing tag: "+j.tagName),j.textNode+="</"+j.tagName+">",j.state=H.TEXT;return}j.tagName=fe;for(var tt=j.tags.length;tt-- >O;){var Ye=j.tag=j.tags.pop();j.tagName=j.tag.name,K(j,"onclosetag",j.tagName);var ct={};for(var Vt in Ye.ns)ct[Vt]=Ye.ns[Vt];var en=j.tags[j.tags.length-1]||j;j.opt.xmlns&&Ye.ns!==en.ns&&Object.keys(Ye.ns).forEach(function(ut){var zt=Ye.ns[ut];K(j,"onclosenamespace",{prefix:ut,uri:zt})})}O===0&&(j.closedRoot=!0),j.tagName=j.attribValue=j.attribName="",j.attribList.length=0,j.state=H.TEXT}function Ze(j){var O=j.entity,fe=O.toLowerCase(),re,Fe="";return j.ENTITIES[O]?j.ENTITIES[O]:j.ENTITIES[fe]?j.ENTITIES[fe]:(O=fe,O.charAt(0)==="#"&&(O.charAt(1)==="x"?(O=O.slice(2),re=parseInt(O,16),Fe=re.toString(16)):(O=O.slice(1),re=parseInt(O,10),Fe=re.toString(10))),O=O.replace(/^0+/,""),isNaN(re)||Fe.toLowerCase()!==O?(we(j,"Invalid character entity"),"&"+j.entity+";"):String.fromCodePoint(re))}function Ge(j,O){O==="<"?(j.state=H.OPEN_WAKA,j.startTagPosition=j.position):R(O)||(we(j,"Non-whitespace before first tag."),j.textNode=O,j.state=H.TEXT)}function rt(j,O){var fe="";return O<j.length&&(fe=j.charAt(O)),fe}function fn(j){var O=this;if(this.error)throw this.error;if(O.closed)return _e(O,"Cannot write after close. Assign an onready handler.");if(j===null)return Ce(O);typeof j=="object"&&(j=j.toString());for(var fe=0,re="";re=rt(j,fe++),O.c=re,!!re;)switch(O.trackPosition&&(O.position++,re===`
`?(O.line++,O.column=0):O.column++),O.state){case H.BEGIN:if(O.state=H.BEGIN_WHITESPACE,re==="\uFEFF")continue;Ge(O,re);continue;case H.BEGIN_WHITESPACE:Ge(O,re);continue;case H.TEXT:if(O.sawRoot&&!O.closedRoot){for(var Fe=fe-1;re&&re!=="<"&&re!=="&";)re=rt(j,fe++),re&&O.trackPosition&&(O.position++,re===`
`?(O.line++,O.column=0):O.column++);O.textNode+=j.substring(Fe,fe-1)}re==="<"&&!(O.sawRoot&&O.closedRoot&&!O.strict)?(O.state=H.OPEN_WAKA,O.startTagPosition=O.position):(!R(re)&&(!O.sawRoot||O.closedRoot)&&we(O,"Text data outside of root node."),re==="&"?O.state=H.TEXT_ENTITY:O.textNode+=re);continue;case H.SCRIPT:re==="<"?O.state=H.SCRIPT_ENDING:O.script+=re;continue;case H.SCRIPT_ENDING:re==="/"?O.state=H.CLOSE_TAG:(O.script+="<"+re,O.state=H.SCRIPT);continue;case H.OPEN_WAKA:if(re==="!")O.state=H.SGML_DECL,O.sgmlDecl="";else if(!R(re))if(Z(B,re))O.state=H.OPEN_TAG,O.tagName=re;else if(re==="/")O.state=H.CLOSE_TAG,O.tagName="";else if(re==="?")O.state=H.PROC_INST,O.procInstName=O.procInstBody="";else{if(we(O,"Unencoded <"),O.startTagPosition+1<O.position){var tt=O.position-O.startTagPosition;re=new Array(tt).join(" ")+re}O.textNode+="<"+re,O.state=H.TEXT}continue;case H.SGML_DECL:(O.sgmlDecl+re).toUpperCase()===I?(K(O,"onopencdata"),O.state=H.CDATA,O.sgmlDecl="",O.cdata=""):O.sgmlDecl+re==="--"?(O.state=H.COMMENT,O.comment="",O.sgmlDecl=""):(O.sgmlDecl+re).toUpperCase()===S?(O.state=H.DOCTYPE,(O.doctype||O.sawRoot)&&we(O,"Inappropriately located doctype declaration"),O.doctype="",O.sgmlDecl=""):re===">"?(K(O,"onsgmldeclaration",O.sgmlDecl),O.sgmlDecl="",O.state=H.TEXT):(D(re)&&(O.state=H.SGML_DECL_QUOTED),O.sgmlDecl+=re);continue;case H.SGML_DECL_QUOTED:re===O.q&&(O.state=H.SGML_DECL,O.q=""),O.sgmlDecl+=re;continue;case H.DOCTYPE:re===">"?(O.state=H.TEXT,K(O,"ondoctype",O.doctype),O.doctype=!0):(O.doctype+=re,re==="["?O.state=H.DOCTYPE_DTD:D(re)&&(O.state=H.DOCTYPE_QUOTED,O.q=re));continue;case H.DOCTYPE_QUOTED:O.doctype+=re,re===O.q&&(O.q="",O.state=H.DOCTYPE);continue;case H.DOCTYPE_DTD:O.doctype+=re,re==="]"?O.state=H.DOCTYPE:D(re)&&(O.state=H.DOCTYPE_DTD_QUOTED,O.q=re);continue;case H.DOCTYPE_DTD_QUOTED:O.doctype+=re,re===O.q&&(O.state=H.DOCTYPE_DTD,O.q="");continue;case H.COMMENT:re==="-"?O.state=H.COMMENT_ENDING:O.comment+=re;continue;case H.COMMENT_ENDING:re==="-"?(O.state=H.COMMENT_ENDED,O.comment=de(O.opt,O.comment),O.comment&&K(O,"oncomment",O.comment),O.comment=""):(O.comment+="-"+re,O.state=H.COMMENT);continue;case H.COMMENT_ENDED:re!==">"?(we(O,"Malformed comment"),O.comment+="--"+re,O.state=H.COMMENT):O.state=H.TEXT;continue;case H.CDATA:re==="]"?O.state=H.CDATA_ENDING:O.cdata+=re;continue;case H.CDATA_ENDING:re==="]"?O.state=H.CDATA_ENDING_2:(O.cdata+="]"+re,O.state=H.CDATA);continue;case H.CDATA_ENDING_2:re===">"?(O.cdata&&K(O,"oncdata",O.cdata),K(O,"onclosecdata"),O.cdata="",O.state=H.TEXT):re==="]"?O.cdata+="]":(O.cdata+="]]"+re,O.state=H.CDATA);continue;case H.PROC_INST:re==="?"?O.state=H.PROC_INST_ENDING:R(re)?O.state=H.PROC_INST_BODY:O.procInstName+=re;continue;case H.PROC_INST_BODY:if(!O.procInstBody&&R(re))continue;re==="?"?O.state=H.PROC_INST_ENDING:O.procInstBody+=re;continue;case H.PROC_INST_ENDING:re===">"?(K(O,"onprocessinginstruction",{name:O.procInstName,body:O.procInstBody}),O.procInstName=O.procInstBody="",O.state=H.TEXT):(O.procInstBody+="?"+re,O.state=H.PROC_INST_BODY);continue;case H.OPEN_TAG:Z($,re)?O.tagName+=re:(Ue(O),re===">"?ye(O):re==="/"?O.state=H.OPEN_TAG_SLASH:(R(re)||we(O,"Invalid character in tag name"),O.state=H.ATTRIB));continue;case H.OPEN_TAG_SLASH:re===">"?(ye(O,!0),Oe(O)):(we(O,"Forward-slash in opening tag not followed by >"),O.state=H.ATTRIB);continue;case H.ATTRIB:if(R(re))continue;re===">"?ye(O):re==="/"?O.state=H.OPEN_TAG_SLASH:Z(B,re)?(O.attribName=re,O.attribValue="",O.state=H.ATTRIB_NAME):we(O,"Invalid attribute name");continue;case H.ATTRIB_NAME:re==="="?O.state=H.ATTRIB_VALUE:re===">"?(we(O,"Attribute without value"),O.attribValue=O.attribName,ge(O),ye(O)):R(re)?O.state=H.ATTRIB_NAME_SAW_WHITE:Z($,re)?O.attribName+=re:we(O,"Invalid attribute name");continue;case H.ATTRIB_NAME_SAW_WHITE:if(re==="=")O.state=H.ATTRIB_VALUE;else{if(R(re))continue;we(O,"Attribute without value"),O.tag.attributes[O.attribName]="",O.attribValue="",K(O,"onattribute",{name:O.attribName,value:""}),O.attribName="",re===">"?ye(O):Z(B,re)?(O.attribName=re,O.state=H.ATTRIB_NAME):(we(O,"Invalid attribute name"),O.state=H.ATTRIB)}continue;case H.ATTRIB_VALUE:if(R(re))continue;D(re)?(O.q=re,O.state=H.ATTRIB_VALUE_QUOTED):(we(O,"Unquoted attribute value"),O.state=H.ATTRIB_VALUE_UNQUOTED,O.attribValue=re);continue;case H.ATTRIB_VALUE_QUOTED:if(re!==O.q){re==="&"?O.state=H.ATTRIB_VALUE_ENTITY_Q:O.attribValue+=re;continue}ge(O),O.q="",O.state=H.ATTRIB_VALUE_CLOSED;continue;case H.ATTRIB_VALUE_CLOSED:R(re)?O.state=H.ATTRIB:re===">"?ye(O):re==="/"?O.state=H.OPEN_TAG_SLASH:Z(B,re)?(we(O,"No whitespace between attributes"),O.attribName=re,O.attribValue="",O.state=H.ATTRIB_NAME):we(O,"Invalid attribute name");continue;case H.ATTRIB_VALUE_UNQUOTED:if(!A(re)){re==="&"?O.state=H.ATTRIB_VALUE_ENTITY_U:O.attribValue+=re;continue}ge(O),re===">"?ye(O):O.state=H.ATTRIB;continue;case H.CLOSE_TAG:if(O.tagName)re===">"?Oe(O):Z($,re)?O.tagName+=re:O.script?(O.script+="</"+O.tagName,O.tagName="",O.state=H.SCRIPT):(R(re)||we(O,"Invalid tagname in closing tag"),O.state=H.CLOSE_TAG_SAW_WHITE);else{if(R(re))continue;X(B,re)?O.script?(O.script+="</"+re,O.state=H.SCRIPT):we(O,"Invalid tagname in closing tag."):O.tagName=re}continue;case H.CLOSE_TAG_SAW_WHITE:if(R(re))continue;re===">"?Oe(O):we(O,"Invalid characters in closing tag");continue;case H.TEXT_ENTITY:case H.ATTRIB_VALUE_ENTITY_Q:case H.ATTRIB_VALUE_ENTITY_U:var Ye,ct;switch(O.state){case H.TEXT_ENTITY:Ye=H.TEXT,ct="textNode";break;case H.ATTRIB_VALUE_ENTITY_Q:Ye=H.ATTRIB_VALUE_QUOTED,ct="attribValue";break;case H.ATTRIB_VALUE_ENTITY_U:Ye=H.ATTRIB_VALUE_UNQUOTED,ct="attribValue";break}re===";"?(O[ct]+=Ze(O),O.entity="",O.state=Ye):Z(O.entity.length?te:V,re)?O.entity+=re:(we(O,"Invalid character in entity name"),O[ct]+="&"+O.entity+re,O.entity="",O.state=Ye);continue;default:throw new Error(O,"Unknown state: "+O.state)}return O.position>=O.bufferCheckPosition&&l(O),O}String.fromCodePoint||function(){var j=String.fromCharCode,O=Math.floor,fe=function(){var re=16384,Fe=[],tt,Ye,ct=-1,Vt=arguments.length;if(!Vt)return"";for(var en="";++ct<Vt;){var ut=Number(arguments[ct]);if(!isFinite(ut)||ut<0||ut>1114111||O(ut)!==ut)throw RangeError("Invalid code point: "+ut);ut<=65535?Fe.push(ut):(ut-=65536,tt=(ut>>10)+55296,Ye=ut%1024+56320,Fe.push(tt,Ye)),(ct+1===Vt||Fe.length>re)&&(en+=j.apply(null,Fe),Fe.length=0)}return en};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:fe,configurable:!0,writable:!0}):String.fromCodePoint=fe}()})(typeof sc>"u"?sc.sax={}:sc)});var Ww=me((D9,Hh)=>{"use strict";var qi=typeof Reflect=="object"?Reflect:null,Fw=qi&&typeof qi.apply=="function"?qi.apply:function(r,i,l){return Function.prototype.apply.call(r,i,l)},lc;qi&&typeof qi.ownKeys=="function"?lc=qi.ownKeys:Object.getOwnPropertySymbols?lc=function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:lc=function(r){return Object.getOwnPropertyNames(r)};function k5(t){console&&console.warn&&console.warn(t)}var zw=Number.isNaN||function(r){return r!==r};function We(){We.init.call(this)}Hh.exports=We;Hh.exports.once=M5;We.EventEmitter=We;We.prototype._events=void 0;We.prototype._eventsCount=0;We.prototype._maxListeners=void 0;var Bw=10;function cc(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(We,"defaultMaxListeners",{enumerable:!0,get:function(){return Bw},set:function(t){if(typeof t!="number"||t<0||zw(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Bw=t}});We.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};We.prototype.setMaxListeners=function(r){if(typeof r!="number"||r<0||zw(r))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+r+".");return this._maxListeners=r,this};function qw(t){return t._maxListeners===void 0?We.defaultMaxListeners:t._maxListeners}We.prototype.getMaxListeners=function(){return qw(this)};We.prototype.emit=function(r){for(var i=[],l=1;l<arguments.length;l++)i.push(arguments[l]);var u=r==="error",d=this._events;if(d!==void 0)u=u&&d.error===void 0;else if(!u)return!1;if(u){var g;if(i.length>0&&(g=i[0]),g instanceof Error)throw g;var m=new Error("Unhandled error."+(g?" ("+g.message+")":""));throw m.context=g,m}var x=d[r];if(x===void 0)return!1;if(typeof x=="function")Fw(x,this,i);else for(var v=x.length,I=$w(x,v),l=0;l<v;++l)Fw(I[l],this,i);return!0};function Uw(t,r,i,l){var u,d,g;if(cc(i),d=t._events,d===void 0?(d=t._events=Object.create(null),t._eventsCount=0):(d.newListener!==void 0&&(t.emit("newListener",r,i.listener?i.listener:i),d=t._events),g=d[r]),g===void 0)g=d[r]=i,++t._eventsCount;else if(typeof g=="function"?g=d[r]=l?[i,g]:[g,i]:l?g.unshift(i):g.push(i),u=qw(t),u>0&&g.length>u&&!g.warned){g.warned=!0;var m=new Error("Possible EventEmitter memory leak detected. "+g.length+" "+String(r)+" listeners added. Use emitter.setMaxListeners() to increase limit");m.name="MaxListenersExceededWarning",m.emitter=t,m.type=r,m.count=g.length,k5(m)}return t}We.prototype.addListener=function(r,i){return Uw(this,r,i,!1)};We.prototype.on=We.prototype.addListener;We.prototype.prependListener=function(r,i){return Uw(this,r,i,!0)};function C5(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Zw(t,r,i){var l={fired:!1,wrapFn:void 0,target:t,type:r,listener:i},u=C5.bind(l);return u.listener=i,l.wrapFn=u,u}We.prototype.once=function(r,i){return cc(i),this.on(r,Zw(this,r,i)),this};We.prototype.prependOnceListener=function(r,i){return cc(i),this.prependListener(r,Zw(this,r,i)),this};We.prototype.removeListener=function(r,i){var l,u,d,g,m;if(cc(i),u=this._events,u===void 0)return this;if(l=u[r],l===void 0)return this;if(l===i||l.listener===i)--this._eventsCount===0?this._events=Object.create(null):(delete u[r],u.removeListener&&this.emit("removeListener",r,l.listener||i));else if(typeof l!="function"){for(d=-1,g=l.length-1;g>=0;g--)if(l[g]===i||l[g].listener===i){m=l[g].listener,d=g;break}if(d<0)return this;d===0?l.shift():N5(l,d),l.length===1&&(u[r]=l[0]),u.removeListener!==void 0&&this.emit("removeListener",r,m||i)}return this};We.prototype.off=We.prototype.removeListener;We.prototype.removeAllListeners=function(r){var i,l,u;if(l=this._events,l===void 0)return this;if(l.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):l[r]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete l[r]),this;if(arguments.length===0){var d=Object.keys(l),g;for(u=0;u<d.length;++u)g=d[u],g!=="removeListener"&&this.removeAllListeners(g);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(i=l[r],typeof i=="function")this.removeListener(r,i);else if(i!==void 0)for(u=i.length-1;u>=0;u--)this.removeListener(r,i[u]);return this};function jw(t,r,i){var l=t._events;if(l===void 0)return[];var u=l[r];return u===void 0?[]:typeof u=="function"?i?[u.listener||u]:[u]:i?A5(u):$w(u,u.length)}We.prototype.listeners=function(r){return jw(this,r,!0)};We.prototype.rawListeners=function(r){return jw(this,r,!1)};We.listenerCount=function(t,r){return typeof t.listenerCount=="function"?t.listenerCount(r):Hw.call(t,r)};We.prototype.listenerCount=Hw;function Hw(t){var r=this._events;if(r!==void 0){var i=r[t];if(typeof i=="function")return 1;if(i!==void 0)return i.length}return 0}We.prototype.eventNames=function(){return this._eventsCount>0?lc(this._events):[]};function $w(t,r){for(var i=new Array(r),l=0;l<r;++l)i[l]=t[l];return i}function N5(t,r){for(;r+1<t.length;r++)t[r]=t[r+1];t.pop()}function A5(t){for(var r=new Array(t.length),i=0;i<r.length;++i)r[i]=t[i].listener||t[i];return r}function M5(t,r){return new Promise(function(i,l){function u(g){t.removeListener(r,d),l(g)}function d(){typeof t.removeListener=="function"&&t.removeListener("error",u),i([].slice.call(arguments))}Vw(t,r,d,{once:!0}),r!=="error"&&D5(t,u,{once:!0})})}function D5(t,r,i){typeof t.on=="function"&&Vw(t,"error",r,i)}function Vw(t,r,i,l){if(typeof t.on=="function")l.once?t.once(r,i):t.on(r,i);else if(typeof t.addEventListener=="function")t.addEventListener(r,function u(d){l.once&&t.removeEventListener(r,u),i(d)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}});var Gw=me($h=>{(function(){"use strict";$h.stripBOM=function(t){return t[0]==="\uFEFF"?t.substring(1):t}}).call($h)});var Vh=me(Wr=>{(function(){"use strict";var t;t=new RegExp(/(?!xmlns)^.*:/),Wr.normalize=function(r){return r.toLowerCase()},Wr.firstCharLowerCase=function(r){return r.charAt(0).toLowerCase()+r.slice(1)},Wr.stripPrefix=function(r){return r.replace(t,"")},Wr.parseNumbers=function(r){return isNaN(r)||(r=r%1===0?parseInt(r,10):parseFloat(r)),r},Wr.parseBooleans=function(r){return/^(?:true|false)$/i.test(r)&&(r=r.toLowerCase()==="true"),r}}).call(Wr)});var Kw=me(Xw=>{Xw.every=function(t){return new Wh(t)};var Vn={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5};for(Gr in Vn)Gr==="millisecond"?Vn.ms=Vn[Gr]:Vn[Gr.charAt(0)]=Vn[Gr],Vn[Gr+"s"]=Vn[Gr];var Gr;function Wh(t){this.count=0;var r=L5(t);r&&(this.time=Number(r[0])*Vn[r[1]],this.type=r[1])}Wh.prototype.do=function(t){this.time&&(this.interval=setInterval(i,this.time));var r=this;function i(){r.count++,t.call(r)}return this};Wh.prototype.stop=function(){return this.interval&&(clearInterval(this.interval),delete this.interval),this};var S5=/^\s*(\d+(?:\.\d+)?)\s*([a-z]+)\s*$/;function L5(t){var r=t.match(S5);return r&&Vn[r[2]]?r.slice(1):null}});var Jw=me(Wn=>{(function(){"use strict";var t,r,i,l,u,d,g,m,x=function(S,M){return function(){return S.apply(M,arguments)}},v=function(S,M){for(var E in M)I.call(M,E)&&(S[E]=M[E]);function C(){this.constructor=S}return C.prototype=M.prototype,S.prototype=new C,S.__super__=M.prototype,S},I={}.hasOwnProperty;g=Rw(),i=Ww(),t=Gw(),d=Vh(),m=Kw().setImmediate,r=jl().defaults,l=function(S){return typeof S=="object"&&S!=null&&Object.keys(S).length===0},u=function(S,M,E){var C,B,$;for(C=0,B=S.length;C<B;C++)$=S[C],M=$(M,E);return M},Wn.Parser=function(S){v(M,S);function M(E){this.parseStringPromise=x(this.parseStringPromise,this),this.parseString=x(this.parseString,this),this.reset=x(this.reset,this),this.assignOrPush=x(this.assignOrPush,this),this.processAsync=x(this.processAsync,this);var C,B,$;if(!(this instanceof Wn.Parser))return new Wn.Parser(E);this.options={},B=r["0.2"];for(C in B)I.call(B,C)&&($=B[C],this.options[C]=$);for(C in E)I.call(E,C)&&($=E[C],this.options[C]=$);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(d.normalize)),this.reset()}return M.prototype.processAsync=function(){var E,C;try{return this.remaining.length<=this.options.chunkSize?(E=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(E),this.saxParser.close()):(E=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(E),m(this.processAsync))}catch(B){if(C=B,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(C)}},M.prototype.assignOrPush=function(E,C,B){return C in E?(E[C]instanceof Array||(E[C]=[E[C]]),E[C].push(B)):this.options.explicitArray?E[C]=[B]:E[C]=B},M.prototype.reset=function(){var E,C,B,$;return this.removeAllListeners(),this.saxParser=g.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=function(V){return function(te){if(V.saxParser.resume(),!V.saxParser.errThrown)return V.saxParser.errThrown=!0,V.emit("error",te)}}(this),this.saxParser.onend=function(V){return function(){if(!V.saxParser.ended)return V.saxParser.ended=!0,V.emit("end",V.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,$=[],E=this.options.attrkey,C=this.options.charkey,this.saxParser.onopentag=function(V){return function(te){var R,D,A,Z,X;if(A={},A[C]="",!V.options.ignoreAttrs){X=te.attributes;for(R in X)I.call(X,R)&&(!(E in A)&&!V.options.mergeAttrs&&(A[E]={}),D=V.options.attrValueProcessors?u(V.options.attrValueProcessors,te.attributes[R],R):te.attributes[R],Z=V.options.attrNameProcessors?u(V.options.attrNameProcessors,R):R,V.options.mergeAttrs?V.assignOrPush(A,Z,D):A[E][Z]=D)}return A["#name"]=V.options.tagNameProcessors?u(V.options.tagNameProcessors,te.name):te.name,V.options.xmlns&&(A[V.options.xmlnskey]={uri:te.uri,local:te.local}),$.push(A)}}(this),this.saxParser.onclosetag=function(V){return function(){var te,R,D,A,Z,X,H,J,U,K;if(X=$.pop(),Z=X["#name"],(!V.options.explicitChildren||!V.options.preserveChildrenOrder)&&delete X["#name"],X.cdata===!0&&(te=X.cdata,delete X.cdata),U=$[$.length-1],X[C].match(/^\s*$/)&&!te?(R=X[C],delete X[C]):(V.options.trim&&(X[C]=X[C].trim()),V.options.normalize&&(X[C]=X[C].replace(/\s{2,}/g," ").trim()),X[C]=V.options.valueProcessors?u(V.options.valueProcessors,X[C],Z):X[C],Object.keys(X).length===1&&C in X&&!V.EXPLICIT_CHARKEY&&(X=X[C])),l(X)&&(X=V.options.emptyTag!==""?V.options.emptyTag:R),V.options.validator!=null&&(K="/"+function(){var se,de,_e;for(_e=[],se=0,de=$.length;se<de;se++)A=$[se],_e.push(A["#name"]);return _e}().concat(Z).join("/"),function(){var se;try{return X=V.options.validator(K,U&&U[Z],X)}catch(de){return se=de,V.emit("error",se)}}()),V.options.explicitChildren&&!V.options.mergeAttrs&&typeof X=="object"){if(!V.options.preserveChildrenOrder)A={},V.options.attrkey in X&&(A[V.options.attrkey]=X[V.options.attrkey],delete X[V.options.attrkey]),!V.options.charsAsChildren&&V.options.charkey in X&&(A[V.options.charkey]=X[V.options.charkey],delete X[V.options.charkey]),Object.getOwnPropertyNames(X).length>0&&(A[V.options.childkey]=X),X=A;else if(U){U[V.options.childkey]=U[V.options.childkey]||[],H={};for(D in X)I.call(X,D)&&(H[D]=X[D]);U[V.options.childkey].push(H),delete X["#name"],Object.keys(X).length===1&&C in X&&!V.EXPLICIT_CHARKEY&&(X=X[C])}}return $.length>0?V.assignOrPush(U,Z,X):(V.options.explicitRoot&&(J=X,X={},X[Z]=J),V.resultObject=X,V.saxParser.ended=!0,V.emit("end",V.resultObject))}}(this),B=function(V){return function(te){var R,D;if(D=$[$.length-1],D)return D[C]+=te,V.options.explicitChildren&&V.options.preserveChildrenOrder&&V.options.charsAsChildren&&(V.options.includeWhiteChars||te.replace(/\\n/g,"").trim()!=="")&&(D[V.options.childkey]=D[V.options.childkey]||[],R={"#name":"__text__"},R[C]=te,V.options.normalize&&(R[C]=R[C].replace(/\s{2,}/g," ").trim()),D[V.options.childkey].push(R)),D}}(this),this.saxParser.ontext=B,this.saxParser.oncdata=function(V){return function(te){var R;if(R=B(te),R)return R.cdata=!0}}(this)},M.prototype.parseString=function(E,C){var B;C!=null&&typeof C=="function"&&(this.on("end",function($){return this.reset(),C(null,$)}),this.on("error",function($){return this.reset(),C($)}));try{return E=E.toString(),E.trim()===""?(this.emit("end",null),!0):(E=t.stripBOM(E),this.options.async?(this.remaining=E,m(this.processAsync),this.saxParser):this.saxParser.write(E).close())}catch($){if(B=$,this.saxParser.errThrown||this.saxParser.ended){if(this.saxParser.ended)throw B}else return this.emit("error",B),this.saxParser.errThrown=!0}},M.prototype.parseStringPromise=function(E){return new Promise(function(C){return function(B,$){return C.parseString(E,function(V,te){return V?$(V):B(te)})}}(this))},M}(i),Wn.parseString=function(S,M,E){var C,B,$;return E!=null?(typeof E=="function"&&(C=E),typeof M=="object"&&(B=M)):(typeof M=="function"&&(C=M),B={}),$=new Wn.Parser(B),$.parseString(S,C)},Wn.parseStringPromise=function(S,M){var E,C;return typeof M=="object"&&(E=M),C=new Wn.Parser(E),C.parseStringPromise(S)}}).call(Wn)});var Yw=me(Gn=>{(function(){"use strict";var t,r,i,l,u=function(g,m){for(var x in m)d.call(m,x)&&(g[x]=m[x]);function v(){this.constructor=g}return v.prototype=m.prototype,g.prototype=new v,g.__super__=m.prototype,g},d={}.hasOwnProperty;r=jl(),t=fw(),i=Jw(),l=Vh(),Gn.defaults=r.defaults,Gn.processors=l,Gn.ValidationError=function(g){u(m,g);function m(x){this.message=x}return m}(Error),Gn.Builder=t.Builder,Gn.Parser=i.Parser,Gn.parseString=i.parseString,Gn.parseStringPromise=i.parseStringPromise}).call(Gn)});var r_=me((uc,n_)=>{"use strict";(function(t,r){typeof uc=="object"&&typeof n_<"u"?r(uc):typeof define=="function"&&define.amd?define(["exports"],r):r(t.d3=t.d3||{})})(uc,function(t){"use strict";function r(e,n){return e<n?-1:e>n?1:e>=n?0:NaN}function i(e){var n;return e.length===1&&(n=e,e=function(o,a){return r(n(o),a)}),{left:function(o,a,s,c){for(s==null&&(s=0),c==null&&(c=o.length);s<c;){var h=s+c>>>1;e(o[h],a)<0?s=h+1:c=h}return s},right:function(o,a,s,c){for(s==null&&(s=0),c==null&&(c=o.length);s<c;){var h=s+c>>>1;e(o[h],a)>0?c=h:s=h+1}return s}}}var l=i(r),u=l.right,d=l.left;function g(e,n){return[e,n]}function m(e){return e===null?NaN:+e}function x(e,n){var o,a,s=e.length,c=0,h=-1,f=0,p=0;if(n==null)for(;++h<s;)isNaN(o=m(e[h]))||(p+=(a=o-f)*(o-(f+=a/++c)));else for(;++h<s;)isNaN(o=m(n(e[h],h,e)))||(p+=(a=o-f)*(o-(f+=a/++c)));if(c>1)return p/(c-1)}function v(e,n){var o=x(e,n);return o&&Math.sqrt(o)}function I(e,n){var o,a,s,c=e.length,h=-1;if(n==null){for(;++h<c;)if((o=e[h])!=null&&o>=o)for(a=s=o;++h<c;)(o=e[h])!=null&&(a>o&&(a=o),s<o&&(s=o))}else for(;++h<c;)if((o=n(e[h],h,e))!=null&&o>=o)for(a=s=o;++h<c;)(o=n(e[h],h,e))!=null&&(a>o&&(a=o),s<o&&(s=o));return[a,s]}var S=Array.prototype,M=S.slice,E=S.map;function C(e){return function(){return e}}function B(e){return e}function $(e,n,o){e=+e,n=+n,o=(s=arguments.length)<2?(n=e,e=0,1):s<3?1:+o;for(var a=-1,s=0|Math.max(0,Math.ceil((n-e)/o)),c=new Array(s);++a<s;)c[a]=e+a*o;return c}var V=Math.sqrt(50),te=Math.sqrt(10),R=Math.sqrt(2);function D(e,n,o){var a,s,c,h,f=-1;if(o=+o,(e=+e)==(n=+n)&&o>0)return[e];if((a=n<e)&&(s=e,e=n,n=s),(h=A(e,n,o))===0||!isFinite(h))return[];if(h>0)for(e=Math.ceil(e/h),n=Math.floor(n/h),c=new Array(s=Math.ceil(n-e+1));++f<s;)c[f]=(e+f)*h;else for(e=Math.floor(e*h),n=Math.ceil(n*h),c=new Array(s=Math.ceil(e-n+1));++f<s;)c[f]=(e-f)/h;return a&&c.reverse(),c}function A(e,n,o){var a=(n-e)/Math.max(0,o),s=Math.floor(Math.log(a)/Math.LN10),c=a/Math.pow(10,s);return s>=0?(c>=V?10:c>=te?5:c>=R?2:1)*Math.pow(10,s):-Math.pow(10,-s)/(c>=V?10:c>=te?5:c>=R?2:1)}function Z(e,n,o){var a=Math.abs(n-e)/Math.max(0,o),s=Math.pow(10,Math.floor(Math.log(a)/Math.LN10)),c=a/s;return c>=V?s*=10:c>=te?s*=5:c>=R&&(s*=2),n<e?-s:s}function X(e){return Math.ceil(Math.log(e.length)/Math.LN2)+1}function H(e,n,o){if(o==null&&(o=m),a=e.length){if((n=+n)<=0||a<2)return+o(e[0],0,e);if(n>=1)return+o(e[a-1],a-1,e);var a,s=(a-1)*n,c=Math.floor(s),h=+o(e[c],c,e);return h+(+o(e[c+1],c+1,e)-h)*(s-c)}}function J(e,n){var o,a,s=e.length,c=-1;if(n==null){for(;++c<s;)if((o=e[c])!=null&&o>=o)for(a=o;++c<s;)(o=e[c])!=null&&o>a&&(a=o)}else for(;++c<s;)if((o=n(e[c],c,e))!=null&&o>=o)for(a=o;++c<s;)(o=n(e[c],c,e))!=null&&o>a&&(a=o);return a}function U(e){for(var n,o,a,s=e.length,c=-1,h=0;++c<s;)h+=e[c].length;for(o=new Array(h);--s>=0;)for(n=(a=e[s]).length;--n>=0;)o[--h]=a[n];return o}function K(e,n){var o,a,s=e.length,c=-1;if(n==null){for(;++c<s;)if((o=e[c])!=null&&o>=o)for(a=o;++c<s;)(o=e[c])!=null&&a>o&&(a=o)}else for(;++c<s;)if((o=n(e[c],c,e))!=null&&o>=o)for(a=o;++c<s;)(o=n(e[c],c,e))!=null&&a>o&&(a=o);return a}function se(e){if(!(s=e.length))return[];for(var n=-1,o=K(e,de),a=new Array(o);++n<o;)for(var s,c=-1,h=a[n]=new Array(s);++c<s;)h[c]=e[c][n];return a}function de(e){return e.length}var _e=Array.prototype.slice;function Ce(e){return e}var we=1,Ue=2,Ae=3,ge=4,ye=1e-6;function Oe(e){return"translate("+(e+.5)+",0)"}function Ze(e){return"translate(0,"+(e+.5)+")"}function Ge(){return!this.__axis}function rt(e,n){var o=[],a=null,s=null,c=6,h=6,f=3,p=e===we||e===ge?-1:1,y=e===ge||e===Ue?"x":"y",w=e===we||e===Ae?Oe:Ze;function _(b){var T=a??(n.ticks?n.ticks.apply(n,o):n.domain()),k=s??(n.tickFormat?n.tickFormat.apply(n,o):Ce),N=Math.max(c,0)+f,P=n.range(),L=+P[0]+.5,z=+P[P.length-1]+.5,F=(n.bandwidth?function(oe){var ee=Math.max(0,oe.bandwidth()-1)/2;return oe.round()&&(ee=Math.round(ee)),function(q){return+oe(q)+ee}}:function(oe){return function(ee){return+oe(ee)}})(n.copy()),W=b.selection?b.selection():b,Y=W.selectAll(".domain").data([null]),ae=W.selectAll(".tick").data(T,n).order(),ie=ae.exit(),ce=ae.enter().append("g").attr("class","tick"),G=ae.select("line"),ne=ae.select("text");Y=Y.merge(Y.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),ae=ae.merge(ce),G=G.merge(ce.append("line").attr("stroke","currentColor").attr(y+"2",p*c)),ne=ne.merge(ce.append("text").attr("fill","currentColor").attr(y,p*N).attr("dy",e===we?"0em":e===Ae?"0.71em":"0.32em")),b!==W&&(Y=Y.transition(b),ae=ae.transition(b),G=G.transition(b),ne=ne.transition(b),ie=ie.transition(b).attr("opacity",ye).attr("transform",function(oe){return isFinite(oe=F(oe))?w(oe):this.getAttribute("transform")}),ce.attr("opacity",ye).attr("transform",function(oe){var ee=this.parentNode.__axis;return w(ee&&isFinite(ee=ee(oe))?ee:F(oe))})),ie.remove(),Y.attr("d",e===ge||e==Ue?h?"M"+p*h+","+L+"H0.5V"+z+"H"+p*h:"M0.5,"+L+"V"+z:h?"M"+L+","+p*h+"V0.5H"+z+"V"+p*h:"M"+L+",0.5H"+z),ae.attr("opacity",1).attr("transform",function(oe){return w(F(oe))}),G.attr(y+"2",p*c),ne.attr(y,p*N).text(k),W.filter(Ge).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===Ue?"start":e===ge?"end":"middle"),W.each(function(){this.__axis=F})}return _.scale=function(b){return arguments.length?(n=b,_):n},_.ticks=function(){return o=_e.call(arguments),_},_.tickArguments=function(b){return arguments.length?(o=b==null?[]:_e.call(b),_):o.slice()},_.tickValues=function(b){return arguments.length?(a=b==null?null:_e.call(b),_):a&&a.slice()},_.tickFormat=function(b){return arguments.length?(s=b,_):s},_.tickSize=function(b){return arguments.length?(c=h=+b,_):c},_.tickSizeInner=function(b){return arguments.length?(c=+b,_):c},_.tickSizeOuter=function(b){return arguments.length?(h=+b,_):h},_.tickPadding=function(b){return arguments.length?(f=+b,_):f},_}var fn={value:function(){}};function j(){for(var e,n=0,o=arguments.length,a={};n<o;++n){if(!(e=arguments[n]+"")||e in a)throw new Error("illegal type: "+e);a[e]=[]}return new O(a)}function O(e){this._=e}function fe(e,n){for(var o,a=0,s=e.length;a<s;++a)if((o=e[a]).name===n)return o.value}function re(e,n,o){for(var a=0,s=e.length;a<s;++a)if(e[a].name===n){e[a]=fn,e=e.slice(0,a).concat(e.slice(a+1));break}return o!=null&&e.push({name:n,value:o}),e}O.prototype=j.prototype={constructor:O,on:function(e,n){var o,a,s=this._,c=(a=s,(e+"").trim().split(/^|\s+/).map(function(p){var y="",w=p.indexOf(".");if(w>=0&&(y=p.slice(w+1),p=p.slice(0,w)),p&&!a.hasOwnProperty(p))throw new Error("unknown type: "+p);return{type:p,name:y}})),h=-1,f=c.length;if(!(arguments.length<2)){if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++h<f;)if(o=(e=c[h]).type)s[o]=re(s[o],e.name,n);else if(n==null)for(o in s)s[o]=re(s[o],e.name,null);return this}for(;++h<f;)if((o=(e=c[h]).type)&&(o=fe(s[o],e.name)))return o},copy:function(){var e={},n=this._;for(var o in n)e[o]=n[o].slice();return new O(e)},call:function(e,n){if((o=arguments.length-2)>0)for(var o,a,s=new Array(o),c=0;c<o;++c)s[c]=arguments[c+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(c=0,o=(a=this._[e]).length;c<o;++c)a[c].value.apply(n,s)},apply:function(e,n,o){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var a=this._[e],s=0,c=a.length;s<c;++s)a[s].value.apply(n,o)}};var Fe="http://www.w3.org/1999/xhtml",tt={svg:"http://www.w3.org/2000/svg",xhtml:Fe,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Ye(e){var n=e+="",o=n.indexOf(":");return o>=0&&(n=e.slice(0,o))!=="xmlns"&&(e=e.slice(o+1)),tt.hasOwnProperty(n)?{space:tt[n],local:e}:e}function ct(e){var n=Ye(e);return(n.local?function(o){return function(){return this.ownerDocument.createElementNS(o.space,o.local)}}:function(o){return function(){var a=this.ownerDocument,s=this.namespaceURI;return s===Fe&&a.documentElement.namespaceURI===Fe?a.createElement(o):a.createElementNS(s,o)}})(n)}function Vt(){}function en(e){return e==null?Vt:function(){return this.querySelector(e)}}function ut(){return[]}function zt(e){return e==null?ut:function(){return this.querySelectorAll(e)}}function uo(e){return function(){return this.matches(e)}}function fo(e){return new Array(e.length)}function er(e,n){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=n}er.prototype={constructor:er,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,n){return this._parent.insertBefore(e,n)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var ho="$";function h2(e,n,o,a,s,c){for(var h,f=0,p=n.length,y=c.length;f<y;++f)(h=n[f])?(h.__data__=c[f],a[f]=h):o[f]=new er(e,c[f]);for(;f<p;++f)(h=n[f])&&(s[f]=h)}function d2(e,n,o,a,s,c,h){var f,p,y,w={},_=n.length,b=c.length,T=new Array(_);for(f=0;f<_;++f)(p=n[f])&&(T[f]=y=ho+h.call(p,p.__data__,f,n),y in w?s[f]=p:w[y]=p);for(f=0;f<b;++f)(p=w[y=ho+h.call(e,c[f],f,c)])?(a[f]=p,p.__data__=c[f],w[y]=null):o[f]=new er(e,c[f]);for(f=0;f<_;++f)(p=n[f])&&w[T[f]]===p&&(s[f]=p)}function p2(e,n){return e<n?-1:e>n?1:e>=n?0:NaN}function Uc(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Er(e,n){return e.style.getPropertyValue(n)||Uc(e).getComputedStyle(e,null).getPropertyValue(n)}function hp(e){return e.trim().split(/^|\s+/)}function Zc(e){return e.classList||new dp(e)}function dp(e){this._node=e,this._names=hp(e.getAttribute("class")||"")}function pp(e,n){for(var o=Zc(e),a=-1,s=n.length;++a<s;)o.add(n[a])}function gp(e,n){for(var o=Zc(e),a=-1,s=n.length;++a<s;)o.remove(n[a])}function g2(){this.textContent=""}function m2(){this.innerHTML=""}function y2(){this.nextSibling&&this.parentNode.appendChild(this)}function b2(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function w2(){return null}function _2(){var e=this.parentNode;e&&e.removeChild(this)}function v2(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function x2(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}dp.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var n=this._names.indexOf(e);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var mp={};t.event=null,typeof document<"u"&&("onmouseenter"in document.documentElement||(mp={mouseenter:"mouseover",mouseleave:"mouseout"}));function T2(e,n,o){return e=yp(e,n,o),function(a){var s=a.relatedTarget;s&&(s===this||8&s.compareDocumentPosition(this))||e.call(this,a)}}function yp(e,n,o){return function(a){var s=t.event;t.event=a;try{e.call(this,this.__data__,n,o)}finally{t.event=s}}}function I2(e){return function(){var n=this.__on;if(n){for(var o,a=0,s=-1,c=n.length;a<c;++a)o=n[a],e.type&&o.type!==e.type||o.name!==e.name?n[++s]=o:this.removeEventListener(o.type,o.listener,o.capture);++s?n.length=s:delete this.__on}}}function E2(e,n,o){var a=mp.hasOwnProperty(e.type)?T2:yp;return function(s,c,h){var f,p=this.__on,y=a(n,c,h);if(p){for(var w=0,_=p.length;w<_;++w)if((f=p[w]).type===e.type&&f.name===e.name)return this.removeEventListener(f.type,f.listener,f.capture),this.addEventListener(f.type,f.listener=y,f.capture=o),void(f.value=n)}this.addEventListener(e.type,y,o),f={type:e.type,name:e.name,value:n,listener:y,capture:o},p?p.push(f):this.__on=[f]}}function po(e,n,o,a){var s=t.event;e.sourceEvent=t.event,t.event=e;try{return n.apply(o,a)}finally{t.event=s}}function bp(e,n,o){var a=Uc(e),s=a.CustomEvent;typeof s=="function"?s=new s(n,o):(s=a.document.createEvent("Event"),o?(s.initEvent(n,o.bubbles,o.cancelable),s.detail=o.detail):s.initEvent(n,!1,!1)),e.dispatchEvent(s)}var jc=[null];function It(e,n){this._groups=e,this._parents=n}function kr(){return new It([[document.documentElement]],jc)}function Pt(e){return typeof e=="string"?new It([[document.querySelector(e)]],[document.documentElement]):new It([[e]],jc)}It.prototype=kr.prototype={constructor:It,select:function(e){typeof e!="function"&&(e=en(e));for(var n=this._groups,o=n.length,a=new Array(o),s=0;s<o;++s)for(var c,h,f=n[s],p=f.length,y=a[s]=new Array(p),w=0;w<p;++w)(c=f[w])&&(h=e.call(c,c.__data__,w,f))&&("__data__"in c&&(h.__data__=c.__data__),y[w]=h);return new It(a,this._parents)},selectAll:function(e){typeof e!="function"&&(e=zt(e));for(var n=this._groups,o=n.length,a=[],s=[],c=0;c<o;++c)for(var h,f=n[c],p=f.length,y=0;y<p;++y)(h=f[y])&&(a.push(e.call(h,h.__data__,y,f)),s.push(h));return new It(a,s)},filter:function(e){typeof e!="function"&&(e=uo(e));for(var n=this._groups,o=n.length,a=new Array(o),s=0;s<o;++s)for(var c,h=n[s],f=h.length,p=a[s]=[],y=0;y<f;++y)(c=h[y])&&e.call(c,c.__data__,y,h)&&p.push(c);return new It(a,this._parents)},data:function(e,n){if(!e)return k=new Array(this.size()),w=-1,this.each(function(ae){k[++w]=ae}),k;var o,a=n?d2:h2,s=this._parents,c=this._groups;typeof e!="function"&&(o=e,e=function(){return o});for(var h=c.length,f=new Array(h),p=new Array(h),y=new Array(h),w=0;w<h;++w){var _=s[w],b=c[w],T=b.length,k=e.call(_,_&&_.__data__,w,s),N=k.length,P=p[w]=new Array(N),L=f[w]=new Array(N);a(_,b,P,L,y[w]=new Array(T),k,n);for(var z,F,W=0,Y=0;W<N;++W)if(z=P[W]){for(W>=Y&&(Y=W+1);!(F=L[Y])&&++Y<N;);z._next=F||null}}return(f=new It(f,s))._enter=p,f._exit=y,f},enter:function(){return new It(this._enter||this._groups.map(fo),this._parents)},exit:function(){return new It(this._exit||this._groups.map(fo),this._parents)},join:function(e,n,o){var a=this.enter(),s=this,c=this.exit();return a=typeof e=="function"?e(a):a.append(e+""),n!=null&&(s=n(s)),o==null?c.remove():o(c),a&&s?a.merge(s).order():s},merge:function(e){for(var n=this._groups,o=e._groups,a=n.length,s=o.length,c=Math.min(a,s),h=new Array(a),f=0;f<c;++f)for(var p,y=n[f],w=o[f],_=y.length,b=h[f]=new Array(_),T=0;T<_;++T)(p=y[T]||w[T])&&(b[T]=p);for(;f<a;++f)h[f]=n[f];return new It(h,this._parents)},order:function(){for(var e=this._groups,n=-1,o=e.length;++n<o;)for(var a,s=e[n],c=s.length-1,h=s[c];--c>=0;)(a=s[c])&&(h&&4^a.compareDocumentPosition(h)&&h.parentNode.insertBefore(a,h),h=a);return this},sort:function(e){function n(_,b){return _&&b?e(_.__data__,b.__data__):!_-!b}e||(e=p2);for(var o=this._groups,a=o.length,s=new Array(a),c=0;c<a;++c){for(var h,f=o[c],p=f.length,y=s[c]=new Array(p),w=0;w<p;++w)(h=f[w])&&(y[w]=h);y.sort(n)}return new It(s,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),n=-1;return this.each(function(){e[++n]=this}),e},node:function(){for(var e=this._groups,n=0,o=e.length;n<o;++n)for(var a=e[n],s=0,c=a.length;s<c;++s){var h=a[s];if(h)return h}return null},size:function(){var e=0;return this.each(function(){++e}),e},empty:function(){return!this.node()},each:function(e){for(var n=this._groups,o=0,a=n.length;o<a;++o)for(var s,c=n[o],h=0,f=c.length;h<f;++h)(s=c[h])&&e.call(s,s.__data__,h,c);return this},attr:function(e,n){var o=Ye(e);if(arguments.length<2){var a=this.node();return o.local?a.getAttributeNS(o.space,o.local):a.getAttribute(o)}return this.each((n==null?o.local?function(s){return function(){this.removeAttributeNS(s.space,s.local)}}:function(s){return function(){this.removeAttribute(s)}}:typeof n=="function"?o.local?function(s,c){return function(){var h=c.apply(this,arguments);h==null?this.removeAttributeNS(s.space,s.local):this.setAttributeNS(s.space,s.local,h)}}:function(s,c){return function(){var h=c.apply(this,arguments);h==null?this.removeAttribute(s):this.setAttribute(s,h)}}:o.local?function(s,c){return function(){this.setAttributeNS(s.space,s.local,c)}}:function(s,c){return function(){this.setAttribute(s,c)}})(o,n))},style:function(e,n,o){return arguments.length>1?this.each((n==null?function(a){return function(){this.style.removeProperty(a)}}:typeof n=="function"?function(a,s,c){return function(){var h=s.apply(this,arguments);h==null?this.style.removeProperty(a):this.style.setProperty(a,h,c)}}:function(a,s,c){return function(){this.style.setProperty(a,s,c)}})(e,n,o??"")):Er(this.node(),e)},property:function(e,n){return arguments.length>1?this.each((n==null?function(o){return function(){delete this[o]}}:typeof n=="function"?function(o,a){return function(){var s=a.apply(this,arguments);s==null?delete this[o]:this[o]=s}}:function(o,a){return function(){this[o]=a}})(e,n)):this.node()[e]},classed:function(e,n){var o=hp(e+"");if(arguments.length<2){for(var a=Zc(this.node()),s=-1,c=o.length;++s<c;)if(!a.contains(o[s]))return!1;return!0}return this.each((typeof n=="function"?function(h,f){return function(){(f.apply(this,arguments)?pp:gp)(this,h)}}:n?function(h){return function(){pp(this,h)}}:function(h){return function(){gp(this,h)}})(o,n))},text:function(e){return arguments.length?this.each(e==null?g2:(typeof e=="function"?function(n){return function(){var o=n.apply(this,arguments);this.textContent=o??""}}:function(n){return function(){this.textContent=n}})(e)):this.node().textContent},html:function(e){return arguments.length?this.each(e==null?m2:(typeof e=="function"?function(n){return function(){var o=n.apply(this,arguments);this.innerHTML=o??""}}:function(n){return function(){this.innerHTML=n}})(e)):this.node().innerHTML},raise:function(){return this.each(y2)},lower:function(){return this.each(b2)},append:function(e){var n=typeof e=="function"?e:ct(e);return this.select(function(){return this.appendChild(n.apply(this,arguments))})},insert:function(e,n){var o=typeof e=="function"?e:ct(e),a=n==null?w2:typeof n=="function"?n:en(n);return this.select(function(){return this.insertBefore(o.apply(this,arguments),a.apply(this,arguments)||null)})},remove:function(){return this.each(_2)},clone:function(e){return this.select(e?x2:v2)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,n,o){var a,s,c=function(_){return _.trim().split(/^|\s+/).map(function(b){var T="",k=b.indexOf(".");return k>=0&&(T=b.slice(k+1),b=b.slice(0,k)),{type:b,name:T}})}(e+""),h=c.length;if(!(arguments.length<2)){for(f=n?E2:I2,o==null&&(o=!1),a=0;a<h;++a)this.each(f(c[a],n,o));return this}var f=this.node().__on;if(f){for(var p,y=0,w=f.length;y<w;++y)for(a=0,p=f[y];a<h;++a)if((s=c[a]).type===p.type&&s.name===p.name)return p.value}},dispatch:function(e,n){return this.each((typeof n=="function"?function(o,a){return function(){return bp(this,o,a.apply(this,arguments))}}:function(o,a){return function(){return bp(this,o,a)}})(e,n))}};var k2=0;function wp(){return new Hc}function Hc(){this._="@"+(++k2).toString(36)}function $c(){for(var e,n=t.event;e=n.sourceEvent;)n=e;return n}function es(e,n){var o=e.ownerSVGElement||e;if(o.createSVGPoint){var a=o.createSVGPoint();return a.x=n.clientX,a.y=n.clientY,[(a=a.matrixTransform(e.getScreenCTM().inverse())).x,a.y]}var s=e.getBoundingClientRect();return[n.clientX-s.left-e.clientLeft,n.clientY-s.top-e.clientTop]}function tr(e){var n=$c();return n.changedTouches&&(n=n.changedTouches[0]),es(e,n)}function ts(e,n,o){arguments.length<3&&(o=n,n=$c().changedTouches);for(var a,s=0,c=n?n.length:0;s<c;++s)if((a=n[s]).identifier===o)return es(e,a);return null}function Vc(){t.event.stopImmediatePropagation()}function ni(){t.event.preventDefault(),t.event.stopImmediatePropagation()}function ns(e){var n=e.document.documentElement,o=Pt(e).on("dragstart.drag",ni,!0);"onselectstart"in n?o.on("selectstart.drag",ni,!0):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function rs(e,n){var o=e.document.documentElement,a=Pt(e).on("dragstart.drag",null);n&&(a.on("click.drag",ni,!0),window.setTimeout(function(){a.on("click.drag",null)},0)),"onselectstart"in o?a.on("selectstart.drag",null):(o.style.MozUserSelect=o.__noselect,delete o.__noselect)}function is(e){return function(){return e}}function Wc(e,n,o,a,s,c,h,f,p,y){this.target=e,this.type=n,this.subject=o,this.identifier=a,this.active=s,this.x=c,this.y=h,this.dx=f,this.dy=p,this._=y}function C2(){return!t.event.button}function N2(){return this.parentNode}function A2(e){return e??{x:t.event.x,y:t.event.y}}function M2(){return"ontouchstart"in this}function ri(e,n,o){e.prototype=n.prototype=o,o.constructor=e}function go(e,n){var o=Object.create(e.prototype);for(var a in n)o[a]=n[a];return o}function nr(){}Hc.prototype=wp.prototype={constructor:Hc,get:function(e){for(var n=this._;!(n in e);)if(!(e=e.parentNode))return;return e[n]},set:function(e,n){return e[this._]=n},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}},Wc.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var ii="\\s*([+-]?\\d+)\\s*",mo="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",hn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",D2=/^#([0-9a-f]{3})$/,S2=/^#([0-9a-f]{6})$/,L2=new RegExp("^rgb\\("+[ii,ii,ii]+"\\)$"),P2=new RegExp("^rgb\\("+[hn,hn,hn]+"\\)$"),O2=new RegExp("^rgba\\("+[ii,ii,ii,mo]+"\\)$"),R2=new RegExp("^rgba\\("+[hn,hn,hn,mo]+"\\)$"),F2=new RegExp("^hsl\\("+[mo,hn,hn]+"\\)$"),B2=new RegExp("^hsla\\("+[mo,hn,hn,mo]+"\\)$"),_p={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function rr(e){var n;return e=(e+"").trim().toLowerCase(),(n=D2.exec(e))?new gt((n=parseInt(n[1],16))>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):(n=S2.exec(e))?vp(parseInt(n[1],16)):(n=L2.exec(e))?new gt(n[1],n[2],n[3],1):(n=P2.exec(e))?new gt(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=O2.exec(e))?xp(n[1],n[2],n[3],n[4]):(n=R2.exec(e))?xp(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=F2.exec(e))?Tp(n[1],n[2]/100,n[3]/100,1):(n=B2.exec(e))?Tp(n[1],n[2]/100,n[3]/100,n[4]):_p.hasOwnProperty(e)?vp(_p[e]):e==="transparent"?new gt(NaN,NaN,NaN,0):null}function vp(e){return new gt(e>>16&255,e>>8&255,255&e,1)}function xp(e,n,o,a){return a<=0&&(e=n=o=NaN),new gt(e,n,o,a)}function Gc(e){return e instanceof nr||(e=rr(e)),e?new gt((e=e.rgb()).r,e.g,e.b,e.opacity):new gt}function oi(e,n,o,a){return arguments.length===1?Gc(e):new gt(e,n,o,a??1)}function gt(e,n,o,a){this.r=+e,this.g=+n,this.b=+o,this.opacity=+a}function Xc(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function Tp(e,n,o,a){return a<=0?e=n=o=NaN:o<=0||o>=1?e=n=NaN:n<=0&&(e=NaN),new dn(e,n,o,a)}function os(e,n,o,a){return arguments.length===1?function(s){if(s instanceof dn)return new dn(s.h,s.s,s.l,s.opacity);if(s instanceof nr||(s=rr(s)),!s)return new dn;if(s instanceof dn)return s;var c=(s=s.rgb()).r/255,h=s.g/255,f=s.b/255,p=Math.min(c,h,f),y=Math.max(c,h,f),w=NaN,_=y-p,b=(y+p)/2;return _?(w=c===y?(h-f)/_+6*(h<f):h===y?(f-c)/_+2:(c-h)/_+4,_/=b<.5?y+p:2-y-p,w*=60):_=b>0&&b<1?0:w,new dn(w,_,b,s.opacity)}(e):new dn(e,n,o,a??1)}function dn(e,n,o,a){this.h=+e,this.s=+n,this.l=+o,this.opacity=+a}function Kc(e,n,o){return 255*(e<60?n+(o-n)*e/60:e<180?o:e<240?n+(o-n)*(240-e)/60:n)}ri(nr,rr,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),ri(gt,oi,go(nr,{brighter:function(e){return e=e==null?1/.7:Math.pow(1/.7,e),new gt(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?.7:Math.pow(.7,e),new gt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function(){return"#"+Xc(this.r)+Xc(this.g)+Xc(this.b)},toString:function(){var e=this.opacity;return((e=isNaN(e)?1:Math.max(0,Math.min(1,e)))===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}})),ri(dn,os,go(nr,{brighter:function(e){return e=e==null?1/.7:Math.pow(1/.7,e),new dn(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?.7:Math.pow(.7,e),new dn(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),n=isNaN(e)||isNaN(this.s)?0:this.s,o=this.l,a=o+(o<.5?o:1-o)*n,s=2*o-a;return new gt(Kc(e>=240?e-240:e+120,s,a),Kc(e,s,a),Kc(e<120?e+240:e-120,s,a),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var Ip=Math.PI/180,Ep=180/Math.PI,kp=.96422,Cp=1,Np=.82521,Ap=4/29,ai=6/29,Mp=3*ai*ai,z2=ai*ai*ai;function Jc(e){if(e instanceof tn)return new tn(e.l,e.a,e.b,e.opacity);if(e instanceof pn){if(isNaN(e.h))return new tn(e.l,0,0,e.opacity);var n=e.h*Ip;return new tn(e.l,Math.cos(n)*e.c,Math.sin(n)*e.c,e.opacity)}e instanceof gt||(e=Gc(e));var o,a,s=tu(e.r),c=tu(e.g),h=tu(e.b),f=Yc((.2225045*s+.7168786*c+.0606169*h)/Cp);return s===c&&c===h?o=a=f:(o=Yc((.4360747*s+.3850649*c+.1430804*h)/kp),a=Yc((.0139322*s+.0971045*c+.7141733*h)/Np)),new tn(116*f-16,500*(o-f),200*(f-a),e.opacity)}function as(e,n,o,a){return arguments.length===1?Jc(e):new tn(e,n,o,a??1)}function tn(e,n,o,a){this.l=+e,this.a=+n,this.b=+o,this.opacity=+a}function Yc(e){return e>z2?Math.pow(e,1/3):e/Mp+Ap}function Qc(e){return e>ai?e*e*e:Mp*(e-Ap)}function eu(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function tu(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Dp(e){if(e instanceof pn)return new pn(e.h,e.c,e.l,e.opacity);if(e instanceof tn||(e=Jc(e)),e.a===0&&e.b===0)return new pn(NaN,0,e.l,e.opacity);var n=Math.atan2(e.b,e.a)*Ep;return new pn(n<0?n+360:n,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function ss(e,n,o,a){return arguments.length===1?Dp(e):new pn(e,n,o,a??1)}function pn(e,n,o,a){this.h=+e,this.c=+n,this.l=+o,this.opacity=+a}ri(tn,as,go(nr,{brighter:function(e){return new tn(this.l+18*(e??1),this.a,this.b,this.opacity)},darker:function(e){return new tn(this.l-18*(e??1),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,n=isNaN(this.a)?e:e+this.a/500,o=isNaN(this.b)?e:e-this.b/200;return new gt(eu(3.1338561*(n=kp*Qc(n))-1.6168667*(e=Cp*Qc(e))-.4906146*(o=Np*Qc(o))),eu(-.9787684*n+1.9161415*e+.033454*o),eu(.0719453*n-.2289914*e+1.4052427*o),this.opacity)}})),ri(pn,ss,go(nr,{brighter:function(e){return new pn(this.h,this.c,this.l+18*(e??1),this.opacity)},darker:function(e){return new pn(this.h,this.c,this.l-18*(e??1),this.opacity)},rgb:function(){return Jc(this).rgb()}}));var Sp=-.14861,nu=1.78277,ru=-.29227,ls=-.90649,yo=1.97294,Lp=yo*ls,Pp=yo*nu,Op=nu*ru-ls*Sp;function nn(e,n,o,a){return arguments.length===1?function(s){if(s instanceof Cr)return new Cr(s.h,s.s,s.l,s.opacity);s instanceof gt||(s=Gc(s));var c=s.r/255,h=s.g/255,f=s.b/255,p=(Op*f+Lp*c-Pp*h)/(Op+Lp-Pp),y=f-p,w=(yo*(h-p)-ru*y)/ls,_=Math.sqrt(w*w+y*y)/(yo*p*(1-p)),b=_?Math.atan2(w,y)*Ep-120:NaN;return new Cr(b<0?b+360:b,_,p,s.opacity)}(e):new Cr(e,n,o,a??1)}function Cr(e,n,o,a){this.h=+e,this.s=+n,this.l=+o,this.opacity=+a}function Rp(e,n,o,a,s){var c=e*e,h=c*e;return((1-3*e+3*c-h)*n+(4-6*c+3*h)*o+(1+3*e+3*c-3*h)*a+h*s)/6}function Fp(e){var n=e.length-1;return function(o){var a=o<=0?o=0:o>=1?(o=1,n-1):Math.floor(o*n),s=e[a],c=e[a+1],h=a>0?e[a-1]:2*s-c,f=a<n-1?e[a+2]:2*c-s;return Rp((o-a/n)*n,h,s,c,f)}}function Bp(e){var n=e.length;return function(o){var a=Math.floor(((o%=1)<0?++o:o)*n),s=e[(a+n-1)%n],c=e[a%n],h=e[(a+1)%n],f=e[(a+2)%n];return Rp((o-a/n)*n,s,c,h,f)}}function cs(e){return function(){return e}}function zp(e,n){return function(o){return e+o*n}}function us(e,n){var o=n-e;return o?zp(e,o>180||o<-180?o-360*Math.round(o/360):o):cs(isNaN(e)?n:e)}function q2(e){return(e=+e)==1?dt:function(n,o){return o-n?function(a,s,c){return a=Math.pow(a,c),s=Math.pow(s,c)-a,c=1/c,function(h){return Math.pow(a+h*s,c)}}(n,o,e):cs(isNaN(n)?o:n)}}function dt(e,n){var o=n-e;return o?zp(e,o):cs(isNaN(e)?n:e)}ri(Cr,nn,go(nr,{brighter:function(e){return e=e==null?1/.7:Math.pow(1/.7,e),new Cr(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?.7:Math.pow(.7,e),new Cr(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*Ip,n=+this.l,o=isNaN(this.s)?0:this.s*n*(1-n),a=Math.cos(e),s=Math.sin(e);return new gt(255*(n+o*(Sp*a+nu*s)),255*(n+o*(ru*a+ls*s)),255*(n+o*(yo*a)),this.opacity)}}));var bo=function e(n){var o=q2(n);function a(s,c){var h=o((s=oi(s)).r,(c=oi(c)).r),f=o(s.g,c.g),p=o(s.b,c.b),y=dt(s.opacity,c.opacity);return function(w){return s.r=h(w),s.g=f(w),s.b=p(w),s.opacity=y(w),s+""}}return a.gamma=e,a}(1);function qp(e){return function(n){var o,a,s=n.length,c=new Array(s),h=new Array(s),f=new Array(s);for(o=0;o<s;++o)a=oi(n[o]),c[o]=a.r||0,h[o]=a.g||0,f[o]=a.b||0;return c=e(c),h=e(h),f=e(f),a.opacity=1,function(p){return a.r=c(p),a.g=h(p),a.b=f(p),a+""}}}var Up=qp(Fp),U2=qp(Bp);function Zp(e,n){var o,a=n?n.length:0,s=e?Math.min(a,e.length):0,c=new Array(s),h=new Array(a);for(o=0;o<s;++o)c[o]=wo(e[o],n[o]);for(;o<a;++o)h[o]=n[o];return function(f){for(o=0;o<s;++o)h[o]=c[o](f);return h}}function jp(e,n){var o=new Date;return n-=e=+e,function(a){return o.setTime(e+n*a),o}}function Wt(e,n){return n-=e=+e,function(o){return e+n*o}}function Hp(e,n){var o,a={},s={};for(o in e!==null&&typeof e=="object"||(e={}),n!==null&&typeof n=="object"||(n={}),n)o in e?a[o]=wo(e[o],n[o]):s[o]=n[o];return function(c){for(o in a)s[o]=a[o](c);return s}}var iu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ou=new RegExp(iu.source,"g");function au(e,n){var o,a,s,c=iu.lastIndex=ou.lastIndex=0,h=-1,f=[],p=[];for(e+="",n+="";(o=iu.exec(e))&&(a=ou.exec(n));)(s=a.index)>c&&(s=n.slice(c,s),f[h]?f[h]+=s:f[++h]=s),(o=o[0])===(a=a[0])?f[h]?f[h]+=a:f[++h]=a:(f[++h]=null,p.push({i:h,x:Wt(o,a)})),c=ou.lastIndex;return c<n.length&&(s=n.slice(c),f[h]?f[h]+=s:f[++h]=s),f.length<2?p[0]?function(y){return function(w){return y(w)+""}}(p[0].x):function(y){return function(){return y}}(n):(n=p.length,function(y){for(var w,_=0;_<n;++_)f[(w=p[_]).i]=w.x(y);return f.join("")})}function wo(e,n){var o,a=typeof n;return n==null||a==="boolean"?cs(n):(a==="number"?Wt:a==="string"?(o=rr(n))?(n=o,bo):au:n instanceof rr?bo:n instanceof Date?jp:Array.isArray(n)?Zp:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?Hp:Wt)(e,n)}function $p(e,n){return n-=e=+e,function(o){return Math.round(e+n*o)}}var _o,su,Vp,fs,Wp=180/Math.PI,lu={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Gp(e,n,o,a,s,c){var h,f,p;return(h=Math.sqrt(e*e+n*n))&&(e/=h,n/=h),(p=e*o+n*a)&&(o-=e*p,a-=n*p),(f=Math.sqrt(o*o+a*a))&&(o/=f,a/=f,p/=f),e*a<n*o&&(e=-e,n=-n,p=-p,h=-h),{translateX:s,translateY:c,rotate:Math.atan2(n,e)*Wp,skewX:Math.atan(p)*Wp,scaleX:h,scaleY:f}}function Xp(e,n,o,a){function s(c){return c.length?c.pop()+" ":""}return function(c,h){var f=[],p=[];return c=e(c),h=e(h),function(y,w,_,b,T,k){if(y!==_||w!==b){var N=T.push("translate(",null,n,null,o);k.push({i:N-4,x:Wt(y,_)},{i:N-2,x:Wt(w,b)})}else(_||b)&&T.push("translate("+_+n+b+o)}(c.translateX,c.translateY,h.translateX,h.translateY,f,p),function(y,w,_,b){y!==w?(y-w>180?w+=360:w-y>180&&(y+=360),b.push({i:_.push(s(_)+"rotate(",null,a)-2,x:Wt(y,w)})):w&&_.push(s(_)+"rotate("+w+a)}(c.rotate,h.rotate,f,p),function(y,w,_,b){y!==w?b.push({i:_.push(s(_)+"skewX(",null,a)-2,x:Wt(y,w)}):w&&_.push(s(_)+"skewX("+w+a)}(c.skewX,h.skewX,f,p),function(y,w,_,b,T,k){if(y!==_||w!==b){var N=T.push(s(T)+"scale(",null,",",null,")");k.push({i:N-4,x:Wt(y,_)},{i:N-2,x:Wt(w,b)})}else _===1&&b===1||T.push(s(T)+"scale("+_+","+b+")")}(c.scaleX,c.scaleY,h.scaleX,h.scaleY,f,p),c=h=null,function(y){for(var w,_=-1,b=p.length;++_<b;)f[(w=p[_]).i]=w.x(y);return f.join("")}}}var Kp=Xp(function(e){return e==="none"?lu:(_o||(_o=document.createElement("DIV"),su=document.documentElement,Vp=document.defaultView),_o.style.transform=e,e=Vp.getComputedStyle(su.appendChild(_o),null).getPropertyValue("transform"),su.removeChild(_o),Gp(+(e=e.slice(7,-1).split(","))[0],+e[1],+e[2],+e[3],+e[4],+e[5]))},"px, ","px)","deg)"),Jp=Xp(function(e){return e==null?lu:(fs||(fs=document.createElementNS("http://www.w3.org/2000/svg","g")),fs.setAttribute("transform",e),(e=fs.transform.baseVal.consolidate())?Gp((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):lu)},", ",")",")"),vo=Math.SQRT2,cu=2,Yp=4,Z2=1e-12;function Qp(e){return((e=Math.exp(e))+1/e)/2}function e0(e,n){var o,a,s=e[0],c=e[1],h=e[2],f=n[0],p=n[1],y=n[2],w=f-s,_=p-c,b=w*w+_*_;if(b<Z2)a=Math.log(y/h)/vo,o=function(z){return[s+z*w,c+z*_,h*Math.exp(vo*z*a)]};else{var T=Math.sqrt(b),k=(y*y-h*h+Yp*b)/(2*h*cu*T),N=(y*y-h*h-Yp*b)/(2*y*cu*T),P=Math.log(Math.sqrt(k*k+1)-k),L=Math.log(Math.sqrt(N*N+1)-N);a=(L-P)/vo,o=function(z){var F,W=z*a,Y=Qp(P),ae=h/(cu*T)*(Y*(F=vo*W+P,((F=Math.exp(2*F))-1)/(F+1))-function(ie){return((ie=Math.exp(ie))-1/ie)/2}(P));return[s+ae*w,c+ae*_,h*Y/Qp(vo*W+P)]}}return o.duration=1e3*a,o}function t0(e){return function(n,o){var a=e((n=os(n)).h,(o=os(o)).h),s=dt(n.s,o.s),c=dt(n.l,o.l),h=dt(n.opacity,o.opacity);return function(f){return n.h=a(f),n.s=s(f),n.l=c(f),n.opacity=h(f),n+""}}}var j2=t0(us),H2=t0(dt);function n0(e){return function(n,o){var a=e((n=ss(n)).h,(o=ss(o)).h),s=dt(n.c,o.c),c=dt(n.l,o.l),h=dt(n.opacity,o.opacity);return function(f){return n.h=a(f),n.c=s(f),n.l=c(f),n.opacity=h(f),n+""}}}var $2=n0(us),V2=n0(dt);function r0(e){return function n(o){function a(s,c){var h=e((s=nn(s)).h,(c=nn(c)).h),f=dt(s.s,c.s),p=dt(s.l,c.l),y=dt(s.opacity,c.opacity);return function(w){return s.h=h(w),s.s=f(w),s.l=p(Math.pow(w,o)),s.opacity=y(w),s+""}}return o=+o,a.gamma=n,a}(1)}var W2=r0(us),hs=r0(dt),ds,xo,si=0,To=0,Io=0,i0=1e3,ps=0,Nr=0,gs=0,Eo=typeof performance=="object"&&performance.now?performance:Date,o0=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){window.setTimeout(e,17)};function li(){return Nr||(o0(G2),Nr=Eo.now()+gs)}function G2(){Nr=0}function ko(){this._call=this._time=this._next=null}function ms(e,n,o){var a=new ko;return a.restart(e,n,o),a}function a0(){li(),++si;for(var e,n=ds;n;)(e=Nr-n._time)>=0&&n._call.call(null,e),n=n._next;--si}function s0(){Nr=(ps=Eo.now())+gs,si=To=0;try{a0()}finally{si=0,function(){for(var e,n,o=ds,a=1/0;o;)o._call?(a>o._time&&(a=o._time),e=o,o=o._next):(n=o._next,o._next=null,o=e?e._next=n:ds=n);xo=e,uu(a)}(),Nr=0}}function X2(){var e=Eo.now(),n=e-ps;n>i0&&(gs-=n,ps=e)}function uu(e){si||(To&&(To=window.clearTimeout(To)),e-Nr>24?(e<1/0&&(To=window.setTimeout(s0,e-Eo.now()-gs)),Io&&(Io=window.clearInterval(Io))):(Io||(ps=Eo.now(),Io=window.setInterval(X2,i0)),si=1,o0(s0)))}function fu(e,n,o){var a=new ko;return n=n==null?0:+n,a.restart(function(s){a.stop(),e(s+n)},n,o),a}ko.prototype=ms.prototype={constructor:ko,restart:function(e,n,o){if(typeof e!="function")throw new TypeError("callback is not a function");o=(o==null?li():+o)+(n==null?0:+n),this._next||xo===this||(xo?xo._next=this:ds=this,xo=this),this._call=e,this._time=o,uu()},stop:function(){this._call&&(this._call=null,this._time=1/0,uu())}};var K2=j("start","end","cancel","interrupt"),J2=[],l0=0,hu=1,du=2,ys=3,c0=4,pu=5,bs=6;function ws(e,n,o,a,s,c){var h=e.__transition;if(h){if(o in h)return}else e.__transition={};(function(f,p,y){var w,_=f.__transition;function b(N){var P,L,z,F;if(y.state!==hu)return k();for(P in _)if((F=_[P]).name===y.name){if(F.state===ys)return fu(b);F.state===c0?(F.state=bs,F.timer.stop(),F.on.call("interrupt",f,f.__data__,F.index,F.group),delete _[P]):+P<p&&(F.state=bs,F.timer.stop(),F.on.call("cancel",f,f.__data__,F.index,F.group),delete _[P])}if(fu(function(){y.state===ys&&(y.state=c0,y.timer.restart(T,y.delay,y.time),T(N))}),y.state=du,y.on.call("start",f,f.__data__,y.index,y.group),y.state===du){for(y.state=ys,w=new Array(z=y.tween.length),P=0,L=-1;P<z;++P)(F=y.tween[P].value.call(f,f.__data__,y.index,y.group))&&(w[++L]=F);w.length=L+1}}function T(N){for(var P=N<y.duration?y.ease.call(null,N/y.duration):(y.timer.restart(k),y.state=pu,1),L=-1,z=w.length;++L<z;)w[L].call(f,P);y.state===pu&&(y.on.call("end",f,f.__data__,y.index,y.group),k())}function k(){for(var N in y.state=bs,y.timer.stop(),delete _[p],_)return;delete f.__transition}_[p]=y,y.timer=ms(function(N){y.state=hu,y.timer.restart(b,y.delay,y.time),y.delay<=N&&b(N-y.delay)},0,y.time)})(e,o,{name:n,index:a,group:s,on:K2,tween:J2,time:c.time,delay:c.delay,duration:c.duration,ease:c.ease,timer:null,state:l0})}function gu(e,n){var o=rn(e,n);if(o.state>l0)throw new Error("too late; already scheduled");return o}function Pn(e,n){var o=rn(e,n);if(o.state>ys)throw new Error("too late; already running");return o}function rn(e,n){var o=e.__transition;if(!o||!(o=o[n]))throw new Error("transition not found");return o}function Ar(e,n){var o,a,s,c=e.__transition,h=!0;if(c){for(s in n=n==null?null:n+"",c)(o=c[s]).name===n?(a=o.state>du&&o.state<pu,o.state=bs,o.timer.stop(),o.on.call(a?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete c[s]):h=!1;h&&delete e.__transition}}function mu(e,n,o){var a=e._id;return e.each(function(){var s=Pn(this,a);(s.value||(s.value={}))[n]=o.apply(this,arguments)}),function(s){return rn(s,a).value[n]}}function u0(e,n){var o;return(typeof n=="number"?Wt:n instanceof rr?bo:(o=rr(n))?(n=o,bo):au)(e,n)}var Y2=kr.prototype.constructor;function f0(e){return function(){this.style.removeProperty(e)}}var Q2=0;function gn(e,n,o,a){this._groups=e,this._parents=n,this._name=o,this._id=a}function h0(e){return kr().transition(e)}function d0(){return++Q2}var ci=kr.prototype;function p0(e){return((e*=2)<=1?e*e:--e*(2-e)+1)/2}function yu(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}gn.prototype=h0.prototype={constructor:gn,select:function(e){var n=this._name,o=this._id;typeof e!="function"&&(e=en(e));for(var a=this._groups,s=a.length,c=new Array(s),h=0;h<s;++h)for(var f,p,y=a[h],w=y.length,_=c[h]=new Array(w),b=0;b<w;++b)(f=y[b])&&(p=e.call(f,f.__data__,b,y))&&("__data__"in f&&(p.__data__=f.__data__),_[b]=p,ws(_[b],n,o,b,_,rn(f,o)));return new gn(c,this._parents,n,o)},selectAll:function(e){var n=this._name,o=this._id;typeof e!="function"&&(e=zt(e));for(var a=this._groups,s=a.length,c=[],h=[],f=0;f<s;++f)for(var p,y=a[f],w=y.length,_=0;_<w;++_)if(p=y[_]){for(var b,T=e.call(p,p.__data__,_,y),k=rn(p,o),N=0,P=T.length;N<P;++N)(b=T[N])&&ws(b,n,o,N,T,k);c.push(T),h.push(p)}return new gn(c,h,n,o)},filter:function(e){typeof e!="function"&&(e=uo(e));for(var n=this._groups,o=n.length,a=new Array(o),s=0;s<o;++s)for(var c,h=n[s],f=h.length,p=a[s]=[],y=0;y<f;++y)(c=h[y])&&e.call(c,c.__data__,y,h)&&p.push(c);return new gn(a,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var n=this._groups,o=e._groups,a=n.length,s=o.length,c=Math.min(a,s),h=new Array(a),f=0;f<c;++f)for(var p,y=n[f],w=o[f],_=y.length,b=h[f]=new Array(_),T=0;T<_;++T)(p=y[T]||w[T])&&(b[T]=p);for(;f<a;++f)h[f]=n[f];return new gn(h,this._parents,this._name,this._id)},selection:function(){return new Y2(this._groups,this._parents)},transition:function(){for(var e=this._name,n=this._id,o=d0(),a=this._groups,s=a.length,c=0;c<s;++c)for(var h,f=a[c],p=f.length,y=0;y<p;++y)if(h=f[y]){var w=rn(h,n);ws(h,e,o,y,f,{time:w.time+w.delay+w.duration,delay:0,duration:w.duration,ease:w.ease})}return new gn(a,this._parents,e,o)},call:ci.call,nodes:ci.nodes,node:ci.node,size:ci.size,empty:ci.empty,each:ci.each,on:function(e,n){var o=this._id;return arguments.length<2?rn(this.node(),o).on.on(e):this.each(function(a,s,c){var h,f,p=function(y){return(y+"").trim().split(/^|\s+/).every(function(w){var _=w.indexOf(".");return _>=0&&(w=w.slice(0,_)),!w||w==="start"})}(s)?gu:Pn;return function(){var y=p(this,a),w=y.on;w!==h&&(f=(h=w).copy()).on(s,c),y.on=f}}(o,e,n))},attr:function(e,n){var o=Ye(e),a=o==="transform"?Jp:u0;return this.attrTween(e,typeof n=="function"?(o.local?function(s,c,h){var f,p,y;return function(){var w,_,b=h(this);if(b!=null)return(w=this.getAttributeNS(s.space,s.local))===(_=b+"")?null:w===f&&_===p?y:(p=_,y=c(f=w,b));this.removeAttributeNS(s.space,s.local)}}:function(s,c,h){var f,p,y;return function(){var w,_,b=h(this);if(b!=null)return(w=this.getAttribute(s))===(_=b+"")?null:w===f&&_===p?y:(p=_,y=c(f=w,b));this.removeAttribute(s)}})(o,a,mu(this,"attr."+e,n)):n==null?(o.local?function(s){return function(){this.removeAttributeNS(s.space,s.local)}}:function(s){return function(){this.removeAttribute(s)}})(o):(o.local?function(s,c,h){var f,p,y=h+"";return function(){var w=this.getAttributeNS(s.space,s.local);return w===y?null:w===f?p:p=c(f=w,h)}}:function(s,c,h){var f,p,y=h+"";return function(){var w=this.getAttribute(s);return w===y?null:w===f?p:p=c(f=w,h)}})(o,a,n))},attrTween:function(e,n){var o="attr."+e;if(arguments.length<2)return(o=this.tween(o))&&o._value;if(n==null)return this.tween(o,null);if(typeof n!="function")throw new Error;var a=Ye(e);return this.tween(o,(a.local?function(s,c){var h,f;function p(){var y=c.apply(this,arguments);return y!==f&&(h=(f=y)&&function(w,_){return function(b){this.setAttributeNS(w.space,w.local,_(b))}}(s,y)),h}return p._value=c,p}:function(s,c){var h,f;function p(){var y=c.apply(this,arguments);return y!==f&&(h=(f=y)&&function(w,_){return function(b){this.setAttribute(w,_(b))}}(s,y)),h}return p._value=c,p})(a,n))},style:function(e,n,o){var a=(e+="")=="transform"?Kp:u0;return n==null?this.styleTween(e,function(s,c){var h,f,p;return function(){var y=Er(this,s),w=(this.style.removeProperty(s),Er(this,s));return y===w?null:y===h&&w===f?p:p=c(h=y,f=w)}}(e,a)).on("end.style."+e,f0(e)):typeof n=="function"?this.styleTween(e,function(s,c,h){var f,p,y;return function(){var w=Er(this,s),_=h(this),b=_+"";return _==null&&(this.style.removeProperty(s),b=_=Er(this,s)),w===b?null:w===f&&b===p?y:(p=b,y=c(f=w,_))}}(e,a,mu(this,"style."+e,n))).each(function(s,c){var h,f,p,y,w="style."+c,_="end."+w;return function(){var b=Pn(this,s),T=b.on,k=b.value[w]==null?y||(y=f0(c)):void 0;T===h&&p===k||(f=(h=T).copy()).on(_,p=k),b.on=f}}(this._id,e)):this.styleTween(e,function(s,c,h){var f,p,y=h+"";return function(){var w=Er(this,s);return w===y?null:w===f?p:p=c(f=w,h)}}(e,a,n),o).on("end.style."+e,null)},styleTween:function(e,n,o){var a="style."+(e+="");if(arguments.length<2)return(a=this.tween(a))&&a._value;if(n==null)return this.tween(a,null);if(typeof n!="function")throw new Error;return this.tween(a,function(s,c,h){var f,p;function y(){var w=c.apply(this,arguments);return w!==p&&(f=(p=w)&&function(_,b,T){return function(k){this.style.setProperty(_,b(k),T)}}(s,w,h)),f}return y._value=c,y}(e,n,o??""))},text:function(e){return this.tween("text",typeof e=="function"?function(n){return function(){var o=n(this);this.textContent=o??""}}(mu(this,"text",e)):function(n){return function(){this.textContent=n}}(e==null?"":e+""))},remove:function(){return this.on("end.remove",(e=this._id,function(){var n=this.parentNode;for(var o in this.__transition)if(+o!==e)return;n&&n.removeChild(this)}));var e},tween:function(e,n){var o=this._id;if(e+="",arguments.length<2){for(var a,s=rn(this.node(),o).tween,c=0,h=s.length;c<h;++c)if((a=s[c]).name===e)return a.value;return null}return this.each((n==null?function(f,p){var y,w;return function(){var _=Pn(this,f),b=_.tween;if(b!==y){for(var T=0,k=(w=y=b).length;T<k;++T)if(w[T].name===p){(w=w.slice()).splice(T,1);break}}_.tween=w}}:function(f,p,y){var w,_;if(typeof y!="function")throw new Error;return function(){var b=Pn(this,f),T=b.tween;if(T!==w){_=(w=T).slice();for(var k={name:p,value:y},N=0,P=_.length;N<P;++N)if(_[N].name===p){_[N]=k;break}N===P&&_.push(k)}b.tween=_}})(o,e,n))},delay:function(e){var n=this._id;return arguments.length?this.each((typeof e=="function"?function(o,a){return function(){gu(this,o).delay=+a.apply(this,arguments)}}:function(o,a){return a=+a,function(){gu(this,o).delay=a}})(n,e)):rn(this.node(),n).delay},duration:function(e){var n=this._id;return arguments.length?this.each((typeof e=="function"?function(o,a){return function(){Pn(this,o).duration=+a.apply(this,arguments)}}:function(o,a){return a=+a,function(){Pn(this,o).duration=a}})(n,e)):rn(this.node(),n).duration},ease:function(e){var n=this._id;return arguments.length?this.each(function(o,a){if(typeof a!="function")throw new Error;return function(){Pn(this,o).ease=a}}(n,e)):rn(this.node(),n).ease},end:function(){var e,n,o=this,a=o._id,s=o.size();return new Promise(function(c,h){var f={value:h},p={value:function(){--s==0&&c()}};o.each(function(){var y=Pn(this,a),w=y.on;w!==e&&((n=(e=w).copy())._.cancel.push(f),n._.interrupt.push(f),n._.end.push(p)),y.on=n})})}};var ex=function e(n){function o(a){return Math.pow(a,n)}return n=+n,o.exponent=e,o}(3),tx=function e(n){function o(a){return 1-Math.pow(1-a,n)}return n=+n,o.exponent=e,o}(3),g0=function e(n){function o(a){return((a*=2)<=1?Math.pow(a,n):2-Math.pow(2-a,n))/2}return n=+n,o.exponent=e,o}(3),m0=Math.PI,y0=m0/2;function b0(e){return(1-Math.cos(m0*e))/2}function w0(e){return((e*=2)<=1?Math.pow(2,10*e-10):2-Math.pow(2,10-10*e))/2}function _0(e){return((e*=2)<=1?1-Math.sqrt(1-e*e):Math.sqrt(1-(e-=2)*e)+1)/2}var bu=4/11,nx=6/11,rx=8/11,ix=.75,ox=9/11,ax=10/11,sx=.9375,lx=21/22,cx=63/64,_s=1/bu/bu;function Co(e){return(e=+e)<bu?_s*e*e:e<rx?_s*(e-=nx)*e+ix:e<ax?_s*(e-=ox)*e+sx:_s*(e-=lx)*e+cx}var ux=function e(n){function o(a){return a*a*((n+1)*a-n)}return n=+n,o.overshoot=e,o}(1.70158),fx=function e(n){function o(a){return--a*a*((n+1)*a+n)+1}return n=+n,o.overshoot=e,o}(1.70158),v0=function e(n){function o(a){return((a*=2)<1?a*a*((n+1)*a-n):(a-=2)*a*((n+1)*a+n)+2)/2}return n=+n,o.overshoot=e,o}(1.70158),ui=2*Math.PI,hx=function e(n,o){var a=Math.asin(1/(n=Math.max(1,n)))*(o/=ui);function s(c){return n*Math.pow(2,10*--c)*Math.sin((a-c)/o)}return s.amplitude=function(c){return e(c,o*ui)},s.period=function(c){return e(n,c)},s}(1,.3),x0=function e(n,o){var a=Math.asin(1/(n=Math.max(1,n)))*(o/=ui);function s(c){return 1-n*Math.pow(2,-10*(c=+c))*Math.sin((c+a)/o)}return s.amplitude=function(c){return e(c,o*ui)},s.period=function(c){return e(n,c)},s}(1,.3),dx=function e(n,o){var a=Math.asin(1/(n=Math.max(1,n)))*(o/=ui);function s(c){return((c=2*c-1)<0?n*Math.pow(2,10*c)*Math.sin((a-c)/o):2-n*Math.pow(2,-10*c)*Math.sin((a+c)/o))/2}return s.amplitude=function(c){return e(c,o*ui)},s.period=function(c){return e(n,c)},s}(1,.3),wu={time:null,delay:0,duration:250,ease:yu};function px(e,n){for(var o;!(o=e.__transition)||!(o=o[n]);)if(!(e=e.parentNode))return wu.time=li(),wu;return o}kr.prototype.interrupt=function(e){return this.each(function(){Ar(this,e)})},kr.prototype.transition=function(e){var n,o;e instanceof gn?(n=e._id,e=e._name):(n=d0(),(o=wu).time=li(),e=e==null?null:e+"");for(var a=this._groups,s=a.length,c=0;c<s;++c)for(var h,f=a[c],p=f.length,y=0;y<p;++y)(h=f[y])&&ws(h,e,n,y,f,o||px(h,n));return new gn(a,this._parents,e,n)};var gx=[null];function T0(e){return function(){return e}}function mx(e,n,o){this.target=e,this.type=n,this.selection=o}function I0(){t.event.stopImmediatePropagation()}function vs(){t.event.preventDefault(),t.event.stopImmediatePropagation()}var E0={name:"drag"},_u={name:"space"},fi={name:"handle"},hi={name:"center"},xs={name:"x",handles:["e","w"].map(No),input:function(e,n){return e&&[[e[0],n[0][1]],[e[1],n[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},Ts={name:"y",handles:["n","s"].map(No),input:function(e,n){return e&&[[n[0][0],e[0]],[n[1][0],e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},yx={name:"xy",handles:["n","e","s","w","nw","ne","se","sw"].map(No),input:function(e){return e},output:function(e){return e}},On={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},k0={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},C0={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},bx={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},wx={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function No(e){return{type:e}}function _x(){return!t.event.button}function vx(){var e=this.ownerSVGElement||this;return[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function vu(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function xu(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}function Tu(e){var n,o=vx,a=_x,s=j(h,"start","brush","end"),c=6;function h(b){var T=b.property("__brush",_).selectAll(".overlay").data([No("overlay")]);T.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",On.overlay).merge(T).each(function(){var N=vu(this).extent;Pt(this).attr("x",N[0][0]).attr("y",N[0][1]).attr("width",N[1][0]-N[0][0]).attr("height",N[1][1]-N[0][1])}),b.selectAll(".selection").data([No("selection")]).enter().append("rect").attr("class","selection").attr("cursor",On.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var k=b.selectAll(".handle").data(e.handles,function(N){return N.type});k.exit().remove(),k.enter().append("rect").attr("class",function(N){return"handle handle--"+N.type}).attr("cursor",function(N){return On[N.type]}),b.each(f).attr("fill","none").attr("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush touchstart.brush",w)}function f(){var b=Pt(this),T=vu(this).selection;T?(b.selectAll(".selection").style("display",null).attr("x",T[0][0]).attr("y",T[0][1]).attr("width",T[1][0]-T[0][0]).attr("height",T[1][1]-T[0][1]),b.selectAll(".handle").style("display",null).attr("x",function(k){return k.type[k.type.length-1]==="e"?T[1][0]-c/2:T[0][0]-c/2}).attr("y",function(k){return k.type[0]==="s"?T[1][1]-c/2:T[0][1]-c/2}).attr("width",function(k){return k.type==="n"||k.type==="s"?T[1][0]-T[0][0]+c:c}).attr("height",function(k){return k.type==="e"||k.type==="w"?T[1][1]-T[0][1]+c:c})):b.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function p(b,T){return b.__brush.emitter||new y(b,T)}function y(b,T){this.that=b,this.args=T,this.state=b.__brush,this.active=0}function w(){if(t.event.touches){if(t.event.changedTouches.length<t.event.touches.length)return vs()}else if(n)return;if(a.apply(this,arguments)){var b,T,k,N,P,L,z,F,W,Y,ae,ie,ce,G=this,ne=t.event.target.__data__.type,oe=(t.event.metaKey?ne="overlay":ne)==="selection"?E0:t.event.altKey?hi:fi,ee=e===Ts?null:bx[ne],q=e===xs?null:wx[ne],Q=vu(G),ue=Q.extent,he=Q.selection,pe=ue[0][0],Ee=ue[0][1],Ne=ue[1][0],je=ue[1][1],be=ee&&q&&t.event.shiftKey,Se=tr(G),He=Se,Le=p(G,arguments).beforestart();ne==="overlay"?Q.selection=he=[[b=e===Ts?pe:Se[0],k=e===xs?Ee:Se[1]],[P=e===Ts?Ne:b,z=e===xs?je:k]]:(b=he[0][0],k=he[0][1],P=he[1][0],z=he[1][1]),T=b,N=k,L=P,F=z;var Re=Pt(G).attr("pointer-events","none"),Qe=Re.selectAll(".overlay").attr("cursor",On[ne]);if(t.event.touches)Re.on("touchmove.brush",Di,!0).on("touchend.brush touchcancel.brush",Ea,!0);else{var xt=Pt(t.event.view).on("keydown.brush",function(){switch(t.event.keyCode){case 16:be=ee&&q;break;case 18:oe===fi&&(ee&&(P=L-W*ee,b=T+W*ee),q&&(z=F-Y*q,k=N+Y*q),oe=hi,vn());break;case 32:oe!==fi&&oe!==hi||(ee<0?P=L-W:ee>0&&(b=T-W),q<0?z=F-Y:q>0&&(k=N-Y),oe=_u,Qe.attr("cursor",On.selection),vn());break;default:return}vs()},!0).on("keyup.brush",function(){switch(t.event.keyCode){case 16:be&&(ie=ce=be=!1,vn());break;case 18:oe===hi&&(ee<0?P=L:ee>0&&(b=T),q<0?z=F:q>0&&(k=N),oe=fi,vn());break;case 32:oe===_u&&(t.event.altKey?(ee&&(P=L-W*ee,b=T+W*ee),q&&(z=F-Y*q,k=N+Y*q),oe=hi):(ee<0?P=L:ee>0&&(b=T),q<0?z=F:q>0&&(k=N),oe=fi),Qe.attr("cursor",On[ne]),vn());break;default:return}vs()},!0).on("mousemove.brush",Di,!0).on("mouseup.brush",Ea,!0);ns(t.event.view)}I0(),Ar(G),f.call(G),Le.start()}function Di(){var St=tr(G);!be||ie||ce||(Math.abs(St[0]-He[0])>Math.abs(St[1]-He[1])?ce=!0:ie=!0),He=St,ae=!0,vs(),vn()}function vn(){var St;switch(W=He[0]-Se[0],Y=He[1]-Se[1],oe){case _u:case E0:ee&&(W=Math.max(pe-b,Math.min(Ne-P,W)),T=b+W,L=P+W),q&&(Y=Math.max(Ee-k,Math.min(je-z,Y)),N=k+Y,F=z+Y);break;case fi:ee<0?(W=Math.max(pe-b,Math.min(Ne-b,W)),T=b+W,L=P):ee>0&&(W=Math.max(pe-P,Math.min(Ne-P,W)),T=b,L=P+W),q<0?(Y=Math.max(Ee-k,Math.min(je-k,Y)),N=k+Y,F=z):q>0&&(Y=Math.max(Ee-z,Math.min(je-z,Y)),N=k,F=z+Y);break;case hi:ee&&(T=Math.max(pe,Math.min(Ne,b-W*ee)),L=Math.max(pe,Math.min(Ne,P+W*ee))),q&&(N=Math.max(Ee,Math.min(je,k-Y*q)),F=Math.max(Ee,Math.min(je,z+Y*q)))}L<T&&(ee*=-1,St=b,b=P,P=St,St=T,T=L,L=St,ne in k0&&Qe.attr("cursor",On[ne=k0[ne]])),F<N&&(q*=-1,St=k,k=z,z=St,St=N,N=F,F=St,ne in C0&&Qe.attr("cursor",On[ne=C0[ne]])),Q.selection&&(he=Q.selection),ie&&(T=he[0][0],L=he[1][0]),ce&&(N=he[0][1],F=he[1][1]),he[0][0]===T&&he[0][1]===N&&he[1][0]===L&&he[1][1]===F||(Q.selection=[[T,N],[L,F]],f.call(G),Le.brush())}function Ea(){if(I0(),t.event.touches){if(t.event.touches.length)return;n&&window.clearTimeout(n),n=window.setTimeout(function(){n=null},500),Re.on("touchmove.brush touchend.brush touchcancel.brush",null)}else rs(t.event.view,ae),xt.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);Re.attr("pointer-events","all"),Qe.attr("cursor",On.overlay),Q.selection&&(he=Q.selection),xu(he)&&(Q.selection=null,f.call(G)),Le.end()}}function _(){var b=this.__brush||{selection:null};return b.extent=o.apply(this,arguments),b.dim=e,b}return h.move=function(b,T){b.selection?b.on("start.brush",function(){p(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){p(this,arguments).end()}).tween("brush",function(){var k=this,N=k.__brush,P=p(k,arguments),L=N.selection,z=e.input(typeof T=="function"?T.apply(this,arguments):T,N.extent),F=wo(L,z);function W(Y){N.selection=Y===1&&xu(z)?null:F(Y),f.call(k),P.brush()}return L&&z?W:W(1)}):b.each(function(){var k=arguments,N=this.__brush,P=e.input(typeof T=="function"?T.apply(this,k):T,N.extent),L=p(this,k).beforestart();Ar(this),N.selection=P==null||xu(P)?null:P,f.call(this),L.start().brush().end()})},y.prototype={beforestart:function(){return++this.active==1&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting&&(this.starting=!1,this.emit("start")),this},brush:function(){return this.emit("brush"),this},end:function(){return--this.active==0&&(delete this.state.emitter,this.emit("end")),this},emit:function(b){po(new mx(h,b,e.output(this.state.selection)),s.apply,s,[b,this.that,this.args])}},h.extent=function(b){return arguments.length?(o=typeof b=="function"?b:T0([[+b[0][0],+b[0][1]],[+b[1][0],+b[1][1]]]),h):o},h.filter=function(b){return arguments.length?(a=typeof b=="function"?b:T0(!!b),h):a},h.handleSize=function(b){return arguments.length?(c=+b,h):c},h.on=function(){var b=s.on.apply(s,arguments);return b===s?h:b},h}var N0=Math.cos,A0=Math.sin,M0=Math.PI,Is=M0/2,D0=2*M0,S0=Math.max,xx=Array.prototype.slice;function Iu(e){return function(){return e}}var Eu=Math.PI,ku=2*Eu,Tx=ku-1e-6;function Cu(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function ir(){return new Cu}function Ix(e){return e.source}function Ex(e){return e.target}function kx(e){return e.radius}function Cx(e){return e.startAngle}function Nx(e){return e.endAngle}Cu.prototype=ir.prototype={constructor:Cu,moveTo:function(e,n){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+n)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,n){this._+="L"+(this._x1=+e)+","+(this._y1=+n)},quadraticCurveTo:function(e,n,o,a){this._+="Q"+ +e+","+ +n+","+(this._x1=+o)+","+(this._y1=+a)},bezierCurveTo:function(e,n,o,a,s,c){this._+="C"+ +e+","+ +n+","+ +o+","+ +a+","+(this._x1=+s)+","+(this._y1=+c)},arcTo:function(e,n,o,a,s){e=+e,n=+n,o=+o,a=+a,s=+s;var c=this._x1,h=this._y1,f=o-e,p=a-n,y=c-e,w=h-n,_=y*y+w*w;if(s<0)throw new Error("negative radius: "+s);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=n);else if(_>1e-6)if(Math.abs(w*f-p*y)>1e-6&&s){var b=o-c,T=a-h,k=f*f+p*p,N=b*b+T*T,P=Math.sqrt(k),L=Math.sqrt(_),z=s*Math.tan((Eu-Math.acos((k+_-N)/(2*P*L)))/2),F=z/L,W=z/P;Math.abs(F-1)>1e-6&&(this._+="L"+(e+F*y)+","+(n+F*w)),this._+="A"+s+","+s+",0,0,"+ +(w*b>y*T)+","+(this._x1=e+W*f)+","+(this._y1=n+W*p)}else this._+="L"+(this._x1=e)+","+(this._y1=n)},arc:function(e,n,o,a,s,c){e=+e,n=+n;var h=(o=+o)*Math.cos(a),f=o*Math.sin(a),p=e+h,y=n+f,w=1^c,_=c?a-s:s-a;if(o<0)throw new Error("negative radius: "+o);this._x1===null?this._+="M"+p+","+y:(Math.abs(this._x1-p)>1e-6||Math.abs(this._y1-y)>1e-6)&&(this._+="L"+p+","+y),o&&(_<0&&(_=_%ku+ku),_>Tx?this._+="A"+o+","+o+",0,1,"+w+","+(e-h)+","+(n-f)+"A"+o+","+o+",0,1,"+w+","+(this._x1=p)+","+(this._y1=y):_>1e-6&&(this._+="A"+o+","+o+",0,"+ +(_>=Eu)+","+w+","+(this._x1=e+o*Math.cos(s))+","+(this._y1=n+o*Math.sin(s))))},rect:function(e,n,o,a){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+n)+"h"+ +o+"v"+ +a+"h"+-o+"Z"},toString:function(){return this._}};function Es(){}function Rn(e,n){var o=new Es;if(e instanceof Es)e.each(function(f,p){o.set(p,f)});else if(Array.isArray(e)){var a,s=-1,c=e.length;if(n==null)for(;++s<c;)o.set(s,e[s]);else for(;++s<c;)o.set(n(a=e[s],s,e),a)}else if(e)for(var h in e)o.set(h,e[h]);return o}function Ax(){return{}}function Mx(e,n,o){e[n]=o}function L0(){return Rn()}function P0(e,n,o){e.set(n,o)}function ks(){}Es.prototype=Rn.prototype={constructor:Es,has:function(e){return"$"+e in this},get:function(e){return this["$"+e]},set:function(e,n){return this["$"+e]=n,this},remove:function(e){var n="$"+e;return n in this&&delete this[n]},clear:function(){for(var e in this)e[0]==="$"&&delete this[e]},keys:function(){var e=[];for(var n in this)n[0]==="$"&&e.push(n.slice(1));return e},values:function(){var e=[];for(var n in this)n[0]==="$"&&e.push(this[n]);return e},entries:function(){var e=[];for(var n in this)n[0]==="$"&&e.push({key:n.slice(1),value:this[n]});return e},size:function(){var e=0;for(var n in this)n[0]==="$"&&++e;return e},empty:function(){for(var e in this)if(e[0]==="$")return!1;return!0},each:function(e){for(var n in this)n[0]==="$"&&e(this[n],n.slice(1),this)}};var Mr=Rn.prototype;function O0(e,n){var o=new ks;if(e instanceof ks)e.each(function(c){o.add(c)});else if(e){var a=-1,s=e.length;if(n==null)for(;++a<s;)o.add(e[a]);else for(;++a<s;)o.add(n(e[a],a,e))}return o}ks.prototype=O0.prototype={constructor:ks,has:Mr.has,add:function(e){return this["$"+(e+="")]=e,this},remove:Mr.remove,clear:Mr.clear,values:Mr.keys,size:Mr.size,empty:Mr.empty,each:Mr.each};var R0=Array.prototype.slice;function Dx(e,n){return e-n}function or(e){return function(){return e}}function Sx(e,n){for(var o,a=-1,s=n.length;++a<s;)if(o=Lx(e,n[a]))return o;return 0}function Lx(e,n){for(var o=n[0],a=n[1],s=-1,c=0,h=e.length,f=h-1;c<h;f=c++){var p=e[c],y=p[0],w=p[1],_=e[f],b=_[0],T=_[1];if(Px(p,_,n))return 0;w>a!=T>a&&o<(b-y)*(a-w)/(T-w)+y&&(s=-s)}return s}function Px(e,n,o){var a,s,c,h;return function(f,p,y){return(p[0]-f[0])*(y[1]-f[1])==(y[0]-f[0])*(p[1]-f[1])}(e,n,o)&&(s=e[a=+(e[0]===n[0])],c=o[a],h=n[a],s<=c&&c<=h||h<=c&&c<=s)}function Ox(){}var Fn=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function F0(){var e=1,n=1,o=X,a=f;function s(p){var y=o(p);if(Array.isArray(y))y=y.slice().sort(Dx);else{var w=I(p),_=w[0],b=w[1];y=Z(_,b,y),y=$(Math.floor(_/y)*y,Math.floor(b/y)*y,y)}return y.map(function(T){return c(p,T)})}function c(p,y){var w=[],_=[];return function(b,T,k){var N,P,L,z,F,W,Y=new Array,ae=new Array;for(N=P=-1,z=b[0]>=T,Fn[z<<1].forEach(ie);++N<e-1;)L=z,z=b[N+1]>=T,Fn[L|z<<1].forEach(ie);for(Fn[z<<0].forEach(ie);++P<n-1;){for(N=-1,z=b[P*e+e]>=T,F=b[P*e]>=T,Fn[z<<1|F<<2].forEach(ie);++N<e-1;)L=z,z=b[P*e+e+N+1]>=T,W=F,F=b[P*e+N+1]>=T,Fn[L|z<<1|F<<2|W<<3].forEach(ie);Fn[z|F<<3].forEach(ie)}for(N=-1,F=b[P*e]>=T,Fn[F<<2].forEach(ie);++N<e-1;)W=F,F=b[P*e+N+1]>=T,Fn[F<<2|W<<3].forEach(ie);function ie(ce){var G,ne,oe=[ce[0][0]+N,ce[0][1]+P],ee=[ce[1][0]+N,ce[1][1]+P],q=h(oe),Q=h(ee);(G=ae[q])?(ne=Y[Q])?(delete ae[G.end],delete Y[ne.start],G===ne?(G.ring.push(ee),k(G.ring)):Y[G.start]=ae[ne.end]={start:G.start,end:ne.end,ring:G.ring.concat(ne.ring)}):(delete ae[G.end],G.ring.push(ee),ae[G.end=Q]=G):(G=Y[Q])?(ne=ae[q])?(delete Y[G.start],delete ae[ne.end],G===ne?(G.ring.push(ee),k(G.ring)):Y[ne.start]=ae[G.end]={start:ne.start,end:G.end,ring:ne.ring.concat(G.ring)}):(delete Y[G.start],G.ring.unshift(oe),Y[G.start=q]=G):Y[q]=ae[Q]={start:q,end:Q,ring:[oe,ee]}}Fn[F<<3].forEach(ie)}(p,y,function(b){a(b,p,y),function(T){for(var k=0,N=T.length,P=T[N-1][1]*T[0][0]-T[N-1][0]*T[0][1];++k<N;)P+=T[k-1][1]*T[k][0]-T[k-1][0]*T[k][1];return P}(b)>0?w.push([b]):_.push(b)}),_.forEach(function(b){for(var T,k=0,N=w.length;k<N;++k)if(Sx((T=w[k])[0],b)!==-1)return void T.push(b)}),{type:"MultiPolygon",value:y,coordinates:w}}function h(p){return 2*p[0]+p[1]*(e+1)*4}function f(p,y,w){p.forEach(function(_){var b,T=_[0],k=_[1],N=0|T,P=0|k,L=y[P*e+N];T>0&&T<e&&N===T&&(b=y[P*e+N-1],_[0]=T+(w-b)/(L-b)-.5),k>0&&k<n&&P===k&&(b=y[(P-1)*e+N],_[1]=k+(w-b)/(L-b)-.5)})}return s.contour=c,s.size=function(p){if(!arguments.length)return[e,n];var y=Math.ceil(p[0]),w=Math.ceil(p[1]);if(!(y>0&&w>0))throw new Error("invalid size");return e=y,n=w,s},s.thresholds=function(p){return arguments.length?(o=typeof p=="function"?p:Array.isArray(p)?or(R0.call(p)):or(p),s):o},s.smooth=function(p){return arguments.length?(a=p?f:Ox,s):a===f},s}function Nu(e,n,o){for(var a=e.width,s=e.height,c=1+(o<<1),h=0;h<s;++h)for(var f=0,p=0;f<a+o;++f)f<a&&(p+=e.data[f+h*a]),f>=o&&(f>=c&&(p-=e.data[f-c+h*a]),n.data[f-o+h*a]=p/Math.min(f+1,a-1+c-f,c))}function Au(e,n,o){for(var a=e.width,s=e.height,c=1+(o<<1),h=0;h<a;++h)for(var f=0,p=0;f<s+o;++f)f<s&&(p+=e.data[h+f*a]),f>=o&&(f>=c&&(p-=e.data[h+(f-c)*a]),n.data[h+(f-o)*a]=p/Math.min(f+1,s-1+c-f,c))}function Rx(e){return e[0]}function Fx(e){return e[1]}function Bx(){return 1}var B0={},Mu={},Du=34,Ao=10,Su=13;function z0(e){return new Function("d","return {"+e.map(function(n,o){return JSON.stringify(n)+": d["+o+"]"}).join(",")+"}")}function q0(e){var n=Object.create(null),o=[];return e.forEach(function(a){for(var s in a)s in n||o.push(n[s]=s)}),o}function Ot(e,n){var o=e+"",a=o.length;return a<n?new Array(n-a+1).join(0)+o:o}function zx(e){var n,o=e.getUTCHours(),a=e.getUTCMinutes(),s=e.getUTCSeconds(),c=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((n=e.getUTCFullYear())<0?"-"+Ot(-n,6):n>9999?"+"+Ot(n,6):Ot(n,4))+"-"+Ot(e.getUTCMonth()+1,2)+"-"+Ot(e.getUTCDate(),2)+(c?"T"+Ot(o,2)+":"+Ot(a,2)+":"+Ot(s,2)+"."+Ot(c,3)+"Z":s?"T"+Ot(o,2)+":"+Ot(a,2)+":"+Ot(s,2)+"Z":a||o?"T"+Ot(o,2)+":"+Ot(a,2)+"Z":"")}function Cs(e){var n=new RegExp('["'+e+`
\r]`),o=e.charCodeAt(0);function a(f,p){var y,w=[],_=f.length,b=0,T=0,k=_<=0,N=!1;function P(){if(k)return Mu;if(N)return N=!1,B0;var z,F,W=b;if(f.charCodeAt(W)===Du){for(;b++<_&&f.charCodeAt(b)!==Du||f.charCodeAt(++b)===Du;);return(z=b)>=_?k=!0:(F=f.charCodeAt(b++))===Ao?N=!0:F===Su&&(N=!0,f.charCodeAt(b)===Ao&&++b),f.slice(W+1,z-1).replace(/""/g,'"')}for(;b<_;){if((F=f.charCodeAt(z=b++))===Ao)N=!0;else if(F===Su)N=!0,f.charCodeAt(b)===Ao&&++b;else if(F!==o)continue;return f.slice(W,z)}return k=!0,f.slice(W,_)}for(f.charCodeAt(_-1)===Ao&&--_,f.charCodeAt(_-1)===Su&&--_;(y=P())!==Mu;){for(var L=[];y!==B0&&y!==Mu;)L.push(y),y=P();p&&(L=p(L,T++))==null||w.push(L)}return w}function s(f,p){return f.map(function(y){return p.map(function(w){return h(y[w])}).join(e)})}function c(f){return f.map(h).join(e)}function h(f){return f==null?"":f instanceof Date?zx(f):n.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:function(f,p){var y,w,_=a(f,function(b,T){if(y)return y(b,T-1);w=b,y=p?function(k,N){var P=z0(k);return function(L,z){return N(P(L),z,k)}}(b,p):z0(b)});return _.columns=w||[],_},parseRows:a,format:function(f,p){return p==null&&(p=q0(f)),[p.map(h).join(e)].concat(s(f,p)).join(`
`)},formatBody:function(f,p){return p==null&&(p=q0(f)),s(f,p).join(`
`)},formatRows:function(f){return f.map(c).join(`
`)}}}var Mo=Cs(","),U0=Mo.parse,qx=Mo.parseRows,Ux=Mo.format,Zx=Mo.formatBody,jx=Mo.formatRows,Do=Cs("	"),Z0=Do.parse,Hx=Do.parseRows,$x=Do.format,Vx=Do.formatBody,Wx=Do.formatRows;function Gx(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.blob()}function Xx(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.arrayBuffer()}function Kx(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function Ns(e,n){return fetch(e,n).then(Kx)}function j0(e){return function(n,o,a){return arguments.length===2&&typeof o=="function"&&(a=o,o=void 0),Ns(n,o).then(function(s){return e(s,a)})}}var Jx=j0(U0),Yx=j0(Z0);function Qx(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.json()}function Lu(e){return function(n,o){return Ns(n,o).then(function(a){return new DOMParser().parseFromString(a,e)})}}var e8=Lu("application/xml"),t8=Lu("text/html"),n8=Lu("image/svg+xml");function ft(e){return function(){return e}}function ar(){return 1e-6*(Math.random()-.5)}function H0(e,n,o,a){if(isNaN(n)||isNaN(o))return e;var s,c,h,f,p,y,w,_,b,T=e._root,k={data:a},N=e._x0,P=e._y0,L=e._x1,z=e._y1;if(!T)return e._root=k,e;for(;T.length;)if((y=n>=(c=(N+L)/2))?N=c:L=c,(w=o>=(h=(P+z)/2))?P=h:z=h,s=T,!(T=T[_=w<<1|y]))return s[_]=k,e;if(f=+e._x.call(null,T.data),p=+e._y.call(null,T.data),n===f&&o===p)return k.next=T,s?s[_]=k:e._root=k,e;do s=s?s[_]=new Array(4):e._root=new Array(4),(y=n>=(c=(N+L)/2))?N=c:L=c,(w=o>=(h=(P+z)/2))?P=h:z=h;while((_=w<<1|y)==(b=(p>=h)<<1|f>=c));return s[b]=T,s[_]=k,e}function Et(e,n,o,a,s){this.node=e,this.x0=n,this.y0=o,this.x1=a,this.y1=s}function r8(e){return e[0]}function i8(e){return e[1]}function As(e,n,o){var a=new Pu(n??r8,o??i8,NaN,NaN,NaN,NaN);return e==null?a:a.addAll(e)}function Pu(e,n,o,a,s,c){this._x=e,this._y=n,this._x0=o,this._y0=a,this._x1=s,this._y1=c,this._root=void 0}function $0(e){for(var n={data:e.data},o=n;e=e.next;)o=o.next={data:e.data};return n}var kt=As.prototype=Pu.prototype;function o8(e){return e.x+e.vx}function a8(e){return e.y+e.vy}function s8(e){return e.index}function V0(e,n){var o=e.get(n);if(!o)throw new Error("missing: "+n);return o}function l8(e){return e.x}function c8(e){return e.y}kt.copy=function(){var e,n,o=new Pu(this._x,this._y,this._x0,this._y0,this._x1,this._y1),a=this._root;if(!a)return o;if(!a.length)return o._root=$0(a),o;for(e=[{source:a,target:o._root=new Array(4)}];a=e.pop();)for(var s=0;s<4;++s)(n=a.source[s])&&(n.length?e.push({source:n,target:a.target[s]=new Array(4)}):a.target[s]=$0(n));return o},kt.add=function(e){var n=+this._x.call(null,e),o=+this._y.call(null,e);return H0(this.cover(n,o),n,o,e)},kt.addAll=function(e){var n,o,a,s,c=e.length,h=new Array(c),f=new Array(c),p=1/0,y=1/0,w=-1/0,_=-1/0;for(o=0;o<c;++o)isNaN(a=+this._x.call(null,n=e[o]))||isNaN(s=+this._y.call(null,n))||(h[o]=a,f[o]=s,a<p&&(p=a),a>w&&(w=a),s<y&&(y=s),s>_&&(_=s));if(p>w||y>_)return this;for(this.cover(p,y).cover(w,_),o=0;o<c;++o)H0(this,h[o],f[o],e[o]);return this},kt.cover=function(e,n){if(isNaN(e=+e)||isNaN(n=+n))return this;var o=this._x0,a=this._y0,s=this._x1,c=this._y1;if(isNaN(o))s=(o=Math.floor(e))+1,c=(a=Math.floor(n))+1;else{for(var h,f,p=s-o,y=this._root;o>e||e>=s||a>n||n>=c;)switch(f=(n<a)<<1|e<o,(h=new Array(4))[f]=y,y=h,p*=2,f){case 0:s=o+p,c=a+p;break;case 1:o=s-p,c=a+p;break;case 2:s=o+p,a=c-p;break;case 3:o=s-p,a=c-p}this._root&&this._root.length&&(this._root=y)}return this._x0=o,this._y0=a,this._x1=s,this._y1=c,this},kt.data=function(){var e=[];return this.visit(function(n){if(!n.length)do e.push(n.data);while(n=n.next)}),e},kt.extent=function(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},kt.find=function(e,n,o){var a,s,c,h,f,p,y,w=this._x0,_=this._y0,b=this._x1,T=this._y1,k=[],N=this._root;for(N&&k.push(new Et(N,w,_,b,T)),o==null?o=1/0:(w=e-o,_=n-o,b=e+o,T=n+o,o*=o);p=k.pop();)if(!(!(N=p.node)||(s=p.x0)>b||(c=p.y0)>T||(h=p.x1)<w||(f=p.y1)<_))if(N.length){var P=(s+h)/2,L=(c+f)/2;k.push(new Et(N[3],P,L,h,f),new Et(N[2],s,L,P,f),new Et(N[1],P,c,h,L),new Et(N[0],s,c,P,L)),(y=(n>=L)<<1|e>=P)&&(p=k[k.length-1],k[k.length-1]=k[k.length-1-y],k[k.length-1-y]=p)}else{var z=e-+this._x.call(null,N.data),F=n-+this._y.call(null,N.data),W=z*z+F*F;if(W<o){var Y=Math.sqrt(o=W);w=e-Y,_=n-Y,b=e+Y,T=n+Y,a=N.data}}return a},kt.remove=function(e){if(isNaN(c=+this._x.call(null,e))||isNaN(h=+this._y.call(null,e)))return this;var n,o,a,s,c,h,f,p,y,w,_,b,T=this._root,k=this._x0,N=this._y0,P=this._x1,L=this._y1;if(!T)return this;if(T.length)for(;;){if((y=c>=(f=(k+P)/2))?k=f:P=f,(w=h>=(p=(N+L)/2))?N=p:L=p,n=T,!(T=T[_=w<<1|y]))return this;if(!T.length)break;(n[_+1&3]||n[_+2&3]||n[_+3&3])&&(o=n,b=_)}for(;T.data!==e;)if(a=T,!(T=T.next))return this;return(s=T.next)&&delete T.next,a?(s?a.next=s:delete a.next,this):n?(s?n[_]=s:delete n[_],(T=n[0]||n[1]||n[2]||n[3])&&T===(n[3]||n[2]||n[1]||n[0])&&!T.length&&(o?o[b]=T:this._root=T),this):(this._root=s,this)},kt.removeAll=function(e){for(var n=0,o=e.length;n<o;++n)this.remove(e[n]);return this},kt.root=function(){return this._root},kt.size=function(){var e=0;return this.visit(function(n){if(!n.length)do++e;while(n=n.next)}),e},kt.visit=function(e){var n,o,a,s,c,h,f=[],p=this._root;for(p&&f.push(new Et(p,this._x0,this._y0,this._x1,this._y1));n=f.pop();)if(!e(p=n.node,a=n.x0,s=n.y0,c=n.x1,h=n.y1)&&p.length){var y=(a+c)/2,w=(s+h)/2;(o=p[3])&&f.push(new Et(o,y,w,c,h)),(o=p[2])&&f.push(new Et(o,a,w,y,h)),(o=p[1])&&f.push(new Et(o,y,s,c,w)),(o=p[0])&&f.push(new Et(o,a,s,y,w))}return this},kt.visitAfter=function(e){var n,o=[],a=[];for(this._root&&o.push(new Et(this._root,this._x0,this._y0,this._x1,this._y1));n=o.pop();){var s=n.node;if(s.length){var c,h=n.x0,f=n.y0,p=n.x1,y=n.y1,w=(h+p)/2,_=(f+y)/2;(c=s[0])&&o.push(new Et(c,h,f,w,_)),(c=s[1])&&o.push(new Et(c,w,f,p,_)),(c=s[2])&&o.push(new Et(c,h,_,w,y)),(c=s[3])&&o.push(new Et(c,w,_,p,y))}a.push(n)}for(;n=a.pop();)e(n.node,n.x0,n.y0,n.x1,n.y1);return this},kt.x=function(e){return arguments.length?(this._x=e,this):this._x},kt.y=function(e){return arguments.length?(this._y=e,this):this._y};var u8=10,f8=Math.PI*(3-Math.sqrt(5));function Ms(e,n){if((o=(e=n?e.toExponential(n-1):e.toExponential()).indexOf("e"))<0)return null;var o,a=e.slice(0,o);return[a.length>1?a[0]+a.slice(2):a,+e.slice(o+1)]}function di(e){return(e=Ms(Math.abs(e)))?e[1]:NaN}var W0,h8=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function So(e){return new Ou(e)}function Ou(e){if(!(n=h8.exec(e)))throw new Error("invalid format: "+e);var n;this.fill=n[1]||" ",this.align=n[2]||">",this.sign=n[3]||"-",this.symbol=n[4]||"",this.zero=!!n[5],this.width=n[6]&&+n[6],this.comma=!!n[7],this.precision=n[8]&&+n[8].slice(1),this.trim=!!n[9],this.type=n[10]||""}function G0(e,n){var o=Ms(e,n);if(!o)return e+"";var a=o[0],s=o[1];return s<0?"0."+new Array(-s).join("0")+a:a.length>s+1?a.slice(0,s+1)+"."+a.slice(s+1):a+new Array(s-a.length+2).join("0")}So.prototype=Ou.prototype,Ou.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width==null?"":Math.max(1,0|this.width))+(this.comma?",":"")+(this.precision==null?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var X0={"%":function(e,n){return(100*e).toFixed(n)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,n){return e.toExponential(n)},f:function(e,n){return e.toFixed(n)},g:function(e,n){return e.toPrecision(n)},o:function(e){return Math.round(e).toString(8)},p:function(e,n){return G0(100*e,n)},r:G0,s:function(e,n){var o=Ms(e,n);if(!o)return e+"";var a=o[0],s=o[1],c=s-(W0=3*Math.max(-8,Math.min(8,Math.floor(s/3))))+1,h=a.length;return c===h?a:c>h?a+new Array(c-h+1).join("0"):c>0?a.slice(0,c)+"."+a.slice(c):"0."+new Array(1-c).join("0")+Ms(e,Math.max(0,n+c-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function K0(e){return e}var Ds,J0=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Y0(e){var n,o,a=e.grouping&&e.thousands?(n=e.grouping,o=e.thousands,function(y,w){for(var _=y.length,b=[],T=0,k=n[0],N=0;_>0&&k>0&&(N+k+1>w&&(k=Math.max(1,w-N)),b.push(y.substring(_-=k,_+k)),!((N+=k+1)>w));)k=n[T=(T+1)%n.length];return b.reverse().join(o)}):K0,s=e.currency,c=e.decimal,h=e.numerals?function(y){return function(w){return w.replace(/[0-9]/g,function(_){return y[+_]})}}(e.numerals):K0,f=e.percent||"%";function p(y){var w=(y=So(y)).fill,_=y.align,b=y.sign,T=y.symbol,k=y.zero,N=y.width,P=y.comma,L=y.precision,z=y.trim,F=y.type;F==="n"?(P=!0,F="g"):X0[F]||(L==null&&(L=12),z=!0,F="g"),(k||w==="0"&&_==="=")&&(k=!0,w="0",_="=");var W=T==="$"?s[0]:T==="#"&&/[boxX]/.test(F)?"0"+F.toLowerCase():"",Y=T==="$"?s[1]:/[%p]/.test(F)?f:"",ae=X0[F],ie=/[defgprs%]/.test(F);function ce(G){var ne,oe,ee,q=W,Q=Y;if(F==="c")Q=ae(G)+Q,G="";else{var ue=(G=+G)<0;if(G=ae(Math.abs(G),L),z&&(G=function(Ee){e:for(var Ne,je=Ee.length,be=1,Se=-1;be<je;++be)switch(Ee[be]){case".":Se=Ne=be;break;case"0":Se===0&&(Se=be),Ne=be;break;default:if(Se>0){if(!+Ee[be])break e;Se=0}}return Se>0?Ee.slice(0,Se)+Ee.slice(Ne+1):Ee}(G)),ue&&+G==0&&(ue=!1),q=(ue?b==="("?b:"-":b==="-"||b==="("?"":b)+q,Q=(F==="s"?J0[8+W0/3]:"")+Q+(ue&&b==="("?")":""),ie){for(ne=-1,oe=G.length;++ne<oe;)if(48>(ee=G.charCodeAt(ne))||ee>57){Q=(ee===46?c+G.slice(ne+1):G.slice(ne))+Q,G=G.slice(0,ne);break}}}P&&!k&&(G=a(G,1/0));var he=q.length+G.length+Q.length,pe=he<N?new Array(N-he+1).join(w):"";switch(P&&k&&(G=a(pe+G,pe.length?N-Q.length:1/0),pe=""),_){case"<":G=q+G+Q+pe;break;case"=":G=q+pe+G+Q;break;case"^":G=pe.slice(0,he=pe.length>>1)+q+G+Q+pe.slice(he);break;default:G=pe+q+G+Q}return h(G)}return L=L==null?6:/[gprs]/.test(F)?Math.max(1,Math.min(21,L)):Math.max(0,Math.min(20,L)),ce.toString=function(){return y+""},ce}return{format:p,formatPrefix:function(y,w){var _=p(((y=So(y)).type="f",y)),b=3*Math.max(-8,Math.min(8,Math.floor(di(w)/3))),T=Math.pow(10,-b),k=J0[8+b/3];return function(N){return _(T*N)+k}}}}function Q0(e){return Ds=Y0(e),t.format=Ds.format,t.formatPrefix=Ds.formatPrefix,Ds}function eg(e){return Math.max(0,-di(Math.abs(e)))}function tg(e,n){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(di(n)/3)))-di(Math.abs(e)))}function ng(e,n){return e=Math.abs(e),n=Math.abs(n)-e,Math.max(0,di(n)-di(e))+1}function sr(){return new Ss}function Ss(){this.reset()}Q0({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),Ss.prototype={constructor:Ss,reset:function(){this.s=this.t=0},add:function(e){rg(Ls,e,this.t),rg(this,Ls.s,this.s),this.s?this.t+=Ls.t:this.s=Ls.t},valueOf:function(){return this.s}};var Ls=new Ss;function rg(e,n,o){var a=e.s=n+o,s=a-n,c=a-s;e.t=n-c+(o-s)}var Ie=1e-6,Ru=1e-12,Be=Math.PI,it=Be/2,Ps=Be/4,Rt=2*Be,Ke=180/Be,ke=Be/180,ze=Math.abs,pi=Math.atan,Ct=Math.atan2,Te=Math.cos,Os=Math.ceil,ig=Math.exp,Rs=Math.log,Fu=Math.pow,xe=Math.sin,Lo=Math.sign||function(e){return e>0?1:e<0?-1:0},lt=Math.sqrt,Bu=Math.tan;function og(e){return e>1?0:e<-1?Be:Math.acos(e)}function Nt(e){return e>1?it:e<-1?-it:Math.asin(e)}function ag(e){return(e=xe(e/2))*e}function nt(){}function Fs(e,n){e&&lg.hasOwnProperty(e.type)&&lg[e.type](e,n)}var sg={Feature:function(e,n){Fs(e.geometry,n)},FeatureCollection:function(e,n){for(var o=e.features,a=-1,s=o.length;++a<s;)Fs(o[a].geometry,n)}},lg={Sphere:function(e,n){n.sphere()},Point:function(e,n){e=e.coordinates,n.point(e[0],e[1],e[2])},MultiPoint:function(e,n){for(var o=e.coordinates,a=-1,s=o.length;++a<s;)e=o[a],n.point(e[0],e[1],e[2])},LineString:function(e,n){zu(e.coordinates,n,0)},MultiLineString:function(e,n){for(var o=e.coordinates,a=-1,s=o.length;++a<s;)zu(o[a],n,0)},Polygon:function(e,n){cg(e.coordinates,n)},MultiPolygon:function(e,n){for(var o=e.coordinates,a=-1,s=o.length;++a<s;)cg(o[a],n)},GeometryCollection:function(e,n){for(var o=e.geometries,a=-1,s=o.length;++a<s;)Fs(o[a],n)}};function zu(e,n,o){var a,s=-1,c=e.length-o;for(n.lineStart();++s<c;)a=e[s],n.point(a[0],a[1],a[2]);n.lineEnd()}function cg(e,n){var o=-1,a=e.length;for(n.polygonStart();++o<a;)zu(e[o],n,1);n.polygonEnd()}function on(e,n){e&&sg.hasOwnProperty(e.type)?sg[e.type](e,n):Fs(e,n)}var ug,fg,qu,Uu,Zu,Bs=sr(),zs=sr(),mn={point:nt,lineStart:nt,lineEnd:nt,polygonStart:function(){Bs.reset(),mn.lineStart=d8,mn.lineEnd=p8},polygonEnd:function(){var e=+Bs;zs.add(e<0?Rt+e:e),this.lineStart=this.lineEnd=this.point=nt},sphere:function(){zs.add(Rt)}};function d8(){mn.point=g8}function p8(){hg(ug,fg)}function g8(e,n){mn.point=hg,ug=e,fg=n,qu=e*=ke,Uu=Te(n=(n*=ke)/2+Ps),Zu=xe(n)}function hg(e,n){var o=(e*=ke)-qu,a=o>=0?1:-1,s=a*o,c=Te(n=(n*=ke)/2+Ps),h=xe(n),f=Zu*h,p=Uu*c+f*Te(s),y=f*a*xe(s);Bs.add(Ct(y,p)),qu=e,Uu=c,Zu=h}function qs(e){return[Ct(e[1],e[0]),Nt(e[2])]}function Dr(e){var n=e[0],o=e[1],a=Te(o);return[a*Te(n),a*xe(n),xe(o)]}function Us(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]}function gi(e,n){return[e[1]*n[2]-e[2]*n[1],e[2]*n[0]-e[0]*n[2],e[0]*n[1]-e[1]*n[0]]}function ju(e,n){e[0]+=n[0],e[1]+=n[1],e[2]+=n[2]}function Zs(e,n){return[e[0]*n,e[1]*n,e[2]*n]}function js(e){var n=lt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=n,e[1]/=n,e[2]/=n}var ot,qt,at,Gt,Sr,dg,pg,mi,lr,Bn,Hs,$s,Vs,Ws,Gs,Xs,Ks,Js,Hu,$u,Vu,gg,mg,At,Mt,Dt,Po=sr(),zn={point:Wu,lineStart:bg,lineEnd:wg,polygonStart:function(){zn.point=_g,zn.lineStart=m8,zn.lineEnd=y8,Po.reset(),mn.polygonStart()},polygonEnd:function(){mn.polygonEnd(),zn.point=Wu,zn.lineStart=bg,zn.lineEnd=wg,Bs<0?(ot=-(at=180),qt=-(Gt=90)):Po>Ie?Gt=90:Po<-Ie&&(qt=-90),Bn[0]=ot,Bn[1]=at}};function Wu(e,n){lr.push(Bn=[ot=e,at=e]),n<qt&&(qt=n),n>Gt&&(Gt=n)}function yg(e,n){var o=Dr([e*ke,n*ke]);if(mi){var a=gi(mi,o),s=gi([a[1],-a[0],0],a);js(s),s=qs(s);var c,h=e-Sr,f=h>0?1:-1,p=s[0]*Ke*f,y=ze(h)>180;y^(f*Sr<p&&p<f*e)?(c=s[1]*Ke)>Gt&&(Gt=c):y^(f*Sr<(p=(p+360)%360-180)&&p<f*e)?(c=-s[1]*Ke)<qt&&(qt=c):(n<qt&&(qt=n),n>Gt&&(Gt=n)),y?e<Sr?Ut(ot,e)>Ut(ot,at)&&(at=e):Ut(e,at)>Ut(ot,at)&&(ot=e):at>=ot?(e<ot&&(ot=e),e>at&&(at=e)):e>Sr?Ut(ot,e)>Ut(ot,at)&&(at=e):Ut(e,at)>Ut(ot,at)&&(ot=e)}else lr.push(Bn=[ot=e,at=e]);n<qt&&(qt=n),n>Gt&&(Gt=n),mi=o,Sr=e}function bg(){zn.point=yg}function wg(){Bn[0]=ot,Bn[1]=at,zn.point=Wu,mi=null}function _g(e,n){if(mi){var o=e-Sr;Po.add(ze(o)>180?o+(o>0?360:-360):o)}else dg=e,pg=n;mn.point(e,n),yg(e,n)}function m8(){mn.lineStart()}function y8(){_g(dg,pg),mn.lineEnd(),ze(Po)>Ie&&(ot=-(at=180)),Bn[0]=ot,Bn[1]=at,mi=null}function Ut(e,n){return(n-=e)<0?n+360:n}function b8(e,n){return e[0]-n[0]}function vg(e,n){return e[0]<=e[1]?e[0]<=n&&n<=e[1]:n<e[0]||e[1]<n}var an={sphere:nt,point:Gu,lineStart:xg,lineEnd:Tg,polygonStart:function(){an.lineStart=v8,an.lineEnd=x8},polygonEnd:function(){an.lineStart=xg,an.lineEnd=Tg}};function Gu(e,n){e*=ke;var o=Te(n*=ke);Oo(o*Te(e),o*xe(e),xe(n))}function Oo(e,n,o){Vs+=(e-Vs)/++Hs,Ws+=(n-Ws)/Hs,Gs+=(o-Gs)/Hs}function xg(){an.point=w8}function w8(e,n){e*=ke;var o=Te(n*=ke);At=o*Te(e),Mt=o*xe(e),Dt=xe(n),an.point=_8,Oo(At,Mt,Dt)}function _8(e,n){e*=ke;var o=Te(n*=ke),a=o*Te(e),s=o*xe(e),c=xe(n),h=Ct(lt((h=Mt*c-Dt*s)*h+(h=Dt*a-At*c)*h+(h=At*s-Mt*a)*h),At*a+Mt*s+Dt*c);$s+=h,Xs+=h*(At+(At=a)),Ks+=h*(Mt+(Mt=s)),Js+=h*(Dt+(Dt=c)),Oo(At,Mt,Dt)}function Tg(){an.point=Gu}function v8(){an.point=T8}function x8(){Ig(gg,mg),an.point=Gu}function T8(e,n){gg=e,mg=n,e*=ke,n*=ke,an.point=Ig;var o=Te(n);At=o*Te(e),Mt=o*xe(e),Dt=xe(n),Oo(At,Mt,Dt)}function Ig(e,n){e*=ke;var o=Te(n*=ke),a=o*Te(e),s=o*xe(e),c=xe(n),h=Mt*c-Dt*s,f=Dt*a-At*c,p=At*s-Mt*a,y=lt(h*h+f*f+p*p),w=Nt(y),_=y&&-w/y;Hu+=_*h,$u+=_*f,Vu+=_*p,$s+=w,Xs+=w*(At+(At=a)),Ks+=w*(Mt+(Mt=s)),Js+=w*(Dt+(Dt=c)),Oo(At,Mt,Dt)}function yi(e){return function(){return e}}function Xu(e,n){function o(a,s){return a=e(a,s),n(a[0],a[1])}return e.invert&&n.invert&&(o.invert=function(a,s){return(a=n.invert(a,s))&&e.invert(a[0],a[1])}),o}function Ku(e,n){return[ze(e)>Be?e+Math.round(-e/Rt)*Rt:e,n]}function Ju(e,n,o){return(e%=Rt)?n||o?Xu(kg(e),Cg(n,o)):kg(e):n||o?Cg(n,o):Ku}function Eg(e){return function(n,o){return[(n+=e)>Be?n-Rt:n<-Be?n+Rt:n,o]}}function kg(e){var n=Eg(e);return n.invert=Eg(-e),n}function Cg(e,n){var o=Te(e),a=xe(e),s=Te(n),c=xe(n);function h(f,p){var y=Te(p),w=Te(f)*y,_=xe(f)*y,b=xe(p),T=b*o+w*a;return[Ct(_*s-T*c,w*o-b*a),Nt(T*s+_*c)]}return h.invert=function(f,p){var y=Te(p),w=Te(f)*y,_=xe(f)*y,b=xe(p),T=b*s-_*c;return[Ct(_*s+b*c,w*o+T*a),Nt(T*o-w*a)]},h}function Ng(e){function n(o){return(o=e(o[0]*ke,o[1]*ke))[0]*=Ke,o[1]*=Ke,o}return e=Ju(e[0]*ke,e[1]*ke,e.length>2?e[2]*ke:0),n.invert=function(o){return(o=e.invert(o[0]*ke,o[1]*ke))[0]*=Ke,o[1]*=Ke,o},n}function Ag(e,n,o,a,s,c){if(o){var h=Te(n),f=xe(n),p=a*o;s==null?(s=n+a*Rt,c=n-p/2):(s=Mg(h,s),c=Mg(h,c),(a>0?s<c:s>c)&&(s+=a*Rt));for(var y,w=s;a>0?w>c:w<c;w-=p)y=qs([h,-f*Te(w),-f*xe(w)]),e.point(y[0],y[1])}}function Mg(e,n){(n=Dr(n))[0]-=e,js(n);var o=og(-n[1]);return((-n[2]<0?-o:o)+Rt-Ie)%Rt}function Dg(){var e,n=[];return{point:function(o,a){e.push([o,a])},lineStart:function(){n.push(e=[])},lineEnd:nt,rejoin:function(){n.length>1&&n.push(n.pop().concat(n.shift()))},result:function(){var o=n;return n=[],e=null,o}}}function Ys(e,n){return ze(e[0]-n[0])<Ie&&ze(e[1]-n[1])<Ie}function Qs(e,n,o,a){this.x=e,this.z=n,this.o=o,this.e=a,this.v=!1,this.n=this.p=null}function Sg(e,n,o,a,s){var c,h,f=[],p=[];if(e.forEach(function(k){if(!((N=k.length-1)<=0)){var N,P,L=k[0],z=k[N];if(Ys(L,z)){for(s.lineStart(),c=0;c<N;++c)s.point((L=k[c])[0],L[1]);s.lineEnd()}else f.push(P=new Qs(L,k,null,!0)),p.push(P.o=new Qs(L,null,P,!1)),f.push(P=new Qs(z,k,null,!1)),p.push(P.o=new Qs(z,null,P,!0))}}),f.length){for(p.sort(n),Lg(f),Lg(p),c=0,h=p.length;c<h;++c)p[c].e=o=!o;for(var y,w,_=f[0];;){for(var b=_,T=!0;b.v;)if((b=b.n)===_)return;y=b.z,s.lineStart();do{if(b.v=b.o.v=!0,b.e){if(T)for(c=0,h=y.length;c<h;++c)s.point((w=y[c])[0],w[1]);else a(b.x,b.n.x,1,s);b=b.n}else{if(T)for(y=b.p.z,c=y.length-1;c>=0;--c)s.point((w=y[c])[0],w[1]);else a(b.x,b.p.x,-1,s);b=b.p}y=(b=b.o).z,T=!T}while(!b.v);s.lineEnd()}}}function Lg(e){if(n=e.length){for(var n,o,a=0,s=e[0];++a<n;)s.n=o=e[a],o.p=s,s=o;s.n=o=e[0],o.p=s}}Ku.invert=Ku;var Yu=sr();function Pg(e,n){var o=n[0],a=n[1],s=xe(a),c=[xe(o),-Te(o),0],h=0,f=0;Yu.reset(),s===1?a=it+Ie:s===-1&&(a=-it-Ie);for(var p=0,y=e.length;p<y;++p)if(_=(w=e[p]).length)for(var w,_,b=w[_-1],T=b[0],k=b[1]/2+Ps,N=xe(k),P=Te(k),L=0;L<_;++L,T=F,N=Y,P=ae,b=z){var z=w[L],F=z[0],W=z[1]/2+Ps,Y=xe(W),ae=Te(W),ie=F-T,ce=ie>=0?1:-1,G=ce*ie,ne=G>Be,oe=N*Y;if(Yu.add(Ct(oe*ce*xe(G),P*ae+oe*Te(G))),h+=ne?ie+ce*Rt:ie,ne^T>=o^F>=o){var ee=gi(Dr(b),Dr(z));js(ee);var q=gi(c,ee);js(q);var Q=(ne^ie>=0?-1:1)*Nt(q[2]);(a>Q||a===Q&&(ee[0]||ee[1]))&&(f+=ne^ie>=0?1:-1)}}return(h<-Ie||h<Ie&&Yu<-Ie)^1&f}function Og(e,n,o,a){return function(s){var c,h,f,p=n(s),y=Dg(),w=n(y),_=!1,b={point:T,lineStart:N,lineEnd:P,polygonStart:function(){b.point=L,b.lineStart=z,b.lineEnd=F,h=[],c=[]},polygonEnd:function(){b.point=T,b.lineStart=N,b.lineEnd=P,h=U(h);var W=Pg(c,a);h.length?(_||(s.polygonStart(),_=!0),Sg(h,E8,W,o,s)):W&&(_||(s.polygonStart(),_=!0),s.lineStart(),o(null,null,1,s),s.lineEnd()),_&&(s.polygonEnd(),_=!1),h=c=null},sphere:function(){s.polygonStart(),s.lineStart(),o(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function T(W,Y){e(W,Y)&&s.point(W,Y)}function k(W,Y){p.point(W,Y)}function N(){b.point=k,p.lineStart()}function P(){b.point=T,p.lineEnd()}function L(W,Y){f.push([W,Y]),w.point(W,Y)}function z(){w.lineStart(),f=[]}function F(){L(f[0][0],f[0][1]),w.lineEnd();var W,Y,ae,ie,ce=w.clean(),G=y.result(),ne=G.length;if(f.pop(),c.push(f),f=null,ne)if(1&ce){if((Y=(ae=G[0]).length-1)>0){for(_||(s.polygonStart(),_=!0),s.lineStart(),W=0;W<Y;++W)s.point((ie=ae[W])[0],ie[1]);s.lineEnd()}}else ne>1&&2&ce&&G.push(G.pop().concat(G.shift())),h.push(G.filter(I8))}return b}}function I8(e){return e.length>1}function E8(e,n){return((e=e.x)[0]<0?e[1]-it-Ie:it-e[1])-((n=n.x)[0]<0?n[1]-it-Ie:it-n[1])}var Qu=Og(function(){return!0},function(e){var n,o=NaN,a=NaN,s=NaN;return{lineStart:function(){e.lineStart(),n=1},point:function(c,h){var f=c>0?Be:-Be,p=ze(c-o);ze(p-Be)<Ie?(e.point(o,a=(a+h)/2>0?it:-it),e.point(s,a),e.lineEnd(),e.lineStart(),e.point(f,a),e.point(c,a),n=0):s!==f&&p>=Be&&(ze(o-s)<Ie&&(o-=s*Ie),ze(c-f)<Ie&&(c-=f*Ie),a=function(y,w,_,b){var T,k,N=xe(y-_);return ze(N)>Ie?pi((xe(w)*(k=Te(b))*xe(_)-xe(b)*(T=Te(w))*xe(y))/(T*k*N)):(w+b)/2}(o,a,c,h),e.point(s,a),e.lineEnd(),e.lineStart(),e.point(f,a),n=0),e.point(o=c,a=h),s=f},lineEnd:function(){e.lineEnd(),o=a=NaN},clean:function(){return 2-n}}},function(e,n,o,a){var s;if(e==null)s=o*it,a.point(-Be,s),a.point(0,s),a.point(Be,s),a.point(Be,0),a.point(Be,-s),a.point(0,-s),a.point(-Be,-s),a.point(-Be,0),a.point(-Be,s);else if(ze(e[0]-n[0])>Ie){var c=e[0]<n[0]?Be:-Be;s=o*c/2,a.point(-c,s),a.point(0,s),a.point(c,s)}else a.point(n[0],n[1])},[-Be,-it]);function Rg(e){var n=Te(e),o=6*ke,a=n>0,s=ze(n)>Ie;function c(p,y){return Te(p)*Te(y)>n}function h(p,y,w){var _=[1,0,0],b=gi(Dr(p),Dr(y)),T=Us(b,b),k=b[0],N=T-k*k;if(!N)return!w&&p;var P=n*T/N,L=-n*k/N,z=gi(_,b),F=Zs(_,P);ju(F,Zs(b,L));var W=z,Y=Us(F,W),ae=Us(W,W),ie=Y*Y-ae*(Us(F,F)-1);if(!(ie<0)){var ce=lt(ie),G=Zs(W,(-Y-ce)/ae);if(ju(G,F),G=qs(G),!w)return G;var ne,oe=p[0],ee=y[0],q=p[1],Q=y[1];ee<oe&&(ne=oe,oe=ee,ee=ne);var ue=ee-oe,he=ze(ue-Be)<Ie;if(!he&&Q<q&&(ne=q,q=Q,Q=ne),he||ue<Ie?he?q+Q>0^G[1]<(ze(G[0]-oe)<Ie?q:Q):q<=G[1]&&G[1]<=Q:ue>Be^(oe<=G[0]&&G[0]<=ee)){var pe=Zs(W,(-Y+ce)/ae);return ju(pe,F),[G,qs(pe)]}}}function f(p,y){var w=a?e:Be-e,_=0;return p<-w?_|=1:p>w&&(_|=2),y<-w?_|=4:y>w&&(_|=8),_}return Og(c,function(p){var y,w,_,b,T;return{lineStart:function(){b=_=!1,T=1},point:function(k,N){var P,L=[k,N],z=c(k,N),F=a?z?0:f(k,N):z?f(k+(k<0?Be:-Be),N):0;if(!y&&(b=_=z)&&p.lineStart(),z!==_&&(!(P=h(y,L))||Ys(y,P)||Ys(L,P))&&(L[0]+=Ie,L[1]+=Ie,z=c(L[0],L[1])),z!==_)T=0,z?(p.lineStart(),P=h(L,y),p.point(P[0],P[1])):(P=h(y,L),p.point(P[0],P[1]),p.lineEnd()),y=P;else if(s&&y&&a^z){var W;F&w||!(W=h(L,y,!0))||(T=0,a?(p.lineStart(),p.point(W[0][0],W[0][1]),p.point(W[1][0],W[1][1]),p.lineEnd()):(p.point(W[1][0],W[1][1]),p.lineEnd(),p.lineStart(),p.point(W[0][0],W[0][1])))}!z||y&&Ys(y,L)||p.point(L[0],L[1]),y=L,_=z,w=F},lineEnd:function(){_&&p.lineEnd(),y=null},clean:function(){return T|(b&&_)<<1}}},function(p,y,w,_){Ag(_,e,o,w,p,y)},a?[0,-e]:[-Be,e-Be])}var Ro=1e9,el=-Ro;function tl(e,n,o,a){function s(y,w){return e<=y&&y<=o&&n<=w&&w<=a}function c(y,w,_,b){var T=0,k=0;if(y==null||(T=h(y,_))!==(k=h(w,_))||p(y,w)<0^_>0)do b.point(T===0||T===3?e:o,T>1?a:n);while((T=(T+_+4)%4)!==k);else b.point(w[0],w[1])}function h(y,w){return ze(y[0]-e)<Ie?w>0?0:3:ze(y[0]-o)<Ie?w>0?2:1:ze(y[1]-n)<Ie?w>0?1:0:w>0?3:2}function f(y,w){return p(y.x,w.x)}function p(y,w){var _=h(y,1),b=h(w,1);return _!==b?_-b:_===0?w[1]-y[1]:_===1?y[0]-w[0]:_===2?y[1]-w[1]:w[0]-y[0]}return function(y){var w,_,b,T,k,N,P,L,z,F,W,Y=y,ae=Dg(),ie={point:ce,lineStart:function(){ie.point=G,_&&_.push(b=[]),F=!0,z=!1,P=L=NaN},lineEnd:function(){w&&(G(T,k),N&&z&&ae.rejoin(),w.push(ae.result())),ie.point=ce,z&&Y.lineEnd()},polygonStart:function(){Y=ae,w=[],_=[],W=!0},polygonEnd:function(){var ne=function(){for(var q=0,Q=0,ue=_.length;Q<ue;++Q)for(var he,pe,Ee=_[Q],Ne=1,je=Ee.length,be=Ee[0],Se=be[0],He=be[1];Ne<je;++Ne)he=Se,pe=He,be=Ee[Ne],Se=be[0],He=be[1],pe<=a?He>a&&(Se-he)*(a-pe)>(He-pe)*(e-he)&&++q:He<=a&&(Se-he)*(a-pe)<(He-pe)*(e-he)&&--q;return q}(),oe=W&&ne,ee=(w=U(w)).length;(oe||ee)&&(y.polygonStart(),oe&&(y.lineStart(),c(null,null,1,y),y.lineEnd()),ee&&Sg(w,f,ne,c,y),y.polygonEnd()),Y=y,w=_=b=null}};function ce(ne,oe){s(ne,oe)&&Y.point(ne,oe)}function G(ne,oe){var ee=s(ne,oe);if(_&&b.push([ne,oe]),F)T=ne,k=oe,N=ee,F=!1,ee&&(Y.lineStart(),Y.point(ne,oe));else if(ee&&z)Y.point(ne,oe);else{var q=[P=Math.max(el,Math.min(Ro,P)),L=Math.max(el,Math.min(Ro,L))],Q=[ne=Math.max(el,Math.min(Ro,ne)),oe=Math.max(el,Math.min(Ro,oe))];(function(ue,he,pe,Ee,Ne,je){var be,Se=ue[0],He=ue[1],Le=0,Re=1,Qe=he[0]-Se,xt=he[1]-He;if(be=pe-Se,Qe||!(be>0)){if(be/=Qe,Qe<0){if(be<Le)return;be<Re&&(Re=be)}else if(Qe>0){if(be>Re)return;be>Le&&(Le=be)}if(be=Ne-Se,Qe||!(be<0)){if(be/=Qe,Qe<0){if(be>Re)return;be>Le&&(Le=be)}else if(Qe>0){if(be<Le)return;be<Re&&(Re=be)}if(be=Ee-He,xt||!(be>0)){if(be/=xt,xt<0){if(be<Le)return;be<Re&&(Re=be)}else if(xt>0){if(be>Re)return;be>Le&&(Le=be)}if(be=je-He,xt||!(be<0)){if(be/=xt,xt<0){if(be>Re)return;be>Le&&(Le=be)}else if(xt>0){if(be<Le)return;be<Re&&(Re=be)}return Le>0&&(ue[0]=Se+Le*Qe,ue[1]=He+Le*xt),Re<1&&(he[0]=Se+Re*Qe,he[1]=He+Re*xt),!0}}}}})(q,Q,e,n,o,a)?(z||(Y.lineStart(),Y.point(q[0],q[1])),Y.point(Q[0],Q[1]),ee||Y.lineEnd(),W=!1):ee&&(Y.lineStart(),Y.point(ne,oe),W=!1)}P=ne,L=oe,z=ee}return ie}}var ef,nl,rl,tf=sr(),bi={sphere:nt,point:nt,lineStart:function(){bi.point=C8,bi.lineEnd=k8},lineEnd:nt,polygonStart:nt,polygonEnd:nt};function k8(){bi.point=bi.lineEnd=nt}function C8(e,n){ef=e*=ke,nl=xe(n*=ke),rl=Te(n),bi.point=N8}function N8(e,n){e*=ke;var o=xe(n*=ke),a=Te(n),s=ze(e-ef),c=Te(s),h=a*xe(s),f=rl*o-nl*a*c,p=nl*o+rl*a*c;tf.add(Ct(lt(h*h+f*f),p)),ef=e,nl=o,rl=a}function Fg(e){return tf.reset(),on(e,bi),+tf}var nf=[null,null],A8={type:"LineString",coordinates:nf};function Fo(e,n){return nf[0]=e,nf[1]=n,Fg(A8)}var Bg={Feature:function(e,n){return il(e.geometry,n)},FeatureCollection:function(e,n){for(var o=e.features,a=-1,s=o.length;++a<s;)if(il(o[a].geometry,n))return!0;return!1}},zg={Sphere:function(){return!0},Point:function(e,n){return qg(e.coordinates,n)},MultiPoint:function(e,n){for(var o=e.coordinates,a=-1,s=o.length;++a<s;)if(qg(o[a],n))return!0;return!1},LineString:function(e,n){return Ug(e.coordinates,n)},MultiLineString:function(e,n){for(var o=e.coordinates,a=-1,s=o.length;++a<s;)if(Ug(o[a],n))return!0;return!1},Polygon:function(e,n){return Zg(e.coordinates,n)},MultiPolygon:function(e,n){for(var o=e.coordinates,a=-1,s=o.length;++a<s;)if(Zg(o[a],n))return!0;return!1},GeometryCollection:function(e,n){for(var o=e.geometries,a=-1,s=o.length;++a<s;)if(il(o[a],n))return!0;return!1}};function il(e,n){return!(!e||!zg.hasOwnProperty(e.type))&&zg[e.type](e,n)}function qg(e,n){return Fo(e,n)===0}function Ug(e,n){var o=Fo(e[0],e[1]);return Fo(e[0],n)+Fo(n,e[1])<=o+Ie}function Zg(e,n){return!!Pg(e.map(M8),jg(n))}function M8(e){return(e=e.map(jg)).pop(),e}function jg(e){return[e[0]*ke,e[1]*ke]}function Hg(e,n,o){var a=$(e,n-Ie,o).concat(n);return function(s){return a.map(function(c){return[s,c]})}}function $g(e,n,o){var a=$(e,n-Ie,o).concat(n);return function(s){return a.map(function(c){return[c,s]})}}function Vg(){var e,n,o,a,s,c,h,f,p,y,w,_,b=10,T=b,k=90,N=360,P=2.5;function L(){return{type:"MultiLineString",coordinates:z()}}function z(){return $(Os(a/k)*k,o,k).map(w).concat($(Os(f/N)*N,h,N).map(_)).concat($(Os(n/b)*b,e,b).filter(function(F){return ze(F%k)>Ie}).map(p)).concat($(Os(c/T)*T,s,T).filter(function(F){return ze(F%N)>Ie}).map(y))}return L.lines=function(){return z().map(function(F){return{type:"LineString",coordinates:F}})},L.outline=function(){return{type:"Polygon",coordinates:[w(a).concat(_(h).slice(1),w(o).reverse().slice(1),_(f).reverse().slice(1))]}},L.extent=function(F){return arguments.length?L.extentMajor(F).extentMinor(F):L.extentMinor()},L.extentMajor=function(F){return arguments.length?(a=+F[0][0],o=+F[1][0],f=+F[0][1],h=+F[1][1],a>o&&(F=a,a=o,o=F),f>h&&(F=f,f=h,h=F),L.precision(P)):[[a,f],[o,h]]},L.extentMinor=function(F){return arguments.length?(n=+F[0][0],e=+F[1][0],c=+F[0][1],s=+F[1][1],n>e&&(F=n,n=e,e=F),c>s&&(F=c,c=s,s=F),L.precision(P)):[[n,c],[e,s]]},L.step=function(F){return arguments.length?L.stepMajor(F).stepMinor(F):L.stepMinor()},L.stepMajor=function(F){return arguments.length?(k=+F[0],N=+F[1],L):[k,N]},L.stepMinor=function(F){return arguments.length?(b=+F[0],T=+F[1],L):[b,T]},L.precision=function(F){return arguments.length?(P=+F,p=Hg(c,s,90),y=$g(n,e,P),w=Hg(f,h,90),_=$g(a,o,P),L):P},L.extentMajor([[-180,-90+Ie],[180,90-Ie]]).extentMinor([[-180,-80-Ie],[180,80+Ie]])}function Lr(e){return e}var Wg,Gg,rf,of,af=sr(),sf=sr(),qn={point:nt,lineStart:nt,lineEnd:nt,polygonStart:function(){qn.lineStart=D8,qn.lineEnd=L8},polygonEnd:function(){qn.lineStart=qn.lineEnd=qn.point=nt,af.add(ze(sf)),sf.reset()},result:function(){var e=af/2;return af.reset(),e}};function D8(){qn.point=S8}function S8(e,n){qn.point=Xg,Wg=rf=e,Gg=of=n}function Xg(e,n){sf.add(of*e-rf*n),rf=e,of=n}function L8(){Xg(Wg,Gg)}var wi=1/0,ol=wi,Bo=-wi,al=Bo,sl={point:function(e,n){e<wi&&(wi=e),e>Bo&&(Bo=e),n<ol&&(ol=n),n>al&&(al=n)},lineStart:nt,lineEnd:nt,polygonStart:nt,polygonEnd:nt,result:function(){var e=[[wi,ol],[Bo,al]];return Bo=al=-(ol=wi=1/0),e}},Kg,Jg,yn,bn,lf=0,cf=0,zo=0,ll=0,cl=0,_i=0,uf=0,ff=0,qo=0,Xt={point:Pr,lineStart:Yg,lineEnd:Qg,polygonStart:function(){Xt.lineStart=R8,Xt.lineEnd=F8},polygonEnd:function(){Xt.point=Pr,Xt.lineStart=Yg,Xt.lineEnd=Qg},result:function(){var e=qo?[uf/qo,ff/qo]:_i?[ll/_i,cl/_i]:zo?[lf/zo,cf/zo]:[NaN,NaN];return lf=cf=zo=ll=cl=_i=uf=ff=qo=0,e}};function Pr(e,n){lf+=e,cf+=n,++zo}function Yg(){Xt.point=P8}function P8(e,n){Xt.point=O8,Pr(yn=e,bn=n)}function O8(e,n){var o=e-yn,a=n-bn,s=lt(o*o+a*a);ll+=s*(yn+e)/2,cl+=s*(bn+n)/2,_i+=s,Pr(yn=e,bn=n)}function Qg(){Xt.point=Pr}function R8(){Xt.point=B8}function F8(){em(Kg,Jg)}function B8(e,n){Xt.point=em,Pr(Kg=yn=e,Jg=bn=n)}function em(e,n){var o=e-yn,a=n-bn,s=lt(o*o+a*a);ll+=s*(yn+e)/2,cl+=s*(bn+n)/2,_i+=s,uf+=(s=bn*e-yn*n)*(yn+e),ff+=s*(bn+n),qo+=3*s,Pr(yn=e,bn=n)}function tm(e){this._context=e}tm.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,n){switch(this._point){case 0:this._context.moveTo(e,n),this._point=1;break;case 1:this._context.lineTo(e,n);break;default:this._context.moveTo(e+this._radius,n),this._context.arc(e,n,this._radius,0,Rt)}},result:nt};var hf,nm,rm,Uo,Zo,df=sr(),jo={point:nt,lineStart:function(){jo.point=z8},lineEnd:function(){hf&&im(nm,rm),jo.point=nt},polygonStart:function(){hf=!0},polygonEnd:function(){hf=null},result:function(){var e=+df;return df.reset(),e}};function z8(e,n){jo.point=im,nm=Uo=e,rm=Zo=n}function im(e,n){Uo-=e,Zo-=n,df.add(lt(Uo*Uo+Zo*Zo)),Uo=e,Zo=n}function om(){this._string=[]}function am(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function Ho(e){return function(n){var o=new pf;for(var a in e)o[a]=e[a];return o.stream=n,o}}function pf(){}function gf(e,n,o){var a=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),a!=null&&e.clipExtent(null),on(o,e.stream(sl)),n(sl.result()),a!=null&&e.clipExtent(a),e}function ul(e,n,o){return gf(e,function(a){var s=n[1][0]-n[0][0],c=n[1][1]-n[0][1],h=Math.min(s/(a[1][0]-a[0][0]),c/(a[1][1]-a[0][1])),f=+n[0][0]+(s-h*(a[1][0]+a[0][0]))/2,p=+n[0][1]+(c-h*(a[1][1]+a[0][1]))/2;e.scale(150*h).translate([f,p])},o)}function mf(e,n,o){return ul(e,[[0,0],n],o)}function yf(e,n,o){return gf(e,function(a){var s=+n,c=s/(a[1][0]-a[0][0]),h=(s-c*(a[1][0]+a[0][0]))/2,f=-c*a[0][1];e.scale(150*c).translate([h,f])},o)}function bf(e,n,o){return gf(e,function(a){var s=+n,c=s/(a[1][1]-a[0][1]),h=-c*a[0][0],f=(s-c*(a[1][1]+a[0][1]))/2;e.scale(150*c).translate([h,f])},o)}om.prototype={_radius:4.5,_circle:am(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,n){switch(this._point){case 0:this._string.push("M",e,",",n),this._point=1;break;case 1:this._string.push("L",e,",",n);break;default:this._circle==null&&(this._circle=am(this._radius)),this._string.push("M",e,",",n,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}},pf.prototype={constructor:pf,point:function(e,n){this.stream.point(e,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var sm=16,q8=Te(30*ke);function lm(e,n){return+n?function(o,a){function s(c,h,f,p,y,w,_,b,T,k,N,P,L,z){var F=_-c,W=b-h,Y=F*F+W*W;if(Y>4*a&&L--){var ae=p+k,ie=y+N,ce=w+P,G=lt(ae*ae+ie*ie+ce*ce),ne=Nt(ce/=G),oe=ze(ze(ce)-1)<Ie||ze(f-T)<Ie?(f+T)/2:Ct(ie,ae),ee=o(oe,ne),q=ee[0],Q=ee[1],ue=q-c,he=Q-h,pe=W*ue-F*he;(pe*pe/Y>a||ze((F*ue+W*he)/Y-.5)>.3||p*k+y*N+w*P<q8)&&(s(c,h,f,p,y,w,q,Q,oe,ae/=G,ie/=G,ce,L,z),z.point(q,Q),s(q,Q,oe,ae,ie,ce,_,b,T,k,N,P,L,z))}}return function(c){var h,f,p,y,w,_,b,T,k,N,P,L,z={point:F,lineStart:W,lineEnd:ae,polygonStart:function(){c.polygonStart(),z.lineStart=ie},polygonEnd:function(){c.polygonEnd(),z.lineStart=W}};function F(ne,oe){ne=o(ne,oe),c.point(ne[0],ne[1])}function W(){T=NaN,z.point=Y,c.lineStart()}function Y(ne,oe){var ee=Dr([ne,oe]),q=o(ne,oe);s(T,k,b,N,P,L,T=q[0],k=q[1],b=ne,N=ee[0],P=ee[1],L=ee[2],sm,c),c.point(T,k)}function ae(){z.point=F,c.lineEnd()}function ie(){W(),z.point=ce,z.lineEnd=G}function ce(ne,oe){Y(h=ne,oe),f=T,p=k,y=N,w=P,_=L,z.point=Y}function G(){s(T,k,b,N,P,L,f,p,h,y,w,_,sm,c),z.lineEnd=ae,ae()}return z}}(e,n):function(o){return Ho({point:function(a,s){a=o(a,s),this.stream.point(a[0],a[1])}})}(e)}var U8=Ho({point:function(e,n){this.stream.point(e*ke,n*ke)}});function cm(e,n,o,a){var s=Te(a),c=xe(a),h=s*e,f=c*e,p=s/e,y=c/e,w=(c*o-s*n)/e,_=(c*n+s*o)/e;function b(T,k){return[h*T-f*k+n,o-f*T-h*k]}return b.invert=function(T,k){return[p*T-y*k+w,_-y*T-p*k]},b}function wn(e){return wf(function(){return e})()}function wf(e){var n,o,a,s,c,h,f,p,y,w,_=150,b=480,T=250,k=0,N=0,P=0,L=0,z=0,F=0,W=null,Y=Qu,ae=null,ie=Lr,ce=.5;function G(q){return p(q[0]*ke,q[1]*ke)}function ne(q){return(q=p.invert(q[0],q[1]))&&[q[0]*Ke,q[1]*Ke]}function oe(){var q=cm(_,0,0,F).apply(null,n(k,N)),Q=(F?cm:function(ue,he,pe){function Ee(Ne,je){return[he+ue*Ne,pe-ue*je]}return Ee.invert=function(Ne,je){return[(Ne-he)/ue,(pe-je)/ue]},Ee})(_,b-q[0],T-q[1],F);return o=Ju(P,L,z),f=Xu(n,Q),p=Xu(o,f),h=lm(f,ce),ee()}function ee(){return y=w=null,G}return G.stream=function(q){return y&&w===q?y:y=U8(function(Q){return Ho({point:function(ue,he){var pe=Q(ue,he);return this.stream.point(pe[0],pe[1])}})}(o)(Y(h(ie(w=q)))))},G.preclip=function(q){return arguments.length?(Y=q,W=void 0,ee()):Y},G.postclip=function(q){return arguments.length?(ie=q,ae=a=s=c=null,ee()):ie},G.clipAngle=function(q){return arguments.length?(Y=+q?Rg(W=q*ke):(W=null,Qu),ee()):W*Ke},G.clipExtent=function(q){return arguments.length?(ie=q==null?(ae=a=s=c=null,Lr):tl(ae=+q[0][0],a=+q[0][1],s=+q[1][0],c=+q[1][1]),ee()):ae==null?null:[[ae,a],[s,c]]},G.scale=function(q){return arguments.length?(_=+q,oe()):_},G.translate=function(q){return arguments.length?(b=+q[0],T=+q[1],oe()):[b,T]},G.center=function(q){return arguments.length?(k=q[0]%360*ke,N=q[1]%360*ke,oe()):[k*Ke,N*Ke]},G.rotate=function(q){return arguments.length?(P=q[0]%360*ke,L=q[1]%360*ke,z=q.length>2?q[2]%360*ke:0,oe()):[P*Ke,L*Ke,z*Ke]},G.angle=function(q){return arguments.length?(F=q%360*ke,oe()):F*Ke},G.precision=function(q){return arguments.length?(h=lm(f,ce=q*q),ee()):lt(ce)},G.fitExtent=function(q,Q){return ul(G,q,Q)},G.fitSize=function(q,Q){return mf(G,q,Q)},G.fitWidth=function(q,Q){return yf(G,q,Q)},G.fitHeight=function(q,Q){return bf(G,q,Q)},function(){return n=e.apply(this,arguments),G.invert=n.invert&&ne,oe()}}function _f(e){var n=0,o=Be/3,a=wf(e),s=a(n,o);return s.parallels=function(c){return arguments.length?a(n=c[0]*ke,o=c[1]*ke):[n*Ke,o*Ke]},s}function um(e,n){var o=xe(e),a=(o+xe(n))/2;if(ze(a)<Ie)return function(f){var p=Te(f);function y(w,_){return[w*p,xe(_)/p]}return y.invert=function(w,_){return[w/p,Nt(_*p)]},y}(e);var s=1+o*(2*a-o),c=lt(s)/a;function h(f,p){var y=lt(s-2*a*xe(p))/a;return[y*xe(f*=a),c-y*Te(f)]}return h.invert=function(f,p){var y=c-p;return[Ct(f,ze(y))/a*Lo(y),Nt((s-(f*f+y*y)*a*a)/(2*a))]},h}function fl(){return _f(um).scale(155.424).center([0,33.6442])}function fm(){return fl().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function hm(e){return function(n,o){var a=Te(n),s=Te(o),c=e(a*s);return[c*s*xe(n),c*xe(o)]}}function $o(e){return function(n,o){var a=lt(n*n+o*o),s=e(a),c=xe(s),h=Te(s);return[Ct(n*c,a*h),Nt(a&&o*c/a)]}}var vf=hm(function(e){return lt(2/(1+e))});vf.invert=$o(function(e){return 2*Nt(e/2)});var xf=hm(function(e){return(e=og(e))&&e/xe(e)});function Vo(e,n){return[e,Rs(Bu((it+n)/2))]}function dm(e){var n,o,a,s=wn(e),c=s.center,h=s.scale,f=s.translate,p=s.clipExtent,y=null;function w(){var _=Be*h(),b=s(Ng(s.rotate()).invert([0,0]));return p(y==null?[[b[0]-_,b[1]-_],[b[0]+_,b[1]+_]]:e===Vo?[[Math.max(b[0]-_,y),n],[Math.min(b[0]+_,o),a]]:[[y,Math.max(b[1]-_,n)],[o,Math.min(b[1]+_,a)]])}return s.scale=function(_){return arguments.length?(h(_),w()):h()},s.translate=function(_){return arguments.length?(f(_),w()):f()},s.center=function(_){return arguments.length?(c(_),w()):c()},s.clipExtent=function(_){return arguments.length?(_==null?y=n=o=a=null:(y=+_[0][0],n=+_[0][1],o=+_[1][0],a=+_[1][1]),w()):y==null?null:[[y,n],[o,a]]},w()}function hl(e){return Bu((it+e)/2)}function pm(e,n){var o=Te(e),a=e===n?xe(e):Rs(o/Te(n))/Rs(hl(n)/hl(e)),s=o*Fu(hl(e),a)/a;if(!a)return Vo;function c(h,f){s>0?f<-it+Ie&&(f=-it+Ie):f>it-Ie&&(f=it-Ie);var p=s/Fu(hl(f),a);return[p*xe(a*h),s-p*Te(a*h)]}return c.invert=function(h,f){var p=s-f,y=Lo(a)*lt(h*h+p*p);return[Ct(h,ze(p))/a*Lo(p),2*pi(Fu(s/y,1/a))-it]},c}function Wo(e,n){return[e,n]}function gm(e,n){var o=Te(e),a=e===n?xe(e):(o-Te(n))/(n-e),s=o/a+e;if(ze(a)<Ie)return Wo;function c(h,f){var p=s-f,y=a*h;return[p*xe(y),s-p*Te(y)]}return c.invert=function(h,f){var p=s-f;return[Ct(h,ze(p))/a*Lo(p),s-Lo(a)*lt(h*h+p*p)]},c}xf.invert=$o(function(e){return e}),Vo.invert=function(e,n){return[e,2*pi(ig(n))-it]},Wo.invert=Wo;var Go=1.340264,Xo=-.081106,Ko=893e-6,Jo=.003796,dl=lt(3)/2;function Tf(e,n){var o=Nt(dl*xe(n)),a=o*o,s=a*a*a;return[e*Te(o)/(dl*(Go+3*Xo*a+s*(7*Ko+9*Jo*a))),o*(Go+Xo*a+s*(Ko+Jo*a))]}function If(e,n){var o=Te(n),a=Te(e)*o;return[o*xe(e)/a,xe(n)/a]}function pl(e,n,o,a){return e===1&&n===1&&o===0&&a===0?Lr:Ho({point:function(s,c){this.stream.point(s*e+o,c*n+a)}})}function Ef(e,n){var o=n*n,a=o*o;return[e*(.8707-.131979*o+a*(a*(.003971*o-.001529*a)-.013791)),n*(1.007226+o*(.015085+a*(.028874*o-.044475-.005916*a)))]}function kf(e,n){return[Te(n)*xe(e),xe(n)]}function Cf(e,n){var o=Te(n),a=1+Te(e)*o;return[o*xe(e)/a,xe(n)/a]}function Nf(e,n){return[Rs(Bu((it+n)/2)),-e]}function Z8(e,n){return e.parent===n.parent?1:2}function j8(e,n){return e+n.x}function H8(e,n){return Math.max(e,n.y)}function $8(e){var n=0,o=e.children,a=o&&o.length;if(a)for(;--a>=0;)n+=o[a].value;else n=1;e.value=n}function Af(e,n){var o,a,s,c,h,f=new vi(e),p=+e.value&&(f.value=e.value),y=[f];for(n==null&&(n=V8);o=y.pop();)if(p&&(o.value=+o.data.value),(s=n(o.data))&&(h=s.length))for(o.children=new Array(h),c=h-1;c>=0;--c)y.push(a=o.children[c]=new vi(s[c])),a.parent=o,a.depth=o.depth+1;return f.eachBefore(mm)}function V8(e){return e.children}function W8(e){e.data=e.data.data}function mm(e){var n=0;do e.height=n;while((e=e.parent)&&e.height<++n)}function vi(e){this.data=e,this.depth=this.height=0,this.parent=null}Tf.invert=function(e,n){for(var o,a=n,s=a*a,c=s*s*s,h=0;h<12&&(c=(s=(a-=o=(a*(Go+Xo*s+c*(Ko+Jo*s))-n)/(Go+3*Xo*s+c*(7*Ko+9*Jo*s)))*a)*s*s,!(ze(o)<Ru));++h);return[dl*e*(Go+3*Xo*s+c*(7*Ko+9*Jo*s))/Te(a),Nt(xe(a)/dl)]},If.invert=$o(pi),Ef.invert=function(e,n){var o,a=n,s=25;do{var c=a*a,h=c*c;a-=o=(a*(1.007226+c*(.015085+h*(.028874*c-.044475-.005916*h)))-n)/(1.007226+c*(.045255+h*(.259866*c-.311325-.005916*11*h)))}while(ze(o)>Ie&&--s>0);return[e/(.8707+(c=a*a)*(c*(c*c*c*(.003971-.001529*c)-.013791)-.131979)),a]},kf.invert=$o(Nt),Cf.invert=$o(function(e){return 2*pi(e)}),Nf.invert=function(e,n){return[-n,2*pi(ig(e))-it]},vi.prototype=Af.prototype={constructor:vi,count:function(){return this.eachAfter($8)},each:function(e){var n,o,a,s,c=this,h=[c];do for(n=h.reverse(),h=[];c=n.pop();)if(e(c),o=c.children)for(a=0,s=o.length;a<s;++a)h.push(o[a]);while(h.length);return this},eachAfter:function(e){for(var n,o,a,s=this,c=[s],h=[];s=c.pop();)if(h.push(s),n=s.children)for(o=0,a=n.length;o<a;++o)c.push(n[o]);for(;s=h.pop();)e(s);return this},eachBefore:function(e){for(var n,o,a=this,s=[a];a=s.pop();)if(e(a),n=a.children)for(o=n.length-1;o>=0;--o)s.push(n[o]);return this},sum:function(e){return this.eachAfter(function(n){for(var o=+e(n.data)||0,a=n.children,s=a&&a.length;--s>=0;)o+=a[s].value;n.value=o})},sort:function(e){return this.eachBefore(function(n){n.children&&n.children.sort(e)})},path:function(e){for(var n=this,o=function(c,h){if(c===h)return c;var f=c.ancestors(),p=h.ancestors(),y=null;for(c=f.pop(),h=p.pop();c===h;)y=c,c=f.pop(),h=p.pop();return y}(n,e),a=[n];n!==o;)n=n.parent,a.push(n);for(var s=a.length;e!==o;)a.splice(s,0,e),e=e.parent;return a},ancestors:function(){for(var e=this,n=[e];e=e.parent;)n.push(e);return n},descendants:function(){var e=[];return this.each(function(n){e.push(n)}),e},leaves:function(){var e=[];return this.eachBefore(function(n){n.children||e.push(n)}),e},links:function(){var e=this,n=[];return e.each(function(o){o!==e&&n.push({source:o.parent,target:o})}),n},copy:function(){return Af(this).eachBefore(W8)}};var G8=Array.prototype.slice;function ym(e){for(var n,o,a=0,s=(e=function(h){for(var f,p,y=h.length;y;)p=Math.random()*y--|0,f=h[y],h[y]=h[p],h[p]=f;return h}(G8.call(e))).length,c=[];a<s;)n=e[a],o&&bm(o,n)?++a:(o=K8(c=X8(c,n)),a=0);return o}function X8(e,n){var o,a;if(Mf(n,e))return[n];for(o=0;o<e.length;++o)if(gl(n,e[o])&&Mf(Yo(e[o],n),e))return[e[o],n];for(o=0;o<e.length-1;++o)for(a=o+1;a<e.length;++a)if(gl(Yo(e[o],e[a]),n)&&gl(Yo(e[o],n),e[a])&&gl(Yo(e[a],n),e[o])&&Mf(wm(e[o],e[a],n),e))return[e[o],e[a],n];throw new Error}function gl(e,n){var o=e.r-n.r,a=n.x-e.x,s=n.y-e.y;return o<0||o*o<a*a+s*s}function bm(e,n){var o=e.r-n.r+1e-6,a=n.x-e.x,s=n.y-e.y;return o>0&&o*o>a*a+s*s}function Mf(e,n){for(var o=0;o<n.length;++o)if(!bm(e,n[o]))return!1;return!0}function K8(e){switch(e.length){case 1:return{x:(n=e[0]).x,y:n.y,r:n.r};case 2:return Yo(e[0],e[1]);case 3:return wm(e[0],e[1],e[2])}var n}function Yo(e,n){var o=e.x,a=e.y,s=e.r,c=n.x,h=n.y,f=n.r,p=c-o,y=h-a,w=f-s,_=Math.sqrt(p*p+y*y);return{x:(o+c+p/_*w)/2,y:(a+h+y/_*w)/2,r:(_+s+f)/2}}function wm(e,n,o){var a=e.x,s=e.y,c=e.r,h=n.x,f=n.y,p=n.r,y=o.x,w=o.y,_=o.r,b=a-h,T=a-y,k=s-f,N=s-w,P=p-c,L=_-c,z=a*a+s*s-c*c,F=z-h*h-f*f+p*p,W=z-y*y-w*w+_*_,Y=T*k-b*N,ae=(k*W-N*F)/(2*Y)-a,ie=(N*P-k*L)/Y,ce=(T*F-b*W)/(2*Y)-s,G=(b*L-T*P)/Y,ne=ie*ie+G*G-1,oe=2*(c+ae*ie+ce*G),ee=ae*ae+ce*ce-c*c,q=-(ne?(oe+Math.sqrt(oe*oe-4*ne*ee))/(2*ne):ee/oe);return{x:a+ae+ie*q,y:s+ce+G*q,r:q}}function _m(e,n,o){var a,s,c,h,f=e.x-n.x,p=e.y-n.y,y=f*f+p*p;y?(s=n.r+o.r,s*=s,h=e.r+o.r,s>(h*=h)?(a=(y+h-s)/(2*y),c=Math.sqrt(Math.max(0,h/y-a*a)),o.x=e.x-a*f-c*p,o.y=e.y-a*p+c*f):(a=(y+s-h)/(2*y),c=Math.sqrt(Math.max(0,s/y-a*a)),o.x=n.x+a*f-c*p,o.y=n.y+a*p+c*f)):(o.x=n.x+o.r,o.y=n.y)}function vm(e,n){var o=e.r+n.r-1e-6,a=n.x-e.x,s=n.y-e.y;return o>0&&o*o>a*a+s*s}function xm(e){var n=e._,o=e.next._,a=n.r+o.r,s=(n.x*o.r+o.x*n.r)/a,c=(n.y*o.r+o.y*n.r)/a;return s*s+c*c}function ml(e){this._=e,this.next=null,this.previous=null}function Tm(e){if(!(s=e.length))return 0;var n,o,a,s,c,h,f,p,y,w,_;if((n=e[0]).x=0,n.y=0,!(s>1))return n.r;if(o=e[1],n.x=-o.r,o.x=n.r,o.y=0,!(s>2))return n.r+o.r;_m(o,n,a=e[2]),n=new ml(n),o=new ml(o),a=new ml(a),n.next=a.previous=o,o.next=n.previous=a,a.next=o.previous=n;e:for(f=3;f<s;++f){_m(n._,o._,a=e[f]),a=new ml(a),p=o.next,y=n.previous,w=o._.r,_=n._.r;do if(w<=_){if(vm(p._,a._)){o=p,n.next=o,o.previous=n,--f;continue e}w+=p._.r,p=p.next}else{if(vm(y._,a._)){(n=y).next=o,o.previous=n,--f;continue e}_+=y._.r,y=y.previous}while(p!==y.next);for(a.previous=n,a.next=o,n.next=o.previous=o=a,c=xm(n);(a=a.next)!==o;)(h=xm(a))<c&&(n=a,c=h);o=n.next}for(n=[o._],a=o;(a=a.next)!==o;)n.push(a._);for(a=ym(n),f=0;f<s;++f)(n=e[f]).x-=a.x,n.y-=a.y;return a.r}function yl(e){if(typeof e!="function")throw new Error;return e}function Or(){return 0}function xi(e){return function(){return e}}function J8(e){return Math.sqrt(e.value)}function Im(e){return function(n){n.children||(n.r=Math.max(0,+e(n)||0))}}function Df(e,n){return function(o){if(a=o.children){var a,s,c,h=a.length,f=e(o)*n||0;if(f)for(s=0;s<h;++s)a[s].r+=f;if(c=Tm(a),f)for(s=0;s<h;++s)a[s].r-=f;o.r=c+f}}}function Em(e){return function(n){var o=n.parent;n.r*=e,o&&(n.x=o.x+e*n.x,n.y=o.y+e*n.y)}}function km(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Qo(e,n,o,a,s){for(var c,h=e.children,f=-1,p=h.length,y=e.value&&(a-n)/e.value;++f<p;)(c=h[f]).y0=o,c.y1=s,c.x0=n,c.x1=n+=c.value*y}var Cm="$",Y8={depth:-1},Nm={};function Q8(e){return e.id}function e6(e){return e.parentId}function t6(e,n){return e.parent===n.parent?1:2}function Sf(e){var n=e.children;return n?n[0]:e.t}function Lf(e){var n=e.children;return n?n[n.length-1]:e.t}function n6(e,n,o){var a=o/(n.i-e.i);n.c-=a,n.s+=o,e.c+=a,n.z+=o,n.m+=o}function r6(e,n,o){return e.a.parent===n.parent?e.a:o}function bl(e,n){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=n}function wl(e,n,o,a,s){for(var c,h=e.children,f=-1,p=h.length,y=e.value&&(s-o)/e.value;++f<p;)(c=h[f]).x0=n,c.x1=a,c.y0=o,c.y1=o+=c.value*y}bl.prototype=Object.create(vi.prototype);var Am=(1+Math.sqrt(5))/2;function Mm(e,n,o,a,s,c){for(var h,f,p,y,w,_,b,T,k,N,P,L=[],z=n.children,F=0,W=0,Y=z.length,ae=n.value;F<Y;){p=s-o,y=c-a;do w=z[W++].value;while(!w&&W<Y);for(_=b=w,P=w*w*(N=Math.max(y/p,p/y)/(ae*e)),k=Math.max(b/P,P/_);W<Y;++W){if(w+=f=z[W].value,f<_&&(_=f),f>b&&(b=f),P=w*w*N,(T=Math.max(b/P,P/_))>k){w-=f;break}k=T}L.push(h={value:w,dice:p<y,children:z.slice(F,W)}),h.dice?Qo(h,o,a,s,ae?a+=y*w/ae:c):wl(h,o,a,ae?o+=p*w/ae:s,c),ae-=w,F=W}return L}var Dm=function e(n){function o(a,s,c,h,f){Mm(n,a,s,c,h,f)}return o.ratio=function(a){return e((a=+a)>1?a:1)},o}(Am),i6=function e(n){function o(a,s,c,h,f){if((p=a._squarify)&&p.ratio===n)for(var p,y,w,_,b,T=-1,k=p.length,N=a.value;++T<k;){for(w=(y=p[T]).children,_=y.value=0,b=w.length;_<b;++_)y.value+=w[_].value;y.dice?Qo(y,s,c,h,c+=(f-c)*y.value/N):wl(y,s,c,s+=(h-s)*y.value/N,f),N-=y.value}else a._squarify=p=Mm(n,a,s,c,h,f),p.ratio=n}return o.ratio=function(a){return e((a=+a)>1?a:1)},o}(Am);function o6(e,n){return e[0]-n[0]||e[1]-n[1]}function Sm(e){for(var n,o,a,s=e.length,c=[0,1],h=2,f=2;f<s;++f){for(;h>1&&(n=e[c[h-2]],o=e[c[h-1]],a=e[f],(o[0]-n[0])*(a[1]-n[1])-(o[1]-n[1])*(a[0]-n[0])<=0);)--h;c[h++]=f}return c.slice(0,h)}function Ti(){return Math.random()}var a6=function e(n){function o(a,s){return a=a==null?0:+a,s=s==null?1:+s,arguments.length===1?(s=a,a=0):s-=a,function(){return n()*s+a}}return o.source=e,o}(Ti),Lm=function e(n){function o(a,s){var c,h;return a=a==null?0:+a,s=s==null?1:+s,function(){var f;if(c!=null)f=c,c=null;else do c=2*n()-1,f=2*n()-1,h=c*c+f*f;while(!h||h>1);return a+s*f*Math.sqrt(-2*Math.log(h)/h)}}return o.source=e,o}(Ti),s6=function e(n){function o(){var a=Lm.source(n).apply(this,arguments);return function(){return Math.exp(a())}}return o.source=e,o}(Ti),Pm=function e(n){function o(a){return function(){for(var s=0,c=0;c<a;++c)s+=n();return s}}return o.source=e,o}(Ti),l6=function e(n){function o(a){var s=Pm.source(n)(a);return function(){return s()/a}}return o.source=e,o}(Ti),c6=function e(n){function o(a){return function(){return-Math.log(1-n())/a}}return o.source=e,o}(Ti);function sn(e,n){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(n).domain(e)}return this}function Un(e,n){switch(arguments.length){case 0:break;case 1:this.interpolator(e);break;default:this.interpolator(n).domain(e)}return this}var Om=Array.prototype,_l=Om.map,Rr=Om.slice,Pf={name:"implicit"};function Of(){var e=Rn(),n=[],o=[],a=Pf;function s(c){var h=c+"",f=e.get(h);if(!f){if(a!==Pf)return a;e.set(h,f=n.push(c))}return o[(f-1)%o.length]}return s.domain=function(c){if(!arguments.length)return n.slice();n=[],e=Rn();for(var h,f,p=-1,y=c.length;++p<y;)e.has(f=(h=c[p])+"")||e.set(f,n.push(h));return s},s.range=function(c){return arguments.length?(o=Rr.call(c),s):o.slice()},s.unknown=function(c){return arguments.length?(a=c,s):a},s.copy=function(){return Of(n,o).unknown(a)},sn.apply(s,arguments),s}function Rf(){var e,n,o=Of().unknown(void 0),a=o.domain,s=o.range,c=[0,1],h=!1,f=0,p=0,y=.5;function w(){var _=a().length,b=c[1]<c[0],T=c[b-0],k=c[1-b];e=(k-T)/Math.max(1,_-f+2*p),h&&(e=Math.floor(e)),T+=(k-T-e*(_-f))*y,n=e*(1-f),h&&(T=Math.round(T),n=Math.round(n));var N=$(_).map(function(P){return T+e*P});return s(b?N.reverse():N)}return delete o.unknown,o.domain=function(_){return arguments.length?(a(_),w()):a()},o.range=function(_){return arguments.length?(c=[+_[0],+_[1]],w()):c.slice()},o.rangeRound=function(_){return c=[+_[0],+_[1]],h=!0,w()},o.bandwidth=function(){return n},o.step=function(){return e},o.round=function(_){return arguments.length?(h=!!_,w()):h},o.padding=function(_){return arguments.length?(f=Math.min(1,p=+_),w()):f},o.paddingInner=function(_){return arguments.length?(f=Math.min(1,_),w()):f},o.paddingOuter=function(_){return arguments.length?(p=+_,w()):p},o.align=function(_){return arguments.length?(y=Math.max(0,Math.min(1,_)),w()):y},o.copy=function(){return Rf(a(),c).round(h).paddingInner(f).paddingOuter(p).align(y)},sn.apply(w(),arguments)}function Ff(e){return+e}var Rm=[0,1];function mt(e){return e}function Bf(e,n){return(n-=e=+e)?function(a){return(a-e)/n}:(o=isNaN(n)?NaN:.5,function(){return o});var o}function Fm(e){var n,o=e[0],a=e[e.length-1];return o>a&&(n=o,o=a,a=n),function(s){return Math.max(o,Math.min(a,s))}}function u6(e,n,o){var a=e[0],s=e[1],c=n[0],h=n[1];return s<a?(a=Bf(s,a),c=o(h,c)):(a=Bf(a,s),c=o(c,h)),function(f){return c(a(f))}}function f6(e,n,o){var a=Math.min(e.length,n.length)-1,s=new Array(a),c=new Array(a),h=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),n=n.slice().reverse());++h<a;)s[h]=Bf(e[h],e[h+1]),c[h]=o(n[h],n[h+1]);return function(f){var p=u(e,f,1,a)-1;return c[p](s[p](f))}}function ea(e,n){return n.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function vl(){var e,n,o,a,s,c,h=Rm,f=Rm,p=wo,y=mt;function w(){return a=Math.min(h.length,f.length)>2?f6:u6,s=c=null,_}function _(b){return isNaN(b=+b)?o:(s||(s=a(h.map(e),f,p)))(e(y(b)))}return _.invert=function(b){return y(n((c||(c=a(f,h.map(e),Wt)))(b)))},_.domain=function(b){return arguments.length?(h=_l.call(b,Ff),y===mt||(y=Fm(h)),w()):h.slice()},_.range=function(b){return arguments.length?(f=Rr.call(b),w()):f.slice()},_.rangeRound=function(b){return f=Rr.call(b),p=$p,w()},_.clamp=function(b){return arguments.length?(y=b?Fm(h):mt,_):y!==mt},_.interpolate=function(b){return arguments.length?(p=b,w()):p},_.unknown=function(b){return arguments.length?(o=b,_):o},function(b,T){return e=b,n=T,w()}}function Bm(e,n){return vl()(e,n)}function zm(e,n,o,a){var s,c=Z(e,n,o);switch((a=So(a??",f")).type){case"s":var h=Math.max(Math.abs(e),Math.abs(n));return a.precision!=null||isNaN(s=tg(c,h))||(a.precision=s),t.formatPrefix(a,h);case"":case"e":case"g":case"p":case"r":a.precision!=null||isNaN(s=ng(c,Math.max(Math.abs(e),Math.abs(n))))||(a.precision=s-(a.type==="e"));break;case"f":case"%":a.precision!=null||isNaN(s=eg(c))||(a.precision=s-2*(a.type==="%"))}return t.format(a)}function Fr(e){var n=e.domain;return e.ticks=function(o){var a=n();return D(a[0],a[a.length-1],o??10)},e.tickFormat=function(o,a){var s=n();return zm(s[0],s[s.length-1],o??10,a)},e.nice=function(o){o==null&&(o=10);var a,s=n(),c=0,h=s.length-1,f=s[c],p=s[h];return p<f&&(a=f,f=p,p=a,a=c,c=h,h=a),(a=A(f,p,o))>0?a=A(f=Math.floor(f/a)*a,p=Math.ceil(p/a)*a,o):a<0&&(a=A(f=Math.ceil(f*a)/a,p=Math.floor(p*a)/a,o)),a>0?(s[c]=Math.floor(f/a)*a,s[h]=Math.ceil(p/a)*a,n(s)):a<0&&(s[c]=Math.ceil(f*a)/a,s[h]=Math.floor(p*a)/a,n(s)),e},e}function qm(e,n){var o,a=0,s=(e=e.slice()).length-1,c=e[a],h=e[s];return h<c&&(o=a,a=s,s=o,o=c,c=h,h=o),e[a]=n.floor(c),e[s]=n.ceil(h),e}function Um(e){return Math.log(e)}function Zm(e){return Math.exp(e)}function h6(e){return-Math.log(-e)}function d6(e){return-Math.exp(-e)}function p6(e){return isFinite(e)?+("1e"+e):e<0?0:e}function jm(e){return function(n){return-e(-n)}}function zf(e){var n,o,a=e(Um,Zm),s=a.domain,c=10;function h(){return n=function(f){return f===Math.E?Math.log:f===10&&Math.log10||f===2&&Math.log2||(f=Math.log(f),function(p){return Math.log(p)/f})}(c),o=function(f){return f===10?p6:f===Math.E?Math.exp:function(p){return Math.pow(f,p)}}(c),s()[0]<0?(n=jm(n),o=jm(o),e(h6,d6)):e(Um,Zm),a}return a.base=function(f){return arguments.length?(c=+f,h()):c},a.domain=function(f){return arguments.length?(s(f),h()):s()},a.ticks=function(f){var p,y=s(),w=y[0],_=y[y.length-1];(p=_<w)&&(N=w,w=_,_=N);var b,T,k,N=n(w),P=n(_),L=f==null?10:+f,z=[];if(!(c%1)&&P-N<L){if(N=Math.round(N)-1,P=Math.round(P)+1,w>0){for(;N<P;++N)for(T=1,b=o(N);T<c;++T)if(!((k=b*T)<w)){if(k>_)break;z.push(k)}}else for(;N<P;++N)for(T=c-1,b=o(N);T>=1;--T)if(!((k=b*T)<w)){if(k>_)break;z.push(k)}}else z=D(N,P,Math.min(P-N,L)).map(o);return p?z.reverse():z},a.tickFormat=function(f,p){if(p==null&&(p=c===10?".0e":","),typeof p!="function"&&(p=t.format(p)),f===1/0)return p;f==null&&(f=10);var y=Math.max(1,c*f/a.ticks().length);return function(w){var _=w/o(Math.round(n(w)));return _*c<c-.5&&(_*=c),_<=y?p(w):""}},a.nice=function(){return s(qm(s(),{floor:function(f){return o(Math.floor(n(f)))},ceil:function(f){return o(Math.ceil(n(f)))}}))},a}function Hm(e){return function(n){return Math.sign(n)*Math.log1p(Math.abs(n/e))}}function $m(e){return function(n){return Math.sign(n)*Math.expm1(Math.abs(n))*e}}function qf(e){var n=1,o=e(Hm(n),$m(n));return o.constant=function(a){return arguments.length?e(Hm(n=+a),$m(n)):n},Fr(o)}function Vm(e){return function(n){return n<0?-Math.pow(-n,e):Math.pow(n,e)}}function g6(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function m6(e){return e<0?-e*e:e*e}function Uf(e){var n=e(mt,mt),o=1;return n.exponent=function(a){return arguments.length?(o=+a)==1?e(mt,mt):o===.5?e(g6,m6):e(Vm(o),Vm(1/o)):o},Fr(n)}function Zf(){var e=Uf(vl());return e.copy=function(){return ea(e,Zf()).exponent(e.exponent())},sn.apply(e,arguments),e}var jf=new Date,Hf=new Date;function ht(e,n,o,a){function s(c){return e(c=new Date(+c)),c}return s.floor=s,s.ceil=function(c){return e(c=new Date(c-1)),n(c,1),e(c),c},s.round=function(c){var h=s(c),f=s.ceil(c);return c-h<f-c?h:f},s.offset=function(c,h){return n(c=new Date(+c),h==null?1:Math.floor(h)),c},s.range=function(c,h,f){var p,y=[];if(c=s.ceil(c),f=f==null?1:Math.floor(f),!(c<h&&f>0))return y;do y.push(p=new Date(+c)),n(c,f),e(c);while(p<c&&c<h);return y},s.filter=function(c){return ht(function(h){if(h>=h)for(;e(h),!c(h);)h.setTime(h-1)},function(h,f){if(h>=h)if(f<0)for(;++f<=0;)for(;n(h,-1),!c(h););else for(;--f>=0;)for(;n(h,1),!c(h););})},o&&(s.count=function(c,h){return jf.setTime(+c),Hf.setTime(+h),e(jf),e(Hf),Math.floor(o(jf,Hf))},s.every=function(c){return c=Math.floor(c),isFinite(c)&&c>0?c>1?s.filter(a?function(h){return a(h)%c==0}:function(h){return s.count(0,h)%c==0}):s:null}),s}var Br=ht(function(){},function(e,n){e.setTime(+e+n)},function(e,n){return n-e});Br.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?ht(function(n){n.setTime(Math.floor(n/e)*e)},function(n,o){n.setTime(+n+o*e)},function(n,o){return(o-n)/e}):Br:null};var Wm=Br.range,zr=6e4,Gm=6048e5,ta=ht(function(e){e.setTime(e-e.getMilliseconds())},function(e,n){e.setTime(+e+1e3*n)},function(e,n){return(n-e)/1e3},function(e){return e.getUTCSeconds()}),Xm=ta.range,$f=ht(function(e){e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds())},function(e,n){e.setTime(+e+n*zr)},function(e,n){return(n-e)/zr},function(e){return e.getMinutes()}),y6=$f.range,Vf=ht(function(e){e.setTime(e-e.getMilliseconds()-1e3*e.getSeconds()-e.getMinutes()*zr)},function(e,n){e.setTime(+e+36e5*n)},function(e,n){return(n-e)/36e5},function(e){return e.getHours()}),b6=Vf.range,na=ht(function(e){e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+n)},function(e,n){return(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*zr)/864e5},function(e){return e.getDate()-1}),w6=na.range;function qr(e){return ht(function(n){n.setDate(n.getDate()-(n.getDay()+7-e)%7),n.setHours(0,0,0,0)},function(n,o){n.setDate(n.getDate()+7*o)},function(n,o){return(o-n-(o.getTimezoneOffset()-n.getTimezoneOffset())*zr)/Gm})}var ra=qr(0),ia=qr(1),Km=qr(2),Jm=qr(3),oa=qr(4),Ym=qr(5),Qm=qr(6),e1=ra.range,_6=ia.range,v6=Km.range,x6=Jm.range,T6=oa.range,I6=Ym.range,E6=Qm.range,Wf=ht(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,n){e.setMonth(e.getMonth()+n)},function(e,n){return n.getMonth()-e.getMonth()+12*(n.getFullYear()-e.getFullYear())},function(e){return e.getMonth()}),k6=Wf.range,Zn=ht(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n)},function(e,n){return n.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Zn.every=function(e){return isFinite(e=Math.floor(e))&&e>0?ht(function(n){n.setFullYear(Math.floor(n.getFullYear()/e)*e),n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,o){n.setFullYear(n.getFullYear()+o*e)}):null};var C6=Zn.range,Gf=ht(function(e){e.setUTCSeconds(0,0)},function(e,n){e.setTime(+e+n*zr)},function(e,n){return(n-e)/zr},function(e){return e.getUTCMinutes()}),N6=Gf.range,Xf=ht(function(e){e.setUTCMinutes(0,0,0)},function(e,n){e.setTime(+e+36e5*n)},function(e,n){return(n-e)/36e5},function(e){return e.getUTCHours()}),A6=Xf.range,aa=ht(function(e){e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+n)},function(e,n){return(n-e)/864e5},function(e){return e.getUTCDate()-1}),M6=aa.range;function Ur(e){return ht(function(n){n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-e)%7),n.setUTCHours(0,0,0,0)},function(n,o){n.setUTCDate(n.getUTCDate()+7*o)},function(n,o){return(o-n)/Gm})}var sa=Ur(0),la=Ur(1),t1=Ur(2),n1=Ur(3),ca=Ur(4),r1=Ur(5),i1=Ur(6),o1=sa.range,D6=la.range,S6=t1.range,L6=n1.range,P6=ca.range,O6=r1.range,R6=i1.range,Kf=ht(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCMonth(e.getUTCMonth()+n)},function(e,n){return n.getUTCMonth()-e.getUTCMonth()+12*(n.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),F6=Kf.range,jn=ht(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n)},function(e,n){return n.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});jn.every=function(e){return isFinite(e=Math.floor(e))&&e>0?ht(function(n){n.setUTCFullYear(Math.floor(n.getUTCFullYear()/e)*e),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,o){n.setUTCFullYear(n.getUTCFullYear()+o*e)}):null};var B6=jn.range;function z6(e){if(0<=e.y&&e.y<100){var n=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return n.setFullYear(e.y),n}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function xl(e){if(0<=e.y&&e.y<100){var n=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return n.setUTCFullYear(e.y),n}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ua(e){return{y:e,m:0,d:1,H:0,M:0,S:0,L:0}}function a1(e){var n=e.dateTime,o=e.date,a=e.time,s=e.periods,c=e.days,h=e.shortDays,f=e.months,p=e.shortMonths,y=fa(s),w=ha(s),_=fa(c),b=ha(c),T=fa(h),k=ha(h),N=fa(f),P=ha(f),L=fa(p),z=ha(p),F={a:function(G){return h[G.getDay()]},A:function(G){return c[G.getDay()]},b:function(G){return p[G.getMonth()]},B:function(G){return f[G.getMonth()]},c:null,d:u1,e:u1,f:c3,H:a3,I:s3,j:l3,L:f1,m:u3,M:f3,p:function(G){return s[+(G.getHours()>=12)]},Q:g1,s:m1,S:h3,u:d3,U:p3,V:g3,w:m3,W:y3,x:null,X:null,y:b3,Y:w3,Z:_3,"%":p1},W={a:function(G){return h[G.getUTCDay()]},A:function(G){return c[G.getUTCDay()]},b:function(G){return p[G.getUTCMonth()]},B:function(G){return f[G.getUTCMonth()]},c:null,d:h1,e:h1,f:I3,H:v3,I:x3,j:T3,L:d1,m:E3,M:k3,p:function(G){return s[+(G.getUTCHours()>=12)]},Q:g1,s:m1,S:C3,u:N3,U:A3,V:M3,w:D3,W:S3,x:null,X:null,y:L3,Y:P3,Z:O3,"%":p1},Y={a:function(G,ne,oe){var ee=T.exec(ne.slice(oe));return ee?(G.w=k[ee[0].toLowerCase()],oe+ee[0].length):-1},A:function(G,ne,oe){var ee=_.exec(ne.slice(oe));return ee?(G.w=b[ee[0].toLowerCase()],oe+ee[0].length):-1},b:function(G,ne,oe){var ee=L.exec(ne.slice(oe));return ee?(G.m=z[ee[0].toLowerCase()],oe+ee[0].length):-1},B:function(G,ne,oe){var ee=N.exec(ne.slice(oe));return ee?(G.m=P[ee[0].toLowerCase()],oe+ee[0].length):-1},c:function(G,ne,oe){return ce(G,n,ne,oe)},d:l1,e:l1,f:n3,H:c1,I:c1,j:Y6,L:t3,m:J6,M:Q6,p:function(G,ne,oe){var ee=y.exec(ne.slice(oe));return ee?(G.p=w[ee[0].toLowerCase()],oe+ee[0].length):-1},Q:i3,s:o3,S:e3,u:H6,U:$6,V:V6,w:j6,W:W6,x:function(G,ne,oe){return ce(G,o,ne,oe)},X:function(G,ne,oe){return ce(G,a,ne,oe)},y:X6,Y:G6,Z:K6,"%":r3};function ae(G,ne){return function(oe){var ee,q,Q,ue=[],he=-1,pe=0,Ee=G.length;for(oe instanceof Date||(oe=new Date(+oe));++he<Ee;)G.charCodeAt(he)===37&&(ue.push(G.slice(pe,he)),(q=s1[ee=G.charAt(++he)])!=null?ee=G.charAt(++he):q=ee==="e"?" ":"0",(Q=ne[ee])&&(ee=Q(oe,q)),ue.push(ee),pe=he+1);return ue.push(G.slice(pe,he)),ue.join("")}}function ie(G,ne){return function(oe){var ee,q,Q=ua(1900);if(ce(Q,G,oe+="",0)!=oe.length)return null;if("Q"in Q)return new Date(Q.Q);if("p"in Q&&(Q.H=Q.H%12+12*Q.p),"V"in Q){if(Q.V<1||Q.V>53)return null;"w"in Q||(Q.w=1),"Z"in Q?(q=(ee=xl(ua(Q.y))).getUTCDay(),ee=q>4||q===0?la.ceil(ee):la(ee),ee=aa.offset(ee,7*(Q.V-1)),Q.y=ee.getUTCFullYear(),Q.m=ee.getUTCMonth(),Q.d=ee.getUTCDate()+(Q.w+6)%7):(q=(ee=ne(ua(Q.y))).getDay(),ee=q>4||q===0?ia.ceil(ee):ia(ee),ee=na.offset(ee,7*(Q.V-1)),Q.y=ee.getFullYear(),Q.m=ee.getMonth(),Q.d=ee.getDate()+(Q.w+6)%7)}else("W"in Q||"U"in Q)&&("w"in Q||(Q.w="u"in Q?Q.u%7:"W"in Q?1:0),q="Z"in Q?xl(ua(Q.y)).getUTCDay():ne(ua(Q.y)).getDay(),Q.m=0,Q.d="W"in Q?(Q.w+6)%7+7*Q.W-(q+5)%7:Q.w+7*Q.U-(q+6)%7);return"Z"in Q?(Q.H+=Q.Z/100|0,Q.M+=Q.Z%100,xl(Q)):ne(Q)}}function ce(G,ne,oe,ee){for(var q,Q,ue=0,he=ne.length,pe=oe.length;ue<he;){if(ee>=pe)return-1;if((q=ne.charCodeAt(ue++))===37){if(q=ne.charAt(ue++),!(Q=Y[q in s1?ne.charAt(ue++):q])||(ee=Q(G,oe,ee))<0)return-1}else if(q!=oe.charCodeAt(ee++))return-1}return ee}return F.x=ae(o,F),F.X=ae(a,F),F.c=ae(n,F),W.x=ae(o,W),W.X=ae(a,W),W.c=ae(n,W),{format:function(G){var ne=ae(G+="",F);return ne.toString=function(){return G},ne},parse:function(G){var ne=ie(G+="",z6);return ne.toString=function(){return G},ne},utcFormat:function(G){var ne=ae(G+="",W);return ne.toString=function(){return G},ne},utcParse:function(G){var ne=ie(G,xl);return ne.toString=function(){return G},ne}}}var Ii,s1={"-":"",_:" ",0:"0"},yt=/^\s*\d+/,q6=/^%/,U6=/[\\^$*+?|[\]().{}]/g;function $e(e,n,o){var a=e<0?"-":"",s=(a?-e:e)+"",c=s.length;return a+(c<o?new Array(o-c+1).join(n)+s:s)}function Z6(e){return e.replace(U6,"\\$&")}function fa(e){return new RegExp("^(?:"+e.map(Z6).join("|")+")","i")}function ha(e){for(var n={},o=-1,a=e.length;++o<a;)n[e[o].toLowerCase()]=o;return n}function j6(e,n,o){var a=yt.exec(n.slice(o,o+1));return a?(e.w=+a[0],o+a[0].length):-1}function H6(e,n,o){var a=yt.exec(n.slice(o,o+1));return a?(e.u=+a[0],o+a[0].length):-1}function $6(e,n,o){var a=yt.exec(n.slice(o,o+2));return a?(e.U=+a[0],o+a[0].length):-1}function V6(e,n,o){var a=yt.exec(n.slice(o,o+2));return a?(e.V=+a[0],o+a[0].length):-1}function W6(e,n,o){var a=yt.exec(n.slice(o,o+2));return a?(e.W=+a[0],o+a[0].length):-1}function G6(e,n,o){var a=yt.exec(n.slice(o,o+4));return a?(e.y=+a[0],o+a[0].length):-1}function X6(e,n,o){var a=yt.exec(n.slice(o,o+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),o+a[0].length):-1}function K6(e,n,o){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(o,o+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),o+a[0].length):-1}function J6(e,n,o){var a=yt.exec(n.slice(o,o+2));return a?(e.m=a[0]-1,o+a[0].length):-1}function l1(e,n,o){var a=yt.exec(n.slice(o,o+2));return a?(e.d=+a[0],o+a[0].length):-1}function Y6(e,n,o){var a=yt.exec(n.slice(o,o+3));return a?(e.m=0,e.d=+a[0],o+a[0].length):-1}function c1(e,n,o){var a=yt.exec(n.slice(o,o+2));return a?(e.H=+a[0],o+a[0].length):-1}function Q6(e,n,o){var a=yt.exec(n.slice(o,o+2));return a?(e.M=+a[0],o+a[0].length):-1}function e3(e,n,o){var a=yt.exec(n.slice(o,o+2));return a?(e.S=+a[0],o+a[0].length):-1}function t3(e,n,o){var a=yt.exec(n.slice(o,o+3));return a?(e.L=+a[0],o+a[0].length):-1}function n3(e,n,o){var a=yt.exec(n.slice(o,o+6));return a?(e.L=Math.floor(a[0]/1e3),o+a[0].length):-1}function r3(e,n,o){var a=q6.exec(n.slice(o,o+1));return a?o+a[0].length:-1}function i3(e,n,o){var a=yt.exec(n.slice(o));return a?(e.Q=+a[0],o+a[0].length):-1}function o3(e,n,o){var a=yt.exec(n.slice(o));return a?(e.Q=1e3*+a[0],o+a[0].length):-1}function u1(e,n){return $e(e.getDate(),n,2)}function a3(e,n){return $e(e.getHours(),n,2)}function s3(e,n){return $e(e.getHours()%12||12,n,2)}function l3(e,n){return $e(1+na.count(Zn(e),e),n,3)}function f1(e,n){return $e(e.getMilliseconds(),n,3)}function c3(e,n){return f1(e,n)+"000"}function u3(e,n){return $e(e.getMonth()+1,n,2)}function f3(e,n){return $e(e.getMinutes(),n,2)}function h3(e,n){return $e(e.getSeconds(),n,2)}function d3(e){var n=e.getDay();return n===0?7:n}function p3(e,n){return $e(ra.count(Zn(e),e),n,2)}function g3(e,n){var o=e.getDay();return e=o>=4||o===0?oa(e):oa.ceil(e),$e(oa.count(Zn(e),e)+(Zn(e).getDay()===4),n,2)}function m3(e){return e.getDay()}function y3(e,n){return $e(ia.count(Zn(e),e),n,2)}function b3(e,n){return $e(e.getFullYear()%100,n,2)}function w3(e,n){return $e(e.getFullYear()%1e4,n,4)}function _3(e){var n=e.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+$e(n/60|0,"0",2)+$e(n%60,"0",2)}function h1(e,n){return $e(e.getUTCDate(),n,2)}function v3(e,n){return $e(e.getUTCHours(),n,2)}function x3(e,n){return $e(e.getUTCHours()%12||12,n,2)}function T3(e,n){return $e(1+aa.count(jn(e),e),n,3)}function d1(e,n){return $e(e.getUTCMilliseconds(),n,3)}function I3(e,n){return d1(e,n)+"000"}function E3(e,n){return $e(e.getUTCMonth()+1,n,2)}function k3(e,n){return $e(e.getUTCMinutes(),n,2)}function C3(e,n){return $e(e.getUTCSeconds(),n,2)}function N3(e){var n=e.getUTCDay();return n===0?7:n}function A3(e,n){return $e(sa.count(jn(e),e),n,2)}function M3(e,n){var o=e.getUTCDay();return e=o>=4||o===0?ca(e):ca.ceil(e),$e(ca.count(jn(e),e)+(jn(e).getUTCDay()===4),n,2)}function D3(e){return e.getUTCDay()}function S3(e,n){return $e(la.count(jn(e),e),n,2)}function L3(e,n){return $e(e.getUTCFullYear()%100,n,2)}function P3(e,n){return $e(e.getUTCFullYear()%1e4,n,4)}function O3(){return"+0000"}function p1(){return"%"}function g1(e){return+e}function m1(e){return Math.floor(+e/1e3)}function y1(e){return Ii=a1(e),t.timeFormat=Ii.format,t.timeParse=Ii.parse,t.utcFormat=Ii.utcFormat,t.utcParse=Ii.utcParse,Ii}y1({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var R3=Date.prototype.toISOString?function(e){return e.toISOString()}:t.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),F3=+new Date("2000-01-01T00:00:00.000Z")?function(e){var n=new Date(e);return isNaN(n)?null:n}:t.utcParse("%Y-%m-%dT%H:%M:%S.%LZ"),da=1e3,pa=60*da,ga=60*pa,ma=24*ga,B3=7*ma,b1=30*ma,Jf=365*ma;function z3(e){return new Date(e)}function q3(e){return e instanceof Date?+e:+new Date(+e)}function Yf(e,n,o,a,s,c,h,f,p){var y=Bm(mt,mt),w=y.invert,_=y.domain,b=p(".%L"),T=p(":%S"),k=p("%I:%M"),N=p("%I %p"),P=p("%a %d"),L=p("%b %d"),z=p("%B"),F=p("%Y"),W=[[h,1,da],[h,5,5*da],[h,15,15*da],[h,30,30*da],[c,1,pa],[c,5,5*pa],[c,15,15*pa],[c,30,30*pa],[s,1,ga],[s,3,3*ga],[s,6,6*ga],[s,12,12*ga],[a,1,ma],[a,2,2*ma],[o,1,B3],[n,1,b1],[n,3,3*b1],[e,1,Jf]];function Y(ie){return(h(ie)<ie?b:c(ie)<ie?T:s(ie)<ie?k:a(ie)<ie?N:n(ie)<ie?o(ie)<ie?P:L:e(ie)<ie?z:F)(ie)}function ae(ie,ce,G,ne){if(ie==null&&(ie=10),typeof ie=="number"){var oe=Math.abs(G-ce)/ie,ee=i(function(q){return q[2]}).right(W,oe);ee===W.length?(ne=Z(ce/Jf,G/Jf,ie),ie=e):ee?(ne=(ee=W[oe/W[ee-1][2]<W[ee][2]/oe?ee-1:ee])[1],ie=ee[0]):(ne=Math.max(Z(ce,G,ie),1),ie=f)}return ne==null?ie:ie.every(ne)}return y.invert=function(ie){return new Date(w(ie))},y.domain=function(ie){return arguments.length?_(_l.call(ie,q3)):_().map(z3)},y.ticks=function(ie,ce){var G,ne=_(),oe=ne[0],ee=ne[ne.length-1],q=ee<oe;return q&&(G=oe,oe=ee,ee=G),G=(G=ae(ie,oe,ee,ce))?G.range(oe,ee+1):[],q?G.reverse():G},y.tickFormat=function(ie,ce){return ce==null?Y:p(ce)},y.nice=function(ie,ce){var G=_();return(ie=ae(ie,G[0],G[G.length-1],ce))?_(qm(G,ie)):y},y.copy=function(){return ea(y,Yf(e,n,o,a,s,c,h,f,p))},y}function Tl(){var e,n,o,a,s,c=0,h=1,f=mt,p=!1;function y(w){return isNaN(w=+w)?s:f(o===0?.5:(w=(a(w)-e)*o,p?Math.max(0,Math.min(1,w)):w))}return y.domain=function(w){return arguments.length?(e=a(c=+w[0]),n=a(h=+w[1]),o=e===n?0:1/(n-e),y):[c,h]},y.clamp=function(w){return arguments.length?(p=!!w,y):p},y.interpolator=function(w){return arguments.length?(f=w,y):f},y.unknown=function(w){return arguments.length?(s=w,y):s},function(w){return a=w,e=w(c),n=w(h),o=e===n?0:1/(n-e),y}}function cr(e,n){return n.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Qf(){var e=Uf(Tl());return e.copy=function(){return cr(e,Qf()).exponent(e.exponent())},Un.apply(e,arguments)}function Il(){var e,n,o,a,s,c,h,f=0,p=.5,y=1,w=mt,_=!1;function b(T){return isNaN(T=+T)?h:(T=.5+((T=+c(T))-n)*(T<n?a:s),w(_?Math.max(0,Math.min(1,T)):T))}return b.domain=function(T){return arguments.length?(e=c(f=+T[0]),n=c(p=+T[1]),o=c(y=+T[2]),a=e===n?0:.5/(n-e),s=n===o?0:.5/(o-n),b):[f,p,y]},b.clamp=function(T){return arguments.length?(_=!!T,b):_},b.interpolator=function(T){return arguments.length?(w=T,b):w},b.unknown=function(T){return arguments.length?(h=T,b):h},function(T){return c=T,e=T(f),n=T(p),o=T(y),a=e===n?0:.5/(n-e),s=n===o?0:.5/(o-n),b}}function eh(){var e=Uf(Il());return e.copy=function(){return cr(e,eh()).exponent(e.exponent())},Un.apply(e,arguments)}function Me(e){for(var n=e.length/6|0,o=new Array(n),a=0;a<n;)o[a]="#"+e.slice(6*a,6*++a);return o}var U3=Me("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Z3=Me("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),j3=Me("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),H3=Me("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),$3=Me("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),V3=Me("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),W3=Me("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),G3=Me("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),X3=Me("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");function Xe(e){return Up(e[e.length-1])}var w1=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Me),K3=Xe(w1),_1=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Me),J3=Xe(_1),v1=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Me),Y3=Xe(v1),x1=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Me),Q3=Xe(x1),T1=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Me),eT=Xe(T1),I1=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Me),tT=Xe(I1),E1=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Me),nT=Xe(E1),k1=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Me),rT=Xe(k1),C1=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Me),iT=Xe(C1),N1=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Me),oT=Xe(N1),A1=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Me),aT=Xe(A1),M1=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Me),sT=Xe(M1),D1=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Me),lT=Xe(D1),S1=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Me),cT=Xe(S1),L1=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Me),uT=Xe(L1),P1=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Me),fT=Xe(P1),O1=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Me),hT=Xe(O1),R1=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Me),dT=Xe(R1),F1=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Me),pT=Xe(F1),B1=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Me),gT=Xe(B1),z1=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Me),mT=Xe(z1),q1=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Me),yT=Xe(q1),U1=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Me),bT=Xe(U1),Z1=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Me),wT=Xe(Z1),j1=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Me),_T=Xe(j1),H1=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Me),vT=Xe(H1),$1=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Me),xT=Xe($1),TT=hs(nn(300,.5,0),nn(-240,.5,1)),IT=hs(nn(-100,.75,.35),nn(80,1.5,.8)),ET=hs(nn(260,.75,.35),nn(80,1.5,.8)),El=nn(),kl=oi(),kT=Math.PI/3,CT=2*Math.PI/3;function Cl(e){var n=e.length;return function(o){return e[Math.max(0,Math.min(n-1,Math.floor(o*n)))]}}var NT=Cl(Me("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),AT=Cl(Me("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),MT=Cl(Me("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),DT=Cl(Me("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function De(e){return function(){return e}}var V1=Math.abs,wt=Math.atan2,Zr=Math.cos,ST=Math.max,th=Math.min,_n=Math.sin,Ei=Math.sqrt,_t=1e-12,ur=Math.PI,Nl=ur/2,fr=2*ur;function W1(e){return e>=1?Nl:e<=-1?-Nl:Math.asin(e)}function LT(e){return e.innerRadius}function PT(e){return e.outerRadius}function OT(e){return e.startAngle}function RT(e){return e.endAngle}function FT(e){return e&&e.padAngle}function Al(e,n,o,a,s,c,h){var f=e-o,p=n-a,y=(h?c:-c)/Ei(f*f+p*p),w=y*p,_=-y*f,b=e+w,T=n+_,k=o+w,N=a+_,P=(b+k)/2,L=(T+N)/2,z=k-b,F=N-T,W=z*z+F*F,Y=s-c,ae=b*N-k*T,ie=(F<0?-1:1)*Ei(ST(0,Y*Y*W-ae*ae)),ce=(ae*F-z*ie)/W,G=(-ae*z-F*ie)/W,ne=(ae*F+z*ie)/W,oe=(-ae*z+F*ie)/W,ee=ce-P,q=G-L,Q=ne-P,ue=oe-L;return ee*ee+q*q>Q*Q+ue*ue&&(ce=ne,G=oe),{cx:ce,cy:G,x01:-w,y01:-_,x11:ce*(s/Y-1),y11:G*(s/Y-1)}}function G1(e){this._context=e}function Ml(e){return new G1(e)}function nh(e){return e[0]}function rh(e){return e[1]}function ih(){var e=nh,n=rh,o=De(!0),a=null,s=Ml,c=null;function h(f){var p,y,w,_=f.length,b=!1;for(a==null&&(c=s(w=ir())),p=0;p<=_;++p)!(p<_&&o(y=f[p],p,f))===b&&((b=!b)?c.lineStart():c.lineEnd()),b&&c.point(+e(y,p,f),+n(y,p,f));if(w)return c=null,w+""||null}return h.x=function(f){return arguments.length?(e=typeof f=="function"?f:De(+f),h):e},h.y=function(f){return arguments.length?(n=typeof f=="function"?f:De(+f),h):n},h.defined=function(f){return arguments.length?(o=typeof f=="function"?f:De(!!f),h):o},h.curve=function(f){return arguments.length?(s=f,a!=null&&(c=s(a)),h):s},h.context=function(f){return arguments.length?(f==null?a=c=null:c=s(a=f),h):a},h}function X1(){var e=nh,n=null,o=De(0),a=rh,s=De(!0),c=null,h=Ml,f=null;function p(w){var _,b,T,k,N,P=w.length,L=!1,z=new Array(P),F=new Array(P);for(c==null&&(f=h(N=ir())),_=0;_<=P;++_){if(!(_<P&&s(k=w[_],_,w))===L)if(L=!L)b=_,f.areaStart(),f.lineStart();else{for(f.lineEnd(),f.lineStart(),T=_-1;T>=b;--T)f.point(z[T],F[T]);f.lineEnd(),f.areaEnd()}L&&(z[_]=+e(k,_,w),F[_]=+o(k,_,w),f.point(n?+n(k,_,w):z[_],a?+a(k,_,w):F[_]))}if(N)return f=null,N+""||null}function y(){return ih().defined(s).curve(h).context(c)}return p.x=function(w){return arguments.length?(e=typeof w=="function"?w:De(+w),n=null,p):e},p.x0=function(w){return arguments.length?(e=typeof w=="function"?w:De(+w),p):e},p.x1=function(w){return arguments.length?(n=w==null?null:typeof w=="function"?w:De(+w),p):n},p.y=function(w){return arguments.length?(o=typeof w=="function"?w:De(+w),a=null,p):o},p.y0=function(w){return arguments.length?(o=typeof w=="function"?w:De(+w),p):o},p.y1=function(w){return arguments.length?(a=w==null?null:typeof w=="function"?w:De(+w),p):a},p.lineX0=p.lineY0=function(){return y().x(e).y(o)},p.lineY1=function(){return y().x(e).y(a)},p.lineX1=function(){return y().x(n).y(o)},p.defined=function(w){return arguments.length?(s=typeof w=="function"?w:De(!!w),p):s},p.curve=function(w){return arguments.length?(h=w,c!=null&&(f=h(c)),p):h},p.context=function(w){return arguments.length?(w==null?c=f=null:f=h(c=w),p):c},p}function BT(e,n){return n<e?-1:n>e?1:n>=e?0:NaN}function zT(e){return e}G1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:this._context.lineTo(e,n)}}};var K1=oh(Ml);function J1(e){this._curve=e}function oh(e){function n(o){return new J1(e(o))}return n._curve=e,n}function ya(e){var n=e.curve;return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e.curve=function(o){return arguments.length?n(oh(o)):n()._curve},e}function Y1(){return ya(ih().curve(K1))}function Q1(){var e=X1().curve(K1),n=e.curve,o=e.lineX0,a=e.lineX1,s=e.lineY0,c=e.lineY1;return e.angle=e.x,delete e.x,e.startAngle=e.x0,delete e.x0,e.endAngle=e.x1,delete e.x1,e.radius=e.y,delete e.y,e.innerRadius=e.y0,delete e.y0,e.outerRadius=e.y1,delete e.y1,e.lineStartAngle=function(){return ya(o())},delete e.lineX0,e.lineEndAngle=function(){return ya(a())},delete e.lineX1,e.lineInnerRadius=function(){return ya(s())},delete e.lineY0,e.lineOuterRadius=function(){return ya(c())},delete e.lineY1,e.curve=function(h){return arguments.length?n(oh(h)):n()._curve},e}function ba(e,n){return[(n=+n)*Math.cos(e-=Math.PI/2),n*Math.sin(e)]}J1.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,n){this._curve.point(n*Math.sin(e),n*-Math.cos(e))}};var ah=Array.prototype.slice;function qT(e){return e.source}function UT(e){return e.target}function sh(e){var n=qT,o=UT,a=nh,s=rh,c=null;function h(){var f,p=ah.call(arguments),y=n.apply(this,p),w=o.apply(this,p);if(c||(c=f=ir()),e(c,+a.apply(this,(p[0]=y,p)),+s.apply(this,p),+a.apply(this,(p[0]=w,p)),+s.apply(this,p)),f)return c=null,f+""||null}return h.source=function(f){return arguments.length?(n=f,h):n},h.target=function(f){return arguments.length?(o=f,h):o},h.x=function(f){return arguments.length?(a=typeof f=="function"?f:De(+f),h):a},h.y=function(f){return arguments.length?(s=typeof f=="function"?f:De(+f),h):s},h.context=function(f){return arguments.length?(c=f??null,h):c},h}function ZT(e,n,o,a,s){e.moveTo(n,o),e.bezierCurveTo(n=(n+a)/2,o,n,s,a,s)}function jT(e,n,o,a,s){e.moveTo(n,o),e.bezierCurveTo(n,o=(o+s)/2,a,o,a,s)}function HT(e,n,o,a,s){var c=ba(n,o),h=ba(n,o=(o+s)/2),f=ba(a,o),p=ba(a,s);e.moveTo(c[0],c[1]),e.bezierCurveTo(h[0],h[1],f[0],f[1],p[0],p[1])}var lh={draw:function(e,n){var o=Math.sqrt(n/ur);e.moveTo(o,0),e.arc(0,0,o,0,fr)}},ey={draw:function(e,n){var o=Math.sqrt(n/5)/2;e.moveTo(-3*o,-o),e.lineTo(-o,-o),e.lineTo(-o,-3*o),e.lineTo(o,-3*o),e.lineTo(o,-o),e.lineTo(3*o,-o),e.lineTo(3*o,o),e.lineTo(o,o),e.lineTo(o,3*o),e.lineTo(-o,3*o),e.lineTo(-o,o),e.lineTo(-3*o,o),e.closePath()}},ty=Math.sqrt(1/3),$T=2*ty,ny={draw:function(e,n){var o=Math.sqrt(n/$T),a=o*ty;e.moveTo(0,-o),e.lineTo(a,0),e.lineTo(0,o),e.lineTo(-a,0),e.closePath()}},ry=Math.sin(ur/10)/Math.sin(7*ur/10),VT=Math.sin(fr/10)*ry,WT=-Math.cos(fr/10)*ry,iy={draw:function(e,n){var o=Math.sqrt(.8908130915292852*n),a=VT*o,s=WT*o;e.moveTo(0,-o),e.lineTo(a,s);for(var c=1;c<5;++c){var h=fr*c/5,f=Math.cos(h),p=Math.sin(h);e.lineTo(p*o,-f*o),e.lineTo(f*a-p*s,p*a+f*s)}e.closePath()}},oy={draw:function(e,n){var o=Math.sqrt(n),a=-o/2;e.rect(a,a,o,o)}},ch=Math.sqrt(3),ay={draw:function(e,n){var o=-Math.sqrt(n/(3*ch));e.moveTo(0,2*o),e.lineTo(-ch*o,-o),e.lineTo(ch*o,-o),e.closePath()}},Kt=Math.sqrt(3)/2,uh=1/Math.sqrt(12),GT=3*(uh/2+1),sy={draw:function(e,n){var o=Math.sqrt(n/GT),a=o/2,s=o*uh,c=a,h=o*uh+o,f=-c,p=h;e.moveTo(a,s),e.lineTo(c,h),e.lineTo(f,p),e.lineTo(-.5*a-Kt*s,Kt*a+-.5*s),e.lineTo(-.5*c-Kt*h,Kt*c+-.5*h),e.lineTo(-.5*f-Kt*p,Kt*f+-.5*p),e.lineTo(-.5*a+Kt*s,-.5*s-Kt*a),e.lineTo(-.5*c+Kt*h,-.5*h-Kt*c),e.lineTo(-.5*f+Kt*p,-.5*p-Kt*f),e.closePath()}},XT=[lh,ey,ny,oy,iy,ay,sy];function hr(){}function Dl(e,n,o){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+n)/6,(e._y0+4*e._y1+o)/6)}function Sl(e){this._context=e}function ly(e){this._context=e}function cy(e){this._context=e}function uy(e,n){this._basis=new Sl(e),this._beta=n}Sl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Dl(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Dl(this,e,n)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=n}},ly.prototype={areaStart:hr,areaEnd:hr,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._x2=e,this._y2=n;break;case 1:this._point=2,this._x3=e,this._y3=n;break;case 2:this._point=3,this._x4=e,this._y4=n,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+n)/6);break;default:Dl(this,e,n)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=n}},cy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var o=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+n)/6;this._line?this._context.lineTo(o,a):this._context.moveTo(o,a);break;case 3:this._point=4;default:Dl(this,e,n)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=n}},uy.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,n=this._y,o=e.length-1;if(o>0)for(var a,s=e[0],c=n[0],h=e[o]-s,f=n[o]-c,p=-1;++p<=o;)a=p/o,this._basis.point(this._beta*e[p]+(1-this._beta)*(s+a*h),this._beta*n[p]+(1-this._beta)*(c+a*f));this._x=this._y=null,this._basis.lineEnd()},point:function(e,n){this._x.push(+e),this._y.push(+n)}};var KT=function e(n){function o(a){return n===1?new Sl(a):new uy(a,n)}return o.beta=function(a){return e(+a)},o}(.85);function Ll(e,n,o){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-n),e._y2+e._k*(e._y1-o),e._x2,e._y2)}function fh(e,n){this._context=e,this._k=(1-n)/6}fh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ll(this,this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2,this._x1=e,this._y1=n;break;case 2:this._point=3;default:Ll(this,e,n)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var JT=function e(n){function o(a){return new fh(a,n)}return o.tension=function(a){return e(+a)},o}(0);function hh(e,n){this._context=e,this._k=(1-n)/6}hh.prototype={areaStart:hr,areaEnd:hr,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._x3=e,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=n);break;case 2:this._point=3,this._x5=e,this._y5=n;break;default:Ll(this,e,n)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var YT=function e(n){function o(a){return new hh(a,n)}return o.tension=function(a){return e(+a)},o}(0);function dh(e,n){this._context=e,this._k=(1-n)/6}dh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ll(this,e,n)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var QT=function e(n){function o(a){return new dh(a,n)}return o.tension=function(a){return e(+a)},o}(0);function ph(e,n,o){var a=e._x1,s=e._y1,c=e._x2,h=e._y2;if(e._l01_a>_t){var f=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,p=3*e._l01_a*(e._l01_a+e._l12_a);a=(a*f-e._x0*e._l12_2a+e._x2*e._l01_2a)/p,s=(s*f-e._y0*e._l12_2a+e._y2*e._l01_2a)/p}if(e._l23_a>_t){var y=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,w=3*e._l23_a*(e._l23_a+e._l12_a);c=(c*y+e._x1*e._l23_2a-n*e._l12_2a)/w,h=(h*y+e._y1*e._l23_2a-o*e._l12_2a)/w}e._context.bezierCurveTo(a,s,c,h,e._x2,e._y2)}function fy(e,n){this._context=e,this._alpha=n}fy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){if(e=+e,n=+n,this._point){var o=this._x2-e,a=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(o*o+a*a,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;break;case 2:this._point=3;default:ph(this,e,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var eI=function e(n){function o(a){return n?new fy(a,n):new fh(a,0)}return o.alpha=function(a){return e(+a)},o}(.5);function hy(e,n){this._context=e,this._alpha=n}hy.prototype={areaStart:hr,areaEnd:hr,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,n){if(e=+e,n=+n,this._point){var o=this._x2-e,a=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(o*o+a*a,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=n;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=n);break;case 2:this._point=3,this._x5=e,this._y5=n;break;default:ph(this,e,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var tI=function e(n){function o(a){return n?new hy(a,n):new hh(a,0)}return o.alpha=function(a){return e(+a)},o}(.5);function dy(e,n){this._context=e,this._alpha=n}dy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){if(e=+e,n=+n,this._point){var o=this._x2-e,a=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(o*o+a*a,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ph(this,e,n)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var nI=function e(n){function o(a){return n?new dy(a,n):new dh(a,0)}return o.alpha=function(a){return e(+a)},o}(.5);function py(e){this._context=e}function gy(e){return e<0?-1:1}function my(e,n,o){var a=e._x1-e._x0,s=n-e._x1,c=(e._y1-e._y0)/(a||s<0&&-0),h=(o-e._y1)/(s||a<0&&-0),f=(c*s+h*a)/(a+s);return(gy(c)+gy(h))*Math.min(Math.abs(c),Math.abs(h),.5*Math.abs(f))||0}function yy(e,n){var o=e._x1-e._x0;return o?(3*(e._y1-e._y0)/o-n)/2:n}function gh(e,n,o){var a=e._x0,s=e._y0,c=e._x1,h=e._y1,f=(c-a)/3;e._context.bezierCurveTo(a+f,s+f*n,c-f,h-f*o,c,h)}function Pl(e){this._context=e}function by(e){this._context=new wy(e)}function wy(e){this._context=e}function _y(e){this._context=e}function vy(e){var n,o,a=e.length-1,s=new Array(a),c=new Array(a),h=new Array(a);for(s[0]=0,c[0]=2,h[0]=e[0]+2*e[1],n=1;n<a-1;++n)s[n]=1,c[n]=4,h[n]=4*e[n]+2*e[n+1];for(s[a-1]=2,c[a-1]=7,h[a-1]=8*e[a-1]+e[a],n=1;n<a;++n)o=s[n]/c[n-1],c[n]-=o,h[n]-=o*h[n-1];for(s[a-1]=h[a-1]/c[a-1],n=a-2;n>=0;--n)s[n]=(h[n]-s[n+1])/c[n];for(c[a-1]=(e[a]+s[a-1])/2,n=0;n<a-1;++n)c[n]=2*e[n+1]-s[n+1];return[s,c]}function Ol(e,n){this._context=e,this._t=n}function ki(e,n){if((s=e.length)>1)for(var o,a,s,c=1,h=e[n[0]],f=h.length;c<s;++c)for(a=h,h=e[n[c]],o=0;o<f;++o)h[o][1]+=h[o][0]=isNaN(a[o][1])?a[o][0]:a[o][1]}function Ci(e){for(var n=e.length,o=new Array(n);--n>=0;)o[n]=n;return o}function rI(e,n){return e[n]}function xy(e){var n=e.map(iI);return Ci(e).sort(function(o,a){return n[o]-n[a]})}function iI(e){for(var n,o=-1,a=0,s=e.length,c=-1/0;++o<s;)(n=+e[o][1])>c&&(c=n,a=o);return a}function Ty(e){var n=e.map(Iy);return Ci(e).sort(function(o,a){return n[o]-n[a]})}function Iy(e){for(var n,o=0,a=-1,s=e.length;++a<s;)(n=+e[a][1])&&(o+=n);return o}function Ey(e){return function(){return e}}function oI(e){return e[0]}function aI(e){return e[1]}function Rl(){this._=null}function Fl(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function wa(e,n){var o=n,a=n.R,s=o.U;s?s.L===o?s.L=a:s.R=a:e._=a,a.U=s,o.U=a,o.R=a.L,o.R&&(o.R.U=o),a.L=o}function _a(e,n){var o=n,a=n.L,s=o.U;s?s.L===o?s.L=a:s.R=a:e._=a,a.U=s,o.U=a,o.L=a.R,o.L&&(o.L.U=o),a.R=o}function ky(e){for(;e.L;)e=e.L;return e}function va(e,n,o,a){var s=[null,null],c=vt.push(s)-1;return s.left=e,s.right=n,o&&Bl(s,e,n,o),a&&Bl(s,n,e,a),Zt[e.index].halfedges.push(c),Zt[n.index].halfedges.push(c),s}function xa(e,n,o){var a=[n,o];return a.left=e,a}function Bl(e,n,o,a){e[0]||e[1]?e.left===o?e[1]=a:e[0]=a:(e[0]=a,e.left=n,e.right=o)}function sI(e,n,o,a,s){var c,h=e[0],f=e[1],p=h[0],y=h[1],w=0,_=1,b=f[0]-p,T=f[1]-y;if(c=n-p,b||!(c>0)){if(c/=b,b<0){if(c<w)return;c<_&&(_=c)}else if(b>0){if(c>_)return;c>w&&(w=c)}if(c=a-p,b||!(c<0)){if(c/=b,b<0){if(c>_)return;c>w&&(w=c)}else if(b>0){if(c<w)return;c<_&&(_=c)}if(c=o-y,T||!(c>0)){if(c/=T,T<0){if(c<w)return;c<_&&(_=c)}else if(T>0){if(c>_)return;c>w&&(w=c)}if(c=s-y,T||!(c<0)){if(c/=T,T<0){if(c>_)return;c>w&&(w=c)}else if(T>0){if(c<w)return;c<_&&(_=c)}return!(w>0||_<1)||(w>0&&(e[0]=[p+w*b,y+w*T]),_<1&&(e[1]=[p+_*b,y+_*T]),!0)}}}}}function lI(e,n,o,a,s){var c=e[1];if(c)return!0;var h,f,p=e[0],y=e.left,w=e.right,_=y[0],b=y[1],T=w[0],k=w[1],N=(_+T)/2,P=(b+k)/2;if(k===b){if(N<n||N>=a)return;if(_>T){if(p){if(p[1]>=s)return}else p=[N,o];c=[N,s]}else{if(p){if(p[1]<o)return}else p=[N,s];c=[N,o]}}else if(f=P-(h=(_-T)/(k-b))*N,h<-1||h>1)if(_>T){if(p){if(p[1]>=s)return}else p=[(o-f)/h,o];c=[(s-f)/h,s]}else{if(p){if(p[1]<o)return}else p=[(s-f)/h,s];c=[(o-f)/h,o]}else if(b<k){if(p){if(p[0]>=a)return}else p=[n,h*n+f];c=[a,h*a+f]}else{if(p){if(p[0]<n)return}else p=[a,h*a+f];c=[n,h*n+f]}return e[0]=p,e[1]=c,!0}function cI(e,n){var o=e.site,a=n.left,s=n.right;return o===s&&(s=a,a=o),s?Math.atan2(s[1]-a[1],s[0]-a[0]):(o===a?(a=n[1],s=n[0]):(a=n[0],s=n[1]),Math.atan2(a[0]-s[0],s[1]-a[1]))}function Cy(e,n){return n[+(n.left!==e.site)]}function uI(e,n){return n[+(n.left===e.site)]}py.prototype={areaStart:hr,areaEnd:hr,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,n){e=+e,n=+n,this._point?this._context.lineTo(e,n):(this._point=1,this._context.moveTo(e,n))}},Pl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:gh(this,this._t0,yy(this,this._t0))}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){var o=NaN;if(n=+n,(e=+e)!==this._x1||n!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;break;case 2:this._point=3,gh(this,yy(this,o=my(this,e,n)),o);break;default:gh(this,this._t0,o=my(this,e,n))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=n,this._t0=o}}},(by.prototype=Object.create(Pl.prototype)).point=function(e,n){Pl.prototype.point.call(this,n,e)},wy.prototype={moveTo:function(e,n){this._context.moveTo(n,e)},closePath:function(){this._context.closePath()},lineTo:function(e,n){this._context.lineTo(n,e)},bezierCurveTo:function(e,n,o,a,s,c){this._context.bezierCurveTo(n,e,a,o,c,s)}},_y.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,n=this._y,o=e.length;if(o)if(this._line?this._context.lineTo(e[0],n[0]):this._context.moveTo(e[0],n[0]),o===2)this._context.lineTo(e[1],n[1]);else for(var a=vy(e),s=vy(n),c=0,h=1;h<o;++c,++h)this._context.bezierCurveTo(a[0][c],s[0][c],a[1][c],s[1][c],e[h],n[h]);(this._line||this._line!==0&&o===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,n){this._x.push(+e),this._y.push(+n)}},Ol.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,n),this._context.lineTo(e,n);else{var o=this._x*(1-this._t)+e*this._t;this._context.lineTo(o,this._y),this._context.lineTo(o,n)}}this._x=e,this._y=n}},Rl.prototype={constructor:Rl,insert:function(e,n){var o,a,s;if(e){if(n.P=e,n.N=e.N,e.N&&(e.N.P=n),e.N=n,e.R){for(e=e.R;e.L;)e=e.L;e.L=n}else e.R=n;o=e}else this._?(e=ky(this._),n.P=null,n.N=e,e.P=e.L=n,o=e):(n.P=n.N=null,this._=n,o=null);for(n.L=n.R=null,n.U=o,n.C=!0,e=n;o&&o.C;)o===(a=o.U).L?(s=a.R)&&s.C?(o.C=s.C=!1,a.C=!0,e=a):(e===o.R&&(wa(this,o),o=(e=o).U),o.C=!1,a.C=!0,_a(this,a)):(s=a.L)&&s.C?(o.C=s.C=!1,a.C=!0,e=a):(e===o.L&&(_a(this,o),o=(e=o).U),o.C=!1,a.C=!0,wa(this,a)),o=e.U;this._.C=!1},remove:function(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var n,o,a,s=e.U,c=e.L,h=e.R;if(o=c?h?ky(h):c:h,s?s.L===e?s.L=o:s.R=o:this._=o,c&&h?(a=o.C,o.C=e.C,o.L=c,c.U=o,o!==h?(s=o.U,o.U=e.U,e=o.R,s.L=e,o.R=h,h.U=o):(o.U=s,s=o,e=o.R)):(a=e.C,e=o),e&&(e.U=s),!a)if(e&&e.C)e.C=!1;else{do{if(e===this._)break;if(e===s.L){if((n=s.R).C&&(n.C=!1,s.C=!0,wa(this,s),n=s.R),n.L&&n.L.C||n.R&&n.R.C){n.R&&n.R.C||(n.L.C=!1,n.C=!0,_a(this,n),n=s.R),n.C=s.C,s.C=n.R.C=!1,wa(this,s),e=this._;break}}else if((n=s.L).C&&(n.C=!1,s.C=!0,_a(this,s),n=s.L),n.L&&n.L.C||n.R&&n.R.C){n.L&&n.L.C||(n.R.C=!1,n.C=!0,wa(this,n),n=s.L),n.C=s.C,s.C=n.L.C=!1,_a(this,s),e=this._;break}n.C=!0,e=s,s=s.U}while(!e.C);e&&(e.C=!1)}}};var mh,Ny=[];function fI(){Fl(this),this.x=this.y=this.arc=this.site=this.cy=null}function Ni(e){var n=e.P,o=e.N;if(n&&o){var a=n.site,s=e.site,c=o.site;if(a!==c){var h=s[0],f=s[1],p=a[0]-h,y=a[1]-f,w=c[0]-h,_=c[1]-f,b=2*(p*_-y*w);if(!(b>=-mI)){var T=p*p+y*y,k=w*w+_*_,N=(_*T-y*k)/b,P=(p*k-w*T)/b,L=Ny.pop()||new fI;L.arc=e,L.site=s,L.x=N+h,L.y=(L.cy=P+f)+Math.sqrt(N*N+P*P),e.circle=L;for(var z=null,F=Ta._;F;)if(L.y<F.y||L.y===F.y&&L.x<=F.x){if(!F.L){z=F.P;break}F=F.L}else{if(!F.R){z=F;break}F=F.R}Ta.insert(z,L),z||(mh=L)}}}}function Ai(e){var n=e.circle;n&&(n.P||(mh=n.N),Ta.remove(n),Ny.push(n),Fl(n),e.circle=null)}var Ay=[];function hI(){Fl(this),this.edge=this.site=this.circle=null}function My(e){var n=Ay.pop()||new hI;return n.site=e,n}function yh(e){Ai(e),Mi.remove(e),Ay.push(e),Fl(e)}function dI(e){var n=e.circle,o=n.x,a=n.cy,s=[o,a],c=e.P,h=e.N,f=[e];yh(e);for(var p=c;p.circle&&Math.abs(o-p.circle.x)<Ve&&Math.abs(a-p.circle.cy)<Ve;)c=p.P,f.unshift(p),yh(p),p=c;f.unshift(p),Ai(p);for(var y=h;y.circle&&Math.abs(o-y.circle.x)<Ve&&Math.abs(a-y.circle.cy)<Ve;)h=y.N,f.push(y),yh(y),y=h;f.push(y),Ai(y);var w,_=f.length;for(w=1;w<_;++w)y=f[w],p=f[w-1],Bl(y.edge,p.site,y.site,s);p=f[0],(y=f[_-1]).edge=va(p.site,y.site,null,s),Ni(p),Ni(y)}function pI(e){for(var n,o,a,s,c=e[0],h=e[1],f=Mi._;f;)if((a=Dy(f,h)-c)>Ve)f=f.L;else{if(!((s=c-gI(f,h))>Ve)){a>-Ve?(n=f.P,o=f):s>-Ve?(n=f,o=f.N):n=o=f;break}if(!f.R){n=f;break}f=f.R}(function(Y){Zt[Y.index]={site:Y,halfedges:[]}})(e);var p=My(e);if(Mi.insert(n,p),n||o){if(n===o)return Ai(n),o=My(n.site),Mi.insert(p,o),p.edge=o.edge=va(n.site,p.site),Ni(n),void Ni(o);if(o){Ai(n),Ai(o);var y=n.site,w=y[0],_=y[1],b=e[0]-w,T=e[1]-_,k=o.site,N=k[0]-w,P=k[1]-_,L=2*(b*P-T*N),z=b*b+T*T,F=N*N+P*P,W=[(P*z-T*F)/L+w,(b*F-N*z)/L+_];Bl(o.edge,y,k,W),p.edge=va(y,e,null,W),o.edge=va(e,k,null,W),Ni(n),Ni(o)}else p.edge=va(n.site,p.site)}}function Dy(e,n){var o=e.site,a=o[0],s=o[1],c=s-n;if(!c)return a;var h=e.P;if(!h)return-1/0;var f=(o=h.site)[0],p=o[1],y=p-n;if(!y)return f;var w=f-a,_=1/c-1/y,b=w/y;return _?(-b+Math.sqrt(b*b-2*_*(w*w/(-2*y)-p+y/2+s-c/2)))/_+a:(a+f)/2}function gI(e,n){var o=e.N;if(o)return Dy(o,n);var a=e.site;return a[1]===n?a[0]:1/0}var Mi,Zt,Ta,vt,Ve=1e-6,mI=1e-12;function yI(e,n){return n[1]-e[1]||n[0]-e[0]}function bh(e,n){var o,a,s,c=e.sort(yI).pop();for(vt=[],Zt=new Array(e.length),Mi=new Rl,Ta=new Rl;;)if(s=mh,c&&(!s||c[1]<s.y||c[1]===s.y&&c[0]<s.x))c[0]===o&&c[1]===a||(pI(c),o=c[0],a=c[1]),c=e.pop();else{if(!s)break;dI(s.arc)}if(function(){for(var w,_,b,T,k=0,N=Zt.length;k<N;++k)if((w=Zt[k])&&(T=(_=w.halfedges).length)){var P=new Array(T),L=new Array(T);for(b=0;b<T;++b)P[b]=b,L[b]=cI(w,vt[_[b]]);for(P.sort(function(z,F){return L[F]-L[z]}),b=0;b<T;++b)L[b]=_[P[b]];for(b=0;b<T;++b)_[b]=L[b]}}(),n){var h=+n[0][0],f=+n[0][1],p=+n[1][0],y=+n[1][1];(function(w,_,b,T){for(var k,N=vt.length;N--;)lI(k=vt[N],w,_,b,T)&&sI(k,w,_,b,T)&&(Math.abs(k[0][0]-k[1][0])>Ve||Math.abs(k[0][1]-k[1][1])>Ve)||delete vt[N]})(h,f,p,y),function(w,_,b,T){var k,N,P,L,z,F,W,Y,ae,ie,ce,G,ne=Zt.length,oe=!0;for(k=0;k<ne;++k)if(N=Zt[k]){for(P=N.site,L=(z=N.halfedges).length;L--;)vt[z[L]]||z.splice(L,1);for(L=0,F=z.length;L<F;)ce=(ie=uI(N,vt[z[L]]))[0],G=ie[1],Y=(W=Cy(N,vt[z[++L%F]]))[0],ae=W[1],(Math.abs(ce-Y)>Ve||Math.abs(G-ae)>Ve)&&(z.splice(L,0,vt.push(xa(P,ie,Math.abs(ce-w)<Ve&&T-G>Ve?[w,Math.abs(Y-w)<Ve?ae:T]:Math.abs(G-T)<Ve&&b-ce>Ve?[Math.abs(ae-T)<Ve?Y:b,T]:Math.abs(ce-b)<Ve&&G-_>Ve?[b,Math.abs(Y-b)<Ve?ae:_]:Math.abs(G-_)<Ve&&ce-w>Ve?[Math.abs(ae-_)<Ve?Y:w,_]:null))-1),++F);F&&(oe=!1)}if(oe){var ee,q,Q,ue=1/0;for(k=0,oe=null;k<ne;++k)(N=Zt[k])&&(Q=(ee=(P=N.site)[0]-w)*ee+(q=P[1]-_)*q)<ue&&(ue=Q,oe=N);if(oe){var he=[w,_],pe=[w,T],Ee=[b,T],Ne=[b,_];oe.halfedges.push(vt.push(xa(P=oe.site,he,pe))-1,vt.push(xa(P,pe,Ee))-1,vt.push(xa(P,Ee,Ne))-1,vt.push(xa(P,Ne,he))-1)}}for(k=0;k<ne;++k)(N=Zt[k])&&(N.halfedges.length||delete Zt[k])}(h,f,p,y)}this.edges=vt,this.cells=Zt,Mi=Ta=vt=Zt=null}function zl(e){return function(){return e}}function bI(e,n,o){this.target=e,this.type=n,this.transform=o}function Hn(e,n,o){this.k=e,this.x=n,this.y=o}bh.prototype={constructor:bh,polygons:function(){var e=this.edges;return this.cells.map(function(n){var o=n.halfedges.map(function(a){return Cy(n,e[a])});return o.data=n.site.data,o})},triangles:function(){var e=[],n=this.edges;return this.cells.forEach(function(o,a){if(c=(s=o.halfedges).length)for(var s,c,h,f,p,y,w=o.site,_=-1,b=n[s[c-1]],T=b.left===w?b.right:b.left;++_<c;)h=T,T=(b=n[s[_]]).left===w?b.right:b.left,h&&T&&a<h.index&&a<T.index&&(p=h,y=T,((f=w)[0]-y[0])*(p[1]-f[1])-(f[0]-p[0])*(y[1]-f[1])<0)&&e.push([w.data,h.data,T.data])}),e},links:function(){return this.edges.filter(function(e){return e.right}).map(function(e){return{source:e.left.data,target:e.right.data}})},find:function(e,n,o){for(var a,s,c=this,h=c._found||0,f=c.cells.length;!(s=c.cells[h]);)if(++h>=f)return null;var p=e-s.site[0],y=n-s.site[1],w=p*p+y*y;do s=c.cells[a=h],h=null,s.halfedges.forEach(function(_){var b=c.edges[_],T=b.left;if(T!==s.site&&T||(T=b.right)){var k=e-T[0],N=n-T[1],P=k*k+N*N;P<w&&(w=P,h=T.index)}});while(h!==null);return c._found=a,o==null||w<=o*o?s.site:null}},Hn.prototype={constructor:Hn,scale:function(e){return e===1?this:new Hn(this.k*e,this.x,this.y)},translate:function(e,n){return e===0&n===0?this:new Hn(this.k,this.x+this.k*e,this.y+this.k*n)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ql=new Hn(1,0,0);function Sy(e){return e.__zoom||ql}function wh(){t.event.stopImmediatePropagation()}function Ia(){t.event.preventDefault(),t.event.stopImmediatePropagation()}function wI(){return!t.event.button}function _I(){var e,n,o=this;return o instanceof window.SVGElement?(e=(o=o.ownerSVGElement||o).width.baseVal.value,n=o.height.baseVal.value):(e=o.clientWidth,n=o.clientHeight),[[0,0],[e,n]]}function Ly(){return this.__zoom||ql}function vI(){return-t.event.deltaY*(t.event.deltaMode?120:1)/500}function xI(){return"ontouchstart"in this}function TI(e,n,o){var a=e.invertX(n[0][0])-o[0][0],s=e.invertX(n[1][0])-o[1][0],c=e.invertY(n[0][1])-o[0][1],h=e.invertY(n[1][1])-o[1][1];return e.translate(s>a?(a+s)/2:Math.min(0,a)||Math.max(0,s),h>c?(c+h)/2:Math.min(0,c)||Math.max(0,h))}Sy.prototype=Hn.prototype,t.version="5.9.1",t.bisect=u,t.bisectRight=u,t.bisectLeft=d,t.ascending=r,t.bisector=i,t.cross=function(e,n,o){var a,s,c,h,f=e.length,p=n.length,y=new Array(f*p);for(o==null&&(o=g),a=c=0;a<f;++a)for(h=e[a],s=0;s<p;++s,++c)y[c]=o(h,n[s]);return y},t.descending=function(e,n){return n<e?-1:n>e?1:n>=e?0:NaN},t.deviation=v,t.extent=I,t.histogram=function(){var e=B,n=I,o=X;function a(s){var c,h,f=s.length,p=new Array(f);for(c=0;c<f;++c)p[c]=e(s[c],c,s);var y=n(p),w=y[0],_=y[1],b=o(p,w,_);Array.isArray(b)||(b=Z(w,_,b),b=$(Math.ceil(w/b)*b,_,b));for(var T=b.length;b[0]<=w;)b.shift(),--T;for(;b[T-1]>_;)b.pop(),--T;var k,N=new Array(T+1);for(c=0;c<=T;++c)(k=N[c]=[]).x0=c>0?b[c-1]:w,k.x1=c<T?b[c]:_;for(c=0;c<f;++c)w<=(h=p[c])&&h<=_&&N[u(b,h,0,T)].push(s[c]);return N}return a.value=function(s){return arguments.length?(e=typeof s=="function"?s:C(s),a):e},a.domain=function(s){return arguments.length?(n=typeof s=="function"?s:C([s[0],s[1]]),a):n},a.thresholds=function(s){return arguments.length?(o=typeof s=="function"?s:Array.isArray(s)?C(M.call(s)):C(s),a):o},a},t.thresholdFreedmanDiaconis=function(e,n,o){return e=E.call(e,m).sort(r),Math.ceil((o-n)/(2*(H(e,.75)-H(e,.25))*Math.pow(e.length,-1/3)))},t.thresholdScott=function(e,n,o){return Math.ceil((o-n)/(3.5*v(e)*Math.pow(e.length,-1/3)))},t.thresholdSturges=X,t.max=J,t.mean=function(e,n){var o,a=e.length,s=a,c=-1,h=0;if(n==null)for(;++c<a;)isNaN(o=m(e[c]))?--s:h+=o;else for(;++c<a;)isNaN(o=m(n(e[c],c,e)))?--s:h+=o;if(s)return h/s},t.median=function(e,n){var o,a=e.length,s=-1,c=[];if(n==null)for(;++s<a;)isNaN(o=m(e[s]))||c.push(o);else for(;++s<a;)isNaN(o=m(n(e[s],s,e)))||c.push(o);return H(c.sort(r),.5)},t.merge=U,t.min=K,t.pairs=function(e,n){n==null&&(n=g);for(var o=0,a=e.length-1,s=e[0],c=new Array(a<0?0:a);o<a;)c[o]=n(s,s=e[++o]);return c},t.permute=function(e,n){for(var o=n.length,a=new Array(o);o--;)a[o]=e[n[o]];return a},t.quantile=H,t.range=$,t.scan=function(e,n){if(o=e.length){var o,a,s=0,c=0,h=e[c];for(n==null&&(n=r);++s<o;)(n(a=e[s],h)<0||n(h,h)!==0)&&(h=a,c=s);return n(h,h)===0?c:void 0}},t.shuffle=function(e,n,o){for(var a,s,c=(o??e.length)-(n=n==null?0:+n);c;)s=Math.random()*c--|0,a=e[c+n],e[c+n]=e[s+n],e[s+n]=a;return e},t.sum=function(e,n){var o,a=e.length,s=-1,c=0;if(n==null)for(;++s<a;)(o=+e[s])&&(c+=o);else for(;++s<a;)(o=+n(e[s],s,e))&&(c+=o);return c},t.ticks=D,t.tickIncrement=A,t.tickStep=Z,t.transpose=se,t.variance=x,t.zip=function(){return se(arguments)},t.axisTop=function(e){return rt(we,e)},t.axisRight=function(e){return rt(Ue,e)},t.axisBottom=function(e){return rt(Ae,e)},t.axisLeft=function(e){return rt(ge,e)},t.brush=function(){return Tu(yx)},t.brushX=function(){return Tu(xs)},t.brushY=function(){return Tu(Ts)},t.brushSelection=function(e){var n=e.__brush;return n?n.dim.output(n.selection):null},t.chord=function(){var e=0,n=null,o=null,a=null;function s(c){var h,f,p,y,w,_,b=c.length,T=[],k=$(b),N=[],P=[],L=P.groups=new Array(b),z=new Array(b*b);for(h=0,w=-1;++w<b;){for(f=0,_=-1;++_<b;)f+=c[w][_];T.push(f),N.push($(b)),h+=f}for(n&&k.sort(function(ne,oe){return n(T[ne],T[oe])}),o&&N.forEach(function(ne,oe){ne.sort(function(ee,q){return o(c[oe][ee],c[oe][q])})}),y=(h=S0(0,D0-e*b)/h)?e:D0/b,f=0,w=-1;++w<b;){for(p=f,_=-1;++_<b;){var F=k[w],W=N[F][_],Y=c[F][W],ae=f,ie=f+=Y*h;z[W*b+F]={index:F,subindex:W,startAngle:ae,endAngle:ie,value:Y}}L[F]={index:F,startAngle:p,endAngle:f,value:T[F]},f+=y}for(w=-1;++w<b;)for(_=w-1;++_<b;){var ce=z[_*b+w],G=z[w*b+_];(ce.value||G.value)&&P.push(ce.value<G.value?{source:G,target:ce}:{source:ce,target:G})}return a?P.sort(a):P}return s.padAngle=function(c){return arguments.length?(e=S0(0,c),s):e},s.sortGroups=function(c){return arguments.length?(n=c,s):n},s.sortSubgroups=function(c){return arguments.length?(o=c,s):o},s.sortChords=function(c){return arguments.length?(c==null?a=null:(h=c,a=function(f,p){return h(f.source.value+f.target.value,p.source.value+p.target.value)})._=c,s):a&&a._;var h},s},t.ribbon=function(){var e=Ix,n=Ex,o=kx,a=Cx,s=Nx,c=null;function h(){var f,p=xx.call(arguments),y=e.apply(this,p),w=n.apply(this,p),_=+o.apply(this,(p[0]=y,p)),b=a.apply(this,p)-Is,T=s.apply(this,p)-Is,k=_*N0(b),N=_*A0(b),P=+o.apply(this,(p[0]=w,p)),L=a.apply(this,p)-Is,z=s.apply(this,p)-Is;if(c||(c=f=ir()),c.moveTo(k,N),c.arc(0,0,_,b,T),b===L&&T===z||(c.quadraticCurveTo(0,0,P*N0(L),P*A0(L)),c.arc(0,0,P,L,z)),c.quadraticCurveTo(0,0,k,N),c.closePath(),f)return c=null,f+""||null}return h.radius=function(f){return arguments.length?(o=typeof f=="function"?f:Iu(+f),h):o},h.startAngle=function(f){return arguments.length?(a=typeof f=="function"?f:Iu(+f),h):a},h.endAngle=function(f){return arguments.length?(s=typeof f=="function"?f:Iu(+f),h):s},h.source=function(f){return arguments.length?(e=f,h):e},h.target=function(f){return arguments.length?(n=f,h):n},h.context=function(f){return arguments.length?(c=f??null,h):c},h},t.nest=function(){var e,n,o,a=[],s=[];function c(h,f,p,y){if(f>=a.length)return e!=null&&h.sort(e),n!=null?n(h):h;for(var w,_,b,T=-1,k=h.length,N=a[f++],P=Rn(),L=p();++T<k;)(b=P.get(w=N(_=h[T])+""))?b.push(_):P.set(w,[_]);return P.each(function(z,F){y(L,F,c(z,f,p,y))}),L}return o={object:function(h){return c(h,0,Ax,Mx)},map:function(h){return c(h,0,L0,P0)},entries:function(h){return function f(p,y){if(++y>a.length)return p;var w,_=s[y-1];return n!=null&&y>=a.length?w=p.entries():(w=[],p.each(function(b,T){w.push({key:T,values:f(b,y)})})),_!=null?w.sort(function(b,T){return _(b.key,T.key)}):w}(c(h,0,L0,P0),0)},key:function(h){return a.push(h),o},sortKeys:function(h){return s[a.length-1]=h,o},sortValues:function(h){return e=h,o},rollup:function(h){return n=h,o}}},t.set=O0,t.map=Rn,t.keys=function(e){var n=[];for(var o in e)n.push(o);return n},t.values=function(e){var n=[];for(var o in e)n.push(e[o]);return n},t.entries=function(e){var n=[];for(var o in e)n.push({key:o,value:e[o]});return n},t.color=rr,t.rgb=oi,t.hsl=os,t.lab=as,t.hcl=ss,t.lch=function(e,n,o,a){return arguments.length===1?Dp(e):new pn(o,n,e,a??1)},t.gray=function(e,n){return new tn(e,0,0,n??1)},t.cubehelix=nn,t.contours=F0,t.contourDensity=function(){var e=Rx,n=Fx,o=Bx,a=960,s=500,c=20,h=2,f=3*c,p=a+2*f>>h,y=s+2*f>>h,w=or(20);function _(L){var z=new Float32Array(p*y),F=new Float32Array(p*y);L.forEach(function(ae,ie,ce){var G=+e(ae,ie,ce)+f>>h,ne=+n(ae,ie,ce)+f>>h,oe=+o(ae,ie,ce);G>=0&&G<p&&ne>=0&&ne<y&&(z[G+ne*p]+=oe)}),Nu({width:p,height:y,data:z},{width:p,height:y,data:F},c>>h),Au({width:p,height:y,data:F},{width:p,height:y,data:z},c>>h),Nu({width:p,height:y,data:z},{width:p,height:y,data:F},c>>h),Au({width:p,height:y,data:F},{width:p,height:y,data:z},c>>h),Nu({width:p,height:y,data:z},{width:p,height:y,data:F},c>>h),Au({width:p,height:y,data:F},{width:p,height:y,data:z},c>>h);var W=w(z);if(!Array.isArray(W)){var Y=J(z);W=Z(0,Y,W),(W=$(0,Math.floor(Y/W)*W,W)).shift()}return F0().thresholds(W).size([p,y])(z).map(b)}function b(L){return L.value*=Math.pow(2,-2*h),L.coordinates.forEach(T),L}function T(L){L.forEach(k)}function k(L){L.forEach(N)}function N(L){L[0]=L[0]*Math.pow(2,h)-f,L[1]=L[1]*Math.pow(2,h)-f}function P(){return p=a+2*(f=3*c)>>h,y=s+2*f>>h,_}return _.x=function(L){return arguments.length?(e=typeof L=="function"?L:or(+L),_):e},_.y=function(L){return arguments.length?(n=typeof L=="function"?L:or(+L),_):n},_.weight=function(L){return arguments.length?(o=typeof L=="function"?L:or(+L),_):o},_.size=function(L){if(!arguments.length)return[a,s];var z=Math.ceil(L[0]),F=Math.ceil(L[1]);if(!(z>=0||z>=0))throw new Error("invalid size");return a=z,s=F,P()},_.cellSize=function(L){if(!arguments.length)return 1<<h;if(!((L=+L)>=1))throw new Error("invalid cell size");return h=Math.floor(Math.log(L)/Math.LN2),P()},_.thresholds=function(L){return arguments.length?(w=typeof L=="function"?L:Array.isArray(L)?or(R0.call(L)):or(L),_):w},_.bandwidth=function(L){if(!arguments.length)return Math.sqrt(c*(c+1));if(!((L=+L)>=0))throw new Error("invalid bandwidth");return c=Math.round((Math.sqrt(4*L*L+1)-1)/2),P()},_},t.dispatch=j,t.drag=function(){var e,n,o,a,s=C2,c=N2,h=A2,f=M2,p={},y=j("start","drag","end"),w=0,_=0;function b(W){W.on("mousedown.drag",T).filter(f).on("touchstart.drag",P).on("touchmove.drag",L).on("touchend.drag touchcancel.drag",z).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function T(){if(!a&&s.apply(this,arguments)){var W=F("mouse",c.apply(this,arguments),tr,this,arguments);W&&(Pt(t.event.view).on("mousemove.drag",k,!0).on("mouseup.drag",N,!0),ns(t.event.view),Vc(),o=!1,e=t.event.clientX,n=t.event.clientY,W("start"))}}function k(){if(ni(),!o){var W=t.event.clientX-e,Y=t.event.clientY-n;o=W*W+Y*Y>_}p.mouse("drag")}function N(){Pt(t.event.view).on("mousemove.drag mouseup.drag",null),rs(t.event.view,o),ni(),p.mouse("end")}function P(){if(s.apply(this,arguments)){var W,Y,ae=t.event.changedTouches,ie=c.apply(this,arguments),ce=ae.length;for(W=0;W<ce;++W)(Y=F(ae[W].identifier,ie,ts,this,arguments))&&(Vc(),Y("start"))}}function L(){var W,Y,ae=t.event.changedTouches,ie=ae.length;for(W=0;W<ie;++W)(Y=p[ae[W].identifier])&&(ni(),Y("drag"))}function z(){var W,Y,ae=t.event.changedTouches,ie=ae.length;for(a&&window.clearTimeout(a),a=window.setTimeout(function(){a=null},500),W=0;W<ie;++W)(Y=p[ae[W].identifier])&&(Vc(),Y("end"))}function F(W,Y,ae,ie,ce){var G,ne,oe,ee=ae(Y,W),q=y.copy();if(po(new Wc(b,"beforestart",G,W,w,ee[0],ee[1],0,0,q),function(){return(t.event.subject=G=h.apply(ie,ce))!=null&&(ne=G.x-ee[0]||0,oe=G.y-ee[1]||0,!0)}))return function Q(ue){var he,pe=ee;switch(ue){case"start":p[W]=Q,he=w++;break;case"end":delete p[W],--w;case"drag":ee=ae(Y,W),he=w}po(new Wc(b,ue,G,W,he,ee[0]+ne,ee[1]+oe,ee[0]-pe[0],ee[1]-pe[1],q),q.apply,q,[ue,ie,ce])}}return b.filter=function(W){return arguments.length?(s=typeof W=="function"?W:is(!!W),b):s},b.container=function(W){return arguments.length?(c=typeof W=="function"?W:is(W),b):c},b.subject=function(W){return arguments.length?(h=typeof W=="function"?W:is(W),b):h},b.touchable=function(W){return arguments.length?(f=typeof W=="function"?W:is(!!W),b):f},b.on=function(){var W=y.on.apply(y,arguments);return W===y?b:W},b.clickDistance=function(W){return arguments.length?(_=(W=+W)*W,b):Math.sqrt(_)},b},t.dragDisable=ns,t.dragEnable=rs,t.dsvFormat=Cs,t.csvParse=U0,t.csvParseRows=qx,t.csvFormat=Ux,t.csvFormatBody=Zx,t.csvFormatRows=jx,t.tsvParse=Z0,t.tsvParseRows=Hx,t.tsvFormat=$x,t.tsvFormatBody=Vx,t.tsvFormatRows=Wx,t.autoType=function(e){for(var n in e){var o,a=e[n].trim();if(a)if(a==="true")a=!0;else if(a==="false")a=!1;else if(a==="NaN")a=NaN;else if(isNaN(o=+a)){if(!/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/.test(a))continue;a=new Date(a)}else a=o;else a=null;e[n]=a}return e},t.easeLinear=function(e){return+e},t.easeQuad=p0,t.easeQuadIn=function(e){return e*e},t.easeQuadOut=function(e){return e*(2-e)},t.easeQuadInOut=p0,t.easeCubic=yu,t.easeCubicIn=function(e){return e*e*e},t.easeCubicOut=function(e){return--e*e*e+1},t.easeCubicInOut=yu,t.easePoly=g0,t.easePolyIn=ex,t.easePolyOut=tx,t.easePolyInOut=g0,t.easeSin=b0,t.easeSinIn=function(e){return 1-Math.cos(e*y0)},t.easeSinOut=function(e){return Math.sin(e*y0)},t.easeSinInOut=b0,t.easeExp=w0,t.easeExpIn=function(e){return Math.pow(2,10*e-10)},t.easeExpOut=function(e){return 1-Math.pow(2,-10*e)},t.easeExpInOut=w0,t.easeCircle=_0,t.easeCircleIn=function(e){return 1-Math.sqrt(1-e*e)},t.easeCircleOut=function(e){return Math.sqrt(1- --e*e)},t.easeCircleInOut=_0,t.easeBounce=Co,t.easeBounceIn=function(e){return 1-Co(1-e)},t.easeBounceOut=Co,t.easeBounceInOut=function(e){return((e*=2)<=1?1-Co(1-e):Co(e-1)+1)/2},t.easeBack=v0,t.easeBackIn=ux,t.easeBackOut=fx,t.easeBackInOut=v0,t.easeElastic=x0,t.easeElasticIn=hx,t.easeElasticOut=x0,t.easeElasticInOut=dx,t.blob=function(e,n){return fetch(e,n).then(Gx)},t.buffer=function(e,n){return fetch(e,n).then(Xx)},t.dsv=function(e,n,o,a){arguments.length===3&&typeof o=="function"&&(a=o,o=void 0);var s=Cs(e);return Ns(n,o).then(function(c){return s.parse(c,a)})},t.csv=Jx,t.tsv=Yx,t.image=function(e,n){return new Promise(function(o,a){var s=new Image;for(var c in n)s[c]=n[c];s.onerror=a,s.onload=function(){o(s)},s.src=e})},t.json=function(e,n){return fetch(e,n).then(Qx)},t.text=Ns,t.xml=e8,t.html=t8,t.svg=n8,t.forceCenter=function(e,n){var o;function a(){var s,c,h=o.length,f=0,p=0;for(s=0;s<h;++s)f+=(c=o[s]).x,p+=c.y;for(f=f/h-e,p=p/h-n,s=0;s<h;++s)(c=o[s]).x-=f,c.y-=p}return e==null&&(e=0),n==null&&(n=0),a.initialize=function(s){o=s},a.x=function(s){return arguments.length?(e=+s,a):e},a.y=function(s){return arguments.length?(n=+s,a):n},a},t.forceCollide=function(e){var n,o,a=1,s=1;function c(){for(var p,y,w,_,b,T,k,N=n.length,P=0;P<s;++P)for(y=As(n,o8,a8).visitAfter(h),p=0;p<N;++p)w=n[p],T=o[w.index],k=T*T,_=w.x+w.vx,b=w.y+w.vy,y.visit(L);function L(z,F,W,Y,ae){var ie=z.data,ce=z.r,G=T+ce;if(!ie)return F>_+G||Y<_-G||W>b+G||ae<b-G;if(ie.index>w.index){var ne=_-ie.x-ie.vx,oe=b-ie.y-ie.vy,ee=ne*ne+oe*oe;ee<G*G&&(ne===0&&(ee+=(ne=ar())*ne),oe===0&&(ee+=(oe=ar())*oe),ee=(G-(ee=Math.sqrt(ee)))/ee*a,w.vx+=(ne*=ee)*(G=(ce*=ce)/(k+ce)),w.vy+=(oe*=ee)*G,ie.vx-=ne*(G=1-G),ie.vy-=oe*G)}}}function h(p){if(p.data)return p.r=o[p.data.index];for(var y=p.r=0;y<4;++y)p[y]&&p[y].r>p.r&&(p.r=p[y].r)}function f(){if(n){var p,y,w=n.length;for(o=new Array(w),p=0;p<w;++p)y=n[p],o[y.index]=+e(y,p,n)}}return typeof e!="function"&&(e=ft(e==null?1:+e)),c.initialize=function(p){n=p,f()},c.iterations=function(p){return arguments.length?(s=+p,c):s},c.strength=function(p){return arguments.length?(a=+p,c):a},c.radius=function(p){return arguments.length?(e=typeof p=="function"?p:ft(+p),f(),c):e},c},t.forceLink=function(e){var n,o,a,s,c,h=s8,f=function(k){return 1/Math.min(s[k.source.index],s[k.target.index])},p=ft(30),y=1;function w(k){for(var N=0,P=e.length;N<y;++N)for(var L,z,F,W,Y,ae,ie,ce=0;ce<P;++ce)z=(L=e[ce]).source,W=(F=L.target).x+F.vx-z.x-z.vx||ar(),Y=F.y+F.vy-z.y-z.vy||ar(),W*=ae=((ae=Math.sqrt(W*W+Y*Y))-o[ce])/ae*k*n[ce],Y*=ae,F.vx-=W*(ie=c[ce]),F.vy-=Y*ie,z.vx+=W*(ie=1-ie),z.vy+=Y*ie}function _(){if(a){var k,N,P=a.length,L=e.length,z=Rn(a,h);for(k=0,s=new Array(P);k<L;++k)(N=e[k]).index=k,typeof N.source!="object"&&(N.source=V0(z,N.source)),typeof N.target!="object"&&(N.target=V0(z,N.target)),s[N.source.index]=(s[N.source.index]||0)+1,s[N.target.index]=(s[N.target.index]||0)+1;for(k=0,c=new Array(L);k<L;++k)N=e[k],c[k]=s[N.source.index]/(s[N.source.index]+s[N.target.index]);n=new Array(L),b(),o=new Array(L),T()}}function b(){if(a)for(var k=0,N=e.length;k<N;++k)n[k]=+f(e[k],k,e)}function T(){if(a)for(var k=0,N=e.length;k<N;++k)o[k]=+p(e[k],k,e)}return e==null&&(e=[]),w.initialize=function(k){a=k,_()},w.links=function(k){return arguments.length?(e=k,_(),w):e},w.id=function(k){return arguments.length?(h=k,w):h},w.iterations=function(k){return arguments.length?(y=+k,w):y},w.strength=function(k){return arguments.length?(f=typeof k=="function"?k:ft(+k),b(),w):f},w.distance=function(k){return arguments.length?(p=typeof k=="function"?k:ft(+k),T(),w):p},w},t.forceManyBody=function(){var e,n,o,a,s=ft(-30),c=1,h=1/0,f=.81;function p(b){var T,k=e.length,N=As(e,l8,c8).visitAfter(w);for(o=b,T=0;T<k;++T)n=e[T],N.visit(_)}function y(){if(e){var b,T,k=e.length;for(a=new Array(k),b=0;b<k;++b)T=e[b],a[T.index]=+s(T,b,e)}}function w(b){var T,k,N,P,L,z=0,F=0;if(b.length){for(N=P=L=0;L<4;++L)(T=b[L])&&(k=Math.abs(T.value))&&(z+=T.value,F+=k,N+=k*T.x,P+=k*T.y);b.x=N/F,b.y=P/F}else{(T=b).x=T.data.x,T.y=T.data.y;do z+=a[T.data.index];while(T=T.next)}b.value=z}function _(b,T,k,N){if(!b.value)return!0;var P=b.x-n.x,L=b.y-n.y,z=N-T,F=P*P+L*L;if(z*z/f<F)return F<h&&(P===0&&(F+=(P=ar())*P),L===0&&(F+=(L=ar())*L),F<c&&(F=Math.sqrt(c*F)),n.vx+=P*b.value*o/F,n.vy+=L*b.value*o/F),!0;if(!(b.length||F>=h)){(b.data!==n||b.next)&&(P===0&&(F+=(P=ar())*P),L===0&&(F+=(L=ar())*L),F<c&&(F=Math.sqrt(c*F)));do b.data!==n&&(z=a[b.data.index]*o/F,n.vx+=P*z,n.vy+=L*z);while(b=b.next)}}return p.initialize=function(b){e=b,y()},p.strength=function(b){return arguments.length?(s=typeof b=="function"?b:ft(+b),y(),p):s},p.distanceMin=function(b){return arguments.length?(c=b*b,p):Math.sqrt(c)},p.distanceMax=function(b){return arguments.length?(h=b*b,p):Math.sqrt(h)},p.theta=function(b){return arguments.length?(f=b*b,p):Math.sqrt(f)},p},t.forceRadial=function(e,n,o){var a,s,c,h=ft(.1);function f(y){for(var w=0,_=a.length;w<_;++w){var b=a[w],T=b.x-n||1e-6,k=b.y-o||1e-6,N=Math.sqrt(T*T+k*k),P=(c[w]-N)*s[w]*y/N;b.vx+=T*P,b.vy+=k*P}}function p(){if(a){var y,w=a.length;for(s=new Array(w),c=new Array(w),y=0;y<w;++y)c[y]=+e(a[y],y,a),s[y]=isNaN(c[y])?0:+h(a[y],y,a)}}return typeof e!="function"&&(e=ft(+e)),n==null&&(n=0),o==null&&(o=0),f.initialize=function(y){a=y,p()},f.strength=function(y){return arguments.length?(h=typeof y=="function"?y:ft(+y),p(),f):h},f.radius=function(y){return arguments.length?(e=typeof y=="function"?y:ft(+y),p(),f):e},f.x=function(y){return arguments.length?(n=+y,f):n},f.y=function(y){return arguments.length?(o=+y,f):o},f},t.forceSimulation=function(e){var n,o=1,a=.001,s=1-Math.pow(a,1/300),c=0,h=.6,f=Rn(),p=ms(w),y=j("tick","end");function w(){_(),y.call("tick",n),o<a&&(p.stop(),y.call("end",n))}function _(k){var N,P,L=e.length;k===void 0&&(k=1);for(var z=0;z<k;++z)for(o+=(c-o)*s,f.each(function(F){F(o)}),N=0;N<L;++N)(P=e[N]).fx==null?P.x+=P.vx*=h:(P.x=P.fx,P.vx=0),P.fy==null?P.y+=P.vy*=h:(P.y=P.fy,P.vy=0);return n}function b(){for(var k,N=0,P=e.length;N<P;++N){if((k=e[N]).index=N,isNaN(k.fx)||(k.x=k.fx),isNaN(k.fy)||(k.y=k.fy),isNaN(k.x)||isNaN(k.y)){var L=u8*Math.sqrt(N),z=N*f8;k.x=L*Math.cos(z),k.y=L*Math.sin(z)}(isNaN(k.vx)||isNaN(k.vy))&&(k.vx=k.vy=0)}}function T(k){return k.initialize&&k.initialize(e),k}return e==null&&(e=[]),b(),n={tick:_,restart:function(){return p.restart(w),n},stop:function(){return p.stop(),n},nodes:function(k){return arguments.length?(e=k,b(),f.each(T),n):e},alpha:function(k){return arguments.length?(o=+k,n):o},alphaMin:function(k){return arguments.length?(a=+k,n):a},alphaDecay:function(k){return arguments.length?(s=+k,n):+s},alphaTarget:function(k){return arguments.length?(c=+k,n):c},velocityDecay:function(k){return arguments.length?(h=1-k,n):1-h},force:function(k,N){return arguments.length>1?(N==null?f.remove(k):f.set(k,T(N)),n):f.get(k)},find:function(k,N,P){var L,z,F,W,Y,ae=0,ie=e.length;for(P==null?P=1/0:P*=P,ae=0;ae<ie;++ae)(F=(L=k-(W=e[ae]).x)*L+(z=N-W.y)*z)<P&&(Y=W,P=F);return Y},on:function(k,N){return arguments.length>1?(y.on(k,N),n):y.on(k)}}},t.forceX=function(e){var n,o,a,s=ft(.1);function c(f){for(var p,y=0,w=n.length;y<w;++y)(p=n[y]).vx+=(a[y]-p.x)*o[y]*f}function h(){if(n){var f,p=n.length;for(o=new Array(p),a=new Array(p),f=0;f<p;++f)o[f]=isNaN(a[f]=+e(n[f],f,n))?0:+s(n[f],f,n)}}return typeof e!="function"&&(e=ft(e==null?0:+e)),c.initialize=function(f){n=f,h()},c.strength=function(f){return arguments.length?(s=typeof f=="function"?f:ft(+f),h(),c):s},c.x=function(f){return arguments.length?(e=typeof f=="function"?f:ft(+f),h(),c):e},c},t.forceY=function(e){var n,o,a,s=ft(.1);function c(f){for(var p,y=0,w=n.length;y<w;++y)(p=n[y]).vy+=(a[y]-p.y)*o[y]*f}function h(){if(n){var f,p=n.length;for(o=new Array(p),a=new Array(p),f=0;f<p;++f)o[f]=isNaN(a[f]=+e(n[f],f,n))?0:+s(n[f],f,n)}}return typeof e!="function"&&(e=ft(e==null?0:+e)),c.initialize=function(f){n=f,h()},c.strength=function(f){return arguments.length?(s=typeof f=="function"?f:ft(+f),h(),c):s},c.y=function(f){return arguments.length?(e=typeof f=="function"?f:ft(+f),h(),c):e},c},t.formatDefaultLocale=Q0,t.formatLocale=Y0,t.formatSpecifier=So,t.precisionFixed=eg,t.precisionPrefix=tg,t.precisionRound=ng,t.geoArea=function(e){return zs.reset(),on(e,mn),2*zs},t.geoBounds=function(e){var n,o,a,s,c,h,f;if(Gt=at=-(ot=qt=1/0),lr=[],on(e,zn),o=lr.length){for(lr.sort(b8),n=1,c=[a=lr[0]];n<o;++n)vg(a,(s=lr[n])[0])||vg(a,s[1])?(Ut(a[0],s[1])>Ut(a[0],a[1])&&(a[1]=s[1]),Ut(s[0],a[1])>Ut(a[0],a[1])&&(a[0]=s[0])):c.push(a=s);for(h=-1/0,n=0,a=c[o=c.length-1];n<=o;a=s,++n)s=c[n],(f=Ut(a[1],s[0]))>h&&(h=f,ot=s[0],at=a[1])}return lr=Bn=null,ot===1/0||qt===1/0?[[NaN,NaN],[NaN,NaN]]:[[ot,qt],[at,Gt]]},t.geoCentroid=function(e){Hs=$s=Vs=Ws=Gs=Xs=Ks=Js=Hu=$u=Vu=0,on(e,an);var n=Hu,o=$u,a=Vu,s=n*n+o*o+a*a;return s<Ru&&(n=Xs,o=Ks,a=Js,$s<Ie&&(n=Vs,o=Ws,a=Gs),(s=n*n+o*o+a*a)<Ru)?[NaN,NaN]:[Ct(o,n)*Ke,Nt(a/lt(s))*Ke]},t.geoCircle=function(){var e,n,o=yi([0,0]),a=yi(90),s=yi(6),c={point:function(f,p){e.push(f=n(f,p)),f[0]*=Ke,f[1]*=Ke}};function h(){var f=o.apply(this,arguments),p=a.apply(this,arguments)*ke,y=s.apply(this,arguments)*ke;return e=[],n=Ju(-f[0]*ke,-f[1]*ke,0).invert,Ag(c,p,y,1),f={type:"Polygon",coordinates:[e]},e=n=null,f}return h.center=function(f){return arguments.length?(o=typeof f=="function"?f:yi([+f[0],+f[1]]),h):o},h.radius=function(f){return arguments.length?(a=typeof f=="function"?f:yi(+f),h):a},h.precision=function(f){return arguments.length?(s=typeof f=="function"?f:yi(+f),h):s},h},t.geoClipAntimeridian=Qu,t.geoClipCircle=Rg,t.geoClipExtent=function(){var e,n,o,a=0,s=0,c=960,h=500;return o={stream:function(f){return e&&n===f?e:e=tl(a,s,c,h)(n=f)},extent:function(f){return arguments.length?(a=+f[0][0],s=+f[0][1],c=+f[1][0],h=+f[1][1],e=n=null,o):[[a,s],[c,h]]}}},t.geoClipRectangle=tl,t.geoContains=function(e,n){return(e&&Bg.hasOwnProperty(e.type)?Bg[e.type]:il)(e,n)},t.geoDistance=Fo,t.geoGraticule=Vg,t.geoGraticule10=function(){return Vg()()},t.geoInterpolate=function(e,n){var o=e[0]*ke,a=e[1]*ke,s=n[0]*ke,c=n[1]*ke,h=Te(a),f=xe(a),p=Te(c),y=xe(c),w=h*Te(o),_=h*xe(o),b=p*Te(s),T=p*xe(s),k=2*Nt(lt(ag(c-a)+h*p*ag(s-o))),N=xe(k),P=k?function(L){var z=xe(L*=k)/N,F=xe(k-L)/N,W=F*w+z*b,Y=F*_+z*T,ae=F*f+z*y;return[Ct(Y,W)*Ke,Ct(ae,lt(W*W+Y*Y))*Ke]}:function(){return[o*Ke,a*Ke]};return P.distance=k,P},t.geoLength=Fg,t.geoPath=function(e,n){var o,a,s=4.5;function c(h){return h&&(typeof s=="function"&&a.pointRadius(+s.apply(this,arguments)),on(h,o(a))),a.result()}return c.area=function(h){return on(h,o(qn)),qn.result()},c.measure=function(h){return on(h,o(jo)),jo.result()},c.bounds=function(h){return on(h,o(sl)),sl.result()},c.centroid=function(h){return on(h,o(Xt)),Xt.result()},c.projection=function(h){return arguments.length?(o=h==null?(e=null,Lr):(e=h).stream,c):e},c.context=function(h){return arguments.length?(a=h==null?(n=null,new om):new tm(n=h),typeof s!="function"&&a.pointRadius(s),c):n},c.pointRadius=function(h){return arguments.length?(s=typeof h=="function"?h:(a.pointRadius(+h),+h),c):s},c.projection(e).context(n)},t.geoAlbers=fm,t.geoAlbersUsa=function(){var e,n,o,a,s,c,h=fm(),f=fl().rotate([154,0]).center([-2,58.5]).parallels([55,65]),p=fl().rotate([157,0]).center([-3,19.9]).parallels([8,18]),y={point:function(b,T){c=[b,T]}};function w(b){var T=b[0],k=b[1];return c=null,o.point(T,k),c||(a.point(T,k),c)||(s.point(T,k),c)}function _(){return e=n=null,w}return w.invert=function(b){var T=h.scale(),k=h.translate(),N=(b[0]-k[0])/T,P=(b[1]-k[1])/T;return(P>=.12&&P<.234&&N>=-.425&&N<-.214?f:P>=.166&&P<.234&&N>=-.214&&N<-.115?p:h).invert(b)},w.stream=function(b){return e&&n===b?e:(T=[h.stream(n=b),f.stream(b),p.stream(b)],k=T.length,e={point:function(N,P){for(var L=-1;++L<k;)T[L].point(N,P)},sphere:function(){for(var N=-1;++N<k;)T[N].sphere()},lineStart:function(){for(var N=-1;++N<k;)T[N].lineStart()},lineEnd:function(){for(var N=-1;++N<k;)T[N].lineEnd()},polygonStart:function(){for(var N=-1;++N<k;)T[N].polygonStart()},polygonEnd:function(){for(var N=-1;++N<k;)T[N].polygonEnd()}});var T,k},w.precision=function(b){return arguments.length?(h.precision(b),f.precision(b),p.precision(b),_()):h.precision()},w.scale=function(b){return arguments.length?(h.scale(b),f.scale(.35*b),p.scale(b),w.translate(h.translate())):h.scale()},w.translate=function(b){if(!arguments.length)return h.translate();var T=h.scale(),k=+b[0],N=+b[1];return o=h.translate(b).clipExtent([[k-.455*T,N-.238*T],[k+.455*T,N+.238*T]]).stream(y),a=f.translate([k-.307*T,N+.201*T]).clipExtent([[k-.425*T+Ie,N+.12*T+Ie],[k-.214*T-Ie,N+.234*T-Ie]]).stream(y),s=p.translate([k-.205*T,N+.212*T]).clipExtent([[k-.214*T+Ie,N+.166*T+Ie],[k-.115*T-Ie,N+.234*T-Ie]]).stream(y),_()},w.fitExtent=function(b,T){return ul(w,b,T)},w.fitSize=function(b,T){return mf(w,b,T)},w.fitWidth=function(b,T){return yf(w,b,T)},w.fitHeight=function(b,T){return bf(w,b,T)},w.scale(1070)},t.geoAzimuthalEqualArea=function(){return wn(vf).scale(124.75).clipAngle(179.999)},t.geoAzimuthalEqualAreaRaw=vf,t.geoAzimuthalEquidistant=function(){return wn(xf).scale(79.4188).clipAngle(179.999)},t.geoAzimuthalEquidistantRaw=xf,t.geoConicConformal=function(){return _f(pm).scale(109.5).parallels([30,30])},t.geoConicConformalRaw=pm,t.geoConicEqualArea=fl,t.geoConicEqualAreaRaw=um,t.geoConicEquidistant=function(){return _f(gm).scale(131.154).center([0,13.9389])},t.geoConicEquidistantRaw=gm,t.geoEqualEarth=function(){return wn(Tf).scale(177.158)},t.geoEqualEarthRaw=Tf,t.geoEquirectangular=function(){return wn(Wo).scale(152.63)},t.geoEquirectangularRaw=Wo,t.geoGnomonic=function(){return wn(If).scale(144.049).clipAngle(60)},t.geoGnomonicRaw=If,t.geoIdentity=function(){var e,n,o,a,s,c,h=1,f=0,p=0,y=1,w=1,_=Lr,b=null,T=Lr;function k(){return a=s=null,c}return c={stream:function(N){return a&&s===N?a:a=_(T(s=N))},postclip:function(N){return arguments.length?(T=N,b=e=n=o=null,k()):T},clipExtent:function(N){return arguments.length?(T=N==null?(b=e=n=o=null,Lr):tl(b=+N[0][0],e=+N[0][1],n=+N[1][0],o=+N[1][1]),k()):b==null?null:[[b,e],[n,o]]},scale:function(N){return arguments.length?(_=pl((h=+N)*y,h*w,f,p),k()):h},translate:function(N){return arguments.length?(_=pl(h*y,h*w,f=+N[0],p=+N[1]),k()):[f,p]},reflectX:function(N){return arguments.length?(_=pl(h*(y=N?-1:1),h*w,f,p),k()):y<0},reflectY:function(N){return arguments.length?(_=pl(h*y,h*(w=N?-1:1),f,p),k()):w<0},fitExtent:function(N,P){return ul(c,N,P)},fitSize:function(N,P){return mf(c,N,P)},fitWidth:function(N,P){return yf(c,N,P)},fitHeight:function(N,P){return bf(c,N,P)}}},t.geoProjection=wn,t.geoProjectionMutator=wf,t.geoMercator=function(){return dm(Vo).scale(961/Rt)},t.geoMercatorRaw=Vo,t.geoNaturalEarth1=function(){return wn(Ef).scale(175.295)},t.geoNaturalEarth1Raw=Ef,t.geoOrthographic=function(){return wn(kf).scale(249.5).clipAngle(90+Ie)},t.geoOrthographicRaw=kf,t.geoStereographic=function(){return wn(Cf).scale(250).clipAngle(142)},t.geoStereographicRaw=Cf,t.geoTransverseMercator=function(){var e=dm(Nf),n=e.center,o=e.rotate;return e.center=function(a){return arguments.length?n([-a[1],a[0]]):[(a=n())[1],-a[0]]},e.rotate=function(a){return arguments.length?o([a[0],a[1],a.length>2?a[2]+90:90]):[(a=o())[0],a[1],a[2]-90]},o([0,0,90]).scale(159.155)},t.geoTransverseMercatorRaw=Nf,t.geoRotation=Ng,t.geoStream=on,t.geoTransform=function(e){return{stream:Ho(e)}},t.cluster=function(){var e=Z8,n=1,o=1,a=!1;function s(c){var h,f=0;c.eachAfter(function(b){var T=b.children;T?(b.x=function(k){return k.reduce(j8,0)/k.length}(T),b.y=function(k){return 1+k.reduce(H8,0)}(T)):(b.x=h?f+=e(b,h):0,b.y=0,h=b)});var p=function(b){for(var T;T=b.children;)b=T[0];return b}(c),y=function(b){for(var T;T=b.children;)b=T[T.length-1];return b}(c),w=p.x-e(p,y)/2,_=y.x+e(y,p)/2;return c.eachAfter(a?function(b){b.x=(b.x-c.x)*n,b.y=(c.y-b.y)*o}:function(b){b.x=(b.x-w)/(_-w)*n,b.y=(1-(c.y?b.y/c.y:1))*o})}return s.separation=function(c){return arguments.length?(e=c,s):e},s.size=function(c){return arguments.length?(a=!1,n=+c[0],o=+c[1],s):a?null:[n,o]},s.nodeSize=function(c){return arguments.length?(a=!0,n=+c[0],o=+c[1],s):a?[n,o]:null},s},t.hierarchy=Af,t.pack=function(){var e=null,n=1,o=1,a=Or;function s(c){return c.x=n/2,c.y=o/2,e?c.eachBefore(Im(e)).eachAfter(Df(a,.5)).eachBefore(Em(1)):c.eachBefore(Im(J8)).eachAfter(Df(Or,1)).eachAfter(Df(a,c.r/Math.min(n,o))).eachBefore(Em(Math.min(n,o)/(2*c.r))),c}return s.radius=function(c){return arguments.length?(e=(h=c)==null?null:yl(h),s):e;var h},s.size=function(c){return arguments.length?(n=+c[0],o=+c[1],s):[n,o]},s.padding=function(c){return arguments.length?(a=typeof c=="function"?c:xi(+c),s):a},s},t.packSiblings=function(e){return Tm(e),e},t.packEnclose=ym,t.partition=function(){var e=1,n=1,o=0,a=!1;function s(c){var h=c.height+1;return c.x0=c.y0=o,c.x1=e,c.y1=n/h,c.eachBefore(function(f,p){return function(y){y.children&&Qo(y,y.x0,f*(y.depth+1)/p,y.x1,f*(y.depth+2)/p);var w=y.x0,_=y.y0,b=y.x1-o,T=y.y1-o;b<w&&(w=b=(w+b)/2),T<_&&(_=T=(_+T)/2),y.x0=w,y.y0=_,y.x1=b,y.y1=T}}(n,h)),a&&c.eachBefore(km),c}return s.round=function(c){return arguments.length?(a=!!c,s):a},s.size=function(c){return arguments.length?(e=+c[0],n=+c[1],s):[e,n]},s.padding=function(c){return arguments.length?(o=+c,s):o},s},t.stratify=function(){var e=Q8,n=e6;function o(a){var s,c,h,f,p,y,w,_=a.length,b=new Array(_),T={};for(c=0;c<_;++c)s=a[c],p=b[c]=new vi(s),(y=e(s,c,a))!=null&&(y+="")&&(T[w=Cm+(p.id=y)]=w in T?Nm:p);for(c=0;c<_;++c)if(p=b[c],(y=n(a[c],c,a))!=null&&(y+="")){if(!(f=T[Cm+y]))throw new Error("missing: "+y);if(f===Nm)throw new Error("ambiguous: "+y);f.children?f.children.push(p):f.children=[p],p.parent=f}else{if(h)throw new Error("multiple roots");h=p}if(!h)throw new Error("no root");if(h.parent=Y8,h.eachBefore(function(k){k.depth=k.parent.depth+1,--_}).eachBefore(mm),h.parent=null,_>0)throw new Error("cycle");return h}return o.id=function(a){return arguments.length?(e=yl(a),o):e},o.parentId=function(a){return arguments.length?(n=yl(a),o):n},o},t.tree=function(){var e=t6,n=1,o=1,a=null;function s(p){var y=function(L){for(var z,F,W,Y,ae,ie=new bl(L,0),ce=[ie];z=ce.pop();)if(W=z._.children)for(z.children=new Array(ae=W.length),Y=ae-1;Y>=0;--Y)ce.push(F=z.children[Y]=new bl(W[Y],Y)),F.parent=z;return(ie.parent=new bl(null,0)).children=[ie],ie}(p);if(y.eachAfter(c),y.parent.m=-y.z,y.eachBefore(h),a)p.eachBefore(f);else{var w=p,_=p,b=p;p.eachBefore(function(L){L.x<w.x&&(w=L),L.x>_.x&&(_=L),L.depth>b.depth&&(b=L)});var T=w===_?1:e(w,_)/2,k=T-w.x,N=n/(_.x+T+k),P=o/(b.depth||1);p.eachBefore(function(L){L.x=(L.x+k)*N,L.y=L.depth*P})}return p}function c(p){var y=p.children,w=p.parent.children,_=p.i?w[p.i-1]:null;if(y){(function(T){for(var k,N=0,P=0,L=T.children,z=L.length;--z>=0;)(k=L[z]).z+=N,k.m+=N,N+=k.s+(P+=k.c)})(p);var b=(y[0].z+y[y.length-1].z)/2;_?(p.z=_.z+e(p._,_._),p.m=p.z-b):p.z=b}else _&&(p.z=_.z+e(p._,_._));p.parent.A=function(T,k,N){if(k){for(var P,L=T,z=T,F=k,W=L.parent.children[0],Y=L.m,ae=z.m,ie=F.m,ce=W.m;F=Lf(F),L=Sf(L),F&&L;)W=Sf(W),(z=Lf(z)).a=T,(P=F.z+ie-L.z-Y+e(F._,L._))>0&&(n6(r6(F,T,N),T,P),Y+=P,ae+=P),ie+=F.m,Y+=L.m,ce+=W.m,ae+=z.m;F&&!Lf(z)&&(z.t=F,z.m+=ie-ae),L&&!Sf(W)&&(W.t=L,W.m+=Y-ce,N=T)}return N}(p,_,p.parent.A||w[0])}function h(p){p._.x=p.z+p.parent.m,p.m+=p.parent.m}function f(p){p.x*=n,p.y=p.depth*o}return s.separation=function(p){return arguments.length?(e=p,s):e},s.size=function(p){return arguments.length?(a=!1,n=+p[0],o=+p[1],s):a?null:[n,o]},s.nodeSize=function(p){return arguments.length?(a=!0,n=+p[0],o=+p[1],s):a?[n,o]:null},s},t.treemap=function(){var e=Dm,n=!1,o=1,a=1,s=[0],c=Or,h=Or,f=Or,p=Or,y=Or;function w(b){return b.x0=b.y0=0,b.x1=o,b.y1=a,b.eachBefore(_),s=[0],n&&b.eachBefore(km),b}function _(b){var T=s[b.depth],k=b.x0+T,N=b.y0+T,P=b.x1-T,L=b.y1-T;P<k&&(k=P=(k+P)/2),L<N&&(N=L=(N+L)/2),b.x0=k,b.y0=N,b.x1=P,b.y1=L,b.children&&(T=s[b.depth+1]=c(b)/2,k+=y(b)-T,N+=h(b)-T,(P-=f(b)-T)<k&&(k=P=(k+P)/2),(L-=p(b)-T)<N&&(N=L=(N+L)/2),e(b,k,N,P,L))}return w.round=function(b){return arguments.length?(n=!!b,w):n},w.size=function(b){return arguments.length?(o=+b[0],a=+b[1],w):[o,a]},w.tile=function(b){return arguments.length?(e=yl(b),w):e},w.padding=function(b){return arguments.length?w.paddingInner(b).paddingOuter(b):w.paddingInner()},w.paddingInner=function(b){return arguments.length?(c=typeof b=="function"?b:xi(+b),w):c},w.paddingOuter=function(b){return arguments.length?w.paddingTop(b).paddingRight(b).paddingBottom(b).paddingLeft(b):w.paddingTop()},w.paddingTop=function(b){return arguments.length?(h=typeof b=="function"?b:xi(+b),w):h},w.paddingRight=function(b){return arguments.length?(f=typeof b=="function"?b:xi(+b),w):f},w.paddingBottom=function(b){return arguments.length?(p=typeof b=="function"?b:xi(+b),w):p},w.paddingLeft=function(b){return arguments.length?(y=typeof b=="function"?b:xi(+b),w):y},w},t.treemapBinary=function(e,n,o,a,s){var c,h,f=e.children,p=f.length,y=new Array(p+1);for(y[0]=h=c=0;c<p;++c)y[c+1]=h+=f[c].value;(function w(_,b,T,k,N,P,L){if(_>=b-1){var z=f[_];return z.x0=k,z.y0=N,z.x1=P,void(z.y1=L)}for(var F=y[_],W=T/2+F,Y=_+1,ae=b-1;Y<ae;){var ie=Y+ae>>>1;y[ie]<W?Y=ie+1:ae=ie}W-y[Y-1]<y[Y]-W&&_+1<Y&&--Y;var ce=y[Y]-F,G=T-ce;if(P-k>L-N){var ne=(k*G+P*ce)/T;w(_,Y,ce,k,N,ne,L),w(Y,b,G,ne,N,P,L)}else{var oe=(N*G+L*ce)/T;w(_,Y,ce,k,N,P,oe),w(Y,b,G,k,oe,P,L)}})(0,p,e.value,n,o,a,s)},t.treemapDice=Qo,t.treemapSlice=wl,t.treemapSliceDice=function(e,n,o,a,s){(1&e.depth?wl:Qo)(e,n,o,a,s)},t.treemapSquarify=Dm,t.treemapResquarify=i6,t.interpolate=wo,t.interpolateArray=Zp,t.interpolateBasis=Fp,t.interpolateBasisClosed=Bp,t.interpolateDate=jp,t.interpolateDiscrete=function(e){var n=e.length;return function(o){return e[Math.max(0,Math.min(n-1,Math.floor(o*n)))]}},t.interpolateHue=function(e,n){var o=us(+e,+n);return function(a){var s=o(a);return s-360*Math.floor(s/360)}},t.interpolateNumber=Wt,t.interpolateObject=Hp,t.interpolateRound=$p,t.interpolateString=au,t.interpolateTransformCss=Kp,t.interpolateTransformSvg=Jp,t.interpolateZoom=e0,t.interpolateRgb=bo,t.interpolateRgbBasis=Up,t.interpolateRgbBasisClosed=U2,t.interpolateHsl=j2,t.interpolateHslLong=H2,t.interpolateLab=function(e,n){var o=dt((e=as(e)).l,(n=as(n)).l),a=dt(e.a,n.a),s=dt(e.b,n.b),c=dt(e.opacity,n.opacity);return function(h){return e.l=o(h),e.a=a(h),e.b=s(h),e.opacity=c(h),e+""}},t.interpolateHcl=$2,t.interpolateHclLong=V2,t.interpolateCubehelix=W2,t.interpolateCubehelixLong=hs,t.piecewise=function(e,n){for(var o=0,a=n.length-1,s=n[0],c=new Array(a<0?0:a);o<a;)c[o]=e(s,s=n[++o]);return function(h){var f=Math.max(0,Math.min(a-1,Math.floor(h*=a)));return c[f](h-f)}},t.quantize=function(e,n){for(var o=new Array(n),a=0;a<n;++a)o[a]=e(a/(n-1));return o},t.path=ir,t.polygonArea=function(e){for(var n,o=-1,a=e.length,s=e[a-1],c=0;++o<a;)n=s,s=e[o],c+=n[1]*s[0]-n[0]*s[1];return c/2},t.polygonCentroid=function(e){for(var n,o,a=-1,s=e.length,c=0,h=0,f=e[s-1],p=0;++a<s;)n=f,f=e[a],p+=o=n[0]*f[1]-f[0]*n[1],c+=(n[0]+f[0])*o,h+=(n[1]+f[1])*o;return[c/(p*=3),h/p]},t.polygonHull=function(e){if((o=e.length)<3)return null;var n,o,a=new Array(o),s=new Array(o);for(n=0;n<o;++n)a[n]=[+e[n][0],+e[n][1],n];for(a.sort(o6),n=0;n<o;++n)s[n]=[a[n][0],-a[n][1]];var c=Sm(a),h=Sm(s),f=h[0]===c[0],p=h[h.length-1]===c[c.length-1],y=[];for(n=c.length-1;n>=0;--n)y.push(e[a[c[n]][2]]);for(n=+f;n<h.length-p;++n)y.push(e[a[h[n]][2]]);return y},t.polygonContains=function(e,n){for(var o,a,s=e.length,c=e[s-1],h=n[0],f=n[1],p=c[0],y=c[1],w=!1,_=0;_<s;++_)o=(c=e[_])[0],(a=c[1])>f!=y>f&&h<(p-o)*(f-a)/(y-a)+o&&(w=!w),p=o,y=a;return w},t.polygonLength=function(e){for(var n,o,a=-1,s=e.length,c=e[s-1],h=c[0],f=c[1],p=0;++a<s;)n=h,o=f,n-=h=(c=e[a])[0],o-=f=c[1],p+=Math.sqrt(n*n+o*o);return p},t.quadtree=As,t.randomUniform=a6,t.randomNormal=Lm,t.randomLogNormal=s6,t.randomBates=l6,t.randomIrwinHall=Pm,t.randomExponential=c6,t.scaleBand=Rf,t.scalePoint=function(){return function e(n){var o=n.copy;return n.padding=n.paddingOuter,delete n.paddingInner,delete n.paddingOuter,n.copy=function(){return e(o())},n}(Rf.apply(null,arguments).paddingInner(1))},t.scaleIdentity=function e(n){var o;function a(s){return isNaN(s=+s)?o:s}return a.invert=a,a.domain=a.range=function(s){return arguments.length?(n=_l.call(s,Ff),a):n.slice()},a.unknown=function(s){return arguments.length?(o=s,a):o},a.copy=function(){return e(n).unknown(o)},n=arguments.length?_l.call(n,Ff):[0,1],Fr(a)},t.scaleLinear=function e(){var n=Bm(mt,mt);return n.copy=function(){return ea(n,e())},sn.apply(n,arguments),Fr(n)},t.scaleLog=function e(){var n=zf(vl()).domain([1,10]);return n.copy=function(){return ea(n,e()).base(n.base())},sn.apply(n,arguments),n},t.scaleSymlog=function e(){var n=qf(vl());return n.copy=function(){return ea(n,e()).constant(n.constant())},sn.apply(n,arguments)},t.scaleOrdinal=Of,t.scaleImplicit=Pf,t.scalePow=Zf,t.scaleSqrt=function(){return Zf.apply(null,arguments).exponent(.5)},t.scaleQuantile=function e(){var n,o=[],a=[],s=[];function c(){var f=0,p=Math.max(1,a.length);for(s=new Array(p-1);++f<p;)s[f-1]=H(o,f/p);return h}function h(f){return isNaN(f=+f)?n:a[u(s,f)]}return h.invertExtent=function(f){var p=a.indexOf(f);return p<0?[NaN,NaN]:[p>0?s[p-1]:o[0],p<s.length?s[p]:o[o.length-1]]},h.domain=function(f){if(!arguments.length)return o.slice();o=[];for(var p,y=0,w=f.length;y<w;++y)(p=f[y])==null||isNaN(p=+p)||o.push(p);return o.sort(r),c()},h.range=function(f){return arguments.length?(a=Rr.call(f),c()):a.slice()},h.unknown=function(f){return arguments.length?(n=f,h):n},h.quantiles=function(){return s.slice()},h.copy=function(){return e().domain(o).range(a).unknown(n)},sn.apply(h,arguments)},t.scaleQuantize=function e(){var n,o=0,a=1,s=1,c=[.5],h=[0,1];function f(y){return y<=y?h[u(c,y,0,s)]:n}function p(){var y=-1;for(c=new Array(s);++y<s;)c[y]=((y+1)*a-(y-s)*o)/(s+1);return f}return f.domain=function(y){return arguments.length?(o=+y[0],a=+y[1],p()):[o,a]},f.range=function(y){return arguments.length?(s=(h=Rr.call(y)).length-1,p()):h.slice()},f.invertExtent=function(y){var w=h.indexOf(y);return w<0?[NaN,NaN]:w<1?[o,c[0]]:w>=s?[c[s-1],a]:[c[w-1],c[w]]},f.unknown=function(y){return arguments.length&&(n=y),f},f.thresholds=function(){return c.slice()},f.copy=function(){return e().domain([o,a]).range(h).unknown(n)},sn.apply(Fr(f),arguments)},t.scaleThreshold=function e(){var n,o=[.5],a=[0,1],s=1;function c(h){return h<=h?a[u(o,h,0,s)]:n}return c.domain=function(h){return arguments.length?(o=Rr.call(h),s=Math.min(o.length,a.length-1),c):o.slice()},c.range=function(h){return arguments.length?(a=Rr.call(h),s=Math.min(o.length,a.length-1),c):a.slice()},c.invertExtent=function(h){var f=a.indexOf(h);return[o[f-1],o[f]]},c.unknown=function(h){return arguments.length?(n=h,c):n},c.copy=function(){return e().domain(o).range(a).unknown(n)},sn.apply(c,arguments)},t.scaleTime=function(){return sn.apply(Yf(Zn,Wf,ra,na,Vf,$f,ta,Br,t.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},t.scaleUtc=function(){return sn.apply(Yf(jn,Kf,sa,aa,Xf,Gf,ta,Br,t.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},t.scaleSequential=function e(){var n=Fr(Tl()(mt));return n.copy=function(){return cr(n,e())},Un.apply(n,arguments)},t.scaleSequentialLog=function e(){var n=zf(Tl()).domain([1,10]);return n.copy=function(){return cr(n,e()).base(n.base())},Un.apply(n,arguments)},t.scaleSequentialPow=Qf,t.scaleSequentialSqrt=function(){return Qf.apply(null,arguments).exponent(.5)},t.scaleSequentialSymlog=function e(){var n=qf(Tl());return n.copy=function(){return cr(n,e()).constant(n.constant())},Un.apply(n,arguments)},t.scaleSequentialQuantile=function e(){var n=[],o=mt;function a(s){if(!isNaN(s=+s))return o((u(n,s)-1)/(n.length-1))}return a.domain=function(s){if(!arguments.length)return n.slice();n=[];for(var c,h=0,f=s.length;h<f;++h)(c=s[h])==null||isNaN(c=+c)||n.push(c);return n.sort(r),a},a.interpolator=function(s){return arguments.length?(o=s,a):o},a.copy=function(){return e(o).domain(n)},Un.apply(a,arguments)},t.scaleDiverging=function e(){var n=Fr(Il()(mt));return n.copy=function(){return cr(n,e())},Un.apply(n,arguments)},t.scaleDivergingLog=function e(){var n=zf(Il()).domain([.1,1,10]);return n.copy=function(){return cr(n,e()).base(n.base())},Un.apply(n,arguments)},t.scaleDivergingPow=eh,t.scaleDivergingSqrt=function(){return eh.apply(null,arguments).exponent(.5)},t.scaleDivergingSymlog=function e(){var n=qf(Il());return n.copy=function(){return cr(n,e()).constant(n.constant())},Un.apply(n,arguments)},t.tickFormat=zm,t.schemeCategory10=U3,t.schemeAccent=Z3,t.schemeDark2=j3,t.schemePaired=H3,t.schemePastel1=$3,t.schemePastel2=V3,t.schemeSet1=W3,t.schemeSet2=G3,t.schemeSet3=X3,t.interpolateBrBG=K3,t.schemeBrBG=w1,t.interpolatePRGn=J3,t.schemePRGn=_1,t.interpolatePiYG=Y3,t.schemePiYG=v1,t.interpolatePuOr=Q3,t.schemePuOr=x1,t.interpolateRdBu=eT,t.schemeRdBu=T1,t.interpolateRdGy=tT,t.schemeRdGy=I1,t.interpolateRdYlBu=nT,t.schemeRdYlBu=E1,t.interpolateRdYlGn=rT,t.schemeRdYlGn=k1,t.interpolateSpectral=iT,t.schemeSpectral=C1,t.interpolateBuGn=oT,t.schemeBuGn=N1,t.interpolateBuPu=aT,t.schemeBuPu=A1,t.interpolateGnBu=sT,t.schemeGnBu=M1,t.interpolateOrRd=lT,t.schemeOrRd=D1,t.interpolatePuBuGn=cT,t.schemePuBuGn=S1,t.interpolatePuBu=uT,t.schemePuBu=L1,t.interpolatePuRd=fT,t.schemePuRd=P1,t.interpolateRdPu=hT,t.schemeRdPu=O1,t.interpolateYlGnBu=dT,t.schemeYlGnBu=R1,t.interpolateYlGn=pT,t.schemeYlGn=F1,t.interpolateYlOrBr=gT,t.schemeYlOrBr=B1,t.interpolateYlOrRd=mT,t.schemeYlOrRd=z1,t.interpolateBlues=yT,t.schemeBlues=q1,t.interpolateGreens=bT,t.schemeGreens=U1,t.interpolateGreys=wT,t.schemeGreys=Z1,t.interpolatePurples=_T,t.schemePurples=j1,t.interpolateReds=vT,t.schemeReds=H1,t.interpolateOranges=xT,t.schemeOranges=$1,t.interpolateCubehelixDefault=TT,t.interpolateRainbow=function(e){(e<0||e>1)&&(e-=Math.floor(e));var n=Math.abs(e-.5);return El.h=360*e-100,El.s=1.5-1.5*n,El.l=.8-.9*n,El+""},t.interpolateWarm=IT,t.interpolateCool=ET,t.interpolateSinebow=function(e){var n;return e=(.5-e)*Math.PI,kl.r=255*(n=Math.sin(e))*n,kl.g=255*(n=Math.sin(e+kT))*n,kl.b=255*(n=Math.sin(e+CT))*n,kl+""},t.interpolateViridis=NT,t.interpolateMagma=AT,t.interpolateInferno=MT,t.interpolatePlasma=DT,t.create=function(e){return Pt(ct(e).call(document.documentElement))},t.creator=ct,t.local=wp,t.matcher=uo,t.mouse=tr,t.namespace=Ye,t.namespaces=tt,t.clientPoint=es,t.select=Pt,t.selectAll=function(e){return typeof e=="string"?new It([document.querySelectorAll(e)],[document.documentElement]):new It([e??[]],jc)},t.selection=kr,t.selector=en,t.selectorAll=zt,t.style=Er,t.touch=ts,t.touches=function(e,n){n==null&&(n=$c().touches);for(var o=0,a=n?n.length:0,s=new Array(a);o<a;++o)s[o]=es(e,n[o]);return s},t.window=Uc,t.customEvent=po,t.arc=function(){var e=LT,n=PT,o=De(0),a=null,s=OT,c=RT,h=FT,f=null;function p(){var y,w,_,b=+e.apply(this,arguments),T=+n.apply(this,arguments),k=s.apply(this,arguments)-Nl,N=c.apply(this,arguments)-Nl,P=V1(N-k),L=N>k;if(f||(f=y=ir()),T<b&&(w=T,T=b,b=w),T>_t)if(P>fr-_t)f.moveTo(T*Zr(k),T*_n(k)),f.arc(0,0,T,k,N,!L),b>_t&&(f.moveTo(b*Zr(N),b*_n(N)),f.arc(0,0,b,N,k,L));else{var z,F,W=k,Y=N,ae=k,ie=N,ce=P,G=P,ne=h.apply(this,arguments)/2,oe=ne>_t&&(a?+a.apply(this,arguments):Ei(b*b+T*T)),ee=th(V1(T-b)/2,+o.apply(this,arguments)),q=ee,Q=ee;if(oe>_t){var ue=W1(oe/b*_n(ne)),he=W1(oe/T*_n(ne));(ce-=2*ue)>_t?(ae+=ue*=L?1:-1,ie-=ue):(ce=0,ae=ie=(k+N)/2),(G-=2*he)>_t?(W+=he*=L?1:-1,Y-=he):(G=0,W=Y=(k+N)/2)}var pe=T*Zr(W),Ee=T*_n(W),Ne=b*Zr(ie),je=b*_n(ie);if(ee>_t){var be,Se=T*Zr(Y),He=T*_n(Y),Le=b*Zr(ae),Re=b*_n(ae);if(P<ur&&(be=function(_h,vh,II,EI,Py,Oy,kI,CI){var Ry=II-_h,Fy=EI-vh,By=kI-Py,zy=CI-Oy,ka=zy*Ry-By*Fy;if(!(ka*ka<_t))return[_h+(ka=(By*(vh-Oy)-zy*(_h-Py))/ka)*Ry,vh+ka*Fy]}(pe,Ee,Le,Re,Se,He,Ne,je))){var Qe=pe-be[0],xt=Ee-be[1],Di=Se-be[0],vn=He-be[1],Ea=1/_n(((_=(Qe*Di+xt*vn)/(Ei(Qe*Qe+xt*xt)*Ei(Di*Di+vn*vn)))>1?0:_<-1?ur:Math.acos(_))/2),St=Ei(be[0]*be[0]+be[1]*be[1]);q=th(ee,(b-St)/(Ea-1)),Q=th(ee,(T-St)/(Ea+1))}}G>_t?Q>_t?(z=Al(Le,Re,pe,Ee,T,Q,L),F=Al(Se,He,Ne,je,T,Q,L),f.moveTo(z.cx+z.x01,z.cy+z.y01),Q<ee?f.arc(z.cx,z.cy,Q,wt(z.y01,z.x01),wt(F.y01,F.x01),!L):(f.arc(z.cx,z.cy,Q,wt(z.y01,z.x01),wt(z.y11,z.x11),!L),f.arc(0,0,T,wt(z.cy+z.y11,z.cx+z.x11),wt(F.cy+F.y11,F.cx+F.x11),!L),f.arc(F.cx,F.cy,Q,wt(F.y11,F.x11),wt(F.y01,F.x01),!L))):(f.moveTo(pe,Ee),f.arc(0,0,T,W,Y,!L)):f.moveTo(pe,Ee),b>_t&&ce>_t?q>_t?(z=Al(Ne,je,Se,He,b,-q,L),F=Al(pe,Ee,Le,Re,b,-q,L),f.lineTo(z.cx+z.x01,z.cy+z.y01),q<ee?f.arc(z.cx,z.cy,q,wt(z.y01,z.x01),wt(F.y01,F.x01),!L):(f.arc(z.cx,z.cy,q,wt(z.y01,z.x01),wt(z.y11,z.x11),!L),f.arc(0,0,b,wt(z.cy+z.y11,z.cx+z.x11),wt(F.cy+F.y11,F.cx+F.x11),L),f.arc(F.cx,F.cy,q,wt(F.y11,F.x11),wt(F.y01,F.x01),!L))):f.arc(0,0,b,ie,ae,L):f.lineTo(Ne,je)}else f.moveTo(0,0);if(f.closePath(),y)return f=null,y+""||null}return p.centroid=function(){var y=(+e.apply(this,arguments)+ +n.apply(this,arguments))/2,w=(+s.apply(this,arguments)+ +c.apply(this,arguments))/2-ur/2;return[Zr(w)*y,_n(w)*y]},p.innerRadius=function(y){return arguments.length?(e=typeof y=="function"?y:De(+y),p):e},p.outerRadius=function(y){return arguments.length?(n=typeof y=="function"?y:De(+y),p):n},p.cornerRadius=function(y){return arguments.length?(o=typeof y=="function"?y:De(+y),p):o},p.padRadius=function(y){return arguments.length?(a=y==null?null:typeof y=="function"?y:De(+y),p):a},p.startAngle=function(y){return arguments.length?(s=typeof y=="function"?y:De(+y),p):s},p.endAngle=function(y){return arguments.length?(c=typeof y=="function"?y:De(+y),p):c},p.padAngle=function(y){return arguments.length?(h=typeof y=="function"?y:De(+y),p):h},p.context=function(y){return arguments.length?(f=y??null,p):f},p},t.area=X1,t.line=ih,t.pie=function(){var e=zT,n=BT,o=null,a=De(0),s=De(fr),c=De(0);function h(f){var p,y,w,_,b,T=f.length,k=0,N=new Array(T),P=new Array(T),L=+a.apply(this,arguments),z=Math.min(fr,Math.max(-fr,s.apply(this,arguments)-L)),F=Math.min(Math.abs(z)/T,c.apply(this,arguments)),W=F*(z<0?-1:1);for(p=0;p<T;++p)(b=P[N[p]=p]=+e(f[p],p,f))>0&&(k+=b);for(n!=null?N.sort(function(Y,ae){return n(P[Y],P[ae])}):o!=null&&N.sort(function(Y,ae){return o(f[Y],f[ae])}),p=0,w=k?(z-T*W)/k:0;p<T;++p,L=_)y=N[p],_=L+((b=P[y])>0?b*w:0)+W,P[y]={data:f[y],index:p,value:b,startAngle:L,endAngle:_,padAngle:F};return P}return h.value=function(f){return arguments.length?(e=typeof f=="function"?f:De(+f),h):e},h.sortValues=function(f){return arguments.length?(n=f,o=null,h):n},h.sort=function(f){return arguments.length?(o=f,n=null,h):o},h.startAngle=function(f){return arguments.length?(a=typeof f=="function"?f:De(+f),h):a},h.endAngle=function(f){return arguments.length?(s=typeof f=="function"?f:De(+f),h):s},h.padAngle=function(f){return arguments.length?(c=typeof f=="function"?f:De(+f),h):c},h},t.areaRadial=Q1,t.radialArea=Q1,t.lineRadial=Y1,t.radialLine=Y1,t.pointRadial=ba,t.linkHorizontal=function(){return sh(ZT)},t.linkVertical=function(){return sh(jT)},t.linkRadial=function(){var e=sh(HT);return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e},t.symbol=function(){var e=De(lh),n=De(64),o=null;function a(){var s;if(o||(o=s=ir()),e.apply(this,arguments).draw(o,+n.apply(this,arguments)),s)return o=null,s+""||null}return a.type=function(s){return arguments.length?(e=typeof s=="function"?s:De(s),a):e},a.size=function(s){return arguments.length?(n=typeof s=="function"?s:De(+s),a):n},a.context=function(s){return arguments.length?(o=s??null,a):o},a},t.symbols=XT,t.symbolCircle=lh,t.symbolCross=ey,t.symbolDiamond=ny,t.symbolSquare=oy,t.symbolStar=iy,t.symbolTriangle=ay,t.symbolWye=sy,t.curveBasisClosed=function(e){return new ly(e)},t.curveBasisOpen=function(e){return new cy(e)},t.curveBasis=function(e){return new Sl(e)},t.curveBundle=KT,t.curveCardinalClosed=YT,t.curveCardinalOpen=QT,t.curveCardinal=JT,t.curveCatmullRomClosed=tI,t.curveCatmullRomOpen=nI,t.curveCatmullRom=eI,t.curveLinearClosed=function(e){return new py(e)},t.curveLinear=Ml,t.curveMonotoneX=function(e){return new Pl(e)},t.curveMonotoneY=function(e){return new by(e)},t.curveNatural=function(e){return new _y(e)},t.curveStep=function(e){return new Ol(e,.5)},t.curveStepAfter=function(e){return new Ol(e,1)},t.curveStepBefore=function(e){return new Ol(e,0)},t.stack=function(){var e=De([]),n=Ci,o=ki,a=rI;function s(c){var h,f,p=e.apply(this,arguments),y=c.length,w=p.length,_=new Array(w);for(h=0;h<w;++h){for(var b,T=p[h],k=_[h]=new Array(y),N=0;N<y;++N)k[N]=b=[0,+a(c[N],T,N,c)],b.data=c[N];k.key=T}for(h=0,f=n(_);h<w;++h)_[f[h]].index=h;return o(_,f),_}return s.keys=function(c){return arguments.length?(e=typeof c=="function"?c:De(ah.call(c)),s):e},s.value=function(c){return arguments.length?(a=typeof c=="function"?c:De(+c),s):a},s.order=function(c){return arguments.length?(n=c==null?Ci:typeof c=="function"?c:De(ah.call(c)),s):n},s.offset=function(c){return arguments.length?(o=c??ki,s):o},s},t.stackOffsetExpand=function(e,n){if((a=e.length)>0){for(var o,a,s,c=0,h=e[0].length;c<h;++c){for(s=o=0;o<a;++o)s+=e[o][c][1]||0;if(s)for(o=0;o<a;++o)e[o][c][1]/=s}ki(e,n)}},t.stackOffsetDiverging=function(e,n){if((f=e.length)>1)for(var o,a,s,c,h,f,p=0,y=e[n[0]].length;p<y;++p)for(c=h=0,o=0;o<f;++o)(s=(a=e[n[o]][p])[1]-a[0])>=0?(a[0]=c,a[1]=c+=s):s<0?(a[1]=h,a[0]=h+=s):a[0]=c},t.stackOffsetNone=ki,t.stackOffsetSilhouette=function(e,n){if((o=e.length)>0){for(var o,a=0,s=e[n[0]],c=s.length;a<c;++a){for(var h=0,f=0;h<o;++h)f+=e[h][a][1]||0;s[a][1]+=s[a][0]=-f/2}ki(e,n)}},t.stackOffsetWiggle=function(e,n){if((s=e.length)>0&&(a=(o=e[n[0]]).length)>0){for(var o,a,s,c=0,h=1;h<a;++h){for(var f=0,p=0,y=0;f<s;++f){for(var w=e[n[f]],_=w[h][1]||0,b=(_-(w[h-1][1]||0))/2,T=0;T<f;++T){var k=e[n[T]];b+=(k[h][1]||0)-(k[h-1][1]||0)}p+=_,y+=b*_}o[h-1][1]+=o[h-1][0]=c,p&&(c-=y/p)}o[h-1][1]+=o[h-1][0]=c,ki(e,n)}},t.stackOrderAppearance=xy,t.stackOrderAscending=Ty,t.stackOrderDescending=function(e){return Ty(e).reverse()},t.stackOrderInsideOut=function(e){var n,o,a=e.length,s=e.map(Iy),c=xy(e),h=0,f=0,p=[],y=[];for(n=0;n<a;++n)o=c[n],h<f?(h+=s[o],p.push(o)):(f+=s[o],y.push(o));return y.reverse().concat(p)},t.stackOrderNone=Ci,t.stackOrderReverse=function(e){return Ci(e).reverse()},t.timeInterval=ht,t.timeMillisecond=Br,t.timeMilliseconds=Wm,t.utcMillisecond=Br,t.utcMilliseconds=Wm,t.timeSecond=ta,t.timeSeconds=Xm,t.utcSecond=ta,t.utcSeconds=Xm,t.timeMinute=$f,t.timeMinutes=y6,t.timeHour=Vf,t.timeHours=b6,t.timeDay=na,t.timeDays=w6,t.timeWeek=ra,t.timeWeeks=e1,t.timeSunday=ra,t.timeSundays=e1,t.timeMonday=ia,t.timeMondays=_6,t.timeTuesday=Km,t.timeTuesdays=v6,t.timeWednesday=Jm,t.timeWednesdays=x6,t.timeThursday=oa,t.timeThursdays=T6,t.timeFriday=Ym,t.timeFridays=I6,t.timeSaturday=Qm,t.timeSaturdays=E6,t.timeMonth=Wf,t.timeMonths=k6,t.timeYear=Zn,t.timeYears=C6,t.utcMinute=Gf,t.utcMinutes=N6,t.utcHour=Xf,t.utcHours=A6,t.utcDay=aa,t.utcDays=M6,t.utcWeek=sa,t.utcWeeks=o1,t.utcSunday=sa,t.utcSundays=o1,t.utcMonday=la,t.utcMondays=D6,t.utcTuesday=t1,t.utcTuesdays=S6,t.utcWednesday=n1,t.utcWednesdays=L6,t.utcThursday=ca,t.utcThursdays=P6,t.utcFriday=r1,t.utcFridays=O6,t.utcSaturday=i1,t.utcSaturdays=R6,t.utcMonth=Kf,t.utcMonths=F6,t.utcYear=jn,t.utcYears=B6,t.timeFormatDefaultLocale=y1,t.timeFormatLocale=a1,t.isoFormat=R3,t.isoParse=F3,t.now=li,t.timer=ms,t.timerFlush=a0,t.timeout=fu,t.interval=function(e,n,o){var a=new ko,s=n;return n==null?(a.restart(e,n,o),a):(n=+n,o=o==null?li():+o,a.restart(function c(h){h+=s,a.restart(c,s+=n,o),e(h)},n,o),a)},t.transition=h0,t.active=function(e,n){var o,a,s=e.__transition;if(s){for(a in n=n==null?null:n+"",s)if((o=s[a]).state>hu&&o.name===n)return new gn([[e]],gx,n,+a)}return null},t.interrupt=Ar,t.voronoi=function(){var e=oI,n=aI,o=null;function a(s){return new bh(s.map(function(c,h){var f=[Math.round(e(c,h,s)/Ve)*Ve,Math.round(n(c,h,s)/Ve)*Ve];return f.index=h,f.data=c,f}),o)}return a.polygons=function(s){return a(s).polygons()},a.links=function(s){return a(s).links()},a.triangles=function(s){return a(s).triangles()},a.x=function(s){return arguments.length?(e=typeof s=="function"?s:Ey(+s),a):e},a.y=function(s){return arguments.length?(n=typeof s=="function"?s:Ey(+s),a):n},a.extent=function(s){return arguments.length?(o=s==null?null:[[+s[0][0],+s[0][1]],[+s[1][0],+s[1][1]]],a):o&&[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},a.size=function(s){return arguments.length?(o=s==null?null:[[0,0],[+s[0],+s[1]]],a):o&&[o[1][0]-o[0][0],o[1][1]-o[0][1]]},a},t.zoom=function(){var e,n,o=wI,a=_I,s=TI,c=vI,h=xI,f=[0,1/0],p=[[-1/0,-1/0],[1/0,1/0]],y=250,w=e0,_=[],b=j("start","zoom","end"),T=500,k=150,N=0;function P(q){q.property("__zoom",Ly).on("wheel.zoom",ie).on("mousedown.zoom",ce).on("dblclick.zoom",G).filter(h).on("touchstart.zoom",ne).on("touchmove.zoom",oe).on("touchend.zoom touchcancel.zoom",ee).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function L(q,Q){return(Q=Math.max(f[0],Math.min(f[1],Q)))===q.k?q:new Hn(Q,q.x,q.y)}function z(q,Q,ue){var he=Q[0]-ue[0]*q.k,pe=Q[1]-ue[1]*q.k;return he===q.x&&pe===q.y?q:new Hn(q.k,he,pe)}function F(q){return[(+q[0][0]+ +q[1][0])/2,(+q[0][1]+ +q[1][1])/2]}function W(q,Q,ue){q.on("start.zoom",function(){Y(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){Y(this,arguments).end()}).tween("zoom",function(){var he=arguments,pe=Y(this,he),Ee=a.apply(this,he),Ne=ue||F(Ee),je=Math.max(Ee[1][0]-Ee[0][0],Ee[1][1]-Ee[0][1]),be=this.__zoom,Se=typeof Q=="function"?Q.apply(this,he):Q,He=w(be.invert(Ne).concat(je/be.k),Se.invert(Ne).concat(je/Se.k));return function(Le){if(Le===1)Le=Se;else{var Re=He(Le),Qe=je/Re[2];Le=new Hn(Qe,Ne[0]-Re[0]*Qe,Ne[1]-Re[1]*Qe)}pe.zoom(null,Le)}})}function Y(q,Q){for(var ue,he=0,pe=_.length;he<pe;++he)if((ue=_[he]).that===q)return ue;return new ae(q,Q)}function ae(q,Q){this.that=q,this.args=Q,this.index=-1,this.active=0,this.extent=a.apply(q,Q)}function ie(){if(o.apply(this,arguments)){var q=Y(this,arguments),Q=this.__zoom,ue=Math.max(f[0],Math.min(f[1],Q.k*Math.pow(2,c.apply(this,arguments)))),he=tr(this);if(q.wheel)q.mouse[0][0]===he[0]&&q.mouse[0][1]===he[1]||(q.mouse[1]=Q.invert(q.mouse[0]=he)),window.clearTimeout(q.wheel);else{if(Q.k===ue)return;q.mouse=[he,Q.invert(he)],Ar(this),q.start()}Ia(),q.wheel=window.setTimeout(function(){q.wheel=null,q.end()},k),q.zoom("mouse",s(z(L(Q,ue),q.mouse[0],q.mouse[1]),q.extent,p))}}function ce(){if(!n&&o.apply(this,arguments)){var q=Y(this,arguments),Q=Pt(t.event.view).on("mousemove.zoom",function(){if(Ia(),!q.moved){var Ee=t.event.clientX-he,Ne=t.event.clientY-pe;q.moved=Ee*Ee+Ne*Ne>N}q.zoom("mouse",s(z(q.that.__zoom,q.mouse[0]=tr(q.that),q.mouse[1]),q.extent,p))},!0).on("mouseup.zoom",function(){Q.on("mousemove.zoom mouseup.zoom",null),rs(t.event.view,q.moved),Ia(),q.end()},!0),ue=tr(this),he=t.event.clientX,pe=t.event.clientY;ns(t.event.view),wh(),q.mouse=[ue,this.__zoom.invert(ue)],Ar(this),q.start()}}function G(){if(o.apply(this,arguments)){var q=this.__zoom,Q=tr(this),ue=q.invert(Q),he=q.k*(t.event.shiftKey?.5:2),pe=s(z(L(q,he),Q,ue),a.apply(this,arguments),p);Ia(),y>0?Pt(this).transition().duration(y).call(W,pe,Q):Pt(this).call(P.transform,pe)}}function ne(){if(o.apply(this,arguments)){var q,Q,ue,he,pe=Y(this,arguments),Ee=t.event.changedTouches,Ne=Ee.length;for(wh(),Q=0;Q<Ne;++Q)he=[he=ts(this,Ee,(ue=Ee[Q]).identifier),this.__zoom.invert(he),ue.identifier],pe.touch0?pe.touch1||(pe.touch1=he):(pe.touch0=he,q=!0);if(e&&(e=window.clearTimeout(e),!pe.touch1))return pe.end(),void((he=Pt(this).on("dblclick.zoom"))&&he.apply(this,arguments));q&&(e=window.setTimeout(function(){e=null},T),Ar(this),pe.start())}}function oe(){var q,Q,ue,he,pe=Y(this,arguments),Ee=t.event.changedTouches,Ne=Ee.length;for(Ia(),e&&(e=window.clearTimeout(e)),q=0;q<Ne;++q)ue=ts(this,Ee,(Q=Ee[q]).identifier),pe.touch0&&pe.touch0[2]===Q.identifier?pe.touch0[0]=ue:pe.touch1&&pe.touch1[2]===Q.identifier&&(pe.touch1[0]=ue);if(Q=pe.that.__zoom,pe.touch1){var je=pe.touch0[0],be=pe.touch0[1],Se=pe.touch1[0],He=pe.touch1[1],Le=(Le=Se[0]-je[0])*Le+(Le=Se[1]-je[1])*Le,Re=(Re=He[0]-be[0])*Re+(Re=He[1]-be[1])*Re;Q=L(Q,Math.sqrt(Le/Re)),ue=[(je[0]+Se[0])/2,(je[1]+Se[1])/2],he=[(be[0]+He[0])/2,(be[1]+He[1])/2]}else{if(!pe.touch0)return;ue=pe.touch0[0],he=pe.touch0[1]}pe.zoom("touch",s(z(Q,ue,he),pe.extent,p))}function ee(){var q,Q,ue=Y(this,arguments),he=t.event.changedTouches,pe=he.length;for(wh(),n&&window.clearTimeout(n),n=window.setTimeout(function(){n=null},T),q=0;q<pe;++q)Q=he[q],ue.touch0&&ue.touch0[2]===Q.identifier?delete ue.touch0:ue.touch1&&ue.touch1[2]===Q.identifier&&delete ue.touch1;ue.touch1&&!ue.touch0&&(ue.touch0=ue.touch1,delete ue.touch1),ue.touch0?ue.touch0[1]=this.__zoom.invert(ue.touch0[0]):ue.end()}return P.transform=function(q,Q){var ue=q.selection?q.selection():q;ue.property("__zoom",Ly),q!==ue?W(q,Q):ue.interrupt().each(function(){Y(this,arguments).start().zoom(null,typeof Q=="function"?Q.apply(this,arguments):Q).end()})},P.scaleBy=function(q,Q){P.scaleTo(q,function(){return this.__zoom.k*(typeof Q=="function"?Q.apply(this,arguments):Q)})},P.scaleTo=function(q,Q){P.transform(q,function(){var ue=a.apply(this,arguments),he=this.__zoom,pe=F(ue),Ee=he.invert(pe),Ne=typeof Q=="function"?Q.apply(this,arguments):Q;return s(z(L(he,Ne),pe,Ee),ue,p)})},P.translateBy=function(q,Q,ue){P.transform(q,function(){return s(this.__zoom.translate(typeof Q=="function"?Q.apply(this,arguments):Q,typeof ue=="function"?ue.apply(this,arguments):ue),a.apply(this,arguments),p)})},P.translateTo=function(q,Q,ue){P.transform(q,function(){var he=a.apply(this,arguments),pe=this.__zoom,Ee=F(he);return s(ql.translate(Ee[0],Ee[1]).scale(pe.k).translate(typeof Q=="function"?-Q.apply(this,arguments):-Q,typeof ue=="function"?-ue.apply(this,arguments):-ue),he,p)})},ae.prototype={start:function(){return++this.active==1&&(this.index=_.push(this)-1,this.emit("start")),this},zoom:function(q,Q){return this.mouse&&q!=="mouse"&&(this.mouse[1]=Q.invert(this.mouse[0])),this.touch0&&q!=="touch"&&(this.touch0[1]=Q.invert(this.touch0[0])),this.touch1&&q!=="touch"&&(this.touch1[1]=Q.invert(this.touch1[0])),this.that.__zoom=Q,this.emit("zoom"),this},end:function(){return--this.active==0&&(_.splice(this.index,1),this.index=-1,this.emit("end")),this},emit:function(q){po(new bI(P,q,this.that.__zoom),b.apply,b,[q,this.that,this.args])}},P.wheelDelta=function(q){return arguments.length?(c=typeof q=="function"?q:zl(+q),P):c},P.filter=function(q){return arguments.length?(o=typeof q=="function"?q:zl(!!q),P):o},P.touchable=function(q){return arguments.length?(h=typeof q=="function"?q:zl(!!q),P):h},P.extent=function(q){return arguments.length?(a=typeof q=="function"?q:zl([[+q[0][0],+q[0][1]],[+q[1][0],+q[1][1]]]),P):a},P.scaleExtent=function(q){return arguments.length?(f[0]=+q[0],f[1]=+q[1],P):[f[0],f[1]]},P.translateExtent=function(q){return arguments.length?(p[0][0]=+q[0][0],p[1][0]=+q[1][0],p[0][1]=+q[0][1],p[1][1]=+q[1][1],P):[[p[0][0],p[0][1]],[p[1][0],p[1][1]]]},P.constrain=function(q){return arguments.length?(s=q,P):s},P.duration=function(q){return arguments.length?(y=+q,P):y},P.interpolate=function(q){return arguments.length?(w=q,P):w},P.on=function(){var q=b.on.apply(b,arguments);return q===b?P:q},P.clickDistance=function(q){return arguments.length?(N=(q=+q)*q,P):Math.sqrt(N)},P},t.zoomTransform=Sy,t.zoomIdentity=ql,Object.defineProperty(t,"__esModule",{value:!0})})});var I_=me((nk,Hi)=>{"use strict";function ji(t){let r=t.length;for(;--r>=0;)t[r]=0}var O5=0,c_=1,R5=2,F5=3,B5=258,id=29,za=256,Oa=za+1+id,Zi=30,od=19,u_=2*Oa+1,Xr=15,Yh=16,z5=7,ad=256,f_=16,h_=17,d_=18,nd=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),fc=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),q5=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),p_=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),U5=512,Xn=new Array((Oa+2)*2);ji(Xn);var Pa=new Array(Zi*2);ji(Pa);var Ra=new Array(U5);ji(Ra);var Fa=new Array(B5-F5+1);ji(Fa);var sd=new Array(id);ji(sd);var hc=new Array(Zi);ji(hc);function Qh(t,r,i,l,u){this.static_tree=t,this.extra_bits=r,this.extra_base=i,this.elems=l,this.max_length=u,this.has_stree=t&&t.length}var g_,m_,y_;function ed(t,r){this.dyn_tree=t,this.max_code=0,this.stat_desc=r}var b_=t=>t<256?Ra[t]:Ra[256+(t>>>7)],Ba=(t,r)=>{t.pending_buf[t.pending++]=r&255,t.pending_buf[t.pending++]=r>>>8&255},Bt=(t,r,i)=>{t.bi_valid>Yh-i?(t.bi_buf|=r<<t.bi_valid&65535,Ba(t,t.bi_buf),t.bi_buf=r>>Yh-t.bi_valid,t.bi_valid+=i-Yh):(t.bi_buf|=r<<t.bi_valid&65535,t.bi_valid+=i)},kn=(t,r,i)=>{Bt(t,i[r*2],i[r*2+1])},w_=(t,r)=>{let i=0;do i|=t&1,t>>>=1,i<<=1;while(--r>0);return i>>>1},Z5=t=>{t.bi_valid===16?(Ba(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)},j5=(t,r)=>{let i=r.dyn_tree,l=r.max_code,u=r.stat_desc.static_tree,d=r.stat_desc.has_stree,g=r.stat_desc.extra_bits,m=r.stat_desc.extra_base,x=r.stat_desc.max_length,v,I,S,M,E,C,B=0;for(M=0;M<=Xr;M++)t.bl_count[M]=0;for(i[t.heap[t.heap_max]*2+1]=0,v=t.heap_max+1;v<u_;v++)I=t.heap[v],M=i[i[I*2+1]*2+1]+1,M>x&&(M=x,B++),i[I*2+1]=M,!(I>l)&&(t.bl_count[M]++,E=0,I>=m&&(E=g[I-m]),C=i[I*2],t.opt_len+=C*(M+E),d&&(t.static_len+=C*(u[I*2+1]+E)));if(B!==0){do{for(M=x-1;t.bl_count[M]===0;)M--;t.bl_count[M]--,t.bl_count[M+1]+=2,t.bl_count[x]--,B-=2}while(B>0);for(M=x;M!==0;M--)for(I=t.bl_count[M];I!==0;)S=t.heap[--v],!(S>l)&&(i[S*2+1]!==M&&(t.opt_len+=(M-i[S*2+1])*i[S*2],i[S*2+1]=M),I--)}},__=(t,r,i)=>{let l=new Array(Xr+1),u=0,d,g;for(d=1;d<=Xr;d++)u=u+i[d-1]<<1,l[d]=u;for(g=0;g<=r;g++){let m=t[g*2+1];m!==0&&(t[g*2]=w_(l[m]++,m))}},H5=()=>{let t,r,i,l,u,d=new Array(Xr+1);for(i=0,l=0;l<id-1;l++)for(sd[l]=i,t=0;t<1<<nd[l];t++)Fa[i++]=l;for(Fa[i-1]=l,u=0,l=0;l<16;l++)for(hc[l]=u,t=0;t<1<<fc[l];t++)Ra[u++]=l;for(u>>=7;l<Zi;l++)for(hc[l]=u<<7,t=0;t<1<<fc[l]-7;t++)Ra[256+u++]=l;for(r=0;r<=Xr;r++)d[r]=0;for(t=0;t<=143;)Xn[t*2+1]=8,t++,d[8]++;for(;t<=255;)Xn[t*2+1]=9,t++,d[9]++;for(;t<=279;)Xn[t*2+1]=7,t++,d[7]++;for(;t<=287;)Xn[t*2+1]=8,t++,d[8]++;for(__(Xn,Oa+1,d),t=0;t<Zi;t++)Pa[t*2+1]=5,Pa[t*2]=w_(t,5);g_=new Qh(Xn,nd,za+1,Oa,Xr),m_=new Qh(Pa,fc,0,Zi,Xr),y_=new Qh(new Array(0),q5,0,od,z5)},v_=t=>{let r;for(r=0;r<Oa;r++)t.dyn_ltree[r*2]=0;for(r=0;r<Zi;r++)t.dyn_dtree[r*2]=0;for(r=0;r<od;r++)t.bl_tree[r*2]=0;t.dyn_ltree[ad*2]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},x_=t=>{t.bi_valid>8?Ba(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},i_=(t,r,i,l)=>{let u=r*2,d=i*2;return t[u]<t[d]||t[u]===t[d]&&l[r]<=l[i]},td=(t,r,i)=>{let l=t.heap[i],u=i<<1;for(;u<=t.heap_len&&(u<t.heap_len&&i_(r,t.heap[u+1],t.heap[u],t.depth)&&u++,!i_(r,l,t.heap[u],t.depth));)t.heap[i]=t.heap[u],i=u,u<<=1;t.heap[i]=l},o_=(t,r,i)=>{let l,u,d=0,g,m;if(t.sym_next!==0)do l=t.pending_buf[t.sym_buf+d++]&255,l+=(t.pending_buf[t.sym_buf+d++]&255)<<8,u=t.pending_buf[t.sym_buf+d++],l===0?kn(t,u,r):(g=Fa[u],kn(t,g+za+1,r),m=nd[g],m!==0&&(u-=sd[g],Bt(t,u,m)),l--,g=b_(l),kn(t,g,i),m=fc[g],m!==0&&(l-=hc[g],Bt(t,l,m)));while(d<t.sym_next);kn(t,ad,r)},rd=(t,r)=>{let i=r.dyn_tree,l=r.stat_desc.static_tree,u=r.stat_desc.has_stree,d=r.stat_desc.elems,g,m,x=-1,v;for(t.heap_len=0,t.heap_max=u_,g=0;g<d;g++)i[g*2]!==0?(t.heap[++t.heap_len]=x=g,t.depth[g]=0):i[g*2+1]=0;for(;t.heap_len<2;)v=t.heap[++t.heap_len]=x<2?++x:0,i[v*2]=1,t.depth[v]=0,t.opt_len--,u&&(t.static_len-=l[v*2+1]);for(r.max_code=x,g=t.heap_len>>1;g>=1;g--)td(t,i,g);v=d;do g=t.heap[1],t.heap[1]=t.heap[t.heap_len--],td(t,i,1),m=t.heap[1],t.heap[--t.heap_max]=g,t.heap[--t.heap_max]=m,i[v*2]=i[g*2]+i[m*2],t.depth[v]=(t.depth[g]>=t.depth[m]?t.depth[g]:t.depth[m])+1,i[g*2+1]=i[m*2+1]=v,t.heap[1]=v++,td(t,i,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],j5(t,r),__(i,x,t.bl_count)},a_=(t,r,i)=>{let l,u=-1,d,g=r[0*2+1],m=0,x=7,v=4;for(g===0&&(x=138,v=3),r[(i+1)*2+1]=65535,l=0;l<=i;l++)d=g,g=r[(l+1)*2+1],!(++m<x&&d===g)&&(m<v?t.bl_tree[d*2]+=m:d!==0?(d!==u&&t.bl_tree[d*2]++,t.bl_tree[f_*2]++):m<=10?t.bl_tree[h_*2]++:t.bl_tree[d_*2]++,m=0,u=d,g===0?(x=138,v=3):d===g?(x=6,v=3):(x=7,v=4))},s_=(t,r,i)=>{let l,u=-1,d,g=r[0*2+1],m=0,x=7,v=4;for(g===0&&(x=138,v=3),l=0;l<=i;l++)if(d=g,g=r[(l+1)*2+1],!(++m<x&&d===g)){if(m<v)do kn(t,d,t.bl_tree);while(--m!==0);else d!==0?(d!==u&&(kn(t,d,t.bl_tree),m--),kn(t,f_,t.bl_tree),Bt(t,m-3,2)):m<=10?(kn(t,h_,t.bl_tree),Bt(t,m-3,3)):(kn(t,d_,t.bl_tree),Bt(t,m-11,7));m=0,u=d,g===0?(x=138,v=3):d===g?(x=6,v=3):(x=7,v=4)}},$5=t=>{let r;for(a_(t,t.dyn_ltree,t.l_desc.max_code),a_(t,t.dyn_dtree,t.d_desc.max_code),rd(t,t.bl_desc),r=od-1;r>=3&&t.bl_tree[p_[r]*2+1]===0;r--);return t.opt_len+=3*(r+1)+5+5+4,r},V5=(t,r,i,l)=>{let u;for(Bt(t,r-257,5),Bt(t,i-1,5),Bt(t,l-4,4),u=0;u<l;u++)Bt(t,t.bl_tree[p_[u]*2+1],3);s_(t,t.dyn_ltree,r-1),s_(t,t.dyn_dtree,i-1)},W5=t=>{let r=4093624447,i;for(i=0;i<=31;i++,r>>>=1)if(r&1&&t.dyn_ltree[i*2]!==0)return 0;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return 1;for(i=32;i<za;i++)if(t.dyn_ltree[i*2]!==0)return 1;return 0},l_=!1,G5=t=>{l_||(H5(),l_=!0),t.l_desc=new ed(t.dyn_ltree,g_),t.d_desc=new ed(t.dyn_dtree,m_),t.bl_desc=new ed(t.bl_tree,y_),t.bi_buf=0,t.bi_valid=0,v_(t)},T_=(t,r,i,l)=>{Bt(t,(O5<<1)+(l?1:0),3),x_(t),Ba(t,i),Ba(t,~i),i&&t.pending_buf.set(t.window.subarray(r,r+i),t.pending),t.pending+=i},X5=t=>{Bt(t,c_<<1,3),kn(t,ad,Xn),Z5(t)},K5=(t,r,i,l)=>{let u,d,g=0;t.level>0?(t.strm.data_type===2&&(t.strm.data_type=W5(t)),rd(t,t.l_desc),rd(t,t.d_desc),g=$5(t),u=t.opt_len+3+7>>>3,d=t.static_len+3+7>>>3,d<=u&&(u=d)):u=d=i+5,i+4<=u&&r!==-1?T_(t,r,i,l):t.strategy===4||d===u?(Bt(t,(c_<<1)+(l?1:0),3),o_(t,Xn,Pa)):(Bt(t,(R5<<1)+(l?1:0),3),V5(t,t.l_desc.max_code+1,t.d_desc.max_code+1,g+1),o_(t,t.dyn_ltree,t.dyn_dtree)),v_(t),l&&x_(t)},J5=(t,r,i)=>(t.pending_buf[t.sym_buf+t.sym_next++]=r,t.pending_buf[t.sym_buf+t.sym_next++]=r>>8,t.pending_buf[t.sym_buf+t.sym_next++]=i,r===0?t.dyn_ltree[i*2]++:(t.matches++,r--,t.dyn_ltree[(Fa[i]+za+1)*2]++,t.dyn_dtree[b_(r)*2]++),t.sym_next===t.sym_end);Hi.exports._tr_init=G5;Hi.exports._tr_stored_block=T_;Hi.exports._tr_flush_block=K5;Hi.exports._tr_tally=J5;Hi.exports._tr_align=X5});var ld=me((rk,E_)=>{"use strict";var Y5=(t,r,i,l)=>{let u=t&65535|0,d=t>>>16&65535|0,g=0;for(;i!==0;){g=i>2e3?2e3:i,i-=g;do u=u+r[l++]|0,d=d+u|0;while(--g);u%=65521,d%=65521}return u|d<<16|0};E_.exports=Y5});var cd=me((ik,k_)=>{"use strict";var Q5=()=>{let t,r=[];for(var i=0;i<256;i++){t=i;for(var l=0;l<8;l++)t=t&1?3988292384^t>>>1:t>>>1;r[i]=t}return r},e4=new Uint32Array(Q5()),t4=(t,r,i,l)=>{let u=e4,d=l+i;t^=-1;for(let g=l;g<d;g++)t=t>>>8^u[(t^r[g])&255];return t^-1};k_.exports=t4});var dc=me((ok,C_)=>{"use strict";C_.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}});var mr=me((ak,N_)=>{"use strict";N_.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}});var B_=me((sk,Mn)=>{"use strict";var{_tr_init:n4,_tr_stored_block:hd,_tr_flush_block:r4,_tr_tally:_r,_tr_align:i4}=I_(),S_=ld(),yr=cd(),o4=dc(),{Z_NO_FLUSH:vr,Z_PARTIAL_FLUSH:a4,Z_FULL_FLUSH:s4,Z_FINISH:Yt,Z_BLOCK:A_,Z_OK:bt,Z_STREAM_END:M_,Z_STREAM_ERROR:Nn,Z_DATA_ERROR:l4,Z_BUF_ERROR:ud,Z_DEFAULT_COMPRESSION:c4,Z_FILTERED:u4,Z_HUFFMAN_ONLY:pc,Z_RLE:f4,Z_FIXED:h4,Z_DEFAULT_STRATEGY:d4,Z_UNKNOWN:p4,Z_DEFLATED:gc}=mr(),g4=9,m4=15,y4=8,b4=29,w4=256,dd=w4+1+b4,_4=30,v4=19,x4=2*dd+1,T4=15,Pe=3,wr=258,An=wr+Pe+1,I4=32,Vi=42,wd=57,pd=69,gd=73,md=91,yd=103,Kr=113,Ua=666,Lt=1,Gi=2,Yr=3,Xi=4,E4=3,Jr=(t,r)=>(t.msg=o4[r],r),D_=t=>t*2-(t>4?9:0),br=t=>{let r=t.length;for(;--r>=0;)t[r]=0},k4=t=>{let r,i,l,u=t.w_size;r=t.hash_size,l=r;do i=t.head[--l],t.head[l]=i>=u?i-u:0;while(--r);r=u,l=r;do i=t.prev[--l],t.prev[l]=i>=u?i-u:0;while(--r)},C4=(t,r,i)=>(r<<t.hash_shift^i)&t.hash_mask,xr=C4,Ht=t=>{let r=t.state,i=r.pending;i>t.avail_out&&(i=t.avail_out),i!==0&&(t.output.set(r.pending_buf.subarray(r.pending_out,r.pending_out+i),t.next_out),t.next_out+=i,r.pending_out+=i,t.total_out+=i,t.avail_out-=i,r.pending-=i,r.pending===0&&(r.pending_out=0))},$t=(t,r)=>{r4(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,r),t.block_start=t.strstart,Ht(t.strm)},qe=(t,r)=>{t.pending_buf[t.pending++]=r},qa=(t,r)=>{t.pending_buf[t.pending++]=r>>>8&255,t.pending_buf[t.pending++]=r&255},bd=(t,r,i,l)=>{let u=t.avail_in;return u>l&&(u=l),u===0?0:(t.avail_in-=u,r.set(t.input.subarray(t.next_in,t.next_in+u),i),t.state.wrap===1?t.adler=S_(t.adler,r,u,i):t.state.wrap===2&&(t.adler=yr(t.adler,r,u,i)),t.next_in+=u,t.total_in+=u,u)},L_=(t,r)=>{let i=t.max_chain_length,l=t.strstart,u,d,g=t.prev_length,m=t.nice_match,x=t.strstart>t.w_size-An?t.strstart-(t.w_size-An):0,v=t.window,I=t.w_mask,S=t.prev,M=t.strstart+wr,E=v[l+g-1],C=v[l+g];t.prev_length>=t.good_match&&(i>>=2),m>t.lookahead&&(m=t.lookahead);do if(u=r,!(v[u+g]!==C||v[u+g-1]!==E||v[u]!==v[l]||v[++u]!==v[l+1])){l+=2,u++;do;while(v[++l]===v[++u]&&v[++l]===v[++u]&&v[++l]===v[++u]&&v[++l]===v[++u]&&v[++l]===v[++u]&&v[++l]===v[++u]&&v[++l]===v[++u]&&v[++l]===v[++u]&&l<M);if(d=wr-(M-l),l=M-wr,d>g){if(t.match_start=r,g=d,d>=m)break;E=v[l+g-1],C=v[l+g]}}while((r=S[r&I])>x&&--i!==0);return g<=t.lookahead?g:t.lookahead},Wi=t=>{let r=t.w_size,i,l,u;do{if(l=t.window_size-t.lookahead-t.strstart,t.strstart>=r+(r-An)&&(t.window.set(t.window.subarray(r,r+r-l),0),t.match_start-=r,t.strstart-=r,t.block_start-=r,t.insert>t.strstart&&(t.insert=t.strstart),k4(t),l+=r),t.strm.avail_in===0)break;if(i=bd(t.strm,t.window,t.strstart+t.lookahead,l),t.lookahead+=i,t.lookahead+t.insert>=Pe)for(u=t.strstart-t.insert,t.ins_h=t.window[u],t.ins_h=xr(t,t.ins_h,t.window[u+1]);t.insert&&(t.ins_h=xr(t,t.ins_h,t.window[u+Pe-1]),t.prev[u&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=u,u++,t.insert--,!(t.lookahead+t.insert<Pe)););}while(t.lookahead<An&&t.strm.avail_in!==0)},P_=(t,r)=>{let i=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,l,u,d,g=0,m=t.strm.avail_in;do{if(l=65535,d=t.bi_valid+42>>3,t.strm.avail_out<d||(d=t.strm.avail_out-d,u=t.strstart-t.block_start,l>u+t.strm.avail_in&&(l=u+t.strm.avail_in),l>d&&(l=d),l<i&&(l===0&&r!==Yt||r===vr||l!==u+t.strm.avail_in)))break;g=r===Yt&&l===u+t.strm.avail_in?1:0,hd(t,0,0,g),t.pending_buf[t.pending-4]=l,t.pending_buf[t.pending-3]=l>>8,t.pending_buf[t.pending-2]=~l,t.pending_buf[t.pending-1]=~l>>8,Ht(t.strm),u&&(u>l&&(u=l),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+u),t.strm.next_out),t.strm.next_out+=u,t.strm.avail_out-=u,t.strm.total_out+=u,t.block_start+=u,l-=u),l&&(bd(t.strm,t.strm.output,t.strm.next_out,l),t.strm.next_out+=l,t.strm.avail_out-=l,t.strm.total_out+=l)}while(g===0);return m-=t.strm.avail_in,m&&(m>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=m&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-m,t.strm.next_in),t.strstart),t.strstart+=m,t.insert+=m>t.w_size-t.insert?t.w_size-t.insert:m),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),g?Xi:r!==vr&&r!==Yt&&t.strm.avail_in===0&&t.strstart===t.block_start?Gi:(d=t.window_size-t.strstart,t.strm.avail_in>d&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,d+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),d>t.strm.avail_in&&(d=t.strm.avail_in),d&&(bd(t.strm,t.window,t.strstart,d),t.strstart+=d,t.insert+=d>t.w_size-t.insert?t.w_size-t.insert:d),t.high_water<t.strstart&&(t.high_water=t.strstart),d=t.bi_valid+42>>3,d=t.pending_buf_size-d>65535?65535:t.pending_buf_size-d,i=d>t.w_size?t.w_size:d,u=t.strstart-t.block_start,(u>=i||(u||r===Yt)&&r!==vr&&t.strm.avail_in===0&&u<=d)&&(l=u>d?d:u,g=r===Yt&&t.strm.avail_in===0&&l===u?1:0,hd(t,t.block_start,l,g),t.block_start+=l,Ht(t.strm)),g?Yr:Lt)},fd=(t,r)=>{let i,l;for(;;){if(t.lookahead<An){if(Wi(t),t.lookahead<An&&r===vr)return Lt;if(t.lookahead===0)break}if(i=0,t.lookahead>=Pe&&(t.ins_h=xr(t,t.ins_h,t.window[t.strstart+Pe-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),i!==0&&t.strstart-i<=t.w_size-An&&(t.match_length=L_(t,i)),t.match_length>=Pe)if(l=_r(t,t.strstart-t.match_start,t.match_length-Pe),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=Pe){t.match_length--;do t.strstart++,t.ins_h=xr(t,t.ins_h,t.window[t.strstart+Pe-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!==0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=xr(t,t.ins_h,t.window[t.strstart+1]);else l=_r(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(l&&($t(t,!1),t.strm.avail_out===0))return Lt}return t.insert=t.strstart<Pe-1?t.strstart:Pe-1,r===Yt?($t(t,!0),t.strm.avail_out===0?Yr:Xi):t.sym_next&&($t(t,!1),t.strm.avail_out===0)?Lt:Gi},$i=(t,r)=>{let i,l,u;for(;;){if(t.lookahead<An){if(Wi(t),t.lookahead<An&&r===vr)return Lt;if(t.lookahead===0)break}if(i=0,t.lookahead>=Pe&&(t.ins_h=xr(t,t.ins_h,t.window[t.strstart+Pe-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=Pe-1,i!==0&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-An&&(t.match_length=L_(t,i),t.match_length<=5&&(t.strategy===u4||t.match_length===Pe&&t.strstart-t.match_start>4096)&&(t.match_length=Pe-1)),t.prev_length>=Pe&&t.match_length<=t.prev_length){u=t.strstart+t.lookahead-Pe,l=_r(t,t.strstart-1-t.prev_match,t.prev_length-Pe),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=u&&(t.ins_h=xr(t,t.ins_h,t.window[t.strstart+Pe-1]),i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!==0);if(t.match_available=0,t.match_length=Pe-1,t.strstart++,l&&($t(t,!1),t.strm.avail_out===0))return Lt}else if(t.match_available){if(l=_r(t,0,t.window[t.strstart-1]),l&&$t(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return Lt}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(l=_r(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<Pe-1?t.strstart:Pe-1,r===Yt?($t(t,!0),t.strm.avail_out===0?Yr:Xi):t.sym_next&&($t(t,!1),t.strm.avail_out===0)?Lt:Gi},N4=(t,r)=>{let i,l,u,d,g=t.window;for(;;){if(t.lookahead<=wr){if(Wi(t),t.lookahead<=wr&&r===vr)return Lt;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=Pe&&t.strstart>0&&(u=t.strstart-1,l=g[u],l===g[++u]&&l===g[++u]&&l===g[++u])){d=t.strstart+wr;do;while(l===g[++u]&&l===g[++u]&&l===g[++u]&&l===g[++u]&&l===g[++u]&&l===g[++u]&&l===g[++u]&&l===g[++u]&&u<d);t.match_length=wr-(d-u),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=Pe?(i=_r(t,1,t.match_length-Pe),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=_r(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&($t(t,!1),t.strm.avail_out===0))return Lt}return t.insert=0,r===Yt?($t(t,!0),t.strm.avail_out===0?Yr:Xi):t.sym_next&&($t(t,!1),t.strm.avail_out===0)?Lt:Gi},A4=(t,r)=>{let i;for(;;){if(t.lookahead===0&&(Wi(t),t.lookahead===0)){if(r===vr)return Lt;break}if(t.match_length=0,i=_r(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&($t(t,!1),t.strm.avail_out===0))return Lt}return t.insert=0,r===Yt?($t(t,!0),t.strm.avail_out===0?Yr:Xi):t.sym_next&&($t(t,!1),t.strm.avail_out===0)?Lt:Gi};function Cn(t,r,i,l,u){this.good_length=t,this.max_lazy=r,this.nice_length=i,this.max_chain=l,this.func=u}var Za=[new Cn(0,0,0,0,P_),new Cn(4,4,8,4,fd),new Cn(4,5,16,8,fd),new Cn(4,6,32,32,fd),new Cn(4,4,16,16,$i),new Cn(8,16,32,32,$i),new Cn(8,16,128,128,$i),new Cn(8,32,128,256,$i),new Cn(32,128,258,1024,$i),new Cn(32,258,258,4096,$i)],M4=t=>{t.window_size=2*t.w_size,br(t.head),t.max_lazy_match=Za[t.level].max_lazy,t.good_match=Za[t.level].good_length,t.nice_match=Za[t.level].nice_length,t.max_chain_length=Za[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Pe-1,t.match_available=0,t.ins_h=0};function D4(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=gc,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(x4*2),this.dyn_dtree=new Uint16Array((2*_4+1)*2),this.bl_tree=new Uint16Array((2*v4+1)*2),br(this.dyn_ltree),br(this.dyn_dtree),br(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(T4+1),this.heap=new Uint16Array(2*dd+1),br(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*dd+1),br(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var ja=t=>{if(!t)return 1;let r=t.state;return!r||r.strm!==t||r.status!==Vi&&r.status!==wd&&r.status!==pd&&r.status!==gd&&r.status!==md&&r.status!==yd&&r.status!==Kr&&r.status!==Ua?1:0},O_=t=>{if(ja(t))return Jr(t,Nn);t.total_in=t.total_out=0,t.data_type=p4;let r=t.state;return r.pending=0,r.pending_out=0,r.wrap<0&&(r.wrap=-r.wrap),r.status=r.wrap===2?wd:r.wrap?Vi:Kr,t.adler=r.wrap===2?0:1,r.last_flush=-2,n4(r),bt},R_=t=>{let r=O_(t);return r===bt&&M4(t.state),r},S4=(t,r)=>ja(t)||t.state.wrap!==2?Nn:(t.state.gzhead=r,bt),F_=(t,r,i,l,u,d)=>{if(!t)return Nn;let g=1;if(r===c4&&(r=6),l<0?(g=0,l=-l):l>15&&(g=2,l-=16),u<1||u>g4||i!==gc||l<8||l>15||r<0||r>9||d<0||d>h4||l===8&&g!==1)return Jr(t,Nn);l===8&&(l=9);let m=new D4;return t.state=m,m.strm=t,m.status=Vi,m.wrap=g,m.gzhead=null,m.w_bits=l,m.w_size=1<<m.w_bits,m.w_mask=m.w_size-1,m.hash_bits=u+7,m.hash_size=1<<m.hash_bits,m.hash_mask=m.hash_size-1,m.hash_shift=~~((m.hash_bits+Pe-1)/Pe),m.window=new Uint8Array(m.w_size*2),m.head=new Uint16Array(m.hash_size),m.prev=new Uint16Array(m.w_size),m.lit_bufsize=1<<u+6,m.pending_buf_size=m.lit_bufsize*4,m.pending_buf=new Uint8Array(m.pending_buf_size),m.sym_buf=m.lit_bufsize,m.sym_end=(m.lit_bufsize-1)*3,m.level=r,m.strategy=d,m.method=i,R_(t)},L4=(t,r)=>F_(t,r,gc,m4,y4,d4),P4=(t,r)=>{if(ja(t)||r>A_||r<0)return t?Jr(t,Nn):Nn;let i=t.state;if(!t.output||t.avail_in!==0&&!t.input||i.status===Ua&&r!==Yt)return Jr(t,t.avail_out===0?ud:Nn);let l=i.last_flush;if(i.last_flush=r,i.pending!==0){if(Ht(t),t.avail_out===0)return i.last_flush=-1,bt}else if(t.avail_in===0&&D_(r)<=D_(l)&&r!==Yt)return Jr(t,ud);if(i.status===Ua&&t.avail_in!==0)return Jr(t,ud);if(i.status===Vi&&i.wrap===0&&(i.status=Kr),i.status===Vi){let u=gc+(i.w_bits-8<<4)<<8,d=-1;if(i.strategy>=pc||i.level<2?d=0:i.level<6?d=1:i.level===6?d=2:d=3,u|=d<<6,i.strstart!==0&&(u|=I4),u+=31-u%31,qa(i,u),i.strstart!==0&&(qa(i,t.adler>>>16),qa(i,t.adler&65535)),t.adler=1,i.status=Kr,Ht(t),i.pending!==0)return i.last_flush=-1,bt}if(i.status===wd){if(t.adler=0,qe(i,31),qe(i,139),qe(i,8),i.gzhead)qe(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),qe(i,i.gzhead.time&255),qe(i,i.gzhead.time>>8&255),qe(i,i.gzhead.time>>16&255),qe(i,i.gzhead.time>>24&255),qe(i,i.level===9?2:i.strategy>=pc||i.level<2?4:0),qe(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(qe(i,i.gzhead.extra.length&255),qe(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=yr(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=pd;else if(qe(i,0),qe(i,0),qe(i,0),qe(i,0),qe(i,0),qe(i,i.level===9?2:i.strategy>=pc||i.level<2?4:0),qe(i,E4),i.status=Kr,Ht(t),i.pending!==0)return i.last_flush=-1,bt}if(i.status===pd){if(i.gzhead.extra){let u=i.pending,d=(i.gzhead.extra.length&65535)-i.gzindex;for(;i.pending+d>i.pending_buf_size;){let m=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+m),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>u&&(t.adler=yr(t.adler,i.pending_buf,i.pending-u,u)),i.gzindex+=m,Ht(t),i.pending!==0)return i.last_flush=-1,bt;u=0,d-=m}let g=new Uint8Array(i.gzhead.extra);i.pending_buf.set(g.subarray(i.gzindex,i.gzindex+d),i.pending),i.pending+=d,i.gzhead.hcrc&&i.pending>u&&(t.adler=yr(t.adler,i.pending_buf,i.pending-u,u)),i.gzindex=0}i.status=gd}if(i.status===gd){if(i.gzhead.name){let u=i.pending,d;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>u&&(t.adler=yr(t.adler,i.pending_buf,i.pending-u,u)),Ht(t),i.pending!==0)return i.last_flush=-1,bt;u=0}i.gzindex<i.gzhead.name.length?d=i.gzhead.name.charCodeAt(i.gzindex++)&255:d=0,qe(i,d)}while(d!==0);i.gzhead.hcrc&&i.pending>u&&(t.adler=yr(t.adler,i.pending_buf,i.pending-u,u)),i.gzindex=0}i.status=md}if(i.status===md){if(i.gzhead.comment){let u=i.pending,d;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>u&&(t.adler=yr(t.adler,i.pending_buf,i.pending-u,u)),Ht(t),i.pending!==0)return i.last_flush=-1,bt;u=0}i.gzindex<i.gzhead.comment.length?d=i.gzhead.comment.charCodeAt(i.gzindex++)&255:d=0,qe(i,d)}while(d!==0);i.gzhead.hcrc&&i.pending>u&&(t.adler=yr(t.adler,i.pending_buf,i.pending-u,u))}i.status=yd}if(i.status===yd){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(Ht(t),i.pending!==0))return i.last_flush=-1,bt;qe(i,t.adler&255),qe(i,t.adler>>8&255),t.adler=0}if(i.status=Kr,Ht(t),i.pending!==0)return i.last_flush=-1,bt}if(t.avail_in!==0||i.lookahead!==0||r!==vr&&i.status!==Ua){let u=i.level===0?P_(i,r):i.strategy===pc?A4(i,r):i.strategy===f4?N4(i,r):Za[i.level].func(i,r);if((u===Yr||u===Xi)&&(i.status=Ua),u===Lt||u===Yr)return t.avail_out===0&&(i.last_flush=-1),bt;if(u===Gi&&(r===a4?i4(i):r!==A_&&(hd(i,0,0,!1),r===s4&&(br(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),Ht(t),t.avail_out===0))return i.last_flush=-1,bt}return r!==Yt?bt:i.wrap<=0?M_:(i.wrap===2?(qe(i,t.adler&255),qe(i,t.adler>>8&255),qe(i,t.adler>>16&255),qe(i,t.adler>>24&255),qe(i,t.total_in&255),qe(i,t.total_in>>8&255),qe(i,t.total_in>>16&255),qe(i,t.total_in>>24&255)):(qa(i,t.adler>>>16),qa(i,t.adler&65535)),Ht(t),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?bt:M_)},O4=t=>{if(ja(t))return Nn;let r=t.state.status;return t.state=null,r===Kr?Jr(t,l4):bt},R4=(t,r)=>{let i=r.length;if(ja(t))return Nn;let l=t.state,u=l.wrap;if(u===2||u===1&&l.status!==Vi||l.lookahead)return Nn;if(u===1&&(t.adler=S_(t.adler,r,i,0)),l.wrap=0,i>=l.w_size){u===0&&(br(l.head),l.strstart=0,l.block_start=0,l.insert=0);let x=new Uint8Array(l.w_size);x.set(r.subarray(i-l.w_size,i),0),r=x,i=l.w_size}let d=t.avail_in,g=t.next_in,m=t.input;for(t.avail_in=i,t.next_in=0,t.input=r,Wi(l);l.lookahead>=Pe;){let x=l.strstart,v=l.lookahead-(Pe-1);do l.ins_h=xr(l,l.ins_h,l.window[x+Pe-1]),l.prev[x&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=x,x++;while(--v);l.strstart=x,l.lookahead=Pe-1,Wi(l)}return l.strstart+=l.lookahead,l.block_start=l.strstart,l.insert=l.lookahead,l.lookahead=0,l.match_length=l.prev_length=Pe-1,l.match_available=0,t.next_in=g,t.input=m,t.avail_in=d,l.wrap=u,bt};Mn.exports.deflateInit=L4;Mn.exports.deflateInit2=F_;Mn.exports.deflateReset=R_;Mn.exports.deflateResetKeep=O_;Mn.exports.deflateSetHeader=S4;Mn.exports.deflate=P4;Mn.exports.deflateEnd=O4;Mn.exports.deflateSetDictionary=R4;Mn.exports.deflateInfo="pako deflate (from Nodeca project)"});var vd=me((lk,_d)=>{"use strict";var F4=(t,r)=>Object.prototype.hasOwnProperty.call(t,r);_d.exports.assign=function(t){let r=Array.prototype.slice.call(arguments,1);for(;r.length;){let i=r.shift();if(i){if(typeof i!="object")throw new TypeError(i+"must be non-object");for(let l in i)F4(i,l)&&(t[l]=i[l])}}return t};_d.exports.flattenChunks=t=>{let r=0;for(let l=0,u=t.length;l<u;l++)r+=t[l].length;let i=new Uint8Array(r);for(let l=0,u=0,d=t.length;l<d;l++){let g=t[l];i.set(g,u),u+=g.length}return i}});var xd=me((ck,mc)=>{"use strict";var z_=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{z_=!1}var Ha=new Uint8Array(256);for(let t=0;t<256;t++)Ha[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Ha[254]=Ha[254]=1;mc.exports.string2buf=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let r,i,l,u,d,g=t.length,m=0;for(u=0;u<g;u++)i=t.charCodeAt(u),(i&64512)===55296&&u+1<g&&(l=t.charCodeAt(u+1),(l&64512)===56320&&(i=65536+(i-55296<<10)+(l-56320),u++)),m+=i<128?1:i<2048?2:i<65536?3:4;for(r=new Uint8Array(m),d=0,u=0;d<m;u++)i=t.charCodeAt(u),(i&64512)===55296&&u+1<g&&(l=t.charCodeAt(u+1),(l&64512)===56320&&(i=65536+(i-55296<<10)+(l-56320),u++)),i<128?r[d++]=i:i<2048?(r[d++]=192|i>>>6,r[d++]=128|i&63):i<65536?(r[d++]=224|i>>>12,r[d++]=128|i>>>6&63,r[d++]=128|i&63):(r[d++]=240|i>>>18,r[d++]=128|i>>>12&63,r[d++]=128|i>>>6&63,r[d++]=128|i&63);return r};var B4=(t,r)=>{if(r<65534&&t.subarray&&z_)return String.fromCharCode.apply(null,t.length===r?t:t.subarray(0,r));let i="";for(let l=0;l<r;l++)i+=String.fromCharCode(t[l]);return i};mc.exports.buf2string=(t,r)=>{let i=r||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,r));let l,u,d=new Array(i*2);for(u=0,l=0;l<i;){let g=t[l++];if(g<128){d[u++]=g;continue}let m=Ha[g];if(m>4){d[u++]=65533,l+=m-1;continue}for(g&=m===2?31:m===3?15:7;m>1&&l<i;)g=g<<6|t[l++]&63,m--;if(m>1){d[u++]=65533;continue}g<65536?d[u++]=g:(g-=65536,d[u++]=55296|g>>10&1023,d[u++]=56320|g&1023)}return B4(d,u)};mc.exports.utf8border=(t,r)=>{r=r||t.length,r>t.length&&(r=t.length);let i=r-1;for(;i>=0&&(t[i]&192)===128;)i--;return i<0||i===0?r:i+Ha[t[i]]>r?i:r}});var Td=me((uk,q_)=>{"use strict";function z4(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}q_.exports=z4});var H_=me((fk,Ki)=>{"use strict";var $a=B_(),U_=vd(),Z_=xd(),Id=dc(),q4=Td(),j_=Object.prototype.toString,{Z_NO_FLUSH:U4,Z_SYNC_FLUSH:Z4,Z_FULL_FLUSH:j4,Z_FINISH:H4,Z_OK:yc,Z_STREAM_END:$4,Z_DEFAULT_COMPRESSION:V4,Z_DEFAULT_STRATEGY:W4,Z_DEFLATED:G4}=mr();function Va(t){this.options=U_.assign({level:V4,method:G4,chunkSize:16384,windowBits:15,memLevel:8,strategy:W4},t||{});let r=this.options;r.raw&&r.windowBits>0?r.windowBits=-r.windowBits:r.gzip&&r.windowBits>0&&r.windowBits<16&&(r.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new q4,this.strm.avail_out=0;let i=$a.deflateInit2(this.strm,r.level,r.method,r.windowBits,r.memLevel,r.strategy);if(i!==yc)throw new Error(Id[i]);if(r.header&&$a.deflateSetHeader(this.strm,r.header),r.dictionary){let l;if(typeof r.dictionary=="string"?l=Z_.string2buf(r.dictionary):j_.call(r.dictionary)==="[object ArrayBuffer]"?l=new Uint8Array(r.dictionary):l=r.dictionary,i=$a.deflateSetDictionary(this.strm,l),i!==yc)throw new Error(Id[i]);this._dict_set=!0}}Va.prototype.push=function(t,r){let i=this.strm,l=this.options.chunkSize,u,d;if(this.ended)return!1;for(r===~~r?d=r:d=r===!0?H4:U4,typeof t=="string"?i.input=Z_.string2buf(t):j_.call(t)==="[object ArrayBuffer]"?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;){if(i.avail_out===0&&(i.output=new Uint8Array(l),i.next_out=0,i.avail_out=l),(d===Z4||d===j4)&&i.avail_out<=6){this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;continue}if(u=$a.deflate(i,d),u===$4)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),u=$a.deflateEnd(this.strm),this.onEnd(u),this.ended=!0,u===yc;if(i.avail_out===0){this.onData(i.output);continue}if(d>0&&i.next_out>0){this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;continue}if(i.avail_in===0)break}return!0};Va.prototype.onData=function(t){this.chunks.push(t)};Va.prototype.onEnd=function(t){t===yc&&(this.result=U_.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function Ed(t,r){let i=new Va(r);if(i.push(t,!0),i.err)throw i.msg||Id[i.err];return i.result}function X4(t,r){return r=r||{},r.raw=!0,Ed(t,r)}function K4(t,r){return r=r||{},r.gzip=!0,Ed(t,r)}Ki.exports.Deflate=Va;Ki.exports.deflate=Ed;Ki.exports.deflateRaw=X4;Ki.exports.gzip=K4;Ki.exports.constants=mr()});var V_=me((hk,$_)=>{"use strict";$_.exports=function(r,i){let l,u,d,g,m,x,v,I,S,M,E,C,B,$,V,te,R,D,A,Z,X,H,J,U,K=r.state;l=r.next_in,J=r.input,u=l+(r.avail_in-5),d=r.next_out,U=r.output,g=d-(i-r.avail_out),m=d+(r.avail_out-257),x=K.dmax,v=K.wsize,I=K.whave,S=K.wnext,M=K.window,E=K.hold,C=K.bits,B=K.lencode,$=K.distcode,V=(1<<K.lenbits)-1,te=(1<<K.distbits)-1;e:do{C<15&&(E+=J[l++]<<C,C+=8,E+=J[l++]<<C,C+=8),R=B[E&V];t:for(;;){if(D=R>>>24,E>>>=D,C-=D,D=R>>>16&255,D===0)U[d++]=R&65535;else if(D&16){A=R&65535,D&=15,D&&(C<D&&(E+=J[l++]<<C,C+=8),A+=E&(1<<D)-1,E>>>=D,C-=D),C<15&&(E+=J[l++]<<C,C+=8,E+=J[l++]<<C,C+=8),R=$[E&te];n:for(;;){if(D=R>>>24,E>>>=D,C-=D,D=R>>>16&255,D&16){if(Z=R&65535,D&=15,C<D&&(E+=J[l++]<<C,C+=8,C<D&&(E+=J[l++]<<C,C+=8)),Z+=E&(1<<D)-1,Z>x){r.msg="invalid distance too far back",K.mode=16209;break e}if(E>>>=D,C-=D,D=d-g,Z>D){if(D=Z-D,D>I&&K.sane){r.msg="invalid distance too far back",K.mode=16209;break e}if(X=0,H=M,S===0){if(X+=v-D,D<A){A-=D;do U[d++]=M[X++];while(--D);X=d-Z,H=U}}else if(S<D){if(X+=v+S-D,D-=S,D<A){A-=D;do U[d++]=M[X++];while(--D);if(X=0,S<A){D=S,A-=D;do U[d++]=M[X++];while(--D);X=d-Z,H=U}}}else if(X+=S-D,D<A){A-=D;do U[d++]=M[X++];while(--D);X=d-Z,H=U}for(;A>2;)U[d++]=H[X++],U[d++]=H[X++],U[d++]=H[X++],A-=3;A&&(U[d++]=H[X++],A>1&&(U[d++]=H[X++]))}else{X=d-Z;do U[d++]=U[X++],U[d++]=U[X++],U[d++]=U[X++],A-=3;while(A>2);A&&(U[d++]=U[X++],A>1&&(U[d++]=U[X++]))}}else if(D&64){r.msg="invalid distance code",K.mode=16209;break e}else{R=$[(R&65535)+(E&(1<<D)-1)];continue n}break}}else if(D&64)if(D&32){K.mode=16191;break e}else{r.msg="invalid literal/length code",K.mode=16209;break e}else{R=B[(R&65535)+(E&(1<<D)-1)];continue t}break}}while(l<u&&d<m);A=C>>3,l-=A,C-=A<<3,E&=(1<<C)-1,r.next_in=l,r.next_out=d,r.avail_in=l<u?5+(u-l):5-(l-u),r.avail_out=d<m?257+(m-d):257-(d-m),K.hold=E,K.bits=C}});var G_=me((dk,W_)=>{"use strict";var J4=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Y4=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Q4=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),e7=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),t7=(t,r,i,l,u,d,g,m)=>{let x=m.bits,v=0,I=0,S=0,M=0,E=0,C=0,B=0,$=0,V=0,te=0,R,D,A,Z,X,H=null,J,U=new Uint16Array(15+1),K=new Uint16Array(15+1),se=null,de,_e,Ce;for(v=0;v<=15;v++)U[v]=0;for(I=0;I<l;I++)U[r[i+I]]++;for(E=x,M=15;M>=1&&U[M]===0;M--);if(E>M&&(E=M),M===0)return u[d++]=1<<24|64<<16|0,u[d++]=1<<24|64<<16|0,m.bits=1,0;for(S=1;S<M&&U[S]===0;S++);for(E<S&&(E=S),$=1,v=1;v<=15;v++)if($<<=1,$-=U[v],$<0)return-1;if($>0&&(t===0||M!==1))return-1;for(K[1]=0,v=1;v<15;v++)K[v+1]=K[v]+U[v];for(I=0;I<l;I++)r[i+I]!==0&&(g[K[r[i+I]]++]=I);if(t===0?(H=se=g,J=20):t===1?(H=J4,se=Y4,J=257):(H=Q4,se=e7,J=0),te=0,I=0,v=S,X=d,C=E,B=0,A=-1,V=1<<E,Z=V-1,t===1&&V>852||t===2&&V>592)return 1;for(;;){de=v-B,g[I]+1<J?(_e=0,Ce=g[I]):g[I]>=J?(_e=se[g[I]-J],Ce=H[g[I]-J]):(_e=32+64,Ce=0),R=1<<v-B,D=1<<C,S=D;do D-=R,u[X+(te>>B)+D]=de<<24|_e<<16|Ce|0;while(D!==0);for(R=1<<v-1;te&R;)R>>=1;if(R!==0?(te&=R-1,te+=R):te=0,I++,--U[v]===0){if(v===M)break;v=r[i+g[I]]}if(v>E&&(te&Z)!==A){for(B===0&&(B=E),X+=S,C=v-B,$=1<<C;C+B<M&&($-=U[C+B],!($<=0));)C++,$<<=1;if(V+=1<<C,t===1&&V>852||t===2&&V>592)return 1;A=te&Z,u[A]=E<<24|C<<16|X-d|0}}return te!==0&&(u[X+te]=v-B<<24|64<<16|0),m.bits=E,0};W_.exports=t7});var Av=me((pk,cn)=>{"use strict";var Dd=ld(),Dn=cd(),n7=V_(),Wa=G_(),r7=0,_v=1,vv=2,{Z_FINISH:X_,Z_BLOCK:i7,Z_TREES:bc,Z_OK:Qr,Z_STREAM_END:o7,Z_NEED_DICT:a7,Z_STREAM_ERROR:Qt,Z_DATA_ERROR:xv,Z_MEM_ERROR:Sd,Z_BUF_ERROR:s7,Z_DEFLATED:K_}=mr(),xc=16180,J_=16181,Y_=16182,Q_=16183,ev=16184,tv=16185,nv=16186,rv=16187,iv=16188,ov=16189,vc=16190,Kn=16191,kd=16192,av=16193,Cd=16194,sv=16195,lv=16196,cv=16197,uv=16198,wc=16199,_c=16200,fv=16201,hv=16202,dv=16203,pv=16204,gv=16205,Nd=16206,mv=16207,yv=16208,et=16209,Ld=16210,Tv=16211,l7=852,c7=592,u7=15,f7=u7,bv=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function h7(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var ei=t=>{if(!t)return 1;let r=t.state;return!r||r.strm!==t||r.mode<xc||r.mode>Tv?1:0},Iv=t=>{if(ei(t))return Qt;let r=t.state;return t.total_in=t.total_out=r.total=0,t.msg="",r.wrap&&(t.adler=r.wrap&1),r.mode=xc,r.last=0,r.havedict=0,r.flags=-1,r.dmax=32768,r.head=null,r.hold=0,r.bits=0,r.lencode=r.lendyn=new Int32Array(l7),r.distcode=r.distdyn=new Int32Array(c7),r.sane=1,r.back=-1,Qr},Ev=t=>{if(ei(t))return Qt;let r=t.state;return r.wsize=0,r.whave=0,r.wnext=0,Iv(t)},kv=(t,r)=>{let i;if(ei(t))return Qt;let l=t.state;return r<0?(i=0,r=-r):(i=(r>>4)+5,r<48&&(r&=15)),r&&(r<8||r>15)?Qt:(l.window!==null&&l.wbits!==r&&(l.window=null),l.wrap=i,l.wbits=r,Ev(t))},Cv=(t,r)=>{if(!t)return Qt;let i=new h7;t.state=i,i.strm=t,i.window=null,i.mode=xc;let l=kv(t,r);return l!==Qr&&(t.state=null),l},d7=t=>Cv(t,f7),wv=!0,Ad,Md,p7=t=>{if(wv){Ad=new Int32Array(512),Md=new Int32Array(32);let r=0;for(;r<144;)t.lens[r++]=8;for(;r<256;)t.lens[r++]=9;for(;r<280;)t.lens[r++]=7;for(;r<288;)t.lens[r++]=8;for(Wa(_v,t.lens,0,288,Ad,0,t.work,{bits:9}),r=0;r<32;)t.lens[r++]=5;Wa(vv,t.lens,0,32,Md,0,t.work,{bits:5}),wv=!1}t.lencode=Ad,t.lenbits=9,t.distcode=Md,t.distbits=5},Nv=(t,r,i,l)=>{let u,d=t.state;return d.window===null&&(d.wsize=1<<d.wbits,d.wnext=0,d.whave=0,d.window=new Uint8Array(d.wsize)),l>=d.wsize?(d.window.set(r.subarray(i-d.wsize,i),0),d.wnext=0,d.whave=d.wsize):(u=d.wsize-d.wnext,u>l&&(u=l),d.window.set(r.subarray(i-l,i-l+u),d.wnext),l-=u,l?(d.window.set(r.subarray(i-l,i),0),d.wnext=l,d.whave=d.wsize):(d.wnext+=u,d.wnext===d.wsize&&(d.wnext=0),d.whave<d.wsize&&(d.whave+=u))),0},g7=(t,r)=>{let i,l,u,d,g,m,x,v,I,S,M,E,C,B,$=0,V,te,R,D,A,Z,X,H,J=new Uint8Array(4),U,K,se=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(ei(t)||!t.output||!t.input&&t.avail_in!==0)return Qt;i=t.state,i.mode===Kn&&(i.mode=kd),g=t.next_out,u=t.output,x=t.avail_out,d=t.next_in,l=t.input,m=t.avail_in,v=i.hold,I=i.bits,S=m,M=x,H=Qr;e:for(;;)switch(i.mode){case xc:if(i.wrap===0){i.mode=kd;break}for(;I<16;){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}if(i.wrap&2&&v===35615){i.wbits===0&&(i.wbits=15),i.check=0,J[0]=v&255,J[1]=v>>>8&255,i.check=Dn(i.check,J,2,0),v=0,I=0,i.mode=J_;break}if(i.head&&(i.head.done=!1),!(i.wrap&1)||(((v&255)<<8)+(v>>8))%31){t.msg="incorrect header check",i.mode=et;break}if((v&15)!==K_){t.msg="unknown compression method",i.mode=et;break}if(v>>>=4,I-=4,X=(v&15)+8,i.wbits===0&&(i.wbits=X),X>15||X>i.wbits){t.msg="invalid window size",i.mode=et;break}i.dmax=1<<i.wbits,i.flags=0,t.adler=i.check=1,i.mode=v&512?ov:Kn,v=0,I=0;break;case J_:for(;I<16;){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}if(i.flags=v,(i.flags&255)!==K_){t.msg="unknown compression method",i.mode=et;break}if(i.flags&57344){t.msg="unknown header flags set",i.mode=et;break}i.head&&(i.head.text=v>>8&1),i.flags&512&&i.wrap&4&&(J[0]=v&255,J[1]=v>>>8&255,i.check=Dn(i.check,J,2,0)),v=0,I=0,i.mode=Y_;case Y_:for(;I<32;){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}i.head&&(i.head.time=v),i.flags&512&&i.wrap&4&&(J[0]=v&255,J[1]=v>>>8&255,J[2]=v>>>16&255,J[3]=v>>>24&255,i.check=Dn(i.check,J,4,0)),v=0,I=0,i.mode=Q_;case Q_:for(;I<16;){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}i.head&&(i.head.xflags=v&255,i.head.os=v>>8),i.flags&512&&i.wrap&4&&(J[0]=v&255,J[1]=v>>>8&255,i.check=Dn(i.check,J,2,0)),v=0,I=0,i.mode=ev;case ev:if(i.flags&1024){for(;I<16;){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}i.length=v,i.head&&(i.head.extra_len=v),i.flags&512&&i.wrap&4&&(J[0]=v&255,J[1]=v>>>8&255,i.check=Dn(i.check,J,2,0)),v=0,I=0}else i.head&&(i.head.extra=null);i.mode=tv;case tv:if(i.flags&1024&&(E=i.length,E>m&&(E=m),E&&(i.head&&(X=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(l.subarray(d,d+E),X)),i.flags&512&&i.wrap&4&&(i.check=Dn(i.check,l,E,d)),m-=E,d+=E,i.length-=E),i.length))break e;i.length=0,i.mode=nv;case nv:if(i.flags&2048){if(m===0)break e;E=0;do X=l[d+E++],i.head&&X&&i.length<65536&&(i.head.name+=String.fromCharCode(X));while(X&&E<m);if(i.flags&512&&i.wrap&4&&(i.check=Dn(i.check,l,E,d)),m-=E,d+=E,X)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=rv;case rv:if(i.flags&4096){if(m===0)break e;E=0;do X=l[d+E++],i.head&&X&&i.length<65536&&(i.head.comment+=String.fromCharCode(X));while(X&&E<m);if(i.flags&512&&i.wrap&4&&(i.check=Dn(i.check,l,E,d)),m-=E,d+=E,X)break e}else i.head&&(i.head.comment=null);i.mode=iv;case iv:if(i.flags&512){for(;I<16;){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}if(i.wrap&4&&v!==(i.check&65535)){t.msg="header crc mismatch",i.mode=et;break}v=0,I=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=Kn;break;case ov:for(;I<32;){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}t.adler=i.check=bv(v),v=0,I=0,i.mode=vc;case vc:if(i.havedict===0)return t.next_out=g,t.avail_out=x,t.next_in=d,t.avail_in=m,i.hold=v,i.bits=I,a7;t.adler=i.check=1,i.mode=Kn;case Kn:if(r===i7||r===bc)break e;case kd:if(i.last){v>>>=I&7,I-=I&7,i.mode=Nd;break}for(;I<3;){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}switch(i.last=v&1,v>>>=1,I-=1,v&3){case 0:i.mode=av;break;case 1:if(p7(i),i.mode=wc,r===bc){v>>>=2,I-=2;break e}break;case 2:i.mode=lv;break;case 3:t.msg="invalid block type",i.mode=et}v>>>=2,I-=2;break;case av:for(v>>>=I&7,I-=I&7;I<32;){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}if((v&65535)!==(v>>>16^65535)){t.msg="invalid stored block lengths",i.mode=et;break}if(i.length=v&65535,v=0,I=0,i.mode=Cd,r===bc)break e;case Cd:i.mode=sv;case sv:if(E=i.length,E){if(E>m&&(E=m),E>x&&(E=x),E===0)break e;u.set(l.subarray(d,d+E),g),m-=E,d+=E,x-=E,g+=E,i.length-=E;break}i.mode=Kn;break;case lv:for(;I<14;){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}if(i.nlen=(v&31)+257,v>>>=5,I-=5,i.ndist=(v&31)+1,v>>>=5,I-=5,i.ncode=(v&15)+4,v>>>=4,I-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=et;break}i.have=0,i.mode=cv;case cv:for(;i.have<i.ncode;){for(;I<3;){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}i.lens[se[i.have++]]=v&7,v>>>=3,I-=3}for(;i.have<19;)i.lens[se[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,U={bits:i.lenbits},H=Wa(r7,i.lens,0,19,i.lencode,0,i.work,U),i.lenbits=U.bits,H){t.msg="invalid code lengths set",i.mode=et;break}i.have=0,i.mode=uv;case uv:for(;i.have<i.nlen+i.ndist;){for(;$=i.lencode[v&(1<<i.lenbits)-1],V=$>>>24,te=$>>>16&255,R=$&65535,!(V<=I);){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}if(R<16)v>>>=V,I-=V,i.lens[i.have++]=R;else{if(R===16){for(K=V+2;I<K;){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}if(v>>>=V,I-=V,i.have===0){t.msg="invalid bit length repeat",i.mode=et;break}X=i.lens[i.have-1],E=3+(v&3),v>>>=2,I-=2}else if(R===17){for(K=V+3;I<K;){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}v>>>=V,I-=V,X=0,E=3+(v&7),v>>>=3,I-=3}else{for(K=V+7;I<K;){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}v>>>=V,I-=V,X=0,E=11+(v&127),v>>>=7,I-=7}if(i.have+E>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=et;break}for(;E--;)i.lens[i.have++]=X}}if(i.mode===et)break;if(i.lens[256]===0){t.msg="invalid code -- missing end-of-block",i.mode=et;break}if(i.lenbits=9,U={bits:i.lenbits},H=Wa(_v,i.lens,0,i.nlen,i.lencode,0,i.work,U),i.lenbits=U.bits,H){t.msg="invalid literal/lengths set",i.mode=et;break}if(i.distbits=6,i.distcode=i.distdyn,U={bits:i.distbits},H=Wa(vv,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,U),i.distbits=U.bits,H){t.msg="invalid distances set",i.mode=et;break}if(i.mode=wc,r===bc)break e;case wc:i.mode=_c;case _c:if(m>=6&&x>=258){t.next_out=g,t.avail_out=x,t.next_in=d,t.avail_in=m,i.hold=v,i.bits=I,n7(t,M),g=t.next_out,u=t.output,x=t.avail_out,d=t.next_in,l=t.input,m=t.avail_in,v=i.hold,I=i.bits,i.mode===Kn&&(i.back=-1);break}for(i.back=0;$=i.lencode[v&(1<<i.lenbits)-1],V=$>>>24,te=$>>>16&255,R=$&65535,!(V<=I);){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}if(te&&!(te&240)){for(D=V,A=te,Z=R;$=i.lencode[Z+((v&(1<<D+A)-1)>>D)],V=$>>>24,te=$>>>16&255,R=$&65535,!(D+V<=I);){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}v>>>=D,I-=D,i.back+=D}if(v>>>=V,I-=V,i.back+=V,i.length=R,te===0){i.mode=gv;break}if(te&32){i.back=-1,i.mode=Kn;break}if(te&64){t.msg="invalid literal/length code",i.mode=et;break}i.extra=te&15,i.mode=fv;case fv:if(i.extra){for(K=i.extra;I<K;){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}i.length+=v&(1<<i.extra)-1,v>>>=i.extra,I-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=hv;case hv:for(;$=i.distcode[v&(1<<i.distbits)-1],V=$>>>24,te=$>>>16&255,R=$&65535,!(V<=I);){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}if(!(te&240)){for(D=V,A=te,Z=R;$=i.distcode[Z+((v&(1<<D+A)-1)>>D)],V=$>>>24,te=$>>>16&255,R=$&65535,!(D+V<=I);){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}v>>>=D,I-=D,i.back+=D}if(v>>>=V,I-=V,i.back+=V,te&64){t.msg="invalid distance code",i.mode=et;break}i.offset=R,i.extra=te&15,i.mode=dv;case dv:if(i.extra){for(K=i.extra;I<K;){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}i.offset+=v&(1<<i.extra)-1,v>>>=i.extra,I-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=et;break}i.mode=pv;case pv:if(x===0)break e;if(E=M-x,i.offset>E){if(E=i.offset-E,E>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=et;break}E>i.wnext?(E-=i.wnext,C=i.wsize-E):C=i.wnext-E,E>i.length&&(E=i.length),B=i.window}else B=u,C=g-i.offset,E=i.length;E>x&&(E=x),x-=E,i.length-=E;do u[g++]=B[C++];while(--E);i.length===0&&(i.mode=_c);break;case gv:if(x===0)break e;u[g++]=i.length,x--,i.mode=_c;break;case Nd:if(i.wrap){for(;I<32;){if(m===0)break e;m--,v|=l[d++]<<I,I+=8}if(M-=x,t.total_out+=M,i.total+=M,i.wrap&4&&M&&(t.adler=i.check=i.flags?Dn(i.check,u,M,g-M):Dd(i.check,u,M,g-M)),M=x,i.wrap&4&&(i.flags?v:bv(v))!==i.check){t.msg="incorrect data check",i.mode=et;break}v=0,I=0}i.mode=mv;case mv:if(i.wrap&&i.flags){for(;I<32;){if(m===0)break e;m--,v+=l[d++]<<I,I+=8}if(i.wrap&4&&v!==(i.total&4294967295)){t.msg="incorrect length check",i.mode=et;break}v=0,I=0}i.mode=yv;case yv:H=o7;break e;case et:H=xv;break e;case Ld:return Sd;case Tv:default:return Qt}return t.next_out=g,t.avail_out=x,t.next_in=d,t.avail_in=m,i.hold=v,i.bits=I,(i.wsize||M!==t.avail_out&&i.mode<et&&(i.mode<Nd||r!==X_))&&Nv(t,t.output,t.next_out,M-t.avail_out)?(i.mode=Ld,Sd):(S-=t.avail_in,M-=t.avail_out,t.total_in+=S,t.total_out+=M,i.total+=M,i.wrap&4&&M&&(t.adler=i.check=i.flags?Dn(i.check,u,M,t.next_out-M):Dd(i.check,u,M,t.next_out-M)),t.data_type=i.bits+(i.last?64:0)+(i.mode===Kn?128:0)+(i.mode===wc||i.mode===Cd?256:0),(S===0&&M===0||r===X_)&&H===Qr&&(H=s7),H)},m7=t=>{if(ei(t))return Qt;let r=t.state;return r.window&&(r.window=null),t.state=null,Qr},y7=(t,r)=>{if(ei(t))return Qt;let i=t.state;return i.wrap&2?(i.head=r,r.done=!1,Qr):Qt},b7=(t,r)=>{let i=r.length,l,u,d;return ei(t)||(l=t.state,l.wrap!==0&&l.mode!==vc)?Qt:l.mode===vc&&(u=1,u=Dd(u,r,i,0),u!==l.check)?xv:(d=Nv(t,r,i,i),d?(l.mode=Ld,Sd):(l.havedict=1,Qr))};cn.exports.inflateReset=Ev;cn.exports.inflateReset2=kv;cn.exports.inflateResetKeep=Iv;cn.exports.inflateInit=d7;cn.exports.inflateInit2=Cv;cn.exports.inflate=g7;cn.exports.inflateEnd=m7;cn.exports.inflateGetHeader=y7;cn.exports.inflateSetDictionary=b7;cn.exports.inflateInfo="pako inflate (from Nodeca project)"});var Dv=me((gk,Mv)=>{"use strict";function w7(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}Mv.exports=w7});var Ov=me((mk,Ji)=>{"use strict";var Jn=Av(),Lv=vd(),Rd=xd(),Fd=dc(),_7=Td(),v7=Dv(),Pv=Object.prototype.toString,{Z_NO_FLUSH:x7,Z_FINISH:T7,Z_OK:Ga,Z_STREAM_END:Pd,Z_NEED_DICT:Od,Z_STREAM_ERROR:I7,Z_DATA_ERROR:Sv,Z_MEM_ERROR:E7}=mr();function Xa(t){this.options=Lv.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});let r=this.options;r.raw&&r.windowBits>=0&&r.windowBits<16&&(r.windowBits=-r.windowBits,r.windowBits===0&&(r.windowBits=-15)),r.windowBits>=0&&r.windowBits<16&&!(t&&t.windowBits)&&(r.windowBits+=32),r.windowBits>15&&r.windowBits<48&&(r.windowBits&15||(r.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _7,this.strm.avail_out=0;let i=Jn.inflateInit2(this.strm,r.windowBits);if(i!==Ga)throw new Error(Fd[i]);if(this.header=new v7,Jn.inflateGetHeader(this.strm,this.header),r.dictionary&&(typeof r.dictionary=="string"?r.dictionary=Rd.string2buf(r.dictionary):Pv.call(r.dictionary)==="[object ArrayBuffer]"&&(r.dictionary=new Uint8Array(r.dictionary)),r.raw&&(i=Jn.inflateSetDictionary(this.strm,r.dictionary),i!==Ga)))throw new Error(Fd[i])}Xa.prototype.push=function(t,r){let i=this.strm,l=this.options.chunkSize,u=this.options.dictionary,d,g,m;if(this.ended)return!1;for(r===~~r?g=r:g=r===!0?T7:x7,Pv.call(t)==="[object ArrayBuffer]"?i.input=new Uint8Array(t):i.input=t,i.next_in=0,i.avail_in=i.input.length;;){for(i.avail_out===0&&(i.output=new Uint8Array(l),i.next_out=0,i.avail_out=l),d=Jn.inflate(i,g),d===Od&&u&&(d=Jn.inflateSetDictionary(i,u),d===Ga?d=Jn.inflate(i,g):d===Sv&&(d=Od));i.avail_in>0&&d===Pd&&i.state.wrap>0&&t[i.next_in]!==0;)Jn.inflateReset(i),d=Jn.inflate(i,g);switch(d){case I7:case Sv:case Od:case E7:return this.onEnd(d),this.ended=!0,!1}if(m=i.avail_out,i.next_out&&(i.avail_out===0||d===Pd))if(this.options.to==="string"){let x=Rd.utf8border(i.output,i.next_out),v=i.next_out-x,I=Rd.buf2string(i.output,x);i.next_out=v,i.avail_out=l-v,v&&i.output.set(i.output.subarray(x,x+v),0),this.onData(I)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(!(d===Ga&&m===0)){if(d===Pd)return d=Jn.inflateEnd(this.strm),this.onEnd(d),this.ended=!0,!0;if(i.avail_in===0)break}}return!0};Xa.prototype.onData=function(t){this.chunks.push(t)};Xa.prototype.onEnd=function(t){t===Ga&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Lv.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function Bd(t,r){let i=new Xa(r);if(i.push(t),i.err)throw i.msg||Fd[i.err];return i.result}function k7(t,r){return r=r||{},r.raw=!0,Bd(t,r)}Ji.exports.Inflate=Xa;Ji.exports.inflate=Bd;Ji.exports.inflateRaw=k7;Ji.exports.ungzip=Bd;Ji.exports.constants=mr()});var Rv=me((yk,Sn)=>{"use strict";var{Deflate:C7,deflate:N7,deflateRaw:A7,gzip:M7}=H_(),{Inflate:D7,inflate:S7,inflateRaw:L7,ungzip:P7}=Ov(),O7=mr();Sn.exports.Deflate=C7;Sn.exports.deflate=N7;Sn.exports.deflateRaw=A7;Sn.exports.gzip=M7;Sn.exports.Inflate=D7;Sn.exports.inflate=S7;Sn.exports.inflateRaw=L7;Sn.exports.ungzip=P7;Sn.exports.constants=O7});var zv=me(Yi=>{"use strict";var q7=Yi&&Yi.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Yi,"__esModule",{value:!0});Yi.DebugBridge=void 0;var qd=Je(),U7=q7(Yn()),un=class{get version(){return un.version}get disableDebugBridgePassword(){return this._disableDebugBridgePassword}set disableDebugBridgePassword(r){this._disableDebugBridgePassword=r}get password(){return qd.BasicTool.getZotero().Prefs.get(un.passwordPref,!0)}set password(r){qd.BasicTool.getZotero().Prefs.set(un.passwordPref,r,!0)}constructor(){this._disableDebugBridgePassword=!1,this.initializeDebugBridge()}static setModule(r){var i;(!(!((i=r.debugBridge)===null||i===void 0)&&i.version)||r.debugBridge.version<un.version)&&(r.debugBridge=new un)}initializeDebugBridge(){let r={noContent:!0,doAction:async i=>{var l;let u=qd.BasicTool.getZotero(),d=i.spec.split("//").pop();if(!d)return;let g={};(l=d.split("?").pop())===null||l===void 0||l.split("&").forEach(v=>{g[v.split("=")[0]]=v.split("=")[1]});let m=U7.default.getInstance().debugBridge.disableDebugBridgePassword,x=!1;if(m?x=!0:typeof g.password>"u"&&typeof this.password>"u"?x=window.confirm(`External App ${g.app} wants to execute command without password.
Command:
${(g.run||g.file||"").slice(0,100)}
If you do not know what it is, please click Cancel to deny.`):x=this.password===g.password,x){if(g.run)try{let v=Object.getPrototypeOf(async function(){}).constructor;await new v("Zotero,window",decodeURIComponent(g.run))(u,u.getMainWindow())}catch(v){u.debug(v),u.getMainWindow().console.log(v)}if(g.file)try{Services.scriptloader.loadSubScript(decodeURIComponent(g.file),{Zotero:u,window:u.getMainWindow()})}catch(v){u.debug(v),u.getMainWindow().console.log(v)}}},newChannel:function(i){this.doAction(i)}};Services.io.getProtocolHandler("zotero").wrappedJSObject._extensions["zotero://ztoolkit-debug"]=r}};Yi.DebugBridge=un;un.version=1;un.passwordPref="extensions.zotero.debug-bridge.password"});var Yn=me(Ja=>{"use strict";Object.defineProperty(Ja,"__esModule",{value:!0});Ja.ToolkitGlobal=void 0;var Ud=Je(),Z7=zv(),eo=class{constructor(){qv(this),this.currentWindow=Ud.BasicTool.getZotero().getMainWindow()}static getInstance(){let r=Ud.BasicTool.getZotero(),i=!1;"_toolkitGlobal"in r||(r._toolkitGlobal=new eo,i=!0);let l=r._toolkitGlobal;return l.currentWindow!==r.getMainWindow()&&(j7(l),i=!0),i&&qv(l),l}};Ja.ToolkitGlobal=eo;function qv(t){Qi(t,"fieldHooks",{_ready:!1,getFieldHooks:{},setFieldHooks:{},isFieldOfBaseHooks:{}}),Qi(t,"itemTree",{_ready:!1,columns:[],renderCellHooks:{}}),Qi(t,"itemBox",{_ready:!1,fieldOptions:{}}),Qi(t,"shortcut",{_ready:!1,eventKeys:[]}),Qi(t,"prompt",{_ready:!1,instance:void 0}),Qi(t,"readerInstance",{_ready:!1,initializedHooks:{}}),Z7.DebugBridge.setModule(t)}function Qi(t,r,i){var l,u;if(i){t[r]||(t[r]=i);for(let d in i)(l=(u=t[r])[d])!==null&&l!==void 0||(u[d]=i[d])}}function j7(t){t.currentWindow=Ud.BasicTool.getZotero().getMainWindow(),t.itemTree=void 0,t.itemBox=void 0,t.shortcut=void 0,t.prompt=void 0,t.readerInstance=void 0}Ja.default=eo});var Je=me(Ln=>{"use strict";var H7=Ln&&Ln.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ln,"__esModule",{value:!0});Ln.unregister=Ln.ManagerTool=Ln.BasicTool=void 0;var $7=H7(Yn()),to=class{get basicOptions(){return this._basicOptions}constructor(r){this.patchSign="zotero-plugin-toolkit@2.0.0",this._basicOptions={log:{_type:"toolkitlog",disableConsole:!1,disableZLog:!1,prefix:""},debug:$7.default.getInstance().debugBridge,api:{pluginID:"zotero-plugin-toolkit@windingwind.com"}},this.updateOptions(r)}getGlobal(r){let i=typeof Zotero<"u"?Zotero:Components.classes["@zotero.org/Zotero;1"].getService(Components.interfaces.nsISupports).wrappedJSObject;try{let l=i.getMainWindow();switch(r){case"Zotero":case"zotero":return i;case"window":return l;case"document":return l.document;case"ZoteroPane":case"ZoteroPane_Local":return i.getActiveZoteroPane();default:return l[r]}}catch(l){Zotero.logError(l)}}isZotero7(){return Zotero.platformMajorVersion>=102}getDOMParser(){if(this.isZotero7())return new(this.getGlobal("DOMParser"));try{return new(this.getGlobal("DOMParser"))}catch{return Components.classes["@mozilla.org/xmlextras/domparser;1"].createInstance(Components.interfaces.nsIDOMParser)}}isXULElement(r){return r.namespaceURI==="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"}createXULElement(r,i){return this.isZotero7()?r.createXULElement(i):r.createElementNS("http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul",i)}log(...r){var i;if(r.length===0)return;let l=this.getGlobal("Zotero"),u=this.getGlobal("console"),d;((i=r[r.length-1])===null||i===void 0?void 0:i._type)==="toolkitlog"?d=r.pop():d=this._basicOptions.log;try{d.prefix&&r.splice(0,0,d.prefix),d.disableConsole||(u.groupCollapsed(...r),u.trace(),u.groupEnd()),d.disableZLog||l.debug(r.map(g=>{try{return typeof g=="object"?JSON.stringify(g):String(g)}catch{return l.debug(g),""}}).join(`
`))}catch(g){u.error(g),l.logError(g)}}patch(r,i,l,u){if(r[i][l])throw new Error(`${String(i)} re-patched`);this.log("patching",i,`by ${l}`),r[i]=u(r[i]),r[i][l]=!0}updateOptions(r){r&&(r instanceof to?this._basicOptions=r._basicOptions:this._basicOptions=r)}static getZotero(){return typeof Zotero<"u"?Zotero:Components.classes["@zotero.org/Zotero;1"].getService(Components.interfaces.nsISupports).wrappedJSObject}};Ln.BasicTool=to;var Tc=class extends to{};Ln.ManagerTool=Tc;function V7(t){Object.values(t).forEach(r=>{(r instanceof Tc||typeof r.unregisterAll=="function")&&r.unregisterAll()})}Ln.unregister=V7});var Qn=me(Ic=>{"use strict";Object.defineProperty(Ic,"__esModule",{value:!0});Ic.UITool=void 0;var W7=Je(),Zd=class extends W7.BasicTool{get basicOptions(){return this._basicOptions}constructor(r){super(r),this.elementCache=[],this._basicOptions.ui||(this._basicOptions.ui={enableElementRecord:!0,enableElementJSONLog:!1,enableElementDOMLog:!0})}unregisterAll(){this.elementCache.forEach(r=>{var i;try{(i=r?.deref())===null||i===void 0||i.remove()}catch(l){this.log(l)}})}createElement(...r){var i,l,u;let d=r[0],g=r[1].toLowerCase(),m=r[2]||{};if(!g)return;typeof r[2]=="string"&&(m={namespace:r[2],enableElementRecord:r[3]}),(typeof m.enableElementJSONLog<"u"&&m.enableElementJSONLog||this.basicOptions.ui.enableElementJSONLog)&&this.log(m),m.properties=m.properties||m.directAttributes,m.children=m.children||m.subElementOptions;let x;if(g==="fragment")x=d.createDocumentFragment();else{let v=m.id&&(m.checkExistenceParent?m.checkExistenceParent:d).querySelector(`#${m.id}`);if(v&&m.ignoreIfExists)return v;if(v&&m.removeIfExists&&(v.remove(),v=void 0),m.customCheck&&!m.customCheck(d,m))return;if(!v||!m.skipIfExists){let I=m.namespace;if(!I){let S=G7.includes(g),M=X7.includes(g),E=K7.includes(g);Number(S)+Number(M)+Number(E)>1&&this.log(`[Warning] Creating element ${g} with no namespace specified. Found multiply namespace matches.`),S?I="html":M?I="xul":E?I="svg":I="html"}I==="xul"?v=this.createXULElement(d,g):v=d.createElementNS({html:"http://www.w3.org/1999/xhtml",svg:"http://www.w3.org/2000/svg"}[I],g),this.elementCache.push(new WeakRef(v))}m.id&&(v.id=m.id),m.styles&&Object.keys(m.styles).length&&Object.keys(m.styles).forEach(I=>{let S=m.styles[I];typeof S<"u"&&(v.style[I]=S)}),m.properties&&Object.keys(m.properties).length&&Object.keys(m.properties).forEach(I=>{let S=m.properties[I];typeof S<"u"&&(v[I]=S)}),m.attributes&&Object.keys(m.attributes).length&&Object.keys(m.attributes).forEach(I=>{let S=m.attributes[I];typeof S<"u"&&v.setAttribute(I,String(S))}),!((i=m.classList)===null||i===void 0)&&i.length&&v.classList.add(...m.classList),!((l=m.listeners)===null||l===void 0)&&l.length&&m.listeners.forEach(({type:I,listener:S,options:M})=>{S&&v.addEventListener(I,S,M)}),x=v}if(!((u=m.children)===null||u===void 0)&&u.length){let v=m.children.map(I=>(I.namespace=I.namespace||m.namespace,this.createElement(d,I.tag,I))).filter(I=>I);x.append(...v)}return(typeof m.enableElementDOMLog<"u"&&m.enableElementDOMLog||this.basicOptions.ui.enableElementDOMLog)&&this.log(x),x}appendElement(r,i){return i.appendChild(this.createElement(i.ownerDocument,r.tag,r))}insertElementBefore(r,i){if(i.parentNode)return i.parentNode.insertBefore(this.createElement(i.ownerDocument,r.tag,r),i);this.log(i.tagName+" has no parent, cannot insert "+r.tag)}replaceElement(r,i){if(i.parentNode)return i.parentNode.replaceChild(this.createElement(i.ownerDocument,r.tag,r),i);this.log(i.tagName+" has no parent, cannot replace it with "+r.tag)}parseXHTMLToFragment(r,i=[],l=!0){let u=this.getDOMParser(),d="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul",g="http://www.w3.org/1999/xhtml",m=`${i.length?`<!DOCTYPE bindings [ ${i.reduce((I,S,M)=>I+`<!ENTITY % _dtd-${M} SYSTEM "${S}"> %_dtd-${M}; `,"")}]>`:""}
      <html:div xmlns="${l?d:g}"
          xmlns:xul="${d}" xmlns:html="${g}">
      ${r}
      </html:div>`;this.log(m,u);let x=u.parseFromString(m,"text/xml");if(this.log(x),x.documentElement.localName==="parsererror")throw new Error("not well-formed XHTML");let v=x.createRange();return v.selectNodeContents(x.querySelector("div")),v.extractContents()}};Ic.UITool=Zd;var G7=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","menu","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"],X7=["action","arrowscrollbox","bbox","binding","bindings","box","broadcaster","broadcasterset","button","browser","checkbox","caption","colorpicker","column","columns","commandset","command","conditions","content","deck","description","dialog","dialogheader","editor","grid","grippy","groupbox","hbox","iframe","image","key","keyset","label","listbox","listcell","listcol","listcols","listhead","listheader","listitem","member","menu","menubar","menuitem","menulist","menupopup","menuseparator","observes","overlay","page","popup","popupset","preference","preferences","prefpane","prefwindow","progressmeter","radio","radiogroup","resizer","richlistbox","richlistitem","row","rows","rule","script","scrollbar","scrollbox","scrollcorner","separator","spacer","splitter","stack","statusbar","statusbarpanel","stringbundle","stringbundleset","tab","tabbrowser","tabbox","tabpanel","tabpanels","tabs","template","textnode","textbox","titlebar","toolbar","toolbarbutton","toolbargrippy","toolbaritem","toolbarpalette","toolbarseparator","toolbarset","toolbarspacer","toolbarspring","toolbox","tooltip","tree","treecell","treechildren","treecol","treecols","treeitem","treerow","treeseparator","triple","vbox","window","wizard","wizardpage"],K7=["a","animate","animateMotion","animateTransform","circle","clipPath","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","foreignObject","g","image","line","linearGradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tspan","use","view"]});var Uv=me(ro=>{"use strict";Object.defineProperty(ro,"__esModule",{value:!0});ro.waitUtilAsync=ro.waitUntil=void 0;var J7=Je(),no=new J7.BasicTool;function Y7(t,r,i=100,l=1e4){let u=Date.now(),d=no.getGlobal("setInterval")(()=>{t()?(no.getGlobal("clearInterval")(d),r()):Date.now()-u>l&&no.getGlobal("clearInterval")(d)},i)}ro.waitUntil=Y7;function Q7(t,r=100,i=1e4){return new Promise((l,u)=>{let d=Date.now(),g=no.getGlobal("setInterval")(()=>{t()?(no.getGlobal("clearInterval")(g),l()):Date.now()-d>i&&(no.getGlobal("clearInterval")(g),u())},r)})}ro.waitUtilAsync=Q7});var Hd=me(Ec=>{"use strict";Object.defineProperty(Ec,"__esModule",{value:!0});Ec.ReaderTool=void 0;var eE=Je(),tE=Uv(),jd=class extends eE.BasicTool{async getReader(r=5e3){let i=this.getGlobal("Zotero_Tabs");if(i.selectedType!=="reader")return;let l=Zotero.Reader.getByTabID(i.selectedID),u=0,d=50;for(;!l&&u*d<r;)await Zotero.Promise.delay(d),l=Zotero.Reader.getByTabID(i.selectedID),u++;return await l?._initPromise,l}getWindowReader(){let r=this.getGlobal("Zotero_Tabs"),i=[],l=r._tabs.map(u=>u.id);for(let u=0;u<Zotero.Reader._readers.length;u++){let d=!1;for(let g=0;g<l.length;g++)if(Zotero.Reader._readers[u].tabID==l[g]){d=!0;break}d||i.push(Zotero.Reader._readers[u])}return i}getReaderTabPanelDeck(){var r;return(r=this.getGlobal("window").document.querySelector(".notes-pane-deck"))===null||r===void 0?void 0:r.previousElementSibling}async addReaderTabPanelDeckObserver(r){await(0,tE.waitUtilAsync)(()=>!!this.getReaderTabPanelDeck());let i=this.getReaderTabPanelDeck(),l=new(this.getGlobal("MutationObserver"))(async u=>{u.forEach(async d=>{let g=d.target;(g.classList.contains("zotero-view-tabbox")||g.tagName==="deck")&&r()})});return l.observe(i,{attributes:!0,attributeFilter:["selectedIndex"],subtree:!0}),l}getSelectedText(r){var i,l,u;if(!r)return"";if(this.isZotero7()){if(r._internalReader._type==="pdf"){let d=r._internalReader._lastView._selectionRanges;return((i=r._internalReader._lastView._getAnnotationFromSelectionRanges(d,"highlight"))===null||i===void 0?void 0:i.text)||""}return((l=r._internalReader._lastView._getAnnotationFromTextSelection("highlight"))===null||l===void 0?void 0:l.text)||""}else{let d=(u=r._iframeWindow)===null||u===void 0?void 0:u.document.querySelectorAll("textarea");if(!d)return"";for(let g=0;g<d.length;g++)if(d[g].style.zIndex==="-1"&&d[g].style.width==="0px")return d[g].value.replace(/(^\s*)|(\s*$)/g,"");return""}}};Ec.ReaderTool=jd});var Zv=me(kc=>{"use strict";Object.defineProperty(kc,"__esModule",{value:!0});kc.ExtraFieldTool=void 0;var nE=Je(),$d=class extends nE.BasicTool{getExtraFields(r,i="custom"){let l=r.getField("extra");if(i==="default")return this.getGlobal("Zotero").Utilities.Internal.extractExtraFields(l).fields;{let u=new Map,d=[];return l.split(`
`).forEach(g=>{let m=g.split(": ");m.length>=2&&m[0]?u.set(m[0],m.slice(1).join(": ")):d.push(g)}),u.set("__nonStandard__",d.join(`
`)),u}}getExtraField(r,i){return this.getExtraFields(r).get(i)}async replaceExtraFields(r,i){let l=[];i.has("__nonStandard__")&&(l.push(i.get("__nonStandard__")),i.delete("__nonStandard__")),i.forEach((u,d)=>{l.push(`${d}: ${u}`)}),r.setField("extra",l.join(`
`)),await r.saveTx()}async setExtraField(r,i,l){let u=this.getExtraFields(r);u.set(i,l),await this.replaceExtraFields(r,u)}};kc.ExtraFieldTool=$d});var Nc=me(Cc=>{"use strict";Object.defineProperty(Cc,"__esModule",{value:!0});Cc.PatcherManager=void 0;var rE=Je(),Vd=class extends rE.ManagerTool{constructor(r){super(r),this.patcherIDMap=new Map}register(r,i,l){let u=this.getGlobal("Zotero"),d=this.patcherIDMap,g=u.randomString();for(;d.has(g);)g=u.randomString();let m=r[i];return d.set(g,!0),this.log("patching ",i),r[i]=function(...x){if(d.get(g))try{return l(m).apply(this,x)}catch(v){u.logError(v)}return m.apply(this,x)},g}unregister(r){this.patcherIDMap.delete(r)}unregisterAll(){this.patcherIDMap.clear()}};Cc.PatcherManager=Vd});var Ac=me(io=>{"use strict";var iE=io&&io.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(io,"__esModule",{value:!0});io.FieldHookManager=void 0;var oE=Je(),aE=Nc(),jv=iE(Yn()),Wd=class extends oE.ManagerTool{constructor(r){super(r),this.patcherManager=new aE.PatcherManager,this.localCache=[],this.initializeGlobal()}register(r,i,l){let u=this.getHooksFactory(r);u&&(i in u&&this.log(`[WARNING] ${r}.${i} overwrites an existing hook.`),u[i]=l,this.localCache.push({type:r,field:i}))}unregister(r,i){let l=this.getHooksFactory(r);l&&delete l[i];let u=this.localCache.findIndex(({type:d})=>d===r);u>-1&&this.localCache.splice(u,1)}unregisterAll(){[...this.localCache].forEach(r=>{this.unregister(r.type,r.field)})}getHooksFactory(r){switch(r){case"getField":let i=jv.default.getInstance().itemTree,l=i.fieldHooks;return l&&l!==this.globalCache.getFieldHooks&&(Object.assign(this.globalCache.getFieldHooks,l),i.fieldHooks=this.globalCache.getFieldHooks),this.globalCache.getFieldHooks;break;case"setField":return this.globalCache.setFieldHooks;case"isFieldOfBase":return this.globalCache.isFieldOfBaseHooks;default:break}}initializeGlobal(){let r=this.getGlobal("Zotero"),i=this.globalCache=jv.default.getInstance().fieldHooks;this.globalCache._ready||(this.globalCache._ready=!0,this.patcherManager.register(r.Item.prototype,"getField",l=>function(u,d,g){let m=this;if(Object.keys(i.getFieldHooks).includes(u))try{let x=i.getFieldHooks[u];return x(u,d,g,m,l.bind(m))}catch(x){return u+String(x)}return l.apply(m,arguments)}),this.patcherManager.register(r.Item.prototype,"setField",l=>function(u,d,g){let m=this;if(Object.keys(i.setFieldHooks).includes(u))try{let x=i.setFieldHooks[u];return x(u,d,g,m,l.bind(m))}catch(x){return u+String(x)}return l.apply(m,arguments)}),this.patcherManager.register(r.ItemFields,"isFieldOfBase",l=>function(u,d){let g=this;if(Object.keys(i.isFieldOfBaseHooks).includes(u))try{let m=i.isFieldOfBaseHooks[u];return m(u,d,l.bind(g))}catch{return!1}return l.apply(g,arguments)}))}};io.FieldHookManager=Wd});var Hv=me(oo=>{"use strict";var sE=oo&&oo.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(oo,"__esModule",{value:!0});oo.ItemTreeManager=void 0;var lE=Je(),cE=Ac(),uE=sE(Yn()),fE=Nc(),Gd=class extends lE.ManagerTool{constructor(r){super(r),this.defaultPersist=["width","ordinal","hidden","sortActive","sortDirection"],this.backend=this.getGlobal("Zotero").ItemTreeManager,this.localColumnCache=[],this.localRenderCellCache=[],this.fieldHooks=new cE.FieldHookManager(r),this.patcherManager=new fE.PatcherManager(r),this.initializationLock=this.getGlobal("Zotero").Promise.defer(),this.initializeGlobal()}unregisterAll(){[...this.localColumnCache].forEach(r=>this.unregister(r,{skipGetField:!0})),[...this.localRenderCellCache].forEach(this.removeRenderCellHook.bind(this)),this.fieldHooks.unregisterAll()}async register(r,i,l,u={showInColumnPicker:!0}){var d;if(await((d=this.initializationLock)===null||d===void 0?void 0:d.promise),!this.backend&&this.globalCache.columns.map(m=>m.dataKey).includes(r)){this.log(`ItemTreeTool: ${r} is already registered.`);return}let g={dataKey:r,label:i,pluginID:this._basicOptions.api.pluginID,iconLabel:u.iconPath?this.createIconLabel({iconPath:u.iconPath,name:i}):void 0,iconPath:u.iconPath,htmlLabel:u.htmlLabel,zoteroPersist:u.zoteroPersist||(this.backend?this.defaultPersist:new Set(this.defaultPersist)),defaultIn:u.defaultIn,disabledIn:u.disabledIn,enabledTreeIDs:u.enabledTreeIDs,defaultSort:u.defaultSort,sortReverse:u.sortReverse||u.defaultSort===-1,flex:typeof u.flex>"u"?1:u.flex,width:u.width,fixedWidth:u.fixedWidth,staticWidth:u.staticWidth,minWidth:u.minWidth,ignoreInColumnPicker:u.ignoreInColumnPicker,showInColumnPicker:typeof u.ignoreInColumnPicker>"u"?!0:u.showInColumnPicker,submenu:u.submenu,columnPickerSubMenu:u.columnPickerSubMenu||u.submenu,dataProvider:u.dataProvider||((m,x)=>m.getField(r))};if(l&&this.fieldHooks.register("getField",r,l),this.backend){let m=await this.backend.registerColumns(g);u.renderCellHook&&(await this.addRenderCellHook(m,u.renderCellHook),await this.refresh())}else this.globalCache.columns.push(g),this.localColumnCache.push(g.dataKey),u.renderCellHook&&await this.addRenderCellHook(r,u.renderCellHook),await this.refresh()}async unregister(r,i={}){if(await this.initializationLock.promise,this.backend){await this.backend.unregisterColumns(r),i.skipGetField||this.fieldHooks.unregister("getField",r);return}let l=this.getGlobal("Zotero"),u=l.Prefs.get("pane.persist"),d=JSON.parse(u);delete d[r],l.Prefs.set("pane.persist",JSON.stringify(d));let g=this.globalCache.columns.map(x=>x.dataKey).indexOf(r);g>=0&&this.globalCache.columns.splice(g,1),i.skipGetField||this.fieldHooks.unregister("getField",r),this.removeRenderCellHook(r),await this.refresh();let m=this.localColumnCache.indexOf(r);m>=0&&this.localColumnCache.splice(m,1)}async addRenderCellHook(r,i){await this.initializationLock.promise,r in this.globalCache.renderCellHooks&&this.log("[WARNING] ItemTreeTool.addRenderCellHook overwrites an existing hook:",r),this.globalCache.renderCellHooks[r]=i,this.localRenderCellCache.push(r)}async removeRenderCellHook(r){delete this.globalCache.renderCellHooks[r];let i=this.localRenderCellCache.indexOf(r);i>=0&&this.localRenderCellCache.splice(i,1),await this.refresh()}async initializeGlobal(){await this.getGlobal("Zotero").uiReadyPromise;let i=this.getGlobal("window"),l=this.globalCache=uE.default.getInstance().itemTree;if(!l._ready){l._ready=!0;let u=i.require("zotero/itemTree");this.backend||this.patcherManager.register(u.prototype,"getColumns",d=>function(){let g=d.apply(this,arguments),m=g.findIndex(x=>x.dataKey==="title");return g.splice(m+1,0,...l.columns),g}),this.patcherManager.register(u.prototype,"_renderCell",d=>function(g,m,x){if(!(x.dataKey in l.renderCellHooks))return d.apply(this,arguments);let v=l.renderCellHooks[x.dataKey],I=v(g,m,x,d.bind(this));if(I.classList.contains("cell"))return I;let S=i.document.createElementNS("http://www.w3.org/1999/xhtml","span");return S.classList.add("cell",x.dataKey,`${x.dataKey}-item-tree-main-default`),x.fixedWidth&&S.classList.add("fixed-width"),S.appendChild(I),S})}this.initializationLock.resolve()}createIconLabel(r){let i=window.require("react");return i.createElement("span",null,i.createElement("img",{src:r.iconPath,height:"10px",width:"9px",style:{"margin-left":"6px"}})," ",r.name)}async refresh(){var r,i;await this.initializationLock.promise;let l=this.getGlobal("ZoteroPane");l.itemsView._columnsId=null;let u=(r=l.itemsView.tree)===null||r===void 0?void 0:r._columns;if(!u){this.log("ItemTree is still loading. Refresh skipped.");return}(i=document.querySelector(`.${u._styleKey}`))===null||i===void 0||i.remove(),await l.itemsView.refreshAndMaintainSelection(),l.itemsView.tree._columns=new u.__proto__.constructor(l.itemsView.tree),await l.itemsView.refreshAndMaintainSelection()}};oo.ItemTreeManager=Gd});var $v=me(Tr=>{"use strict";var hE=Tr&&Tr.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Tr,"__esModule",{value:!0});Tr.PromptManager=Tr.Prompt=void 0;var dE=Je(),pE=Je(),gE=Qn(),mE=hE(Yn()),Mc=class{get document(){return this.base.getGlobal("document")}constructor(){this.lastInputText="",this.defaultText={placeholder:"Select a command...",empty:"No commands found."},this.maxLineNum=12,this.maxSuggestionNum=100,this.commands=[],this.base=new dE.BasicTool,this.ui=new gE.UITool,this.initializeUI()}initializeUI(){this.addStyle(),this.createHTML(),this.initInputEvents(),this.registerShortcut()}createHTML(){this.promptNode=this.ui.createElement(this.document,"div",{styles:{display:"none"},children:[{tag:"div",styles:{position:"fixed",left:"0",top:"0",backgroundColor:"rgba(220, 220, 220, 0.4)",width:"100%",height:"100%",opacity:"0.5"},listeners:[{type:"click",listener:()=>{this.promptNode.style.display="none"}}]}]}),this.promptNode.appendChild(this.ui.createElement(this.document,"div",{id:"zotero-plugin-toolkit-prompt",classList:["prompt-container"],children:[{tag:"div",classList:["input-container"],children:[{tag:"input",classList:["prompt-input"],attributes:{type:"text",placeholder:this.defaultText.placeholder}},{tag:"div",classList:["cta"]}]},{tag:"div",classList:["commands-containers"]},{tag:"div",classList:["instructions"],children:[{tag:"div",classList:["instruction"],children:[{tag:"span",classList:["key"],properties:{innerText:"\u2191\u2193"}},{tag:"span",properties:{innerText:"to navigate"}}]},{tag:"div",classList:["instruction"],children:[{tag:"span",classList:["key"],properties:{innerText:"enter"}},{tag:"span",properties:{innerText:"to trigger"}}]},{tag:"div",classList:["instruction"],children:[{tag:"span",classList:["key"],properties:{innerText:"esc"}},{tag:"span",properties:{innerText:"to exit"}}]}]}]})),this.inputNode=this.promptNode.querySelector("input"),this.document.documentElement.appendChild(this.promptNode)}showCommands(r,i=!1){i&&this.promptNode.querySelectorAll(".commands-container").forEach(u=>u.remove()),this.inputNode.placeholder=this.defaultText.placeholder;let l=this.createCommandsContainer();for(let u of r){try{if(!u.name||u.when&&!u.when())continue}catch{continue}l.appendChild(this.createCommandNode(u))}}createCommandsContainer(){let r=this.ui.createElement(this.document,"div",{classList:["commands-container"]});return this.promptNode.querySelectorAll(".commands-container").forEach(i=>{i.style.display="none"}),this.promptNode.querySelector(".commands-containers").appendChild(r),r}getCommandsContainer(){return[...Array.from(this.promptNode.querySelectorAll(".commands-container"))].find(r=>r.style.display!="none")}createCommandNode(r){let i=this.ui.createElement(this.document,"div",{classList:["command"],children:[{tag:"div",classList:["content"],children:[{tag:"div",classList:["name"],children:[{tag:"span",properties:{innerText:r.name}}]},{tag:"div",classList:["aux"],children:r.label?[{tag:"span",classList:["label"],properties:{innerText:r.label}}]:[]}]}],listeners:[{type:"mousemove",listener:()=>{this.selectItem(i)}},{type:"click",listener:async()=>{await this.execCallback(r.callback)}}]});return i.command=r,i}trigger(){[...Array.from(this.promptNode.querySelectorAll(".commands-container"))].find(r=>r.style.display!="none").querySelector(".selected").click()}exit(){if(this.inputNode.placeholder=this.defaultText.placeholder,this.promptNode.querySelectorAll(".commands-containers .commands-container").length>=2){this.promptNode.querySelector(".commands-container:last-child").remove();let r=this.promptNode.querySelector(".commands-container:last-child");r.style.display="",r.querySelectorAll(".commands").forEach(i=>i.style.display="flex"),this.inputNode.focus()}else this.promptNode.style.display="none"}async execCallback(r){Array.isArray(r)?this.showCommands(r):await r(this)}async showSuggestions(r){var i=/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,\-.\/:;<=>?@\[\]^_`{|}~]/,l=/\s/,u=/[\u0F00-\u0FFF\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\uff66-\uff9f]/;function d(M,E,C,B){if(M.length===0)return 0;var $=0;$-=Math.max(0,M.length-1),$-=B/10;var V=M[0][0];return $-=(M[M.length-1][1]-V+1-E)/100,$-=V/1e3,$-=C/1e4}function g(M,E,C,B){if(M.length===0)return null;for(var $=C.toLowerCase(),V=0,te=0,R=[],D=0;D<M.length;D++){var A=M[D],Z=$.indexOf(A,te);if(Z===-1)return null;var X=C.charAt(Z);if(Z>0&&!i.test(X)&&!u.test(X)){var H=C.charAt(Z-1);if(X.toLowerCase()!==X&&H.toLowerCase()!==H||X.toUpperCase()!==X&&!i.test(H)&&!l.test(H)&&!u.test(H))if(B){if(Z!==te){te+=A.length,D--;continue}}else V+=1}if(R.length===0)R.push([Z,Z+A.length]);else{var J=R[R.length-1];J[1]<Z?R.push([Z,Z+A.length]):J[1]=Z+A.length}te=Z+A.length}return{matches:R,score:d(R,E.length,$.length,V)}}function m(M){for(var E=M.toLowerCase(),C=[],B=0,$=0;$<E.length;$++){var V=E.charAt($);l.test(V)?(B!==$&&C.push(E.substring(B,$)),B=$+1):(i.test(V)||u.test(V))&&(B!==$&&C.push(E.substring(B,$)),C.push(V),B=$+1)}return B!==E.length&&C.push(E.substring(B,E.length)),{query:M,tokens:C,fuzzy:E.split("")}}function x(M,E){if(M.query==="")return{score:0,matches:[]};var C=g(M.tokens,M.query,E,!1);return C||g(M.fuzzy,M.query,E,!0)}var v=m(r);let I=this.getCommandsContainer();if(I.classList.contains("suggestions")&&this.exit(),r.trim()=="")return!0;let S=[];if(this.getCommandsContainer().querySelectorAll(".command").forEach(M=>{let C=M.querySelector(".name span").innerText,B=x(v,C);if(B){M=this.createCommandNode(M.command);let $="",V=0;for(let te=0;te<B.matches.length;te++){let[R,D]=B.matches[te];R>V&&($+=C.slice(V,R)),$+=`<span class="highlight">${C.slice(R,D)}</span>`,V=D}V<C.length&&($+=C.slice(V,C.length)),M.querySelector(".name span").innerHTML=$,S.push({score:B.score,commandNode:M})}}),S.length>0)return S.sort((M,E)=>E.score-M.score).slice(this.maxSuggestionNum),I=this.createCommandsContainer(),I.classList.add("suggestions"),S.forEach(M=>{I.appendChild(M.commandNode)}),!0;{let M=this.commands.find(E=>!E.name&&(!E.when||E.when()));return M?await this.execCallback(M.callback):this.showTip(this.defaultText.empty),!1}}initInputEvents(){this.promptNode.addEventListener("keydown",r=>{if(["ArrowUp","ArrowDown"].indexOf(r.key)!=-1){r.preventDefault();let i,l=[...Array.from(this.getCommandsContainer().querySelectorAll(".command"))].filter(d=>d.style.display!="none");i=l.findIndex(d=>d.classList.contains("selected")),i!=-1?(l[i].classList.remove("selected"),i+=r.key=="ArrowUp"?-1:1):r.key=="ArrowUp"?i=l.length-1:i=0,i==-1?i=l.length-1:i==l.length&&(i=0),l[i].classList.add("selected");let u=this.getCommandsContainer();u.scrollTo(0,u.querySelector(".selected").offsetTop-u.offsetHeight+7.5),l[i].classList.add("selected")}}),this.promptNode.addEventListener("keyup",async r=>{if(r.key=="Enter")this.trigger();else if(r.key=="Escape")this.inputNode.value.length>0?this.inputNode.value="":this.exit();else if(["ArrowUp","ArrowDown"].indexOf(r.key)!=-1)return;let i=this.inputNode.value;i!=this.lastInputText&&(this.lastInputText=i,window.setTimeout(async()=>{await this.showSuggestions(i)}))})}showTip(r){let i=this.ui.createElement(this.document,"div",{classList:["tip"],properties:{innerText:r}}),l=this.createCommandsContainer();return l.classList.add("suggestions"),l.appendChild(i),i}selectItem(r){this.getCommandsContainer().querySelectorAll(".command").forEach(i=>i.classList.remove("selected")),r.classList.add("selected")}addStyle(){let r=this.ui.createElement(this.document,"style",{namespace:"html",id:"prompt-style"});r.innerText=`
      .prompt-container * {
        box-sizing: border-box;
      }
      .prompt-container {
        ---radius---: 10px;
        position: fixed;
        left: 25%;
        top: 10%;
        width: 50%;
        border-radius: var(---radius---);
        border: 1px solid #bdbdbd;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background-color: white;
        font-size: 18px;
        box-shadow: 0px 1.8px 7.3px rgba(0, 0, 0, 0.071),
                    0px 6.3px 24.7px rgba(0, 0, 0, 0.112),
                    0px 30px 90px rgba(0, 0, 0, 0.2);
        font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Inter", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Microsoft YaHei Light", sans-serif;
      }
      
      /* input */
      .prompt-container .input-container  {
        width: 100%;
      }
      
      .input-container input {
        width: 100%;
        height: 40px;
        padding: 24px;
        border-radius: 50%;
        border: none;
        outline: none;
        font-size: 18px;
      }
      
      .input-container .cta {
        border-bottom: 1px solid #f6f6f6;  
        margin: 5px auto;
      }
      
      /* results */
      .commands-containers {
        width: 100%;
        height: 100%;
      }
      .commands-container {
        max-height: calc(${this.maxLineNum} * 35.5px);
        width: calc(100% - 12px);
        margin-left: 12px;
        margin-right: 0%;
        overflow-y: auto;
        overflow-x: hidden;
      }
      
      .commands-container .command {
        display: flex;
        align-content: baseline;
        justify-content: space-between;
        border-radius: 5px;
        padding: 6px 12px;
        margin-right: 12px;
        margin-top: 2px;
        margin-bottom: 2px;
      }
      .commands-container .command .content {
        display: flex;
        width: 100%;
        justify-content: space-between;
        flex-direction: row;
        overflow: hidden;
      }
      .commands-container .command .content .name {
        white-space: nowrap; 
        text-overflow: ellipsis;
        overflow: hidden;
      }
      .commands-container .command .content .aux {
        display: flex;
        align-items: center;
        align-self: center;
        flex-shrink: 0;
      }
      
      .commands-container .command .content .aux .label {
        font-size: 15px;
        color: #5a5a5a;
        padding: 2px 6px;
        background-color: #fafafa;
        border-radius: 5px;
      }
      
      .commands-container .selected {
          background-color: rgba(0, 0, 0, 0.075);
      }

      .commands-container .highlight {
        font-weight: bold;
      }

      .tip {
        color: #5a5a5a;
        text-align: center;
        padding: 12px 12px;
        font-size: 18px;
      }
      
      .current-value {
        background-color: #a7b8c1;
        color: white;
        border-radius: 5px;
        padding: 0 5px;
        margin-left: 10px;
        font-size: 14px;
        vertical-align: middle;
        letter-spacing: 0.05em;
      }

      /* instructions */
      .instructions {
        display: flex;
        align-content: center;
        justify-content: center;
        font-size: 15px;
        color: rgba(0, 0, 0, 0.4);
        height: 2.5em;
        width: 100%;
        border-top: 1px solid #f6f6f6;
        margin-top: 5px;
      }
      
      .instructions .instruction {
        margin: auto .5em;  
      }
      
      .instructions .key {
        margin-right: .2em;
        font-weight: 600;
      }
    `,this.document.documentElement.appendChild(r)}registerShortcut(){this.document.addEventListener("keydown",r=>{if(r.shiftKey&&r.key.toLowerCase()=="p"){if(r.originalTarget.isContentEditable||"value"in r.originalTarget||this.commands.length==0)return;r.preventDefault(),r.stopPropagation(),this.promptNode.style.display=="none"?(this.promptNode.style.display="flex",this.promptNode.querySelectorAll(".commands-container").length==1&&this.showCommands(this.commands,!0),this.promptNode.focus(),this.inputNode.focus()):this.promptNode.style.display="none"}},!0)}};Tr.Prompt=Mc;var Xd=class extends pE.ManagerTool{constructor(r){super(r),this.commands=[];let i=mE.default.getInstance().prompt;i._ready||(i._ready=!0,i.instance=new Mc),this.prompt=i.instance}register(r){window.console.log(JSON.parse(JSON.stringify(r))),r.forEach(i=>{var l;return(l=i.id)!==null&&l!==void 0?l:i.id=i.name}),this.prompt.commands=[...this.prompt.commands,...r],this.commands=[...this.commands,...r],this.prompt.showCommands(this.commands,!0),window.console.log(JSON.parse(JSON.stringify(Zotero._toolkitGlobal.prompt.instance.commands)))}unregister(r){let i=this.commands.find(l=>l.id==r);this.prompt.commands=this.prompt.commands.filter(l=>JSON.stringify(i)!=JSON.stringify(l)),this.commands=this.commands.filter(l=>l.id!=r)}unregisterAll(){this.prompt.commands=this.prompt.commands.filter(r=>this.commands.find(i=>{JSON.stringify(i)!=JSON.stringify(r)})),this.commands=[]}};Tr.PromptManager=Xd});var Vv=me(Dc=>{"use strict";Object.defineProperty(Dc,"__esModule",{value:!0});Dc.LibraryTabPanelManager=void 0;var yE=Qn(),bE=Je(),Kd=class extends bE.ManagerTool{constructor(r){super(r),this.ui=new yE.UITool(this),this.libraryTabCache={optionsList:[]}}register(r,i,l){l=l||{tabId:void 0,panelId:void 0,targetIndex:-1,selectPanel:!1};let u=this.getGlobal("window"),d=u.document.querySelector("#zotero-view-tabbox"),g=`${Zotero.Utilities.randomString()}-${new Date().getTime()}`,m=l.tabId||`toolkit-readertab-${g}`,x=l.panelId||`toolkit-readertabpanel-${g}`,v=this.ui.createElement(u.document,"tab",{id:m,classList:[`toolkit-ui-tabs-${m}`],attributes:{label:r},ignoreIfExists:!0}),I=this.ui.createElement(u.document,"tabpanel",{id:x,classList:[`toolkit-ui-tabs-${m}`],ignoreIfExists:!0}),S=d.querySelector("tabs"),M=d.querySelector("tabpanels"),E=typeof l.targetIndex=="number"?l.targetIndex:-1;return E>=0?(S.querySelectorAll("tab")[E].before(v),M.querySelectorAll("tabpanel")[E].before(I)):(S.appendChild(v),M.appendChild(I)),l.selectPanel&&(d.selectedTab=v),this.libraryTabCache.optionsList.push({tabId:m,tabLabel:r,panelId:x,renderPanelHook:i,targetIndex:E,selectPanel:l.selectPanel}),i(I,u),m}unregister(r){let i=this.libraryTabCache.optionsList.findIndex(l=>l.tabId===r);i>=0&&this.libraryTabCache.optionsList.splice(i,1),this.removeTabPanel(r)}unregisterAll(){this.libraryTabCache.optionsList.map(i=>i.tabId).forEach(this.unregister.bind(this))}removeTabPanel(r){let i=this.getGlobal("document");Array.prototype.forEach.call(i.querySelectorAll(`.toolkit-ui-tabs-${r}`),l=>{l.remove()})}};Dc.LibraryTabPanelManager=Kd});var Wv=me(Sc=>{"use strict";Object.defineProperty(Sc,"__esModule",{value:!0});Sc.ReaderTabPanelManager=void 0;var wE=Qn(),_E=Hd(),vE=Je(),Jd=class extends vE.ManagerTool{constructor(r){super(r),this.ui=new wE.UITool(this),this.readerTool=new _E.ReaderTool(this),this.readerTabCache={optionsList:[],observer:void 0,initializeLock:void 0}}async register(r,i,l){var u;l=l||{tabId:void 0,panelId:void 0,targetIndex:-1,selectPanel:!1},typeof this.readerTabCache.initializeLock>"u"&&await this.initializeReaderTabObserver(),await((u=this.readerTabCache.initializeLock)===null||u===void 0?void 0:u.promise);let d=`${Zotero.Utilities.randomString()}-${new Date().getTime()}`,g=l.tabId||`toolkit-readertab-${d}`,m=l.panelId||`toolkit-readertabpanel-${d}`,x=typeof l.targetIndex=="number"?l.targetIndex:-1;return this.readerTabCache.optionsList.push({tabId:g,tabLabel:r,panelId:m,renderPanelHook:i,targetIndex:x,selectPanel:l.selectPanel}),await this.addReaderTabPanel(),g}unregister(r){var i;let l=this.readerTabCache.optionsList.findIndex(u=>u.tabId===r);l>=0&&this.readerTabCache.optionsList.splice(l,1),this.readerTabCache.optionsList.length===0&&((i=this.readerTabCache.observer)===null||i===void 0||i.disconnect(),this.readerTabCache={optionsList:[],observer:void 0,initializeLock:void 0}),this.removeTabPanel(r)}unregisterAll(){this.readerTabCache.optionsList.map(i=>i.tabId).forEach(this.unregister.bind(this))}changeTabPanel(r,i){let l=this.readerTabCache.optionsList.findIndex(u=>u.tabId===r);l>=0&&Object.assign(this.readerTabCache.optionsList[l],i)}removeTabPanel(r){let i=this.getGlobal("document");Array.prototype.forEach.call(i.querySelectorAll(`.toolkit-ui-tabs-${r}`),l=>{l.remove()})}async initializeReaderTabObserver(){this.readerTabCache.initializeLock=this.getGlobal("Zotero").Promise.defer(),await Promise.all([Zotero.initializationPromise,Zotero.unlockPromise,Zotero.uiReadyPromise]);let r=Zotero.Promise.defer();r.resolve();let i=await this.readerTool.addReaderTabPanelDeckObserver(async()=>{await r.promise,r=Zotero.Promise.defer();try{this.addReaderTabPanel()}catch{}r.resolve()});this.readerTabCache.observer=i,this.readerTabCache.initializeLock.resolve()}async addReaderTabPanel(){var r,i;let l=this.getGlobal("window"),u=this.readerTool.getReaderTabPanelDeck(),d=await this.readerTool.getReader();if(!d)return;if(((r=u.selectedPanel)===null||r===void 0?void 0:r.children[0].tagName)==="vbox"){let v=u.selectedPanel;v.innerHTML="",this.ui.appendElement({tag:"tabbox",classList:["zotero-view-tabbox"],attributes:{flex:"1"},enableElementRecord:!1,children:[{tag:"tabs",classList:["zotero-editpane-tabs"],attributes:{orient:"horizontal"},enableElementRecord:!1},{tag:"tabpanels",classList:["zotero-view-item"],attributes:{flex:"1"},enableElementRecord:!1}]},v)}let g=(i=u.selectedPanel)===null||i===void 0?void 0:i.querySelector("tabbox");if(!g)return;let m=g.querySelector("tabs"),x=g.querySelector("tabpanels");this.readerTabCache.optionsList.forEach(v=>{let I=`${v.tabId}-${d._instanceID}`,S=`toolkit-ui-tabs-${v.tabId}`;if(m?.querySelector(`.${S}`))return;let M=this.ui.createElement(l.document,"tab",{id:I,classList:[S],attributes:{label:v.tabLabel},ignoreIfExists:!0}),E=this.ui.createElement(l.document,"tabpanel",{id:`${v.panelId}-${d._instanceID}`,classList:[S],ignoreIfExists:!0});v.targetIndex>=0?(m?.querySelectorAll("tab")[v.targetIndex].before(M),x?.querySelectorAll("tabpanel")[v.targetIndex].before(E),g.getAttribute("toolkit-select-fixed")!=="true"&&(g.tabpanels.addEventListener("select",()=>{this.getGlobal("setTimeout")(()=>{g.tabpanels.selectedPanel=g.tabs.getRelatedElement(g?.tabs.selectedItem)},0)}),g.setAttribute("toolkit-select-fixed","true"))):(m?.appendChild(M),x?.appendChild(E)),v.selectPanel&&(g.selectedTab=M),v.renderPanelHook(E,u,l,d)})}};Sc.ReaderTabPanelManager=Jd});var Gv=me(Lc=>{"use strict";Object.defineProperty(Lc,"__esModule",{value:!0});Lc.MenuManager=void 0;var xE=Qn(),TE=Je(),Yd=class extends TE.ManagerTool{constructor(r){super(r),this.ui=new xE.UITool(this)}register(r,i,l="after",u){let d;if(typeof r=="string"?d=this.getGlobal("document").querySelector(Qd[r]):d=r,!d)return!1;let g=d.ownerDocument,m=I=>{var S;let M={tag:I.tag,id:I.id,namespace:"xul",attributes:{label:I.label||"",hidden:!!I.hidden,disaled:!!I.disabled,class:I.class||"",oncommand:I.oncommand||""},classList:I.classList,styles:I.styles||{},listeners:[],children:[]};return I.icon&&(I.tag==="menu"?M.attributes.class+=" menu-iconic":M.attributes.class+=" menuitem-iconic",M.styles["list-style-image"]=`url(${I.icon})`),I.tag==="menu"&&M.children.push({tag:"menupopup",id:I.popupId,attributes:{onpopupshowing:I.onpopupshowing||""},children:(I.children||I.subElementOptions||[]).map(m)}),I.commandListener&&((S=M.listeners)===null||S===void 0||S.push({type:"command",listener:I.commandListener})),M},x=m(i),v=this.ui.createElement(g,i.tag,x);u||(u=l==="after"?d.lastElementChild:d.firstElementChild),u[l](v),i.getVisibility&&d.addEventListener("popupshowing",I=>{i.getVisibility(v,I)?v.removeAttribute("hidden"):v.setAttribute("hidden","true")})}unregister(r){var i;(i=this.getGlobal("document").querySelector(`#${r}`))===null||i===void 0||i.remove()}unregisterAll(){this.ui.unregisterAll()}};Lc.MenuManager=Yd;var Qd;(function(t){t.menuFile="#menu_FilePopup",t.menuEdit="#menu_EditPopup",t.menuView="#menu_viewPopup",t.menuGo="#menu_goPopup",t.menuTools="#menu_ToolsPopup",t.menuHelp="#menu_HelpPopup",t.collection="#zotero-collectionmenu",t.item="#zotero-itemmenu"})(Qd||(Qd={}))});var Xv=me(Pc=>{"use strict";Object.defineProperty(Pc,"__esModule",{value:!0});Pc.PreferencePaneManager=void 0;var IE=Qn(),EE=Je(),ep=class extends EE.ManagerTool{constructor(r){super(r),this.alive=!0,this.ui=new IE.UITool(this),this.prefPaneCache={win:void 0,listeners:{}}}register(r){if(this.isZotero7()){this.getGlobal("Zotero").PreferencePanes.register(r);return}let i=u=>{var d;let g=new Map,m=this.getGlobal("Zotero"),x=u.ownerGlobal,v=C=>C instanceof x.HTMLInputElement&&C.type=="checkbox"||C.tagName=="checkbox",I=(C,B)=>{let $=m.Prefs.get(B,!0);v(C)?C.checked=$:C.value=$,C.dispatchEvent(new x.Event("syncfrompreference"))},S=C=>{let B=C.currentTarget;if(B?.getAttribute("preference")){let $=v(B)?B.checked:B.value;m.Prefs.set(B.getAttribute("preference")||"",$,!0),B.dispatchEvent(new x.Event("synctopreference"))}},M=(C,B)=>{m.debug(`Attaching <${C.tagName}> element to ${B}`);let $=m.Prefs.registerObserver(B,()=>I(C,B),!0);g.set(C,$)},E=C=>{g.has(C)&&(m.debug(`Detaching <${C.tagName}> element from preference`),m.Prefs.unregisterObserver(this._observerSymbols.get(C)),g.delete(C))};for(let C of Array.from(u.querySelectorAll("[preference]"))){let B=C.getAttribute("preference");u.querySelector("preferences > preference#"+B)&&(this.log("<preference> is deprecated -- `preference` attribute values should be full preference keys, not <preference> IDs"),B=(d=u.querySelector("preferences > preference#"+B))===null||d===void 0?void 0:d.getAttribute("name")),M(C,B),C.addEventListener(this.isXULElement(C)?"command":"input",S),x.setTimeout(()=>{I(C,B)})}new x.MutationObserver(C=>{for(let B of C)if(B.type=="attributes"){let $=B.target;E($),$.hasAttribute("preference")&&(M($,$.getAttribute("preference")||""),$.addEventListener(this.isXULElement($)?"command":"input",S))}else if(B.type=="childList"){for(let $ of Array.from(B.removedNodes))E($);for(let $ of Array.from(B.addedNodes))$.nodeType==x.Node.ELEMENT_NODE&&$.hasAttribute("preference")&&(M($,$.getAttribute("preference")||""),$.addEventListener(this.isXULElement($)?"command":"input",S))}}).observe(u,{childList:!0,subtree:!0,attributeFilter:["preference"]});for(let C of Array.from(u.querySelectorAll("[oncommand]")))C.oncommand=C.getAttribute("oncommand");for(let C of Array.from(u.children))C.dispatchEvent(new x.Event("load"))},l={onOpenWindow:u=>{if(!this.alive)return;let d=u.QueryInterface(Components.interfaces.nsIInterfaceRequestor).getInterface(Components.interfaces.nsIDOMWindow);d.addEventListener("load",async()=>{var g;if(d.location.href==="chrome://zotero/content/preferences/preferences.xul"){this.log("registerPrefPane:detected",r);let m=this.getGlobal("Zotero");r.id||(r.id=`plugin-${m.Utilities.randomString()}-${new Date().getTime()}`);let x=await m.File.getContentsAsync(r.src),v=typeof x=="string"?x:x.response,I=`<prefpane xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul" id="${r.id}" insertafter="zotero-prefpane-advanced" label="${r.label||r.pluginID}" image="${r.image||""}">
                ${v}
                </prefpane>`,S=this.ui.parseXHTMLToFragment(I,r.extraDTD,r.defaultXUL);this.log(S);let M=d.document.querySelector("prefwindow");M.appendChild(S);let E=d.document.querySelector(`#${r.id}`);M.addPane(E);let C=d.document.getAnonymousNodes(d.document.querySelector(`#${r.id}`))[0];C.style.overflowY="scroll",C.style.height="440px",d.sizeToContent(),C.scrollHeight===C.clientHeight&&(C.style.overflowY="hidden"),this.prefPaneCache.win=d,this.prefPaneCache.listeners[r.id]=l,i(E),!((g=r.scripts)===null||g===void 0)&&g.length&&r.scripts.forEach(B=>Services.scriptloader.loadSubScript(B,d)),r.onload&&r.onload(d)}},!1)}};Services.wm.addListener(l)}unregister(r){var i;if(Object.keys(this.prefPaneCache.listeners).indexOf(r)<0)return!1;let u=this.prefPaneCache.listeners[r];Services.wm.removeListener(u),u.onOpenWindow=void 0;let d=this.prefPaneCache.win;return d&&!d.closed&&((i=d.document.querySelector(`#${r}`))===null||i===void 0||i.remove()),delete this.prefPaneCache.listeners[r],!0}unregisterAll(){this.alive=!1;for(let r in this.prefPaneCache.listeners)this.unregister(r)}};Pc.PreferencePaneManager=ep});var Jv=me(so=>{"use strict";var kE=so&&so.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(so,"__esModule",{value:!0});so.ShortcutManager=void 0;var Tt=Je(),CE=Qn(),NE=Je(),AE=kE(Yn()),tp=class extends NE.ManagerTool{constructor(r){super(r),this.ui=new CE.UITool(this),this.creatorId=`${Zotero.Utilities.randomString()}-${new Date().getTime()}`,this.initializeGlobal()}register(r,i){let l=i;switch(l.type=r,l.type){case"event":return this.registerEventKey(l),!0;case"element":return this.registerElementKey(l),!0;case"prefs":return this.getGlobal("Zotero").Prefs.set(l.id,l.key||""),!0;default:try{return l.register?l.register(l):!1}catch(u){return this.log(u),!1}}}getAll(){return Array.prototype.concat(this.getMainWindowElementKeys(),this.getEventKeys(),this.getPrefsKeys(),this.getBuiltinKeys())}checkKeyConflicting(r,i={includeEmpty:!1,customKeys:[]}){var l;r.modifiers=new ti(r.modifiers||"").getRaw();let u=this.getAll();return!((l=i.customKeys)===null||l===void 0)&&l.length&&(u=u.concat(i.customKeys)),i.includeEmpty||(u=u.filter(d=>d.key)),u.filter(d=>{var g,m;return d.id!==r.id&&((g=d.key)===null||g===void 0?void 0:g.toLowerCase())===((m=r.key)===null||m===void 0?void 0:m.toLowerCase())&&d.modifiers===r.modifiers})}checkAllKeyConflicting(r={includeEmpty:!1,customKeys:[]}){var i;let l=this.getAll();!((i=r.customKeys)===null||i===void 0)&&i.length&&(l=l.concat(r.customKeys)),r.includeEmpty||(l=l.filter(d=>d.key));let u=[];for(;l.length>0;){let d=l.pop(),g=l.filter(m=>{var x,v;return((x=m.key)===null||x===void 0?void 0:x.toLowerCase())===((v=d.key)===null||v===void 0?void 0:v.toLowerCase())&&m.modifiers===d.modifiers});if(g.length){g.push(d),u.push(g);let m=g.map(v=>v.id),x=[];l.forEach((v,I)=>m.includes(v.id)&&x.push(I)),x.sort((v,I)=>I-v).forEach(v=>l.splice(v,1))}}return u}async unregister(r){var i;switch(r.type){case"element":return(i=(r.xulData.document||this.getGlobal("document")).querySelector(`#${r.id}`))===null||i===void 0||i.remove(),!0;case"prefs":return this.getGlobal("Zotero").Prefs.set(r.id,""),!0;case"builtin":return!1;case"event":let l=this.globalCache.eventKeys.findIndex(u=>u.id===r.id);for(;l>=0;)this.globalCache.eventKeys.splice(l,1),l=this.globalCache.eventKeys.findIndex(u=>u.id===r.id);return!0;default:try{return r.unregister?await r.unregister(r):!1}catch(u){return this.log(u),!1}}}unregisterAll(){this.ui.unregisterAll(),this.globalCache.eventKeys.filter(r=>r.creatorId===this.creatorId).forEach(r=>this.unregister(r))}initializeGlobal(){let r=this.getGlobal("Zotero"),i=this.getGlobal("window");this.globalCache=AE.default.getInstance().shortcut,this.globalCache._ready||(this.globalCache._ready=!0,i.addEventListener("keypress",l=>{let u=[],d=[];l.altKey&&(u.push("alt"),d.push("alt")),l.shiftKey&&(u.push("shift"),d.push("shift")),l.metaKey&&(u.push("meta"),r.isMac&&d.push("accel")),l.ctrlKey&&(u.push("control"),!r.isMac&&d.push("accel"));let g=new ti(u.join(",")).getRaw(),m=new ti(u.join(",")).getRaw();this.globalCache.eventKeys.forEach(x=>{var v;if(x.disabled)return;let I=new ti(x.modifiers||"").getRaw();(I===g||I===m)&&((v=x.key)===null||v===void 0?void 0:v.toLowerCase())===l.key.toLowerCase()&&x.callback()})}))}registerEventKey(r){r.creatorId=this.creatorId,this.globalCache.eventKeys.push(r)}registerElementCommandset(r){var i;(i=r.document.querySelector("window"))===null||i===void 0||i.appendChild(this.ui.createElement(r.document,"commandset",{id:r.id,skipIfExists:!0,children:r.commands.map(l=>({tag:"command",id:l.id,attributes:{oncommand:l.oncommand,disabled:l.disabled,label:l.label}}))}))}registerElementCommand(r){var i;r._parentId&&this.registerElementCommandset({id:r._parentId,document:r.document,commands:[]}),(i=r.document.querySelector(`commandset#${r._parentId}`))===null||i===void 0||i.appendChild(this.ui.createElement(r.document,"command",{id:r.id,skipIfExists:!0,attributes:{oncommand:r.oncommand,disabled:r.disabled,label:r.label}}))}registerElementKeyset(r){var i;(i=r.document.querySelector("window"))===null||i===void 0||i.appendChild(this.ui.createElement(r.document,"keyset",{id:r.id,skipIfExists:!0,children:r.keys.map(l=>({tag:"key",id:l.id,attributes:{oncommand:l.xulData.oncommand||"//",command:l.xulData.command,modifiers:l.modifiers,key:this.getXULKey(l.key),keycode:this.getXULKeyCode(l.key),disabled:l.disabled}}))}))}registerElementKey(r){var i;let l=r.xulData.document||this.getGlobal("document");r.xulData._parentId&&this.registerElementKeyset({id:r.xulData._parentId,document:l,keys:[]}),(i=l.querySelector(`keyset#${r.xulData._parentId}`))===null||i===void 0||i.appendChild(this.ui.createElement(l,"key",{id:r.id,skipIfExists:!0,attributes:{oncommand:r.xulData.oncommand||"//",command:r.xulData.command,modifiers:r.modifiers,key:this.getXULKey(r.key),keycode:this.getXULKeyCode(r.key),disabled:r.disabled}})),r.xulData._commandOptions&&this.registerElementCommand(r.xulData._commandOptions)}getXULKey(r){if(r.length===1)return r}getXULKeyCode(r){let i=Object.values(ao).findIndex(l=>l===r);if(i>=0)return Object.values(ao)[i]}getStandardKey(r,i){return i&&Object.keys(ao).includes(i)?ao[i]:r}getElementCommandSets(r){return Array.from((r||this.getGlobal("document")).querySelectorAll("commandset")).map(i=>({id:i.id,commands:Array.from(i.querySelectorAll("command")).map(l=>({id:l.id,oncommand:l.getAttribute("oncommand"),disabled:l.getAttribute("disabled")==="true",label:l.getAttribute("label"),_parentId:i.id}))}))}getElementCommands(r){return Array.prototype.concat(...this.getElementCommandSets(r).map(i=>i.commands))}getElementKeySets(r){let i=this.getElementCommands(r);return Array.from((r||this.getGlobal("document")).querySelectorAll("keyset")).map(l=>({id:l.id,document:r,keys:Array.from(l.querySelectorAll("key")).map(u=>{let d=u.getAttribute("oncommand")||"",g=u.getAttribute("command")||"",m=i.find(v=>v.id===g);return{type:"element",id:u.id,key:this.getStandardKey(u.getAttribute("key")||"",u.getAttribute("keycode")||""),modifiers:new ti(u.getAttribute("modifiers")||"").getRaw(),disabled:u.getAttribute("disabled")==="true",xulData:{document:r,oncommand:d,command:g,_parentId:l.id,_commandOptions:m},callback:()=>{let I=r.ownerGlobal.eval;I(d),I(m?.oncommand||"")}}})}))}getElementKeys(r){return Array.prototype.concat(...this.getElementKeySets(r).map(i=>i.keys)).filter(i=>!ME.includes(i.id))}getMainWindowElementKeys(){return this.getElementKeys(this.getGlobal("document"))}getEventKeys(){return this.globalCache.eventKeys}getPrefsKeys(){let r=this.getGlobal("Zotero");return DE.map(i=>({id:i.id,modifiers:i.modifiers,key:r.Prefs.get(i.id),callback:i.callback,type:"prefs"}))}getBuiltinKeys(){return SE.map(r=>({id:r.id,modifiers:r.modifiers,key:r.key,callback:r.callback,type:"builtin"}))}};so.ShortcutManager=tp;var ti=class{constructor(r){r=r||"",this.accel=r.includes("accel"),this.shift=r.includes("shift"),this.control=r.includes("control"),this.meta=r.includes("meta"),this.alt=r.includes("alt")}equals(r){this.accel,r.accel,this.shift,r.shift,this.control,r.control,this.meta,r.meta,this.alt,r.alt}getRaw(){let r=[];return this.accel&&r.push("accel"),this.shift&&r.push("shift"),this.control&&r.push("control"),this.meta&&r.push("meta"),this.alt&&r.push("alt"),r.join(",")}},ao;(function(t){t.VK_CANCEL="Unidentified",t.VK_BACK="Backspace",t.VK_TAB="Tab",t.VK_CLEAR="Clear",t.VK_RETURN="Enter",t.VK_ENTER="Enter",t.VK_SHIFT="Shift",t.VK_CONTROL="Control",t.VK_ALT="Alt",t.VK_PAUSE="Pause",t.VK_CAPS_LOCK="CapsLock",t.VK_ESCAPE="Escape",t.VK_SPACE=" ",t.VK_PAGE_UP="PageUp",t.VK_PAGE_DOWN="PageDown",t.VK_END="End",t.VK_HOME="Home",t.VK_LEFT="ArrowLeft",t.VK_UP="ArrowUp",t.VK_RIGHT="ArrowRight",t.VK_DOWN="ArrowDown",t.VK_PRINTSCREEN="PrintScreen",t.VK_INSERT="Insert",t.VK_DELETE="Backspace",t.VK_0="0",t.VK_1="1",t.VK_2="2",t.VK_3="3",t.VK_4="4",t.VK_5="5",t.VK_6="6",t.VK_7="7",t.VK_8="8",t.VK_9="9",t.VK_A="A",t.VK_B="B",t.VK_C="C",t.VK_D="D",t.VK_E="E",t.VK_F="F",t.VK_G="G",t.VK_H="H",t.VK_I="I",t.VK_J="J",t.VK_K="K",t.VK_L="L",t.VK_M="M",t.VK_N="N",t.VK_O="O",t.VK_P="P",t.VK_Q="Q",t.VK_R="R",t.VK_S="S",t.VK_T="T",t.VK_U="U",t.VK_V="V",t.VK_W="W",t.VK_X="X",t.VK_Y="Y",t.VK_Z="Z",t.VK_SEMICOLON="Unidentified",t.VK_EQUALS="Unidentified",t.VK_NUMPAD0="0",t.VK_NUMPAD1="1",t.VK_NUMPAD2="2",t.VK_NUMPAD3="3",t.VK_NUMPAD4="4",t.VK_NUMPAD5="5",t.VK_NUMPAD6="6",t.VK_NUMPAD7="7",t.VK_NUMPAD8="8",t.VK_NUMPAD9="9",t.VK_MULTIPLY="Multiply",t.VK_ADD="Add",t.VK_SEPARATOR="Separator",t.VK_SUBTRACT="Subtract",t.VK_DECIMAL="Decimal",t.VK_DIVIDE="Divide",t.VK_F1="F1",t.VK_F2="F2",t.VK_F3="F3",t.VK_F4="F4",t.VK_F5="F5",t.VK_F6="F6",t.VK_F7="F7",t.VK_F8="F8",t.VK_F9="F9",t.VK_F10="F10",t.VK_F11="F11",t.VK_F12="F12",t.VK_F13="F13",t.VK_F14="F14",t.VK_F15="F15",t.VK_F16="F16",t.VK_F17="F17",t.VK_F18="F18",t.VK_F19="F19",t.VK_F20="F20",t.VK_F21="Soft1",t.VK_F22="Soft2",t.VK_F23="Soft3",t.VK_F24="Soft4",t.VK_NUM_LOCK="NumLock",t.VK_SCROLL_LOCK="ScrollLock",t.VK_COMMA=",",t.VK_PERIOD=".",t.VK_SLASH="Divide",t.VK_BACK_QUOTE="`",t.VK_OPEN_BRACKET="[",t.VK_CLOSE_BRACKET="]",t.VK_QUOTE="\\",t.VK_HELP="Help"})(ao||(ao={}));function Kv(t){return function(){var r;let i=Tt.BasicTool.getZotero().getMainWindow(),l=i.document.querySelector(`#${t}`);if(!l)return function(){};let u=i.eval;u(l.getAttribute("oncommand")||"//");let d=l.getAttribute("command");d&&u(((r=i.document.querySelector(`#${d}`))===null||r===void 0?void 0:r.getAttribute("oncommand"))||"//")}}function Ir(t){return function(){let r=Tt.BasicTool.getZotero();r.getActiveZoteroPane().handleKeyPress({metaKey:!0,ctrlKey:!0,shiftKey:!0,originalTarget:{id:""},preventDefault:()=>{},key:r.Prefs.get(`extensions.zotero.keys.${t}`,!0)})}}var ME=["key_copyCitation","key_copyBibliography"],DE=[{id:"extensions.zotero.keys.copySelectedItemCitationsToClipboard",modifiers:"accel,shift",elemId:"key_copyCitation",callback:Kv("key_copyCitation")},{id:"extensions.zotero.keys.copySelectedItemsToClipboard",modifiers:"accel,shift",elemId:"key_copyBibliography",callback:Kv("key_copyBibliography")},{id:"extensions.zotero.keys.library",modifiers:"accel,shift",callback:Ir("library")},{id:"extensions.zotero.keys.newItem",modifiers:"accel,shift",callback:Ir("newItem")},{id:"extensions.zotero.keys.newNote",modifiers:"accel,shift",callback:Ir("newNote")},{id:"extensions.zotero.keys.quicksearch",modifiers:"accel,shift",callback:Ir("quicksearch")},{id:"extensions.zotero.keys.saveToZotero",modifiers:"accel,shift",callback:Ir("saveToZotero")},{id:"extensions.zotero.keys.sync",modifiers:"accel,shift",callback:Ir("sync")},{id:"extensions.zotero.keys.toggleAllRead",modifiers:"accel,shift",callback:Ir("toggleAllRead")},{id:"extensions.zotero.keys.toggleRead",modifiers:"accel,shift",callback:Ir("toggleRead")}],SE=[{id:"showItemCollection",modifiers:"",key:"Ctrl",callback:()=>{let t=Tt.BasicTool.getZotero(),r=t.getActiveZoteroPane();r.handleKeyUp({originalTarget:{id:r.itemsView.id},keyCode:t.isWin?17:18})}},{id:"closeSelectedTab",modifiers:"accel",key:"W",callback:()=>{let t=Tt.BasicTool.getZotero().getMainWindow().Zotero_Tabs;t.selectedIndex>0&&t.close("")}},{id:"undoCloseTab",modifiers:"accel,shift",key:"T",callback:()=>{Tt.BasicTool.getZotero().getMainWindow().Zotero_Tabs.undoClose()}},{id:"selectNextTab",modifiers:"control",key:"Tab",callback:()=>{Tt.BasicTool.getZotero().getMainWindow().Zotero_Tabs.selectPrev()}},{id:"selectPreviousTab",modifiers:"control,shift",key:"Tab",callback:()=>{Tt.BasicTool.getZotero().getMainWindow().Zotero_Tabs.selectNext()}},{id:"selectTab1",modifiers:"accel",key:"1",callback:()=>{Tt.BasicTool.getZotero().getMainWindow().Zotero_Tabs.jump(0)}},{id:"selectTab2",modifiers:"accel",key:"2",callback:()=>{Tt.BasicTool.getZotero().getMainWindow().Zotero_Tabs.jump(1)}},{id:"selectTab3",modifiers:"accel",key:"3",callback:()=>{Tt.BasicTool.getZotero().getMainWindow().Zotero_Tabs.jump(2)}},{id:"selectTab4",modifiers:"accel",key:"4",callback:()=>{Tt.BasicTool.getZotero().getMainWindow().Zotero_Tabs.jump(3)}},{id:"selectTab5",modifiers:"accel",key:"5",callback:()=>{Tt.BasicTool.getZotero().getMainWindow().Zotero_Tabs.jump(4)}},{id:"selectTab6",modifiers:"accel",key:"6",callback:()=>{Tt.BasicTool.getZotero().getMainWindow().Zotero_Tabs.jump(5)}},{id:"selectTab7",modifiers:"accel",key:"7",callback:()=>{Tt.BasicTool.getZotero().getMainWindow().Zotero_Tabs.jump(6)}},{id:"selectTab8",modifiers:"accel",key:"8",callback:()=>{Tt.BasicTool.getZotero().getMainWindow().Zotero_Tabs.jump(7)}},{id:"selectTabLast",modifiers:"accel",key:"9",callback:()=>{Tt.BasicTool.getZotero().getMainWindow().Zotero_Tabs.selectLast()}}]});var Yv=me(Oc=>{"use strict";Object.defineProperty(Oc,"__esModule",{value:!0});Oc.ClipboardHelper=void 0;var LE=Je(),np=class{constructor(){this.transferable=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable),this.clipboardService=Components.classes["@mozilla.org/widget/clipboard;1"].getService(Components.interfaces.nsIClipboard),this.transferable.init(null)}addText(r,i){let l=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);return l.data=r,this.transferable.addDataFlavor(i),this.transferable.setTransferData(i,l,r.length*2),this}addImage(r){let i=r.split(",");if(!i[0].includes("base64"))return this;let l=new LE.BasicTool,u=i[0].match(/:(.*?);/)[1],d=l.getGlobal("window").atob(i[1]),g=d.length,m=new Uint8Array(g);for(;g--;)m[g]=d.charCodeAt(g);let x=Components.classes["@mozilla.org/image/tools;1"].getService(Components.interfaces.imgITools),v,I;return l.getGlobal("Zotero").platformMajorVersion>=102?(I=x.decodeImageFromArrayBuffer(m.buffer,u),v="application/x-moz-nativeimage"):(v="image/png",I=Components.classes["@mozilla.org/supports-interface-pointer;1"].createInstance(Components.interfaces.nsISupportsInterfacePointer),I.data=x.decodeImageFromArrayBuffer(m.buffer,v)),this.transferable.addDataFlavor(v),this.transferable.setTransferData(v,I,0),this}copy(){return this.clipboardService.setData(this.transferable,null,Components.interfaces.nsIClipboard.kGlobalClipboard),this}};Oc.ClipboardHelper=np});var Qv=me(Rc=>{"use strict";Object.defineProperty(Rc,"__esModule",{value:!0});Rc.FilePickerHelper=void 0;var PE=Je(),rp=class{constructor(r,i,l,u,d,g){this.title=r,this.mode=i,this.filters=l,this.suggestion=u,this.window=d,this.filterMask=g}async open(){let r=new PE.BasicTool,i=r.getGlobal("require")("zotero/modules/filePicker").default,l=new i;l.init(this.window||r.getGlobal("window"),this.title,this.getMode(l));for(let[d,g]of this.filters||[])l.appendFilter(d,g);switch(this.filterMask&&l.appendFilters(this.getFilterMask(l)),this.suggestion&&(l.defaultString=this.suggestion),await l.show()){case l.returnOK:case l.returnReplace:return this.mode==="multiple"?l.files:l.file;default:return!1}}getMode(r){switch(this.mode){case"open":return r.modeOpen;case"save":return r.modeSave;case"folder":return r.modeGetFolder;case"multiple":return r.modeOpenMultiple;default:return 0}}getFilterMask(r){switch(this.filterMask){case"all":return r.filterAll;case"html":return r.filterHTML;case"text":return r.filterText;case"images":return r.filterImages;case"xml":return r.filterXML;case"apps":return r.filterApps;case"urls":return r.filterAllowURLs;case"audio":return r.filterAudio;case"video":return r.filterVideo;default:return 1}}};Rc.FilePickerHelper=rp});var e2=me(Fc=>{"use strict";Object.defineProperty(Fc,"__esModule",{value:!0});Fc.ProgressWindowHelper=void 0;var OE=Je(),op=class extends Zotero.ProgressWindow{constructor(r,i={closeOnClick:!0,closeTime:5e3}){super(i),this.lines=[],this.closeTime=i.closeTime||5e3,this.changeHeadline(r),this.originalShow=this.show,this.show=this.showWithTimer,i.closeOtherProgressWindows&&OE.BasicTool.getZotero().ProgressWindowSet.closeAll()}createLine(r){let i=this.getIcon(r.type,r.icon),l=new this.ItemProgress(i||"",r.text||"");return typeof r.progress=="number"&&l.setProgress(r.progress),this.lines.push(l),this}changeLine(r){var i;if(((i=this.lines)===null||i===void 0?void 0:i.length)===0)return this;let l=typeof r.idx<"u"&&r.idx>=0&&r.idx<this.lines.length?r.idx:0,u=this.getIcon(r.type,r.icon);return r.text&&this.lines[l].setText(r.text),u&&this.lines[l].setIcon(u),typeof r.progress=="number"&&this.lines[l].setProgress(r.progress),this}showWithTimer(r=void 0){return this.originalShow(),typeof r<"u"&&(this.closeTime=r),this.closeTime&&this.closeTime>0&&this.startCloseTimer(this.closeTime),this}static setIconURI(r,i){ip[r]=i}getIcon(r,i){return r&&r in ip?ip[r]:i}};Fc.ProgressWindowHelper=op;var ip={success:"chrome://zotero/skin/tick.png",fail:"chrome://zotero/skin/cross.png"}});var t2=me(Bc=>{"use strict";Object.defineProperty(Bc,"__esModule",{value:!0});Bc.VirtualizedTableHelper=void 0;var RE=Je(),ap=class{constructor(r){this.window=r,this.basicTool=new RE.BasicTool;let i=this.basicTool.getGlobal("Zotero"),l=r.require;this.React=l("react"),this.ReactDOM=l("react-dom"),this.VirtualizedTable=l("components/virtualized-table"),this.IntlProvider=l("react-intl").IntlProvider,this.props={id:`${i.Utilities.randomString()}-${new Date().getTime()}`,getRowCount:()=>0},this.localeStrings=i.Intl.strings}setProp(...r){return r.length===1?Object.assign(this.props,r[0]):r.length===2&&(this.props[r[0]]=r[1]),this}setLocale(r){return Object.assign(this.localeStrings,r),this}setContainerId(r){return this.containerId=r,this}render(r,i,l){let u=()=>{this.treeInstance.invalidate(),typeof r<"u"&&r>=0?this.treeInstance.selection.select(r):this.treeInstance.selection.clearSelection()};if(this.treeInstance)u();else{let d=Object.assign({},this.props,{ref:x=>this.treeInstance=x});d.getRowData&&!d.renderItem&&Object.assign(d,{renderItem:this.VirtualizedTable.makeRowRenderer(d.getRowData)});let g=this.React.createElement(this.IntlProvider,{locale:Zotero.locale,messages:Zotero.Intl.strings},this.React.createElement(this.VirtualizedTable,d)),m=this.window.document.getElementById(this.containerId);new Promise(x=>this.ReactDOM.render(g,m,x)).then(()=>{this.basicTool.getGlobal("setTimeout")(()=>{u()})}).then(i,l)}return this}};Bc.VirtualizedTableHelper=ap});var r2=me(zc=>{"use strict";Object.defineProperty(zc,"__esModule",{value:!0});zc.DialogHelper=void 0;var FE=Qn(),sp=class{constructor(r,i){if(r<=0||i<=0)throw Error("row and column must be positive integers.");this.elementProps={tag:"vbox",attributes:{flex:1},styles:{width:"100%",height:"100%"},children:[]};for(let l=0;l<Math.max(r,1);l++){this.elementProps.children.push({tag:"hbox",attributes:{flex:1},children:[]});for(let u=0;u<Math.max(i,1);u++)this.elementProps.children[l].children.push({tag:"vbox",attributes:{flex:1},children:[]})}this.elementProps.children.push({tag:"hbox",attributes:{flex:0,pack:"end"},children:[]}),this.dialogData={}}addCell(r,i,l,u=!0){if(r>=this.elementProps.children.length||i>=this.elementProps.children[r].children.length)throw Error(`Cell index (${r}, ${i}) is invalid, maximum (${this.elementProps.children.length}, ${this.elementProps.children[0].children.length})`);return this.elementProps.children[r].children[i].children=[l],this.elementProps.children[r].children[i].attributes.flex=u?1:0,this}addButton(r,i,l={}){return i=i||`${Zotero.Utilities.randomString()}-${new Date().getTime()}`,this.elementProps.children[this.elementProps.children.length-1].children.push({tag:"vbox",styles:{margin:"10px"},children:[{tag:"button",namespace:"html",id:i,attributes:{type:"button"},listeners:[{type:"click",listener:u=>{this.dialogData._lastButtonId=i,l.callback&&l.callback(u),l.noClose||this.window.close()}}],children:[{tag:"div",styles:{padding:"2.5px 15px"},properties:{innerHTML:r}}]}]}),this}setDialogData(r){return this.dialogData=r,this}open(r,i={centerscreen:!0,resizable:!0,fitContent:!0}){return this.window=BE(`${Zotero.Utilities.randomString()}-${new Date().getTime()}`,r,this.elementProps,this.dialogData,i),this}};zc.DialogHelper=sp;function BE(t,r,i,l,u={centerscreen:!0,resizable:!0,fitContent:!0}){var d,g;let m=new FE.UITool;m.basicOptions.ui.enableElementJSONLog=!1,m.basicOptions.ui.enableElementRecord=!1;let x=m.getGlobal("Zotero");l=l||{},l.loadLock||(l.loadLock=x.Promise.defer()),l.unloadLock||(l.unloadLock=x.Promise.defer());let v=`resizable=${u.resizable?"yes":"no"},`;(u.width||u.height)&&(v+=`width=${u.width||100},height=${u.height||100},`),u.left&&(v+=`left=${u.left},`),u.top&&(v+=`top=${u.top},`),u.centerscreen&&(v+="centerscreen,"),u.noDialogMode&&(v+="dialog=no,"),u.alwaysRaised&&(v+="alwaysRaised=yes,");let I=m.getGlobal("openDialog")("about:blank",t||"_blank",v,l);return l.loadLock.promise.then(()=>{I.document.head.appendChild(m.createElement(I.document,"title",{properties:{innerText:r}})),I.document.head.appendChild(m.createElement(I.document,"style",{properties:{innerHTML:zE}})),n2(i,m),I.document.body.appendChild(m.createElement(I.document,"fragment",{children:[i]})),Array.from(I.document.querySelectorAll("*[data-bind]")).forEach(S=>{let M=S.getAttribute("data-bind"),E=S.getAttribute("data-attr"),C=S.getAttribute("data-prop");M&&l&&l[M]&&(C?S[C]=l[M]:S.setAttribute(E||"value",l[M]))}),u.fitContent&&I.sizeToContent(),I.focus()}).then(()=>{l?.loadCallback&&l.loadCallback()}),l.unloadLock.promise.then(()=>{l?.unloadCallback&&l.unloadCallback()}),I.addEventListener("DOMContentLoaded",function S(M){var E,C;(C=(E=I.arguments[0])===null||E===void 0?void 0:E.loadLock)===null||C===void 0||C.resolve(),I.removeEventListener("DOMContentLoaded",S,!1)},!1),I.addEventListener("beforeunload",function S(M){Array.from(I.document.querySelectorAll("*[data-bind]")).forEach(E=>{let C=this.window.arguments[0],B=E.getAttribute("data-bind"),$=E.getAttribute("data-attr"),V=E.getAttribute("data-prop");B&&C&&(V?C[B]=E[V]:C[B]=E.getAttribute($||"value"))}),this.window.removeEventListener("beforeunload",S,!1),l?.beforeUnloadCallback&&l.beforeUnloadCallback()}),I.addEventListener("unload",function S(M){var E,C,B;!((E=this.window.arguments[0])===null||E===void 0)&&E.loadLock.promise.isPending()||((B=(C=this.window.arguments[0])===null||C===void 0?void 0:C.unloadLock)===null||B===void 0||B.resolve(),this.window.removeEventListener("unload",S,!1))}),I.document.readyState==="complete"&&((g=(d=I.arguments[0])===null||d===void 0?void 0:d.loadLock)===null||g===void 0||g.resolve()),I}function n2(t,r){var i,l,u,d,g,m,x;let v=!0;if(t.tag==="select"&&r.isZotero7()){v=!1;let I={tag:"div",classList:["dropdown"],listeners:[{type:"mouseleave",listener:S=>{let M=S.target.querySelector("select");M?.blur()}}],children:[Object.assign({},t,{tag:"select",listeners:[{type:"focus",listener:S=>{var M;let E=S.target,C=(M=E.parentElement)===null||M===void 0?void 0:M.querySelector(".dropdown-content");C&&(C.style.display="block"),E.setAttribute("focus","true")}},{type:"blur",listener:S=>{var M;let E=S.target,C=(M=E.parentElement)===null||M===void 0?void 0:M.querySelector(".dropdown-content");C&&(C.style.display="none"),E.removeAttribute("focus")}}]}),{tag:"div",classList:["dropdown-content"],children:(i=t.children)===null||i===void 0?void 0:i.map(S=>{var M,E,C;return{tag:"p",attributes:{value:(M=S.properties)===null||M===void 0?void 0:M.value},properties:{innerHTML:((E=S.properties)===null||E===void 0?void 0:E.innerHTML)||((C=S.properties)===null||C===void 0?void 0:C.innerText)},classList:["dropdown-item"],listeners:[{type:"click",listener:B=>{var $;let V=($=B.target.parentElement)===null||$===void 0?void 0:$.previousElementSibling;V&&(V.value=B.target.getAttribute("value")||""),V?.blur()}}]}})}]};for(let S in t)delete t[S];Object.assign(t,I)}else if(t.tag==="a"){let I=((l=t?.properties)===null||l===void 0?void 0:l.href)||"";(u=t.properties)!==null&&u!==void 0||(t.properties={}),t.properties.href="javascript:void(0);",(d=t.attributes)!==null&&d!==void 0||(t.attributes={}),t.attributes["zotero-href"]=I,(g=t.listeners)!==null&&g!==void 0||(t.listeners=[]),t.listeners.push({type:"click",listener:S=>{var M;let E=(M=S.target)===null||M===void 0?void 0:M.getAttribute("zotero-href");E&&r.getGlobal("Zotero").launchURL(E)}}),(m=t.classList)!==null&&m!==void 0||(t.classList=[]),t.classList.push("zotero-text-link")}v&&((x=t.children)===null||x===void 0||x.forEach(I=>n2(I,r)))}var zE=`
html,
body {
  font-size: calc(12px * 1);
}
.zotero-text-link {
  -moz-user-focus: normal;
  color: -moz-nativehyperlinktext;
  text-decoration: underline;
  border: 1px solid transparent;
  cursor: pointer;
}
.dropdown {
  position: relative;
  display: inline-block;
}
.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f9f9fb;
  min-width: 160px;
  box-shadow: 0px 0px 5px 0px rgba(0, 0, 0, 0.5);
  border-radius: 5px;
  padding: 5px 0 5px 0;
  z-index: 999;
}
.dropdown-item {
  margin: 0px;
  padding: 5px 10px 5px 10px;
}
.dropdown-item:hover {
  background-color: #efeff3;
}
`});var i2=me(lo=>{"use strict";var qE=lo&&lo.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(lo,"__esModule",{value:!0});lo.ReaderInstanceManager=void 0;var UE=Je(),ZE=qE(Yn()),lp=class extends UE.ManagerTool{constructor(r){super(r),this.cachedHookIds=[],this.initializeGlobal()}register(r,i,l){let u=this.getGlobal("Zotero");switch(r){case"initialized":this.globalCache.initializedHooks[i]=l,u.Reader._readers.forEach(l);break;default:break}this.cachedHookIds.push(i)}unregister(r){delete this.globalCache.initializedHooks[r]}unregisterAll(){this.cachedHookIds.forEach(r=>this.unregister(r))}initializeGlobal(){if(this.globalCache=ZE.default.getInstance().readerInstance,!this.globalCache._ready){this.globalCache._ready=!0;let r=this.getGlobal("Zotero"),i=this;r.Reader._readers=new(this.getGlobal("Proxy"))(r.Reader._readers,{set(l,u,d,g){return l[u]=d,isNaN(Number(u))||Object.values(i.globalCache.initializedHooks).forEach(m=>{try{m(d)}catch(x){i.log(x)}}),!0}})}}};lo.ReaderInstanceManager=lp});var o2=me(co=>{"use strict";var jE=co&&co.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(co,"__esModule",{value:!0});co.ItemBoxManager=void 0;var HE=Je(),$E=Ac(),VE=Nc(),WE=jE(Yn()),cp=class extends HE.ManagerTool{constructor(r){super(r),this.initializationLock=this.getGlobal("Zotero").Promise.defer(),this.localCache=[],this.fieldHooks=new $E.FieldHookManager,this.patcherManager=new VE.PatcherManager,this.initializeGlobal()}async register(r,i,l,u={}){this.fieldHooks.register("isFieldOfBase",r,()=>!1),l&&this.fieldHooks.register("getField",r,l),u.editable&&u.setFieldHook&&this.fieldHooks.register("setField",r,u.setFieldHook),this.globalCache.fieldOptions[r]={field:r,displayName:i,editable:u.editable||!1,index:u.index||-1,multiline:u.multiline||!1,collapsible:u.collapsible||!1},this.localCache.push(r),await this.initializationLock.promise,this.refresh()}unregister(r,i={}){delete this.globalCache.fieldOptions[r],i.skipIsFieldOfBase||this.fieldHooks.unregister("isFieldOfBase",r),i.skipGetField||this.fieldHooks.unregister("getField",r),i.skipSetField||this.fieldHooks.unregister("setField",r);let l=this.localCache.indexOf(r);l>-1&&this.localCache.splice(l,1),i.skipRefresh||this.refresh()}unregisterAll(){[...this.localCache].forEach(r=>this.unregister(r,{skipGetField:!0,skipSetField:!0,skipIsFieldOfBase:!0,skipRefresh:!0})),this.fieldHooks.unregisterAll(),this.refresh()}refresh(){try{Array.from(this.getGlobal("document").querySelectorAll(this.isZotero7()?"item-box":"zoteroitembox")).forEach(r=>r.refresh())}catch(r){this.log(r)}}async initializeGlobal(){let r=this.getGlobal("Zotero");await r.uiReadyPromise;let i=this.getGlobal("window"),l=this.globalCache=WE.default.getInstance().itemBox,u=this.isZotero7();if(!l._ready){l._ready=!0;let d;if(u)d=new(this.getGlobal("customElements").get("item-box"));else{d=i.document.querySelector("#zotero-editpane-item-box");let g=5e3,m=0;for(;!d&&m<g;)d=i.document.querySelector("#zotero-editpane-item-box"),await r.Promise.delay(10),m+=10;if(!d){l._ready=!1,this.log("ItemBox initialization failed");return}}this.patcherManager.register(d.__proto__,"refresh",g=>function(){let m=this;g.apply(m,arguments);for(let x of Object.values(l.fieldOptions)){let v=document.createElement(u?"th":"label");v.setAttribute("fieldname",x.field);let I=`extensions.zotero.pluginToolkit.fieldCollapsed.${x.field}`,S=x.multiline&&x.collapsible&&r.Prefs.get(I,!0),M=x.displayName;if(S&&(M=`(...)${M}`),u){let V=document.createElement("label");V.className="key",V.textContent=M,v.appendChild(V)}else v.setAttribute("value",M);let E=m.clickable;m.clickable=x.editable;let C=m.createValueElement(m.item.getField(x.field),x.field,1099);m.clickable=E,x.multiline&&!r.Prefs.get(I,!0)?C.classList.add("multiline"):u||(C.setAttribute("crop","end"),C.setAttribute("value",C.innerHTML),C.innerHTML=""),x.collapsible&&v.addEventListener("click",function(V){r.Prefs.set(I,!r.Prefs.get(I,!0),!0),m.refresh()}),v.addEventListener("click",u?function(V){var te;let R=(te=V.currentTarget.nextElementSibling)===null||te===void 0?void 0:te.querySelector("input, textarea");R&&R.blur()}:function(V){var te;let R=(te=V.currentTarget.nextElementSibling)===null||te===void 0?void 0:te.inputField;R&&R.blur()});let B=u?m._infoTable:m._dynamicFields,$=x.index;$===0&&($=1),$&&$>=0&&$<B.children.length?(m._beforeRow=B.children[$],m.addDynamicRow(v,C,!0)):m.addDynamicRow(v,C)}})}this.initializationLock.resolve()}};co.ItemBoxManager=cp});var s2=me(Ya=>{"use strict";Object.defineProperty(Ya,"__esModule",{value:!0});Ya.ZoteroToolkit=void 0;var a2=Je(),GE=Qn(),XE=Hd(),KE=Zv(),JE=Hv(),YE=$v(),QE=Vv(),e9=Wv(),t9=Gv(),n9=Xv(),r9=Jv(),i9=Yv(),o9=Qv(),a9=e2(),s9=t2(),l9=r2(),c9=i2(),u9=Ac(),f9=o2(),qc=class extends a2.BasicTool{constructor(){super(),this.UI=new GE.UITool(this),this.Reader=new XE.ReaderTool(this),this.ExtraField=new KE.ExtraFieldTool(this),this.FieldHooks=new u9.FieldHookManager(this),this.ItemTree=new JE.ItemTreeManager(this),this.ItemBox=new f9.ItemBoxManager(this),this.Prompt=new YE.PromptManager(this),this.LibraryTabPanel=new QE.LibraryTabPanelManager(this),this.ReaderTabPanel=new e9.ReaderTabPanelManager(this),this.ReaderInstance=new c9.ReaderInstanceManager(this),this.Menu=new t9.MenuManager(this),this.PreferencePane=new n9.PreferencePaneManager(this),this.Shortcut=new r9.ShortcutManager(this),this.Clipboard=i9.ClipboardHelper,this.FilePicker=o9.FilePickerHelper,this.ProgressWindow=a9.ProgressWindowHelper,this.VirtualizedTable=s9.VirtualizedTableHelper,this.Dialog=l9.DialogHelper}unregisterAll(){(0,a2.unregister)(this)}};Ya.ZoteroToolkit=qc;Ya.default=qc});var f2=Uy(Ul());var ve={addonName:"Crush Reference",addonID:"zoteroreference@polygon.org",addonRef:"zoteroreference",addonInstance:"ZoteroReference",releasepage:"https://github.com/muisedestiny/zotero-reference/releases/latest/download/zotero-reference.xpi",updaterdf:"https://raw.githubusercontent.com/muisedestiny/zotero-reference/bootstrap/update.json"};function Hy(){let t={pluginID:ve.addonID,src:rootURI+"chrome/content/preferences.xhtml",label:"Reference",image:`chrome://${ve.addonRef}/content/icons/favicon.png`};ztoolkit.PreferencePane.register(t)}function $y(t){addon.data.prefs?addon.data.prefs.window=t:addon.data.prefs={window:t};let r=addon.data.prefs.window.document}function Vy(){let t=new(typeof Localization>"u"?ztoolkit.getGlobal("Localization"):Localization)([`${ve.addonRef}-addon.ftl`],!0);addon.data.locale={current:t}}function jr(...t){if(t.length===1)return Ih(t[0]);if(t.length===2)return typeof t[1]=="string"?Ih(t[0],{branch:t[1]}):Ih(t[0],t[1]);throw new Error("Invalid arguments")}function Ih(t,r={}){let i=`${ve.addonRef}-${t}`,{branch:l,args:u}=r,d=addon.data.locale?.current.formatMessagesSync([{id:i,args:u}])[0];return d?l&&d.attributes?d.attributes[l]||i:d.value||i:i}var Hr=class{constructor(){this.cache={}}async get(r,i="json",l={}){let u=JSON.stringify(arguments);if(this.cache[u])return this.cache[u];let d=await Zotero.HTTP.request("GET",r,{responseType:i,headers:l,credentials:"include"});if(d.status==200)return this.cache[u]=d.response,d.response;ztoolkit.log(`get ${r} error`,d)}async post(r,i={},l="json"){let u=JSON.stringify(arguments);if(this.cache[u])return this.cache[u];let d=await Zotero.HTTP.request("POST",r,Object.assign({responseType:l},Object.keys(i).length>0?{headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}:{}));if(d.status==200)return this.cache[u]=d.response,d.response;ztoolkit.log(`post ${r} error`,d)}};var P5=Yw(),Gh=class{constructor(r){this.utils=r,this.requests=new Hr,this.Info={crossref:i=>{let l={"journal-article":"journalArticle",report:"report","posted-content":"preprint","book-chapter":"bookSection"},u=i.reference?.map(m=>{let x,v,I,S={};if(m.unstructured)I=m.unstructured,S=this.utils.refText2Info(I);else if(m["article-title"]&&m.year&&m.author)I=`${m.author} et al., ${m.year}, ${m["article-title"]}`;else{let E=[];for(let C in m)E.push(`${C}: ${m[C]}`);I=E.join("; ")}return m.DOI&&(x={DOI:m.DOI},v=this.utils.identifiers2URL(x)),{identifiers:x||S.identifiers||{},title:m["article-title"],authors:[m?.author],year:m.year,text:I,type:l[m.type]||"journalArticle",url:S?.url||v}}),d=i["is-referenced-by-count"];return{identifiers:{DOI:i.DOI},authors:i?.author?.map(m=>m.family),title:Array.isArray(i.title)?i.title[0]:i.title,year:i.published&&i.published["date-parts"][0][0],type:l[i.type]||"journalArticle",text:i.title[0],url:i.URL,abstract:i.abstract,publishDate:i.published&&i.published["date-parts"][0].join("-"),source:i.source.toLowerCase(),primaryVenue:i["container-title"]?i["container-title"][0]:[],references:u,tags:[...d&&d>0?[{text:d,color:"#2fb8cb",tip:"is-referenced-by-count"}]:[]]}},connectedpapers:i=>({identifiers:{DOI:i.doiInfo.doi},authors:i?.authors?.map(u=>u[0].name),title:i.title.text,year:i.year.text,type:"journalArticle",text:i.title.text,url:i.doiInfo.doiUrl,abstract:i.paperAbstract.text,source:"connectedpapers",primaryVenue:i.venue.text,references:[],tags:[{text:i.citationStats.numCitations,tip:"citationStats.numCitations",color:"rgba(53, 153, 154, 0.5)"},{text:i.citationStats.numReferences,tip:"citationStats.numReferences",color:"rgba(53, 153, 154, 0.75)"}]}),readpaper:i=>({identifiers:{},title:this.utils.Html2Text(i.title),year:i.year,publishDate:i.publishDate,authors:i?.authorList.map(u=>this.utils.Html2Text(u.name)),abstract:this.utils.Html2Text(i.summary),primaryVenue:this.utils.Html2Text(i.primaryVenue),tags:[...i.venueTags||[],...i.citationCount&&i.citationCount>0?[{text:i.citationCount,tip:"citationCount",color:"#1f71e0"}]:[]],source:"readpaper",type:"journalArticle"}),semanticscholar(i){return{identifiers:{DOI:i.DOI},title:i.title,authors:i.authors.map(u=>u.name),year:i.year,publishDate:i.publicationDate,abstract:i.abstract,source:"semanticscholar",type:"journalArticle",tags:i.fieldsOfStudy||[],primaryVenue:i.journal?.name,url:i.DOI?`http://doi.org/${i.DOI}`:void 0}},unpaywall(i){let l={"journal-article":"journalArticle",report:"report","posted-content":"preprint","book-chapter":"bookSection"};return{identifiers:{DOI:i.DOI},authors:i.z_authors.map(d=>d.family),title:i.title,year:i.year,type:l[i.genre],primaryVenue:i.journal_name,source:"unpaywall",publishDate:i.published_date,abstract:void 0}},arXiv:i=>({identifiers:{arXiv:i.arXiv},title:i.title[0].replace(/\n/g,""),year:i.year,authors:i.author.map(u=>u.name[0]),abstract:i.summary[0].replace(/\n/g,""),url:this.utils.identifiers2URL({arXiv:i.arXiv}),type:"preprint",tags:i.category.map(u=>u.$.term),publishDate:i.published&&i.published[0],primaryVenue:i["arxiv:comment"]&&i["arxiv:comment"][0]._.replace(/\n/g,"")})},this.BaseInfo={readcube:i=>{let l;i.doi&&this.utils.regex.arXiv.test(i.doi)&&(i.arxiv=i.doi.match(this.utils.regex.arXiv).slice(-1)[0],i.doi=void 0);let u="journalArticle";i.arxiv&&!i.doi?(l={arXiv:i.arxiv},u="preprint"):l={DOI:i.doi};let d=this.utils.identifiers2URL(l);return{identifiers:l,title:i.title,authors:i?.authors,year:i.year,type:u,text:i.title,url:d}}}}async getDOIBaseInfo(r){let i={semanticscholar:`https://api.semanticscholar.org/graph/v1/paper/${r}?fields=title,year,authors`,unpaywall:`https://api.unpaywall.org/v2/${r}?email=ZoteroReference@polygon.org`};for(let l in i){let u=await this.requests.get(i[l]);if(u)return u.DOI=r,this.Info[l](u)}}async getDOIInfoBySemanticscholar(r){let i=`https://api.semanticscholar.org/graph/v1/paper/${r}?fields=title,authors,abstract,year,journal,fieldsOfStudy,publicationVenue,publicationDate`,l=await this.requests.get(i);if(l){if(l.DOI=r,!l.abstract){let u=await this.requests.get(`https://www.semanticscholar.org/paper/${l.paperId}`,"text/html"),m=ztoolkit.getDOMParser().parseFromString(u,"text/html").head.querySelector("meta[name=description]")?.getAttribute("content");m?.startsWith("Semantic Scholar")||(l.abstract=m)}return this.Info.semanticscholar(l)}}async getDOIInfoByCrossref(r){let i=`https://api.crossref.org/works/${r}/transform/application/vnd.citationstyles.csl+json`,l=await this.requests.get(i);if(l)return l.DOI=r,this.Info.crossref(l)}async getDOIRelatedArray(r,i=20){let u=`https://www.semanticscholar.org/api/1/paper/${(await this.requests.get(`https://rest.connectedpapers.com/id_translator/doi/${r}`,"json",{"user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 e/107.0.0.0 Safari/537.36"})).paperId}/related-papers?limit=20&recommenderType=relatedPapers`,d=await this.requests.get(u,"json",{cookie:"aws-waf-token=fcf9f43b-d494-44a8-8806-da20c50d9457:AQoAaIgZ+Q0AAAAA:z/ZtlDV2Oz/Ymw+RFbJ0vnEAl1/wBKTH6I4/INUou3Qqkm00bibIWkYKq0w3qq4yxB2EtdBTtRT7Q2MBPjx17WmPmcVznf7mTMTwFQjmJOB2VgQeoBzsmuzVlI/l/NBlyTFdH8xEKYYWbXB8R5oK9o7JxolugTzDKvLX4Pc57cdkbCA5A6AIExi/Wm16"});if(ztoolkit.log(d),d)return d.papers.map(m=>{let x={title:m.title.text,identifiers:{},year:m.year.text,text:m.title.text,type:"journalArticle",authors:m.authors.map(v=>v[1].text),abstract:m.paperAbstract?.text||m?.paperAbstractTruncated};if(m.citationContexts?.length>0){let v=[];m.citationContexts.slice(0,1).forEach(I=>{try{v.push(`${I.intents.length>0?I.intents[0].id:"unknown"}: ${m.citationContexts[0].context.text}`)}catch{ztoolkit.log(I)}}),x.description=v.join(`
`)}return x})}async _getDOIRelatedArray(r,i=20){let u=`https://www.semanticscholar.org/api/1/search/paper/${(await this.requests.get(`https://rest.connectedpapers.com/id_translator/doi/${r}`,"json",{"user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 e/107.0.0.0 Safari/537.36"})).paperId}/citations`,d=await this.requests.post(u,{page:1,pageSize:20,sort:"relevance",authors:[],coAuthors:[],venues:[],yearFilter:null,requireViewablePdf:!1,fieldsOfStudy:[],useS2FosFields:!0});if(ztoolkit.log(d),d)return d.results.map(m=>{let x={title:m.title.text,identifiers:{},year:m.year,text:m.title.text,type:"journalArticle",authors:m.authors.map(v=>v[1].text)};if(m.citationContexts?.length>0){let v=[];m.citationContexts.slice(0,1).forEach(I=>{try{v.push(`${I.intents.length>0?I.intents[0].id:"unknown"}: ${m.citationContexts[0].context.text}`)}catch{ztoolkit.log(I)}}),x.description=v.join(`
`)}return x})}async getArXivInfo(r){let i=`https://export.arxiv.org/api/query?id_list=${r}`,l=await this.requests.get(i,"application/xhtml+xml");if(l){let u=(await P5.parseStringPromise(l))?.feed?.entry[0];if(u)return u.arXiv=r,this.Info.arXiv(u)}}async getTitleInfoByCrossref(r){let i=`https://api.crossref.org/works?query=${r}`,l=await this.requests.get(i);if(l){let u=["component"],d=l.message.items.filter(m=>u.indexOf(m.type)==-1)[0];return this.Info.crossref(d)}}async getTitleInfoByConnectedpapers(r){let i=r;if(this.utils.isDOI(r)){let d=r;i=(await this.requests.get(`https://rest.connectedpapers.com/id_translator/doi/${d}`)).title}let l=`https://rest.connectedpapers.com/search/${escape(i)}/1`,u=await this.requests.post(l);if(u&&u?.results?.length){let d=u.results[0];return this.Info.connectedpapers(d)}}async getTitleInfoByReadpaper(r,i={},l=void 0){let u="https://readpaper.com/api/microService-app-aiKnowledge/aiKnowledge/paper/search";i={...{keywords:r,page:1,pageSize:1,searchType:+(Object.values(i).length>0)},...i};let g=await this.requests.post(u,i);if(g&&g?.data?.list?.[0]){let m=g?.data?.list?.[0];if(l){let v=await this.requests.post("https://readpaper.com/api/microService-app-aiKnowledge/aiKnowledge/paper/getPaperDetailInfo",{paperId:m.id});if(ztoolkit.log(l,v.data.doi),v.data.doi.toUpperCase()!=l.toUpperCase())return}let x=this.Info.readpaper(m);return l&&(x.identifiers={DOI:l}),x}}async _getCNKIURL(r,i){ztoolkit.log("getCNKIURL",r,i);let l,u=Zotero.Jasminum.Scrape.getItemFromSearch;if(ztoolkit.patch(Zotero.Jasminum.Scrape,"createPostData",ve.addonRef,g=>m=>{let x=g.call(Zotero.Jasminum.Scrape,m);return ztoolkit.log(x),x=escape(unescape(x).replace(/SCDB/g,"CFLS")),ztoolkit.log(x),x}),Zotero.Jasminum.Scrape.getItemFromSearch=function(g){try{let m=g.match(/href='(.+FileName=.+?&DbName=.+?)'/i);if(m.length)return m[1]}catch{return}}.bind(Zotero.Jasminum),l=await Zotero.Jasminum.Scrape.search({keyword:r}),Zotero.Jasminum.Scrape.getItemFromSearch=u.bind(Zotero.Jasminum),!l){ztoolkit.log("cnkiURL",l);return}let d=this.utils.parseCNKIURL(l);if(d)return l=`https://kns.cnki.net/kcms/detail/detail.aspx?FileName=${d.fileName}&DbName=${d.dbName}&DbCode=${d.dbCode}`,l}async getCNKIURL(r,i=!1){i||new ztoolkit.ProgressWindow("[Pending] API",{closeOtherProgressWindows:!0}).createLine({text:"Get CNKI URL",type:"default"}).show();let l=await Zotero.HTTP.request("POST","https://kns.cnki.net/kns8/Brief/GetGridTableHtml",{headers:{Accept:"text/html, */*; q=0.01","Accept-Encoding":"gzip, deflate, br","Accept-Language":"zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7",Connection:"keep-alive","Content-Length":"2085","Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Host:"kns.cnki.net",Origin:"https://kns.cnki.net",Referer:"https://kns.cnki.net/kns8/AdvSearch?dbprefix=SCDB&&crossDbcodes=CJFQ%2CCDMD%2CCIPD%2CCCND%2CCISD%2CSNAD%2CBDZK%2CCJFN%2CCCJD","Sec-Fetch-Dest":"empty","Sec-Fetch-Mode":"cors","Sec-Fetch-Site":"same-origin","X-Requested-With":"XMLHttpRequest"},body:`IsSearch=true&QueryJson={"Platform":"","DBCode":"CFLS","KuaKuCode":"CJFQ,CDMD,CIPD,CCND,CISD,SNAD,BDZK,CCJD,CCVD,CJFN","QNode":{"QGroup":[{"Key":"Subject","Title":"","Logic":1,"Items":[{"Title":"\u4E3B\u9898","Name":"SU","Value":"${r}","Operate":"%=","BlurType":""}],"ChildItems":[]}]},"CodeLang":"ch"}&PageName=defaultresult&DBCode=CFLS&CurPage=1&RecordsCntPerPage=20&CurDisplayMode=listmode&CurrSortField=&CurrSortFieldType=desc&IsSentenceSearch=false&Subject=`});try{if(l){let u=l.responseText.match(/href='(.+FileName=.+?&DbName=.+?)'/i);if(u){let d=this.utils.parseCNKIURL(u[1]);if(d)return u=`https://kns.cnki.net/kcms/detail/detail.aspx?FileName=${d.fileName}&DbName=${d.dbName}&DbCode=${d.dbCode}`,u}}}catch{}i||new ztoolkit.ProgressWindow("[Pending] API",{closeOtherProgressWindows:!0}).createLine({text:"Get CNKI URL Fail",type:"fail"}).show()}async getTitleInfoByCNKI(r){if(!this.utils.isChinese(r))return;let i=this.utils.parseRefText(r),l=`${i.title}${i.authors}${r}`;if(this.requests.cache[l])return this.requests.cache[l];ztoolkit.log("parseRefText",r,i);let u=await this.getCNKIURL(i.title,!0);if(!u)return;let d=await this.requests.get(u,"text");ztoolkit.log(u,d);let m=ztoolkit.getDOMParser().parseFromString(d,"text/html").childNodes[1],x=m.querySelectorAll(".top-tip span a"),v={identifiers:{CNKI:u},title:m.querySelector(".brief h1").innerText,abstract:m.querySelector("span#ChDivSummary").innerText,authors:[...m.querySelectorAll("#authorpart span a")].map(I=>I.innerText),type:"journalArticle",primaryVenue:x[0].innerText,year:x[1].innerText.split(",")[0],url:u,source:"CNKI",tags:[...m.querySelectorAll(".keywords a")].map(I=>I.innerText.replace(/(\n|\s+|;)/g,"")).concat([{text:[...m.querySelectorAll("p.total-inform span")].find(I=>I.innerText.includes("\u4E0B\u8F7D")).innerText.match(/\d+/)[0],color:"#cc7c08",tip:"\u77E5\u7F51\u4E0B\u8F7D\u91CF"}])};return this.requests.cache[l]=v,v}async getCNKIFileInfo(r,i=0){let l=`${ve.addonRef}.CNKI.token`,u=Zotero.Prefs.get(`${ve.addonRef}.CNKI.username`),d=Zotero.Prefs.get(`${ve.addonRef}.CNKI.password`);u.length*d.length==0&&new ztoolkit.ProgressWindow("[Fail] API",{closeOtherProgressWindows:!0}).createLine({text:"\u8BF7\u914D\u7F6E\u77E5\u7F51\u7814\u5B66\u8D26\u53F7\u5BC6\u7801\u540E\u91CD\u8BD5",type:"fail"}).show();let g=async()=>{function B(){let te="";for(var R=0;R<4;R++)R<3?te=te+String(Math.floor(Math.random()*256))+".":te=te+String(Math.floor(Math.random()*256));return te}let V=(await this.requests.post("https://apix.cnki.net/databusapi/api/v1.0/credential/namepasswithcleartext/personalaccount",{Username:u,Password:d,Clientip:B()})).Content;Zotero.Prefs.set(l,V)},m=`https://x.cnki.net/readApi/api/v1/paperInfo?fileName=${r}&tableName=CJFDTOTAL&dbCode=CJFD&from=ReadingHistory&type=psmc&fsType=1&taskId=0`,x=`https://x.cnki.net/readApi/api/v1/paperRefreNotes?appId=CRSP_BASIC_PSMC&dbcode=CJFD&tablename=CJFDTOTAL&filename=${r}&type=1&page=1`,v="user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/107.0.0.0 Safari/537.36",I=Zotero.Prefs.get(l),S=await this.requests.get(m,"json",{token:I,"user-agent":v}),M=await this.requests.get(x,"json",{token:I,"user-agent":v});if(ztoolkit.log(M),String(M.code)!="200"){if(i<3)return await g(),await this.getCNKIFileInfo(r,i+1);new ztoolkit.ProgressWindow("[Fail] API",{closeOtherProgressWindows:!0}).createLine({text:`${M.code}: ${M.promptMessage}`,type:"fail"}).show();return}let E={identifiers:{},authors:[],type:"",references:[],title:""},C={journal:"journalArticle"};return String(S.code)=="200"?S.content.paper.bibliography.forEach(B=>{let $=M.content.refer.find(te=>B.title.indexOf(te.title)!=-1),V=B.title.replace(/^\[\d+\]/,"");if($){let te=`https://kns.cnki.net/kcms/detail/detail.aspx?FileName=${$.fileName}&DbName=${$.tableName}&DbCode=${$.dbSource.split("_")[0]}`;E.references?.push({identifiers:{CNKI:te},text:V,title:$.title,authors:[],type:C[$.type]||"journalArticle",url:te})}else E.references?.push({identifiers:{},text:V,authors:[],type:"journalArticle",title:V})}):M.content.refer.sort((B,$)=>Number(B.citationNumber)-Number($.citationNumber)).forEach(B=>{let $=B.title.replace(/^\[\d+\]/,""),V=`https://kns.cnki.net/kcms/detail/detail.aspx?FileName=${B.fileName}&DbName=${B.tableName}&DbCode=${B.dbSource.split("_")[0]}`;E.references?.push({identifiers:{CNKI:V},authors:B.author.split(";").filter(te=>te.length),type:C[B.type]||"journalArticle",text:`${B.author}. ${$}[${B.type[0]}]. ${B.source}, ${B.year}, ${B.volumn}:${B.pageNumber}.`,title:B.title,year:B.year,url:V,number:Number(B.citationNumber)})}),E}},Qw=Gh;var Xh=class{constructor(r){this.utils=r||new Ui,this.refRegex=[[/^\(\d+\)\s?/],[/^\[\d{0,3}\].+?[\,\.\uff0c\uff0e]?/],[/^\uff3b\d{0,3}\uff3d.+?[\,\.\uff0c\uff0e]?/],[/^\d+[\,\.\uff0c\uff0e]/],[/^\d+[^\d\w]+?[\,\.\uff0c\uff0e]?/],[/^\[.+?\].+?[\,\.\uff0c\uff0e]?/],[/^\d+\s+/],[/^[A-Z]\w.+?\(\d+[a-z]?\)/,/^[A-Z][A-Za-z]+[\,\.\uff0c\uff0e]?/,/^.+?,.+.,/,/^[\u4e00-\u9fa5]{1,4}[\,\.\uff0c\uff0e]?/]]}async getReferences(r,i){let l=await this.getRefLines(r,i),u=r._iframeWindow.wrappedJSObject.PDFViewerApplication.pdfViewer._pages[0].viewport.viewBox[3];if(Zotero.ProgressWindowSet.closeAll(),l.length==0)return new ztoolkit.ProgressWindow("[Fail] PDF").createLine({text:"Function getRefLines: 0 refLines",type:"fail"}).show(),[];let d=this.mergeSameRef(l);d.length>0?new ztoolkit.ProgressWindow("[Done] PDF").createLine({text:`${d.length} references`,type:"success"}).show():new ztoolkit.ProgressWindow("[Fail] PDF").createLine({text:"Function mergeSameRef: 0 reference",type:"fail"}).show(),ztoolkit.log("references",d);for(let g=0;g<d.length;g++){let m={...d[g]};m.text=m.text.trim().replace(/^[^0-9a-zA-Z]\s*\d+\s*[^0-9a-zA-Z]/,"").replace(/^\d+[\.\s]?/,"").trim(),d[g]={text:m.text,...this.utils.refText2Info(m.text),x:m._x,y:m.y+m.height},d[g].url=m.url||d[g].url}return d}mergeSameLine(r){let i=d=>{let g={x:parseFloat(d.transform[4].toFixed(1)),y:parseFloat(d.transform[5].toFixed(1)),text:d.str||"",height:d.height,width:d.width,url:d?.url,_height:[d.height]};return g.width<0&&(g.x+=g.width,g.width=-g.width),g},l=0,u=[i(r[l])];for(l=1;l<r.length;l++){let d=i(r[l]),g=u.slice(-1)[0];if(d.y==g.y||d.y>=g.y&&d.y<g.y+g.height||d.y+d.height>g.y&&d.y+d.height<=g.y+g.height)g.text+=" "+d.text,g.width+=d.width,g.url=g.url||d.url,g._height.push(d.height);else{let m=g._height,x={};for(let v=0;v<m.length;v++)x[String(m[v])]??=0,x[String(m[v])]+=1;g.height=Number(Object.keys(x).sort((v,I)=>x[I]-x[v])[0]),u.push(d)}}return u}getRefType(r){for(let i=0;i<this.refRegex.length;i++)if(new Set(this.refRegex[i].map(u=>u.test(r.trim())||u.test(r.replace(/\s+/g,"")))).has(!0))return ztoolkit.log(r,i),i;return-1}mergeSameRef(r){let i=[...r];ztoolkit.log(this.copy(i));let l=r[0],u=l.x,d=r.slice(1).find(v=>v.x!=u&&this.abs(v.x-u)<10*l.height);ztoolkit.log(d);let g=d?u-d.x:0;ztoolkit.log("indent",g);let m=this.getRefType(l.text);ztoolkit.log(l.text,m);let x;for(let v=0;v<r.length;v++){let I=r[v],S=I.text,M=this.getRefType(S);if(M==m&&m<=2||g==0&&M!=-1&&M==m&&this.abs(u-I.x)<(this.abs(g)||I.height)*.5||g!=0&&M==m&&i.find(E=>I!=E&&(I.x-E.x)*g>0&&this.abs(I.x-E.x)>=this.abs(g)&&this.abs(this.abs(I.x-E.x)-this.abs(g))<2*I.height)!==void 0)x=I,ztoolkit.log("->",I.text);else if(x){if(x&&v/r.length>.9&&this.abs(this.abs(x.x-I.x)-this.abs(g))>5*I.height){r=r.slice(0,v),ztoolkit.log("x",I.text,this.abs(this.abs(x.x-I.x)-this.abs(g)),5*I.height);break}ztoolkit.log("+",S),x.text=x.text.replace(/-$/,"")+(x.text.endsWith("-")?"":" ")+S,I.url&&(x.url=I.url),r[v]=!1}}return r.filter(v=>v)}isIntersect(r,i){return!(i.right<r.left||i.left>r.right||i.bottom>r.top||i.top<r.bottom)}updateItemsAnnotions(r,i){let l=u=>{let[d,g,m,x]=u;return{left:d,bottom:g,right:m,top:x}};i.forEach(u=>{let d=l(u.rect);r.forEach(g=>{let[m,x]=g.transform.slice(4),v=l([m,x,m+g.width,x+g.height]);this.isIntersect(d,v)&&(g.url=u?.url||u?.unsafeUrl)})})}async readPdfPage(r){let l=(await r.getTextContent()).items.filter(g=>g.str.trim().length);if(l.length==0)return[];let u=await r.getAnnotations();return ztoolkit.log("items",this.copy(l)),this.updateItemsAnnotions(l,u),this.mergeSameLine(l)}async getRefLines(r,i,l=!1){let u=r._iframeWindow.wrappedJSObject.PDFViewerApplication;await u.pdfLoadingTask.promise,await u.pdfViewer.pagesPromise;let d=u.pdfViewer._pages,g={},m,x,v=0;i&&(v=d.length-u.page);let I=d.length-v,S=parseInt(Zotero.Prefs.get(`${ve.addonRef}.preLoadingPageNum`)),M=I>S?S:I,E=new ztoolkit.ProgressWindow("[Pending] PDF",{closeTime:-1});E.createLine({text:`[0/${M}] Analysis PDF`,type:"success",progress:1}).show();for(let R=I-1;R>=I-M;R--){let D=d[R].pdfPage;m=D._pageInfo.view[2],x=D._pageInfo.view[3];let A=await this.readPdfPage(D);if(A.length==0)continue;g[R]=A;let Z=(I-R)/M*100;E.changeLine({text:`[${I-R}/${M}] Read text`,progress:Z>90?90:Z})}let C=[],B=[],$=[],V={done:!1,parts:[]},te=`

===current page===

`;for(let R=I-1;R>=1;R--){ztoolkit.log(te,R+1);let D=d[R].pdfPage;m=D._pageInfo.view[2],x=D._pageInfo.view[3],ztoolkit.log(`maxWidth=${m}, maxHeight=${x}`);let A;if(R in g)A=[...g[R]];else{A=await this.readPdfPage(D),g[R]=[...A];let ge=I-R;E.changeLine({text:`[${ge}/${ge}] Read PDF`})}if(A.length==0)continue;let Z=new Set,X=ge=>(/^[A-Z]{1,3}$/.test(ge)&&(ge=""),ge=ge.replace(/\s+/g,"").replace(/\d+/g,""),ge),H=(ge,ye)=>{let Oe={left:ge.x/m,right:(ge.x+ge.width)/m,bottom:ge.y/x,top:(ge.y+ge.height)/x},Ze={left:ye.x/m,right:(ye.x+ye.width)/m,bottom:ye.y/x,top:(ye.y+ye.height)/x};return this.isIntersect(Oe,Ze)},J=(ge,ye)=>{let Oe=X(ge.text),Ze=X(ye.text);return Oe==Ze&&H(ge,ye)};for(let ge of Object.keys(g)){if(Number(ge)==R)continue;let ye=g[ge],Oe={forward:{factor:1,done:!1},backward:{factor:-1,done:!1}};for(let Ge=0;Ge<A.length&&Ge<ye.length;Ge++)["forward","backward"].forEach(rt=>{if(Oe[rt].done)return;let fn=Oe[rt].factor,j=fn*Ge+(fn>0?0:-1),O=A.slice(j)[0],fe=ye.slice(j)[0];J(O,fe)?(O[rt]=!0,Z.add(O)):Oe[rt].done=!0});let Ze={x:.2*m,width:.6*m,y:.2*x,height:.6*x};for(let Ge=0;Ge<A.length;Ge++){let rt=A[Ge];if(!H(Ze,rt))for(let fn=0;fn<ye.length;fn++){let j=ye[fn];J(rt,j)&&(rt.repeat=rt.repeat==null?1:rt.repeat+1,rt.repateWith=j,Z.add(rt))}}}if(A=A.filter(ge=>!(ge.forward||ge.backward||ge.repeat&&ge.repeat>M/2)),A.length==0)continue;ztoolkit.log("remove",[...Z]);let U=ge=>{ge=ge.replace(/\s+/g,"");let ye=/^(Table|Fig|Figure).*\d/i.test(ge);return ye&&ztoolkit.log(`isFigureOrTable - skip - ${ge}`),ye};A=A.filter(ge=>U(ge.text)==!1);let K=[[A[0]]];for(let ge=1;ge<A.length;ge++){let ye=A[ge],Oe=K.slice(-1)[0];ye.y>Oe.slice(-1)[0].y||Oe.map(Ze=>+(ye.x>Ze.x+Ze.width)).reduce((Ze,Ge)=>Ze+Ge)==Oe.length||Oe.map(Ze=>+(ye.x+ye.width<Ze.x)).reduce((Ze,Ge)=>Ze+Ge)==Oe.length?K.push([ye]):Oe.push(ye)}ztoolkit.log("columns",this.copy(K)),K.forEach((ge,ye)=>{ge.forEach(Oe=>{Oe.column=ye,Oe.pageNum=R})}),ztoolkit.log("remove indent",this.copy(A));let se=!1,de=ge=>{ge.reverse();let ye=[[ge[0]]];for(let Oe=1;Oe<ge.length;Oe++){let Ze=ge[Oe];Ze.column==ye.slice(-1)[0].slice(-1)[0].column&&Ze.pageNum==ye.slice(-1)[0].slice(-1)[0].pageNum?ye.slice(-1)[0].push(Ze):ye.push([Ze])}return ye.forEach(Oe=>{let Ze=Oe.map(Ge=>Ge.x).sort((Ge,rt)=>Ge-rt)[0];Oe.forEach(Ge=>{Ge._x=Ge.x,Ge._offset=Ze,Ge.x=parseInt((Ge.x-Ze).toFixed(1))})}),C.push(ge),ge},_e=ge=>(ge=ge.replace(/\s+/g,""),l?!1:/(\u53c2\u8003\u6587\u732e|reference|bibliography|)/i.test(ge)&&ge.length<20),Ce=ge=>{ge=de(ge),V.parts.push(ge),ztoolkit.log("doneRefPart",ge[0].text);let ye=ge[0].text.trim().match(/^\d+/);ye&&ye[0]!="1"?V.done=!1:V.done=!0},we=A.filter(ge=>A.every(ye=>ye==ge?!0:ye.x+ye.width<ge.x+ge.width||ye.y>ge.y)),Ue=(ge,ye)=>ge.some(Oe=>ye.some(Ze=>Oe-Ze<(Oe>Ze?Ze:Oe)*.3)),Ae=we.slice(-1)[0];ztoolkit.log("endLine",Ae);for(let ge=A.length-1;ge>=0;ge--){let ye=A[ge];if(!se&&(ye!=Ae||/(图|fig|Fig|Figure).*\d+/.test(ye.text.replace(/\s+/g,"")))){ztoolkit.log("Not the endLine, skip",ye.text),B.length&&R==I-1&&(de(B),B=[]);continue}else se=!0;if(B.length>0&&!Ue(B.slice(-1)[0]._height,ye._height)){de(B),B=[ye];continue}if(_e(ye.text)){ztoolkit.log("isRefBreak",ye.text),Ce(B),B=[];break}if(B.push(ye),A[ge-1]&&(!Ue(ye._height,A[ge-1]._height)||A[ge].column<A[ge-1].column||ye.pageNum==A[ge-1].pageNum&&ye.column==A[ge-1].column&&this.abs(ye.y-A[ge-1].y)>ye.height*3)){if(_e(A[ge-1].text)){ztoolkit.log("isRefBreak",A[ge-1].text),Ce(B),B=[];break}de(B),B=[],ztoolkit.log("break",ye.text," - ",A[ge-1].text,this.copy(ye),this.copy(A[ge-1]))}}if(V.done){ztoolkit.log(V),V.parts.reverse().forEach(ge=>{$=[...$,...ge]});break}}if(E.changeLine({progress:100}),ztoolkit.log("parts",this.copy(C)),ztoolkit.log($),$.length==0){let R=[];for(let A=0;A<C.length;A++){let Z=C[A].map(X=>+(this.getRefType(X.text)!=-1));R.push([A,Z.reduce((X,H)=>X+H)])}ztoolkit.log(R);let D=R.sort((A,Z)=>Z[1]-A[1])[0][0];$=C[D]}return ztoolkit.log("refPart",this.copy($)),E.changeHeadline("[Done] PDF"),E.changeLine({progress:100}),E.startCloseTimer(3e3),l?C:$}copy(r){try{return JSON.parse(JSON.stringify(r))}catch(i){ztoolkit.log("Error copy",i,r)}}abs(r){return r>0?r:-r}},e_=Xh;var Kh=class{constructor(){this.cache={};this.regex={DOI:/10\.\d{4,9}\/[-\._;\(\)\/:A-z0-9><]+[^\.\]]/,arXiv:/arXiv[\.:](\d+\.\d+)/,URL:/https?:\/\/[^\s\.]+/};this.copyText=(r,i=!0)=>{new ztoolkit.Clipboard().addText(r,"text/unicode").copy(),i&&new ztoolkit.ProgressWindow("Copy").createLine({text:r,type:"success"}).show()};this.API=new Qw(this),this.PDF=new e_(this)}getIdentifiers(r){let i=[{key:"DOI",ignoreSpace:!0,regex:this.regex.DOI},{key:"arXiv",ignoreSpace:!0,regex:this.regex.arXiv}],l={};for(let u of i){let d=(u.ignoreSpace?r.replace(/\s+/g,""):r).match(u.regex);d&&(l[u.key]=d.slice(-1)[0])}return l}extractURL(r){let i=r.match(this.regex.URL);if(i)return i.slice(-1)[0]}parseRefText(r){try{r=r.replace(/^\[\d+?\]/,""),r=r.replace(/\s+/g," ");let i,l;/\u201c(.+)\u201d/.test(r)?([l,i]=r.match(/\u201c(.+)\u201d/),i.endsWith(",")&&(i=i.slice(0,-1))):(i=l=(r.indexOf(". ")!=-1&&r.match(/\.\s/g).length>=2&&r.split(". ")||r.split(".")).sort((I,S)=>S.length-I.length).map(I=>{let S=0;return[/[A-Z]\./g,/[,\.\-\(\)\:]/g,/\d/g].forEach(M=>{let E=I.match(M);S+=E?E.length:0}),[S/I.length,I]}).filter(I=>I[1].match(/\s+/g)?.length>=3).sort((I,S)=>I[0]-S[0])[0][1],/\[[A-Z]\]$/.test(i)&&(i=i.replace(/\[[A-Z]\]$/,""))),i=i.trim();let u=r.split(l),d=u[0].trim(),g=u[1].match(/[^.\s].+[^\.]/)[0].split(/[,\d]/)[0].trim();d.indexOf("et al.")!=-1&&(d=d.split("et al.")[0]+"et al.");let m=new Date().getFullYear(),v=r.match(/[^\d]\d{4}[^\d-]/g)?.map(I=>I.match(/\d+/)[0])?.find(I=>Number(I)<=Number(m)+1);return d=d.replace(`${v}.`,"").replace(v,"").trim(),{year:v,title:i,authors:[d],publicationVenue:g}}catch{return{title:r}}}_parseRefText(r){let i,l=r.match(/[^\d]?(\d{4})[^\d]?/g);if(l){let u=l.map(d=>Number(d.match(/\d{4}/)[0])).filter(d=>d>1900&&d<new Date().getFullYear());u.length>0&&(i=String(u[0]))}if(i=i,this.isChinese(r)){let u=r.replace(/\[.+?\]/g,"").replace(/\s+/g," ").split(/[\.,\uff0c\uff0e\uff3b\[\]]/).map(x=>x.trim()).filter(x=>x),d=[],g=[];for(let x of u)x.length<=3&&x.length>=2?d.push(x):g.push(x);return{title:g.sort((x,v)=>v.length-x.length)[0],authors:d,year:i}}else{let u=[];return r=r.replace(/[\u4e00-\u9fa5]/g,""),[/[A-Za-z,\.\s]+?\.?[\.,;]/g,/[A-Z][a-z]+ et al.,/].forEach(m=>{r.match(m)?.forEach(x=>{u.push(x.slice(0,-1))})}),{title:r.split(/[,\.]\s/g).filter(m=>!m.includes("http")).sort((m,x)=>x.length-m.length)[0],authors:u,year:i}}}identifiers2URL(r){let i;return r.DOI&&(i=`https://doi.org/${r.DOI}`),r.arXiv&&(i=`https://arxiv.org/abs/${r.arXiv}`),i}refText2Info(r){let i=this.getIdentifiers(r);return{identifiers:i,url:this.extractURL(r)||this.identifiers2URL(i),authors:[],...this.parseRefText(r),type:i.arXiv?"preprint":"journalArticle"}}parseCNKIURL(r){try{let i=r.match(/fileName=(\w+)/i)[1],l=r.match(/dbName=(\w+)/i)[1],u=r.match(/dbCode=(\w+)/i)[1];return{fileName:i,dbName:l,dbCode:u}}catch{}}async createItemByZotero(r,i){var l=new Zotero.Translate.Search;l.setIdentifier(r);let u=await l.getTranslators();l.setTranslator(u);let d=ZoteroPane.getSelectedLibraryID();return(await l.translate({libraryID:d,collections:i,saveAttachments:!0}))[0]}async createItemByJasminum(r){let i=await this.API.getCNKIURL(r,!0);ztoolkit.log("cnkiURL",i);let l=Zotero.Jasminum.Scrape.getIDFromURL(i),u=Zotero.Jasminum.Scrape.createRefPostData([l]),d=await Zotero.Jasminum.Scrape.getRefText(u),g=await Zotero.Jasminum.Utils.trans2Items(d,1);if(g){let m=g[0];return m.setField("url",i),await m.saveTx(),m}}searchRelatedItem(r,i){if(!r)return;let l=r.relatedItems.map(u=>Zotero.Items.getByLibraryAndKey(1,u));if(i)return l.find(d=>i.id==d.id)}async searchItem(r){if(!r)return;let i=new Zotero.Search;i.addCondition("joinMode","any"),r.identifiers.DOI?(i.addCondition("DOI","is",r.identifiers.DOI),i.addCondition("DOI","is",r.identifiers.DOI.toLowerCase()),i.addCondition("DOI","is",r.identifiers.DOI.toUpperCase())):(r.title&&r.title?.length>8&&i.addCondition("title","contains",r.title),i.addCondition("url","contains",r.identifiers.arXiv),i.addCondition("url","contains",r.identifiers.CNKI));var l=await i.search();let u=(await Zotero.Items.getAsync(l)).filter(d=>!d.itemType.startsWith("attachment")&&d.isRegularItem&&d.isRegularItem());if(u.length)return u[0]}async searchLibraryItem(r){await Zotero.Promise.delay(0);let i=JSON.stringify(r.identifiers)+r.text+"library-item";if(i in this.cache)return r._item=this.cache[i],this.cache[i];{let l=await Zotero.Items.getAll(1),u=g=>this.cache["getPureText"+g]??=g.toLowerCase().match(/[0-9a-z\u4e00-\u9fa5]+/g)?.join(""),d=await this.searchItem(r)||l.filter(g=>g.isRegularItem()&&g.getField("title")&&["journalArtical","preprint","book"].indexOf(g.itemType)!=-1).find(g=>{try{let m=g.getField("title");if(!this.isChinese(m)&&m.split(" ").length<4)return!1;m=u(m);let x=u(r.title||r.text);if(x.length>10&&m&&x&&(m?.indexOf(x)!=-1||x?.indexOf(m)!=-1))return g}catch{}});if(d){r._item=d,this.cache[i]=d,r.title=d.getField("title");let g=d.getField("DOI");g&&(r.identifiers={DOI:g})}return d}}selectItemInLibrary(r){Zotero_Tabs.select("zotero-pane"),ZoteroPane.selectItem(r.id)}getItemType(r){if(r)return Zotero.ItemTypes.getName(r.getField("itemTypeID"))}isChinese(r){return r=r.replace(/\s+/g,""),(r.match(/[\u4E00-\u9FA5]/g)?.length||0)/r.length>.5}isDOI(r){if(!r)return!1;let i=r.match(this.regex.DOI);return i?i[0]==r&&!/(cnki|issn)/i.test(r):!1}matchArXiv(r){let i=r.match(this.regex.arXiv);return i!=null&&i.length>=2?i[1]:!1}Html2Text(r){if(!r)return"";let i;try{let l=document.createElement("span");l.innerHTML=r,i=l.innerText||l.textContent,l=null}catch{i=r}return i&&(i=i.replace(/<([\w:]+?)>([\s\S]+?)<\/\1>/g,(l,u,d)=>d).replace(/\n+/g,"")),i}getReader(){return Zotero.Reader.getByTabID(Zotero_Tabs.selectedID)}getItem(){let r=this.getReader();if(r)return r._item.parentItem}abs(r){return r>0?r:-r}},Ui=Kh;var Da=class{constructor(){this.option={size:8,color:{active:"#FF597B",default:"#F9B5D0"}};this.shadeMillisecond=parseInt(Zotero.Prefs.get(`${ve.addonRef}.shadeMillisecond`)),this.removeTipAfterMillisecond=parseInt(Zotero.Prefs.get(`${ve.addonRef}.removeTipAfterMillisecond`)),this.utils=new Ui}onInit(r,i){this.refRect=r,this.position=i,this.clear(),this.buildContainer()}clear(){document.querySelectorAll(".zotero-reference-tip-container").forEach(r=>{r.style.opacity="0",window.setTimeout(()=>{r.remove()},this.shadeMillisecond)})}place(){let r=x=>{for(let v in x)this.container.style[v]=x[v];return this.container.getBoundingClientRect()},i=document.documentElement.getBoundingClientRect(),l=i.width,u=i.height,d=this.refRect,g;if(this.position=="left")g={right:`${l-d.x}px`,bottom:"",top:`${d.y}px`,width:`${d.x*.7}px`};else if(this.position=="top center"){let x=l*.7;g={width:`${x}px`,left:`${d.x+d.width/2-x/2}px`,bottom:`${u-d.y}px`,top:""},this.container.style.flexDirection="column-reverse"}let m=r(g);m.bottom>u&&(r({top:"",bottom:"0px"}),this.container.style.flexDirection="column-reverse"),m.top<0&&r({bottom:"",top:"0px"}),m.left<30&&r({right:"",left:"30px"}),l-m.right<30&&r({left:"",right:"30px"}),this.container.style.opacity="1"}buildContainer(){this.container=ztoolkit.UI.createElement(document,"div",{namespace:"html",classList:["zotero-reference-tip-container"],styles:{display:"flex",flexDirection:"column",justifyContent:"center",position:"fixed",zIndex:"999",padding:"1em",backgroundColor:Zotero.Prefs.get(`${ve.addonRef}.tipBackgroundColor`),opacity:"0",transition:`opacity ${this.shadeMillisecond/1e3}s linear`,"-moz-user-select":"text",boxShadow:"0 4px 24px rgb(0 0 0 / 20%)",borderRadius:"8px"},listeners:[{type:"DOMMouseScroll",listener:r=>{r.ctrlKey&&this.zoom(r)}},{type:"mouseenter",listener:()=>{window.clearTimeout(this.tipTimer)}},{type:"mouseleave",listener:()=>{this.tipTimer=window.setTimeout(()=>{this.container.remove()},this.removeTipAfterMillisecond)}}],children:[{tag:"box",id:"option-container",styles:{width:"100%",height:`${this.option.size}px`,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",marginBottom:".25em",marginTop:".25em"}},{tag:"box",id:"content-container",styles:{width:"100%"}}]}),document.documentElement.appendChild(this.container)}addTip(r,i,l,u,d,g,m){let x=async B=>{if(Zotero.ZoteroPDFTranslate){Zotero.ZoteroPDFTranslate._sourceText=B;let $=await Zotero.ZoteroPDFTranslate.translate.getTranslation();if(!$){Zotero.ZoteroPDFTranslate.view.showProgressWindow("Translate Failed",$,"fail");return}return Zotero.ZoteroPDFTranslate._translatedText}else if(Zotero.PDFTranslate)return(await Zotero.PDFTranslate.api.translate(B))?.result},v=async function(B){if((Zotero.isMac&&B.metaKey&&!B.ctrlKey||!Zotero.isMac&&B.ctrlKey)&&Zotero.Prefs.get(`${ve.addonRef}.ctrlClickTranslate`)){let $=this,V=$.getAttribute("sourceText"),te=$.getAttribute("translatedText");ztoolkit.log(V,te),V||(V=$.innerText,$.setAttribute("sourceText",V)),te||(te=await x(V),$.setAttribute("translatedText",te)),$.innerText==V?(ztoolkit.log("-> translatedText"),$.innerText=te):$.innerText==te&&($.innerText=V,ztoolkit.log("-> sourceText"))}},I=g!==void 0&&m!==void 0&&g==m||this.container.querySelector("#option-container").childNodes.length==0;I&&this.reset();let S=ztoolkit.UI.createElement(document,"div",{classList:["zotero-reference-tip"],styles:{padding:"0px",width:"100%",display:I?"":"none"},subElementOptions:[{tag:"span",classList:["title"],styles:{display:"block",fontWeight:"bold",marginBottom:".25em",fontSize:"1.2em",color:Zotero.Prefs.get(`${ve.addonRef}.tipTitleColor`)},directAttributes:{innerText:r},listeners:[{type:"click",listener:v}]},...i&&i.length>0?[{tag:"div",id:"tags",styles:{width:"100%"},subElementOptions:(B=>{if(!B)return[];let $=[];for(let V of B)$.push({tag:"span",directAttributes:{innerText:V.text},styles:{backgroundColor:V.color,borderRadius:"10px",margin:"0.5em 1em 0.5em 0px",display:"inline-block",padding:"0 8px",color:"white",cursor:"pointer",userSelect:"none"},listeners:[{type:"click",listener:()=>{V.url?(new ztoolkit.ProgressWindow("Launching URL").createLine({text:V.url,type:"default"}).show(),Zotero.launchURL(V.url)):V.item?(this.clear(),Zotero.ProgressWindowSet.closeAll(),this.utils.selectItemInLibrary(V.item)):this.utils.copyText(V.text)}},{type:"mouseenter",listener:()=>{V.tip&&(Zotero.ProgressWindowSet.closeAll(),new ztoolkit.ProgressWindow("Reference",{closeTime:-1}).createLine({text:V.tip,type:"default"}).show())}},{type:"mouseleave",listener:()=>{V.tip&&Zotero.ProgressWindowSet.closeAll()}}]});return $})(i)}]:[],...l&&l.length>0?[{tag:"div",id:"descriptions",styles:{marginBottom:"0.25em"},children:(B=>{if(!B)return[];let $=[];for(let V of B)$.push({tag:"span",id:"content",styles:{display:"block",lineHeight:"1.5em",opacity:"0.5",cursor:"pointer",userSelect:"none"},properties:{innerText:V},listeners:[{type:"click",listener:()=>{this.utils.copyText(V)}}]});return $})(l)}]:[],{tag:"span",id:"content",properties:{innerText:u},styles:{display:"block",lineHeight:"1.5em",textAlign:"justify",opacity:"0.8",maxHeight:"300px",overflowY:"auto",marginTop:".25em"},listeners:[{type:"click",listener:v}]}]}),M=ztoolkit.UI.createElement(document,"div",{id:`option-${g}`,styles:{width:`${this.option.size}px`,height:`${this.option.size}px`,borderRadius:"50%",backgroundColor:I?this.option.color.active:this.option.color.default,marginLeft:`${this.option.size*.5}px`,marginRight:`${this.option.size*.5}px`,cursor:"pointer",transition:"background-color 0.23s linear"},listeners:[{type:"click",listener:()=>{this.reset(),M.style.backgroundColor=this.option.color.active,S.style.display="",Zotero.Prefs.set(`${ve.addonRef}.${d}InfoIndex`,g),this.place()}},{type:"mouseenter",listener:()=>{let B=i.find(V=>V.source),$=B&&B.source&&d&&`${B.source} view according to ${d}`||"reference view";Zotero.ProgressWindowSet.closeAll(),new ztoolkit.ProgressWindow("Reference",{closeTime:-1}).createLine({text:$,type:"default"}).show()}},{type:"mouseleave",listener:()=>{Zotero.ProgressWindowSet.closeAll()}}]}),E=this.container.querySelector("#option-container"),C=[...E.querySelectorAll("[id^=option]")];if(C.length==0)E.appendChild(M);else{let B=$=>Number($.id.split("-")[1]);for(let $=0;$<C.length;$++)if(g>B(C[$]))if($+1<C.length){if(g<B(C[$+1])){E.insertBefore(M,C[$+1]);break}}else{E.appendChild(M);break}else{E.insertBefore(M,C[$]);break}}this.container.querySelector("#content-container").appendChild(S),this.place()}reset(){this.container.querySelector("#content-container").childNodes.forEach(r=>{r.style.display="none"}),this.container.querySelector("#option-container").childNodes.forEach(r=>{r.style.backgroundColor=this.option.color.default})}zoom(r){let i=this.container.style.transform.match(/scale\((.+)\)/),l=i?parseFloat(i[1]):1,u=1,d=1.7,g=.05;this.container.style.bottom=="0px"?this.container.style.transformOrigin="center bottom":this.container.style.transformOrigin="center center",r.detail>0?(l=l-g,this.container.style.transform=`scale(${l<u?u:l})`):(l=l+g,this.container.style.transform=`scale(${l>d?d:l})`)}};var Jh=class{constructor(r){this.lock=Zotero.Promise.defer(),this.init(r)}async init(r){let l=Zotero.getMainWindow().OS;if(await l.File.exists(r))this.filename=r;else{let u=Zotero.getTempDirectory();this.filename=l.Path.join(u.path.replace(u.leafName,""),`${r}.json`)}try{let u=await Zotero.File.getContentsAsync(this.filename);this.cache=JSON.parse(u),ztoolkit.log(this.cache)}catch{this.cache={}}this.lock.resolve()}get(r,i){if(this.cache==null){ztoolkit.log("cache is undefined");return}return(this.cache[r.key]??={})[i]}async set(r,i,l){await this.lock.promise,(this.cache[r.key]??={})[i]=l,window.setTimeout(async()=>{await Zotero.File.putContentsAsync(this.filename,JSON.stringify(this.cache))})}},t_=Jh;var Sa=new t_(ve.addonRef),La=class{constructor(){Vy(),this.utils=new Ui,this.addStyle()}addStyle(){let r=ztoolkit.UI.createElement(document,"style",{id:"reference-style",properties:{innerHTML:`
          .reference-search-box .icon {
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0.8;
          }
          .reference-search-box .icon:hover {
            opacity: 1
          }
        `}});document.documentElement.appendChild(r)}async onInit(){ztoolkit.ReaderTabPanel.register(jr("tabpanel-reader-tab-label"),(r,i,l,u)=>{if(!r){ztoolkit.log("This reader do not have right-side bar. Adding reader tab skipped.");return}let d,g=`${ve.addonRef}-${u._instanceID}-extra-reader-tab-div`;window.setTimeout(async()=>{let m=ztoolkit.UI.createElement(document,"related-box",{id:g,classList:["zotero-editpane-related"],namespace:"xul",ignoreIfExists:!0,attributes:{flex:"1"},styles:{alignItems:"center"},children:[{tag:"box",namespace:"xul",classList:["reference"],attributes:{flex:"1"},styles:{display:"flex"},children:[{tag:"div",namespace:"html",styles:{flexGrow:"1"},children:[{tag:"div",classList:["header"],namespace:"html",children:[{tag:"label",id:"reference-num",properties:{innerText:`0 ${jr("relatedbox-number-label")}`},listeners:[{type:"dblclick",listener:()=>{ztoolkit.log("dblclick: Copy all references");let x=[],v=m.querySelectorAll("#related-grid .box #reference-label");ztoolkit.log(v),v.forEach(I=>{x.push(I.textContent)}),ztoolkit.log(x),new ztoolkit.ProgressWindow("Reference").createLine({text:"Copy all references",type:"success"}).show(),new ztoolkit.Clipboard().addText(x.join(`
`),"text/unicode").copy()}}]},{tag:"button",id:"refresh-button",properties:{innerText:jr("relatedbox-refresh-label")},listeners:[{type:"mousedown",listener:x=>{d=window.setTimeout(async()=>{d=void 0,await this.refreshReferences(r,!1,x.ctrlKey||x.metaKey)},1e3)}},{type:"mouseup",listener:async x=>{d&&(window.clearTimeout(d),d=void 0,await this.refreshReferences(r,!0,x.ctrlKey||x.metaKey))}}]}]},{tag:"div",namespace:"html",id:"related-grid",classList:["grid"],styles:{overflowY:"auto",alignItems:"center",display:"grid"}}]}]}]});r.append(m),m.querySelector("box:not(.reference)")?.remove(),window.setTimeout(async()=>{if(Zotero.Prefs.get(`${ve.addonRef}.autoRefresh`)){let x=Zotero.Prefs.get(`${ve.addonRef}.notAutoRefreshItemTypes`).split(/,\s*/);if(r.getAttribute("isAutoRefresh")!="true"){let I=Zotero.Items.get(u._itemID).parentItem.getType(),S=Zotero.ItemTypes.getTypes().find(M=>M.id==I)?.name;x.indexOf(S)==-1&&(await this.refreshReferences(r),r.setAttribute("isAutoRefresh","true"))}}}),window.setTimeout(async()=>{await this.loadingRelated()})})},{tabId:"zotero-reference",selectPanel:!1})}async registerSplitButtons(r){let i;for(;!(i=r?._iframeWindow?.wrappedJSObject);)ztoolkit.log("wait..."),await Zotero.Promise.delay(10);let u=i.document.querySelector("#toolbarViewerLeft").querySelector("#pageNumber"),d={backgroundSize:"16px 16px",backgroundPosition:"center",backgroundRepeat:"no-repeat",width:"16px"};ztoolkit.UI.insertElementBefore({tag:"div",classList:["splitToolbarButton"],children:[{tag:"button",namespace:"html",id:"split-horizontally",classList:["toolbarButton"],styles:{backgroundImage:`url(chrome://${ve.addonRef}/content/icons/horizontally.png)`,marginRight:"1px",...d},attributes:{title:"Split Horizontally",tabindex:"-1"},listeners:[{type:"click",listener:()=>{r.menuCmd("splitHorizontally")}}]},{tag:"button",namespace:"html",id:"split-vertically",classList:["toolbarButton"],styles:{backgroundImage:`url(chrome://${ve.addonRef}/content/icons/split.png)`,marginLeft:"0",...d},attributes:{title:"Split Vertically",tabindex:"-1"},listeners:[{type:"click",listener:()=>{r.menuCmd("splitVertically")}}]}]},u)}refreshRelated(r,i){let l=0;return r.forEach((u,d)=>{let{box:g,label:m}=this.addRow(i,r,d,!1,!1);g&&(g.classList.add("only-title"),l+=1)}),l}async loadingRelated(){if(!Zotero.Prefs.get(`${ve.addonRef}.loadingRelated`))return;ztoolkit.log("loadingRelated");let r=this.utils.getItem();if(!r)return;let i=r.getField("DOI");if(!i||!this.utils.isDOI(i)){ztoolkit.log("Not DOI",i);return}let l=document.querySelector(`#${Zotero_Tabs.selectedID}-context`).querySelector("tabpanel:nth-child(3) related-box");do await Zotero.Promise.delay(50);while(!l.querySelector("#related-grid"));let u=l.querySelector("#related-grid").parentNode;if(u.querySelector(".zotero-clicky-plus"))return;ztoolkit.log("getDOIRelatedArray");let d=await this.utils.API.getDOIRelatedArray(i)||[],g=l.refresh;l.refresh=()=>{g.call(l),u.querySelectorAll(".box").forEach(x=>{x.nextElementSibling?.remove(),x.remove()}),ztoolkit.log(d);let m=r.relatedItems.map(x=>{try{return Zotero.Items.getByLibraryAndKey(1,x)}catch{}}).filter(x=>x).map(x=>({identifiers:{DOI:x.getField("DOI")},authors:[],title:x.getField("title"),text:x.getField("title"),url:x.getField("url"),type:x.itemType,year:x.getField("year"),_item:x})).concat(d);ztoolkit.log(m),this.refreshRelated(m,u)},l.refresh()}async pdfLinks(r,i){let l,u;for(;!((u=r?._iframeWindow?.wrappedJSObject)&&(l=u.PDFViewerApplication?.pdfDocument));)await Zotero.Promise.delay(10);let d=await l._transport.getDestinations(),g=window.setInterval(async()=>{try{u.document}catch(m){return ztoolkit.log(m),window.clearInterval(g),await this.pdfLinks(r,i)}u.document.querySelectorAll(`section.linkAnnotation a[href^='#']:not([${ve.addonRef}])`).forEach(async m=>{let x=Zotero.Prefs.get(`${ve.addonRef}.clickLink`),v=Zotero.Prefs.get(`${ve.addonRef}.hoverLink`),I,S=m.getAttribute("href");if(S.indexOf("fig")>=0)return;x&&(I=ztoolkit.UI.appendElement({tag:"a",namespace:"html"},m.parentNode),I.setAttribute(ve.addonRef,S),I.setAttribute("style","cursor: pointer;"),m.remove(),I.addEventListener("click",async E=>{if(E.stopPropagation(),E.preventDefault(),u.secondViewIframeWindow==null){for(await r.menuCmd(Zotero.Prefs.get(`${ve.addonRef}.clickLink.cmd`));!u?.secondViewIframeWindow?.PDFViewerApplication?.pdfDocument;)await Zotero.Promise.delay(100);await Zotero.Promise.delay(1e3)}u.secondViewIframeWindow.eval(`PDFViewerApplication
                .pdfViewer.linkService.goToDestination("${S.slice(1)}")`)}));let M;if(I=I||m,v){let E;I.addEventListener("mouseenter",async C=>{let B=i.references;if(!B)return;let[$,V]=d[S.slice(1)].slice(2,4),te=B.map(Z=>($-Z.x)**2+(V-Z.y)**2),R=[...te].sort((Z,X)=>Z-X)[0],D=te.indexOf(R),A=B[D];A&&(M=window.setTimeout(()=>{M=void 0;let Z=I.getBoundingClientRect();Z.y=Z.y+40,E=this.showTipUI(Z,A,"top center")},233))}),I.addEventListener("mouseleave",async()=>{if(window.clearTimeout(M),E){let C=E.removeTipAfterMillisecond;E.tipTimer=window.setTimeout(async()=>{E&&E.container.remove()},C)}})}})},100)}async refreshReferences(r,i=!0,l=!1){Zotero.ProgressWindowSet.closeAll();let u=r.querySelector("label#reference-num");u.innerText=`0 ${jr("relatedbox-number-label")}`;let d=r.getAttribute("source");d?i&&(d=="PDF"&&r.setAttribute("source","API"),d=="API"&&r.setAttribute("source","PDF")):r.setAttribute("source",Zotero.Prefs.get(`${ve.addonRef}.prioritySource`)),r.querySelectorAll("#related-grid *").forEach(I=>I.remove()),r.querySelectorAll("#zotero-reference-search").forEach(I=>I.remove());let g,m=this.utils.getItem(),x=this.utils.getReader();if(r.getAttribute("source")=="PDF"){let I="References-PDF";g=i&&Sa.get(m,I),g?new ztoolkit.ProgressWindow("[Local] PDF").createLine({text:`${g.length} references`,type:"success"}).show():(g=await this.utils.PDF.getReferences(x,l),Zotero.Prefs.get(`${ve.addonRef}.savePDFReferences`)&&window.setTimeout(async()=>{await Sa.set(m,I,g)}))}else{let I="References-API";if(g=i&&Sa.get(m,I),g)new ztoolkit.ProgressWindow("[Local] API").createLine({text:`${g.length} references`,type:"success"}).show();else{let S=m.getField("DOI"),M=m.getField("url"),E=m.getField("title"),C=this.utils.parseCNKIURL(M)?.fileName,B;if(this.utils.isDOI(S))B=new ztoolkit.ProgressWindow("[Pending] API",{closeTime:-1}),B.createLine({text:"Request DOI references...",type:"default"}).show(),g=(await this.utils.API.getDOIInfoByCrossref(S))?.references;else{if(!C){try{let $=await this.utils.API.getCNKIURL(E);$&&(C=this.utils.parseCNKIURL($)?.fileName,m.setField("url",$),await m.saveTx())}catch{new ztoolkit.ProgressWindow("[Fail] API").createLine({text:"Error, Get CNKI URL",type:"fail"}).show();return}if(!C){new ztoolkit.ProgressWindow("[Fail] API").createLine({text:"Fail, Get CNKI URL",type:"fail"}).show();return}}if(B=new ztoolkit.ProgressWindow("[Pending] API",{closeTime:-1,closeOtherProgressWindows:!0}),B.createLine({text:"Request CNKI references...",type:"default"}).show(),g=(await this.utils.API.getCNKIFileInfo(C))?.references,!g){B.changeHeadline("[Fail] API"),B.changeLine({text:`Not Supported, ${C}`,type:"fail"}),B.startCloseTimer(3e3);return}}Zotero.Prefs.get(`${ve.addonRef}.saveAPIReferences`)&&window.setTimeout(async()=>{g&&await Sa.set(m,I,g)}),B.changeHeadline("[Done] API"),B.changeLine({text:`${g.length} references`,type:"success"}),B.startCloseTimer(3e3)}}let v=g.length;r.references=g,g.forEach(async(I,S)=>{let{box:M}=this.addRow(r,g,S);M.reference=I,u.innerText=`${S+1}/${v} ${jr("relatedbox-number-label")}`}),u.innerText=`${v} ${jr("relatedbox-number-label")}`}showTipUI(r,i,l,u){let d=E=>{if(!E)return;let C=new Date(E).toString().split(" ");return`${C[1]} ${C[3]}`},g=new Da;g.onInit(r,l);let m=i.text,x=async()=>{let E=i._item,C;if(E)C={identifiers:{},authors:E.getCreators().map(B=>B.firstName+" "+B.lastName),tags:E.getTags().map(B=>{let $=E.getColoredTags().find(V=>V.tag==B.tag);return $?{text:B.tag,color:$.color}:B.tag}),abstract:E.getField("abstractNote"),title:E.getField("title"),year:E.getField("year"),primaryVenue:E.getField("publicationTitle"),type:"",source:i.source||void 0};else{C={identifiers:i.identifiers||{},authors:i.authors||[],type:"",year:i.year||void 0,title:i.title||u||"Reference",tags:i.tags||[],text:i.text||m,abstract:i.abstract||m,primaryVenue:i.primaryVenue||void 0};let B=this.utils.identifiers2URL(C.identifiers);B&&(C.url=B)}return C},v,I,S;i?.identifiers.arXiv?(S="arXiv",v=[x(),this.utils.API.getArXivInfo(i.identifiers.arXiv)],I=parseInt(Zotero.Prefs.get(`${ve.addonRef}.${S}InfoIndex`))):i?.identifiers.DOI?(S="DOI",v=[x(),this.utils.API.getDOIInfoBySemanticscholar(i.identifiers.DOI),this.utils.API.getTitleInfoByReadpaper(m,{},i.identifiers.DOI),this.utils.API.getTitleInfoByConnectedpapers(i.identifiers.DOI),this.utils.API.getDOIInfoByCrossref(i.identifiers.DOI)],I=parseInt(Zotero.Prefs.get(`${ve.addonRef}.${S}InfoIndex`))):(S="Title",v=[x(),this.utils.API.getTitleInfoByReadpaper(i.title),this.utils.API.getTitleInfoByCrossref(i.title),this.utils.API.getTitleInfoByConnectedpapers(i.title),this.utils.API.getTitleInfoByCNKI(i.title)],I=parseInt(Zotero.Prefs.get(`${ve.addonRef}.${S}InfoIndex`)));let M={arXiv:{color:"#b31b1b",tip:"arXiv is a free distribution service and an open-access archive for 2,186,475 scholarly articles in the fields of physics, mathematics, computer science, quantitative biology, quantitative finance, statistics, electrical engineering and systems science, and economics. Materials on this site are not peer-reviewed by arXiv."},readpaper:{color:"#1f71e0",tip:"\u8BBA\u6587\u9605\u8BFB\u5E73\u53F0ReadPaper\u5171\u6536\u5F55\u8FD12\u4EBF\u7BC7\u8BBA\u6587\u30012.7\u4EBF\u4F4D\u4F5C\u8005\u3001\u8FD13\u4E07\u6240\u9AD8\u6821\u53CA\u7814\u7A76\u673A\u6784\uFF0C\u51E0\u4E4E\u6DB5\u76D6\u4E86\u5168\u4EBA\u7C7B\u6240\u6709\u5B66\u79D1\u3002\u79D1\u7814\u5DE5\u4F5C\u79BB\u4E0D\u5F00\u8BBA\u6587\u7684\u5E2E\u52A9\uFF0C\u5982\u4F55\u8BFB\u61C2\u8BBA\u6587\uFF0C\u8BFB\u597D\u8BBA\u6587\uFF0C\u8FD9\u672C\u8EAB\u5C31\u662F\u4E00\u4E2A\u5F88\u5927\u7684\u547D\u9898\uFF0C\u6211\u4EEC\u7684\u4F7F\u547D\u662F\uFF1A\u201C\u8BA9\u5929\u4E0B\u6CA1\u6709\u96BE\u8BFB\u7684\u8BBA\u6587\u201D"},semanticscholar:{color:"#1857b6",tip:"Semantic Scholar is an artificial intelligence\u2013powered research tool for scientific literature developed at the Allen Institute for AI and publicly released in November 2015. It uses advances in natural language processing to provide summaries for scholarly papers. The Semantic Scholar team is actively researching the use of artificial-intelligence in natural language processing, machine learning, Human-Computer interaction, and information retrieval."},crossref:{color:"#89bf04",tip:"Crossref is a nonprofit association of approximately 2,000 voting member publishers who represent 4,300 societies and publishers, including both commercial and nonprofit organizations. Crossref includes publishers with varied business models, including those with both open access and subscription policies."},connectedpapers:{color:"#35999a",tip:"Connected Papers is a visual tool to help researchers and applied scientists find academic papers relevant to their field of work."},DOI:{color:"#fcb426"},Zotero:{color:"#d63b3b",tip:"Zotero is a free, easy-to-use tool to help you collect, organize, cite, and share your research sources."},CNKI:{color:"#1b66e6",tip:"\u4E2D\u56FD\u77E5\u7F51\u77E5\u8BC6\u53D1\u73B0\u7F51\u7EDC\u5E73\u53F0\u2014\u9762\u5411\u6D77\u5185\u5916\u8BFB\u8005\u63D0\u4F9B\u4E2D\u56FD\u5B66\u672F\u6587\u732E\u3001\u5916\u6587\u6587\u732E\u3001\u5B66\u4F4D\u8BBA\u6587\u3001\u62A5\u7EB8\u3001\u4F1A\u8BAE\u3001\u5E74\u9274\u3001\u5DE5\u5177\u4E66\u7B49\u5404\u7C7B\u8D44\u6E90\u7EDF\u4E00\u68C0\u7D22\u3001\u7EDF\u4E00\u5BFC\u822A\u3001\u5728\u7EBF\u9605\u8BFB\u548C\u4E0B\u8F7D\u670D\u52A1\u3002"}};for(let E=0;E<v.length;E++)window.setTimeout(async()=>{let C=await v[E];if(!C)return;let B="#59C1BD",$=C.tags.map(V=>typeof V=="object"?{color:B,...V}:{color:B,text:V})||[];if(C.source&&$.push({text:C.source,...M[C.source],source:C.source}),C.identifiers.DOI){let V=C.identifiers.DOI;$.push({text:"DOI",color:M.DOI.color,tip:V,url:C.url})}if(C.identifiers.arXiv){let V=C.identifiers.arXiv;$.push({text:"arXiv",color:M.arXiv.color,tip:V,url:C.url})}if(C.identifiers.CNKI){let V=C.identifiers.CNKI;$.push({text:"URL",color:M.CNKI.color,tip:V,url:C.url})}i._item&&$.push({text:"Zotero",color:M.Zotero.color,tip:M.Zotero.tip,item:i._item}),g.addTip(this.utils.Html2Text(C.title),$,[C.authors?.slice(0,3).join(" / "),[C?.primaryVenue,d(C.publishDate)||C.year].filter(V=>V).join(" \xB7 "),i.description].filter(V=>V&&V!=""),this.utils.Html2Text(C.abstract),S,E,I)});return g}addRow(r,i,l,u=!0,d=!0){let g=Zotero.Prefs.get(`${ve.addonRef}.notInLibarayOpacity`);/[\d\.]+/.test(g)?g=Number(g):g=1;let m=i[l],x;u?x=`[${m?.number||l+1}] ${m.text}`:x=m.text;let v=J=>J.replace(/[^\u4e00-\u9fa5a-zA-Z0-9]/g,"");if([...r.querySelectorAll(".box label")].find(J=>v(J.innerText)==v(x)))return;let I=m.identifiers&&Object.values(m.identifiers).length>0&&Object.keys(m.identifiers)[0]+": "+Object.values(m.identifiers)[0]||"Reference",S=this.utils.getItem(),M,E=ztoolkit.UI.createElement(document,"div",{namespace:"html",classList:["box","zotero-clicky"],listeners:[{type:"click",listener:J=>{J.preventDefault(),J.stopPropagation()}},{type:"mouseup",listener:async J=>{if(J.preventDefault(),J.stopPropagation(),J.ctrlKey||J.metaKey){if(window.clearTimeout(M),m._item)return this.utils.selectItemInLibrary(m._item);{let K=await this.utils.searchLibraryItem(m);if(K)return this.utils.selectItemInLibrary(K)}let U=m.url;if(!U){let K=m.text,se=this.utils.refText2Info(K),de=new ztoolkit.ProgressWindow("Searching URL",{closeTime:-1}).createLine({text:`Title: ${m.title}`,type:"default"}).show();if(this.utils.isChinese(K))U=await this.utils.API.getCNKIURL(se.title);else{let _e=(await this.utils.API.getTitleInfoByConnectedpapers(m.title))?.identifiers.DOI;U=this.utils.identifiers2URL({DOI:_e})}de.close()}U&&(new ztoolkit.ProgressWindow("Launching URL",{closeOtherProgressWindows:!0}).createLine({text:U,type:"default"}).show(),Zotero.launchURL(U))}else{if(Z.querySelector("#reference-edit"))return;M&&(window.clearTimeout(M),Zotero.ProgressWindowSet.closeAll(),this.utils.copyText((I?I+`
`:"")+x,!1),new ztoolkit.ProgressWindow("Reference").createLine({text:x,type:"success"}).show())}}}],styles:{alignItems:"center",opacity:String(g),paddingTop:"1px",paddingBottom:"1px"},children:[{tag:"img",attributes:{src:Zotero.ItemTypes.getImageSrc(m.type)}},{tag:"label",id:"reference-label",properties:{innerText:x},styles:{width:"100%"},listeners:[{type:"mousedown",listener:()=>{M=window.setTimeout(()=>{M=void 0,B()},500)}}]}]}),C=ztoolkit.UI.createElement(document,"label",{id:"add-remove",namespace:"xul",attributes:{value:"+"},classList:["zotero-clicky","zotero-clicky-plus"]}),B=()=>{let J=E.querySelector("#reference-label");J.style.display="none";let U=ztoolkit.UI.createElement(document,"textarea",{id:"reference-edit",namespace:"html",attributes:{flex:"1",multiline:"true",rows:"4"},properties:{value:u?J.innerText.replace(/^\[\d+\]\s+/,""):J.innerText},styles:{width:"100%"},listeners:[{type:"blur",listener:async()=>{await K()}}]});U.focus(),J.parentNode.insertBefore(U,J);let K=async()=>{let de=U.value;if(!de||(J.style.display="",U.remove(),de==m.text))return;J.innerText=`[${l+1}] ${de}`,i[l]={...m,identifiers:this.utils.getIdentifiers(de),...this.utils.refText2Info(de),text:de},m=i[l];let _e=this.utils.searchLibraryItem(m),Ce=`References-${r.getAttribute("source")}`;window.setTimeout(async()=>{await Sa.set(S,Ce,i)})},se=window.setInterval(async()=>{let de=Z.querySelector(".active");de&&de!=E&&(await K(),window.clearInterval(se))},100)},$=(J="")=>{switch(J){case"+":C.setAttribute("class","zotero-clicky zotero-clicky-plus"),C.setAttribute("value","+"),C.style.opacity="1";break;case"-":C.setAttribute("class","zotero-clicky zotero-clicky-minus"),C.setAttribute("value","-"),C.style.opacity="1";break;case"":C.setAttribute("value",""),C.style.opacity=".23";break}},V=async()=>{ztoolkit.log("removeRelatedItem");let J=new ztoolkit.ProgressWindow("Removing Item",{closeTime:-1}).createLine({text:x,type:"default"}).show();$();let U=this.utils.searchRelatedItem(S,m._item);if(!U){J.changeHeadline("Removed"),r.querySelector("#refresh-button").click(),J.startCloseTimer(3e3);return}U.removeRelatedItem(S),S.removeRelatedItem(U),await S.saveTx(),await U.saveTx(),$("+"),J.changeLine({type:"success"}),J.startCloseTimer(3e3)},te=async(J=void 0)=>{let U=de=>{let _e;return this.utils.isChinese(de)?_e=15:_e=35,de.length>_e?de.slice(0,_e)+"...":de},K=new ztoolkit.ProgressWindow("Searching Item",{closeTime:-1,closeOtherProgressWindows:!0}).createLine({text:U(m.text),type:"default"}).show(),se=m._item||await this.utils.searchLibraryItem(m);if($(),se)K.changeHeadline("Existing Item"),K.changeLine({text:U(se.getField("title"))});else{let de=this.utils.refText2Info(m.text);if(this.utils.isChinese(m.text)&&Zotero.Jasminum){K.changeHeadline("Creating Item"),K.changeLine({text:U(`CNKI: ${de.title}`)});try{se=await this.utils.createItemByJasminum(de.title)}catch(_e){ztoolkit.log(_e)}if(!se){K.changeLine({type:"fail"}),K.startCloseTimer(3e3),$("+");return}}else{if(Object.keys(m.identifiers).length==0){K.changeHeadline("Searching DOI"),K.changeLine({text:U(`Title: ${de.title}`)});let _e=(await this.utils.API.getTitleInfoByConnectedpapers(de.title))?.identifiers.DOI;if(!this.utils.isDOI(_e)){$("+"),K.changeLine({type:"fail"}),K.startCloseTimer(3e3);return}m.identifiers={DOI:_e}}if(K.changeHeadline("Creating Item"),K.changeLine({text:U(`${Object.keys(m.identifiers)}: ${Object.values(m.identifiers)[0]}`)}),await this.utils.searchRelatedItem(S,se)){K.changeHeadline("Added Item"),K.changeLine({type:"success"}),K.startCloseTimer(3e3),r.querySelector("#refresh-button").click();return}try{se=await this.utils.createItemByZotero(m.identifiers,J||S.getCollections())}catch(_e){K.changeLine({type:"fail"}),K.startCloseTimer(3e3),$("+"),ztoolkit.log(_e);return}}for(let _e of J||S.getCollections())se.addToCollection(_e),await se.saveTx()}K.changeHeadline("Adding Item"),K.changeLine({text:U(se.getField("title"))}),m._item=se,S.addRelatedItem(se),se.addRelatedItem(S),await S.saveTx(),await se.saveTx(),$("-"),K.changeLine({type:"success"}),K.startCloseTimer(3e3),R(se)},R=J=>{E.style.opacity="1",E.querySelector("img")?.setAttribute("src",J.getImageSrc()),this.utils.searchRelatedItem(S,J)&&$("-")},D,A;g<1&&window.setTimeout(async()=>{let J=m._item||await this.utils.searchLibraryItem(m);J&&R(J)},l*0),E.addEventListener("mouseenter",()=>{if(!Zotero.Prefs.get(`${ve.addonRef}.isShowTip`))return;E.classList.add("active");let J=parseInt(Zotero.Prefs.get(`${ve.addonRef}.showTipAfterMillisecond`)),U=Zotero.Prefs.get("extensions.zotero.layout",!0)=="stacked"?"top center":"left";D=window.setTimeout(async()=>{let K=document.documentElement.getBoundingClientRect(),se=E.getBoundingClientRect();se.x-=5,A=this.showTipUI(se,m,U,I),E.classList.contains("active")||(A.container.style.display="none")},J)}),E.addEventListener("mouseleave",()=>{if(E.classList.remove("active"),window.clearTimeout(D),!A)return;let J=A.removeTipAfterMillisecond;A.tipTimer=window.setTimeout(async()=>{for(let U=0;U<J/2;U++){if(Z.querySelector(".active"))return;await Zotero.Promise.delay(1/1e3)}A&&A.clear()},J/2)}),C.addEventListener("click",async J=>{J.preventDefault(),J.stopPropagation();let U=C.getAttribute("value");if(U=="+")if(J.ctrlKey||J.metaKey){let K=E.getBoundingClientRect(),se=document.createElementNS("http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul","menupopup");document.querySelector("#browser").append(se);let de=Zotero.Collections.getByLibrary(1);for(let _e of de){let Ce=Zotero.Utilities.Internal.createMenuForTarget(_e,se,null,async(we,Ue)=>{we.target.tagName=="menuitem"&&(ztoolkit.log(Ue),se.remove(),await te([Ue.id]),we.stopPropagation())});se.append(Ce)}se.openPopupAtScreen(K.left,K.top+K.height,!0)}else await te();else U=="-"&&await V()});let Z=r.querySelector("#related-grid");Z.append(E,C);let X=Z.childNodes.length;d&&X&&!r.querySelector("#zotero-reference-search")&&this.addSearch(r);let H=r.querySelector("#related-grid");return H.style.maxHeight=`${document.documentElement.getBoundingClientRect().height-H.getBoundingClientRect().top}px`,{box:E,label:C}}addSearch(r){let l=ztoolkit.UI.insertElementBefore({tag:"div",id:"zotero-reference-search",classList:["reference-search-box"],styles:{height:"10px",padding:"5px",borderRadius:"5px",border:"1px solid #e0e0e0",display:"flex",flexDirection:"row",alignItems:"center",margin:".5em 1em",opacity:"0.8"},children:[{tag:"div",styles:{width:"10px",height:"10px",display:"flex",justifyContent:"center",alignItems:"center"},properties:{innerHTML:'<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="10" height="10"><path d="M1005.312 914.752l-198.528-198.464A448 448 0 1 0 0 448a448 448 0 0 0 716.288 358.784l198.4 198.4a64 64 0 1 0 90.624-90.432zM448 767.936A320 320 0 1 1 448 128a320 320 0 0 1 0 640z" fill="#5a5a5a"></path></svg>'}},{tag:"input",styles:{outline:"none",border:"none",width:"100%",margin:"0 5px"},listeners:[{type:"focus",listener:()=>{l.style.opacity="1",l.style.boxShadow="0 0 0 1px rgba(0,0,0,0.5)"}},{type:"blur",listener:()=>{l.style.opacity="0.8",l.style.boxShadow=""}},{type:"keyup",listener:async()=>{let g=u.value;g.length>0?d.style.display="":d.style.display="none";let m=g.split(/[ ,，]/).filter(x=>x);ztoolkit.log(m),r.querySelectorAll("#related-grid *").forEach(x=>x.style.display=""),m.length!=0&&r.querySelectorAll("#related-grid .box").forEach(x=>{let v=x.querySelector("#reference-label").textContent,I=!0;for(let S=0;S<m.length;S++)I=I&&v.toLowerCase().indexOf(m[S].toLowerCase())>=0;I?(ztoolkit.log(v),x.style.display="",x.nextElementSibling.style.display=""):(x.style.display="none",x.nextElementSibling.style.display="none")})}}]},{tag:"div",classList:["icon","clear"],styles:{width:"10px",height:"10px",display:"none"},properties:{innerHTML:'<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="10" height="10"><path d="M512.288 1009.984c-274.912 0-497.76-222.848-497.76-497.76s222.848-497.76 497.76-497.76c274.912 0 497.76 222.848 497.76 497.76s-222.848 497.76-497.76 497.76zM700.288 368.768c12.16-12.16 12.16-31.872 0-44s-31.872-12.16-44.032 0l-154.08 154.08-154.08-154.08c-12.16-12.16-31.872-12.16-44.032 0s-12.16 31.84 0 44l154.08 154.08-154.08 154.08c-12.16 12.16-12.16 31.84 0 44s31.872 12.16 44.032 0l154.08-154.08 154.08 154.08c12.16 12.16 31.872 12.16 44.032 0s12.16-31.872 0-44l-154.08-154.08 154.08-154.08z" fill="#5a5a5a" p-id="5698"></path></svg>'},listeners:[{type:"click",listener:async()=>{u.value="",d.style.display="none",r.querySelectorAll("#related-grid *").forEach(g=>g.style.display="")}}]}]},r.querySelector(".grid")),u=l.querySelector("input"),d=l.querySelector(".clear")}};var zd=r_(),Ka=class{constructor(r){this.itemIDs=[];this.cache={};this.zoteroColor=!0;this.requests=new Hr,this.views=r}async init(){for(this.addStyle(),this.registerButton(),this.initOnSelect(),document.querySelectorAll("#graph").forEach(r=>r.remove()),document.querySelectorAll(".resizer").forEach(r=>r.remove());!document.querySelector("#item-tree-main-default");)await Zotero.Promise.delay(100);this.initItemsPane(),this.initEditPane()}addStyle(){let r=`${ve.addonRef}-related-container`;ztoolkit.UI.appendElement({tag:"style",id:`${ve.addonRef}-style`,namespace:"html",properties:{innerHTML:`
          #${r} * {
            transition: background-color .1s linear;
          }
          #${r} .button, #${r} .item, #${r} .filter-button {
            height: 2em;
            line-height: 2em;
            cursor: pointer;
          }
          #${r} .button:hover, #${r} .item.hover {
            background-color: #f5f5f5;
          }
          #${r} .item.selected {
            background-color: #ebebeb;
          }
          #${r} .filter-button {
            display: inline-block;
            width: 50%;
            border: 1px solid rgb(238, 238, 238);
            text-align: center;
            color: #005028;
          }
          #${r} .filter-button:hover {
            background-color: #d9e5ec;
          }
          #${r} .filter-button.activate {
            color: #fff;
            background-color: #045384;
          }
          #${r} .item.highlight {
            background-color: #d9f5f9;
          }
          #${r} .item.highlight.hover {
            background-color: #d0ecf0;
          }
          #zotero-item-pane-content {
            width: 100%;
          }
        `+(Zotero.isMac?"":`
        #zotero-reference-show-hide-graph-view .toolbarbutton-icon {
          width: 16px;
          height: 16px;
        }
        `)}},document.documentElement)}initOnSelect(){ZoteroPane.itemsView.onSelect.addListener(()=>{this.updateAddOrRemove()})}updateAddOrRemove(){let r=this.relatedContainer?.querySelector("#remove-origin"),i=this.relatedContainer?.querySelector("#add-origin");this.itemIDs.indexOf(ZoteroPane.getSelectedItems()[0]?.id)>=0?(r&&(r.style.display="flex"),i&&(i.style.display="none")):(r&&(r.style.display="none"),i&&(i.style.display="flex"))}registerButton(){let r=document.querySelector("#zotero-tb-advanced-search"),i=r?.cloneNode(!0);i.setAttribute("id","zotero-reference-show-hide-graph-view"),i.setAttribute("tooltiptext","show/hide"),i.setAttribute("command",""),i.setAttribute("oncommand",""),i.addEventListener("click",()=>{let l=this.graphContainer;l&&(l.style.display=="none"?(l.style.display="",this.boxAfter.style.display="block",Zotero.Prefs.set(`${ve.addonRef}.graphView.enable`,!0)):(l.style.display="none",this.boxAfter.style.display="none",Zotero.Prefs.set(`${ve.addonRef}.graphView.enable`,!1)))}),i.style.listStyleImage=`url(chrome://${ve.addonRef}/content/icons/connectedpapers.png)`,document.querySelector("#zotero-items-toolbar")?.insertBefore(i,r?.nextElementSibling)}initEditPane(){let r=Zotero.Prefs.get(`${ve.addonRef}.graphView.enable`),i=document.querySelector("#zotero-item-pane-content");i.parentElement?.setAttribute("orient","vertical");let l=this.boxAfter=document.createElement("box");l.id="connected-papers-relatedsplit-after",l.style.overflow="hidden",l.style.backgroundColor="#fff",i.after(l),l.style.display=r?"block":"none",l.style.height=Zotero.Prefs.get(`${ve.addonRef}.graphView.height`),l.style["padding-top"]="0",this.buildRelatedPanel(l)}buildRelatedPanel(r){document.querySelector("#zotero-items-splitter")?.addEventListener("mousemove",()=>{i.style.width=document.querySelector("relatedbox")?.getBoundingClientRect().width+"px"});let i=ztoolkit.UI.appendElement({id:`${ve.addonRef}-related-container`,tag:"div",styles:{margin:"0",padding:"0",width:document.querySelector("relatedbox")?.getBoundingClientRect().width+"px",display:"flex",flexDirection:"column",overflow:"hidden",height:"100%"},children:[{tag:"div",id:"origin-items-container",styles:{display:"flex",flexDirection:"column"},children:[{tag:"div",styles:{maxHeight:"8em",overflow:"auto",borderTop:"1px solid #cecece"},classList:["origin-items"]},{tag:"div",id:"add-origin",classList:["button"],styles:{display:"flex",justifyContent:"center",alignContent:"center",cursor:"pointer",height:"2em"},children:[{tag:"div",classList:["icon"],properties:{innerHTML:'<svg style="margin-right: .5em;" width="24" height="24"  viewBox="2 0 24 24" fill="#7a306c" xmlns="http://www.w3.org/2000/svg" class="graph-action-icon mr-[6px]" data-v-f4c185ee=""><path d="M11 19V13H5V11H11V5H13V11H19V13H13V19H11Z"></path></svg>'}},{tag:"span",styles:{lineHeight:"2em"},properties:{innerText:"Add Origin"}}],listeners:[{type:"click",listener:async()=>{let l=ZoteroPane.getSelectedItems()[0],u=new ztoolkit.ProgressWindow("Add Origin",{closeTime:-1}).createLine({text:l.getField("title"),type:"connectedpapers"}).show(),d={identifiers:{DOI:l.getField("DOI"),paperID:await this.getPaperID(l)},authors:l.getCreators().map(g=>g.firstName+" "+g.lastName),tags:l.getTags().map(g=>{let m=l.getColoredTags().find(x=>x.tag==g.tag);return m?{text:g.tag,color:m.color}:g.tag}),abstract:l.getField("abstractNote"),title:l.getField("title"),year:l.getField("year"),primaryVenue:l.getField("publicationTitle"),type:"",source:"Zotero",_itemID:l.id};this.addItem(i.querySelector("#origin-items-container .origin-items"),d),this.itemIDs.push(l.id),this.updateAddOrRemove(),u.changeLine({text:l.getField("title"),type:"success"}).startCloseTimer(1e3)}}]},{tag:"div",id:"remove-origin",classList:["button"],styles:{display:"none",justifyContent:"center",alignContent:"center",cursor:"pointer",height:"2em"},children:[{tag:"div",classList:["icon"],properties:{innerHTML:'<svg style="margin-right: .5em;"  width="24" height="24" viewBox="0 0 24 24" fill="#7a306c" xmlns="http://www.w3.org/2000/svg" class="graph-action-icon mr-[6px]" data-v-f4c185ee=""><path d="M19 13H5V11H19V13Z"></path></svg>'}},{tag:"span",styles:{lineHeight:"2em"},properties:{innerText:"Remove Origin"}}],listeners:[{type:"click",listener:()=>{let l=ZoteroPane.getSelectedItems()[0].id;this.itemIDs=this.itemIDs.filter(u=>u!=l),i.querySelectorAll(".normal-items .item")?.forEach(u=>u.remove()),i.querySelectorAll("#origin-items-container .origin-items .item").forEach(u=>{Number(u.getAttribute("zotero-item-id"))==l&&u.remove()}),this.updateAddOrRemove()}}]}]},{tag:"div",id:"build-graph",classList:["button"],styles:{width:"100%",borderTop:"1px solid #eee",borderBottom:"1px solid #eee",display:"flex",flexDirection:"row",justifyContent:"center",alignContent:"center",cursor:"pointer",height:"2em"},children:[{tag:"div",styles:{display:"flex",justifyContent:"center",alignContent:"center"},properties:{innerHTML:'<svg style="margin: auto 0; margin-right: .5em;" width="20" height="20" viewBox="-8 -5.5 35 35" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M16.1757 14.0888L13.9333 7.08338L14.5478 6.93021L16.7901 13.9356L16.1757 14.0888Z" fill="url(#paint0_linear_icon)"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M6.33333 15.1579L11.4 6.31579L11.9499 6.62914L6.88322 15.4712L6.33333 15.1579Z" fill="url(#paint1_linear_icon)"></path><path d="M19 13.8947C19 15.29 17.8658 16.4211 16.4667 16.4211C15.0675 16.4211 13.9333 15.29 13.9333 13.8947C13.9333 12.4995 15.0675 11.3684 16.4667 11.3684C17.8658 11.3684 19 12.4995 19 13.8947Z" fill="url(#paint2_linear_icon)"></path><path d="M10.1333 18.9474C10.1333 21.7379 7.86491 24 5.06667 24C2.26842 24 0 21.7379 0 18.9474C0 16.1569 2.26842 13.8947 5.06667 13.8947C7.86491 13.8947 10.1333 16.1569 10.1333 18.9474Z" fill="url(#paint3_linear_icon)"></path><path d="M16.9731 3.78947C16.9731 5.88234 15.2718 7.57895 13.1731 7.57895C11.0744 7.57895 9.37312 5.88234 9.37312 3.78947C9.37312 1.69661 11.0744 0 13.1731 0C15.2718 0 16.9731 1.69661 16.9731 3.78947Z" fill="url(#paint4_linear_icon)"></path><defs><linearGradient id="paint0_linear_icon" x1="1.9" y1="24" x2="26.4917" y2="-24.0554" gradientUnits="userSpaceOnUse"><stop stop-color="#239092"></stop><stop offset="0.624978" stop-color="#97C8C9"></stop></linearGradient><linearGradient id="paint1_linear_icon" x1="1.9" y1="24" x2="26.4917" y2="-24.0554" gradientUnits="userSpaceOnUse"><stop stop-color="#239092"></stop><stop offset="0.624978" stop-color="#97C8C9"></stop></linearGradient><linearGradient id="paint2_linear_icon" x1="1.9" y1="24" x2="26.4917" y2="-24.0554" gradientUnits="userSpaceOnUse"><stop stop-color="#239092"></stop><stop offset="0.624978" stop-color="#97C8C9"></stop></linearGradient><linearGradient id="paint3_linear_icon" x1="1.9" y1="24" x2="26.4917" y2="-24.0554" gradientUnits="userSpaceOnUse"><stop stop-color="#239092"></stop><stop offset="0.624978" stop-color="#97C8C9"></stop></linearGradient><linearGradient id="paint4_linear_icon" x1="1.9" y1="24" x2="26.4917" y2="-24.0554" gradientUnits="userSpaceOnUse"><stop stop-color="#239092"></stop><stop offset="0.624978" stop-color="#97C8C9"></stop></linearGradient></defs></svg>'}},{tag:"span",styles:{lineHeight:"2em"},properties:{innerText:"Build Graph"}}],listeners:[{type:"click",listener:async()=>{let l=this.itemIDs.map(g=>Zotero.Items.get(g));i.querySelectorAll(".normal-items .item")?.forEach(g=>g.remove()),i.querySelectorAll(".prior-items .item")?.forEach(g=>g.remove()),i.querySelectorAll(".deriv-items .item")?.forEach(g=>g.remove());let u=await this.refresh(l);ztoolkit.log("graphdata",u);let d=this.frame.contentWindow.app;Object.values(u.nodes).sort((g,m)=>m.year-g.year).forEach(g=>{this.addItem(i.querySelector(".normal-items"),this.paper2Info(g),d.paper_to_color(g))}),u.common_references.sort((g,m)=>m.year-g.year).forEach(g=>{this.addItem(i.querySelector(".prior-items"),this.paper2Info(g),d.paper_to_color(g)).setAttribute("local",g.local_citations.join("+"))}),u.common_citations.sort((g,m)=>m.year-g.year).forEach(g=>{this.addItem(i.querySelector(".deriv-items"),this.paper2Info(g),d.paper_to_color(g)).setAttribute("local",g.local_references.join("+"))})}}]},{tag:"div",styles:{flexGrow:"1",overflowY:"auto",display:"flex",flexDirection:"row"},classList:["items-container"],children:[{tag:"div",classList:["prior-items"],styles:{display:"none",overflowY:"auto"}},{tag:"div",classList:["normal-items"],styles:{overflowY:"auto"}},{tag:"div",classList:["deriv-items"],styles:{display:"none",overflowY:"auto"}}]},{tag:"div",styles:{display:"flex"},children:[{tag:"div",id:"prior-works",classList:["filter-button"],properties:{innerText:"Prior Works"},listeners:[{type:"click",listener:()=>{let l=this.relatedContainer?.querySelector("#prior-works"),u=this.relatedContainer?.querySelector("#deriv-works"),d=this.relatedContainer.querySelector(".prior-items"),g=this.relatedContainer.querySelector(".deriv-items"),m=this.relatedContainer.querySelector(".normal-items");u.classList.remove("activate"),g.style.display="none",m.style.borderLeft=m.style.borderRight=d.style.borderLeft=d.style.borderRight="none",l?.classList.contains("activate")?(l.classList.remove("activate"),d.style.display="none",d.style.borderLeft="none",m.style.borderRight="none",m.style.width="100%"):(l.classList.add("activate"),d.style.display="",m.style.width=d.style.width="50%",m.style.borderLeft=".5px solid #cecece",d.style.borderRight=".5px solid #cecece")}}]},{tag:"div",id:"deriv-works",classList:["filter-button"],attributes:{activate:"false"},properties:{innerText:"Derivative Works"},listeners:[{type:"click",listener:()=>{let l=this.relatedContainer?.querySelector("#prior-works"),u=this.relatedContainer?.querySelector("#deriv-works"),d=this.relatedContainer.querySelector(".prior-items"),g=this.relatedContainer.querySelector(".deriv-items"),m=this.relatedContainer.querySelector(".normal-items");l.classList.remove("activate"),d.style.display="none",m.style.borderLeft=m.style.borderRight=g.style.borderLeft=g.style.borderRight="none",u?.classList.contains("activate")?(u.classList.remove("activate"),g.style.display="none",m.style.width="100%"):(u.classList.add("activate"),g.style.display="",m.style.width=g.style.width="50%",m.style.borderRight=".5px solid #cecece",g.style.borderLeft=".5px solid #cecece")}}]}]}]},r);this.relatedContainer=i}setNodeState(r){if(r.state=="selected"){let i;Array.prototype.forEach.call(this.relatedContainer?.querySelectorAll(".items-container .item"),d=>{d._ref.identifiers.paperID==r.paperID?(d.classList.add("selected"),i=d):d.classList.remove("selected")});let l="Nodes";this.zoteroColor=!0;let u=i.parentElement;u.classList.contains("prior-items")?(l="Prior",this.zoteroColor=!1):u.classList.contains("deriv-items")&&(this.zoteroColor=!1,l="Deriv"),this.frame.contentWindow.GLOBAL_SELECTED_PAPER.value={paper_id:r.paperID,src:l},[...this.relatedContainer?.querySelectorAll(".prior-items .item"),...this.relatedContainer?.querySelectorAll(".deriv-items .item")].forEach(d=>{d.getAttribute("local").indexOf(r.paperID)>=0?d.classList.add("highlight"):d.classList.remove("highlight")}),Array.prototype.forEach.call(this.relatedContainer?.querySelectorAll(".normal-items .item"),d=>{let g=i.getAttribute("local");g&&g.indexOf(d._ref.identifiers.paperID)>=0?d.classList.add("highlight"):d.classList.remove("highlight")})}else r.state=="hover"&&(this.frame.contentWindow.GLOBAL_HOVER_PAPER.value={paper_id:r.paperID,src:"Nodes"},Array.prototype.forEach.call(this.relatedContainer?.querySelectorAll(".item"),i=>{this.frame.contentWindow.GLOBAL_SELECTED_PAPER.value?.paper_id!=i._ref.identifiers.paperID&&(i._ref.identifiers.paperID==r.paperID?i.classList.add("hover"):i.classList.remove("hover"))}))}addItem(r,i,l){let u,d,g=ztoolkit.UI.appendElement({tag:"div",classList:["item"],attributes:{"zotero-item-id":i?._itemID},properties:{_ref:i},styles:{display:"flex",flexDirection:"row",height:"2em",justifyContent:"space-between",alignItems:"center",padding:"0 .25em"},children:[{tag:"div",styles:{width:"2em",height:"2em",display:"flex",justifyContent:"center",alignItems:"center"},children:[l?{tag:"div",classList:["color-circle"],styles:{width:"1.2em",height:"1.2em",borderRadius:"50%",backgroundColor:l},listeners:[{type:"mouseenter",listener:()=>{this.setNodeState({state:"hover",paperID:i.identifiers.paperID})}},{type:"mouseleave",listener:()=>{this.setNodeState({state:"hover",paperID:""})}},{type:"click",listener:()=>{this.setNodeState({state:"selected",paperID:i.identifiers.paperID}),new ztoolkit.Clipboard().addText(i.identifiers.DOI,"text/unicode").copy()}}]}:{tag:"div",styles:{width:"2em",height:"2em",display:"flex",justifyContent:"center",alignItems:"center"},classList:["icon"],properties:{innerHTML:'<svg width="24" height="24" viewBox="0 0 24 24" fill="#7a306c" xmlns="http://www.w3.org/2000/svg" class="graph-action-icon mr-[6px]" data-v-f4c185ee=""><path d="M19 13H5V11H19V13Z"></path></svg>'},listeners:[{type:"click",listener:()=>{this.itemIDs=this.itemIDs.filter(m=>m!=i._itemID),g.remove(),this.updateAddOrRemove()}}]}]},{tag:"div",classList:["title-box"],styles:{width:"100%",height:"2em",flex:"1",boxSizing:"border-box"},children:[{tag:"div",namespace:"xul",classList:["title"],styles:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",lineHeight:"2em"},properties:{textContent:i.title}}],listeners:[{type:"mouseenter",listener:()=>{this.setNodeState({state:"hover",paperID:i.identifiers.paperID})}},{type:"mouseup",listener:m=>{if(m.button!=2)return;g.classList.add("active");let x=parseInt(Zotero.Prefs.get(`${ve.addonRef}.showTipAfterMillisecond`)),v=Zotero.Prefs.get("extensions.zotero.layout",!0)=="stacked"?"top center":"left";d=window.setTimeout(async()=>{let I=g.getBoundingClientRect();u=this.views.showTipUI(I,i,v,i.identifiers.DOI),g.classList.contains("active")||(u.container.style.display="none")},x)}},{type:"mouseleave",listener:()=>{if(g.classList.remove("active"),window.clearTimeout(d),!u)return;let m=u.removeTipAfterMillisecond;u.tipTimer=window.setTimeout(async()=>{for(let x=0;x<m/2;x++){if(this.relatedContainer.querySelector(".active"))return;await Zotero.Promise.delay(.001)}u&&u.clear()},m/2)}},{type:"click",listener:()=>{u&&u.clear(),this.setNodeState({state:"selected",paperID:i.identifiers.paperID}),new ztoolkit.Clipboard().addText(i.identifiers.DOI,"text/unicode").copy()}}]}]},r);return ztoolkit.UI.appendElement({tag:"div",styles:{width:"2em",height:"2em",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer"},properties:{innerHTML:i?._itemID?'<svg viewBox="0 0 743 743" width="1.2em" height="1.2em"  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" overflow="hidden"><defs><clipPath id="clip0"><rect x="769" y="697" width="743" height="743"/></clipPath></defs><g transform="translate(-769 -697)"><path d="M769 1068.5C769 863.326 935.326 697 1140.5 697 1345.67 697 1512 863.326 1512 1068.5 1512 1273.67 1345.67 1440 1140.5 1440 935.326 1440 769 1273.67 769 1068.5Z" fill="#ca6363" fill-rule="evenodd"/><path d="M1162.25 901C1173.47 901 1181.89 904.166 1190.66 912.612L1316.22 1032.96C1327.09 1042.81 1332 1054.07 1332 1068.5 1332 1082.58 1326.74 1094.19 1316.22 1104.04L1190.66 1224.39C1181.89 1232.48 1173.47 1236 1162.25 1236 1141.2 1236 1126.12 1220.52 1126.12 1198.35 1126.12 1187.79 1130.68 1177.24 1138.75 1170.55L1178.73 1133.95 1215.56 1107.56 1143.66 1112.13 989.685 1112.13C965.838 1112.13 949 1093.13 949 1068.5 949 1043.52 965.838 1024.87 989.685 1024.87L1143.66 1024.87 1215.21 1029.09 1179.78 1003.05 1138.75 966.451C1130.68 959.766 1126.12 949.209 1126.12 938.3 1126.12 916.483 1141.2 901 1162.25 901Z" fill="#FFFFFF" fill-rule="evenodd"/></g></svg>':'<svg viewBox="0 0 743 743" width="1.2em" height="1.2em" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" overflow="hidden"><defs><clipPath id="clip0"><rect x="944" y="711" width="743" height="743"/></clipPath></defs><g transform="translate(-944 -711)"><path d="M944 1082.5C944 877.326 1110.33 711 1315.5 711 1520.67 711 1687 877.326 1687 1082.5 1687 1287.67 1520.67 1454 1315.5 1454 1110.33 1454 944 1287.67 944 1082.5Z" fill="#9cb8b8" fill-rule="evenodd"/><path d="M1159.5 1083.5 1472.1 1083.5" stroke="#FFFFFF" stroke-width="87.0833" stroke-linecap="round" stroke-miterlimit="8" fill="none" fill-rule="evenodd"/><path d="M1316.5 927.5 1316.5 1240.1" stroke="#FFFFFF" stroke-width="87.0833" stroke-linecap="round" stroke-miterlimit="8" fill="none" fill-rule="evenodd"/></g></svg>'},listeners:[{type:"click",listener:async m=>{if(i._itemID)ZoteroPane.selectItem(i._itemID);else{let x=i.identifiers.DOI,v=this.itemIDs.map(E=>Zotero.Items.get(E)),I=async E=>{let C=new ztoolkit.ProgressWindow("[Pending] Adding",{closeTime:-1}).createLine({text:x,type:"default"}).show(),B=await this.views.utils.createItemByZotero({DOI:x},E);v.forEach(async $=>{B.addRelatedItem($),$.addRelatedItem(B),await $.saveTx({skipSelect:!0,skipNotifier:!0}),await B.saveTx({skipSelect:!0,skipNotifier:!0})}),C.changeHeadline("[Done] Adding"),C.changeLine({type:"success"}),C.startCloseTimer(3e3),document.querySelector("#build-graph").click()},S=ZoteroPane.getSelectedCollection(),M=[];if(S&&(M=[S.id]),m.ctrlKey||m.metaKey){let E=g.getBoundingClientRect(),C=document.createElementNS("http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul","menupopup");document.querySelector("#browser").append(C);let B=Zotero.Collections.getByLibrary(1);for(let $ of B){let V=Zotero.Utilities.Internal.createMenuForTarget($,C,null,async(te,R)=>{te.target.tagName=="menuitem"&&(ztoolkit.log(R),C.remove(),I([R.id]),te.stopPropagation())});C.append(V)}C.openPopupAtScreen(E.left,E.top+E.height,!0)}else I(M)}}}]},g),g}async getGraphData(r){this.popupWin??=new ztoolkit.ProgressWindow("[Pending] Connected Papers",{closeOtherProgressWindows:!0,closeTime:-1}).createLine({text:"Initializing",type:"default"}).show();let i={1:"OK",2:"LONG_PAPER",3:"IN_PROGRESS",4:"NOT_RUN",5:"ADDED_TO_QUEUE",6:"ERROR",7:"OVERLOADED",8:"IN_QUEUE",9:"NOT_IN_API"},l=async m=>{let x=m,v=16,I=x.slice(0,v),S=new Uint32Array(I.slice(4,8)),M=S[0],E=Rv();var C=new window.TextDecoder("utf-8");x=x.slice(8);let B=new window.Uint32Array(x.slice(0,4)),$=B[0],V=x.slice(4,4+$);if(M==1){let te=new window.Uint8Array(V),R=E.inflate(te),D=C.decode(R);return JSON.parse(D)}else{let te=new window.Uint32Array(V)[0];this.popupWin.changeLine({progress:te,text:`[${te||1}/100] Building`}),await Zotero.Promise.delay(100);return}},d=await(await window.fetch(`https://rest.connectedpapers.com/graph_no_build/${r}`,{credentials:"same-origin",headers:{accept:"application/json, text/plain, */*",referer:"https://www.connectedpapers.com/",origin:"https://www.connectedpapers.com","sec-fetch-site":"same-site"}})).arrayBuffer(),g=await l(d);return g||await this.getGraphData(r)}async getPaperID(r){let i=r.getField("DOI"),l=r.getField("title");if(i)return(await this.requests.get(`https://rest.connectedpapers.com/id_translator/doi/${i}`)).paperId;{let u=`https://rest.connectedpapers.com/search/${escape(l)}/1`,d=await this.requests.post(u);if(d&&d?.results?.length)return d.results[0].id}}async buildGraphData(r){this.popupWin=new ztoolkit.ProgressWindow("[Pending] Connected Papers",{closeOtherProgressWindows:!0,closeTime:-1}).createLine({text:"Initializing",type:"default"}).show();let i=(await Promise.all(r.map(async m=>await this.getPaperID(m)))).join("+");ztoolkit.log("id",i),i?this.popupWin.changeLine({progress:1,text:"[1/100] Building"}):(this.popupWin.changeHeadline("[Fail] Connected Papers"),this.popupWin.changeLine({type:"fail"}),this.popupWin.startCloseTimer(3e3)),this.requests.post(`https://rest.connectedpapers.com/graph/${i}`);let l=await this.getGraphData(i);ztoolkit.log(l);let u=Object.keys(l.nodes).length;this.popupWin.changeLine({text:`[1/${u}] Indexing`,progress:1,type:"default"});let d={};for(let m in l.nodes)d[m]=this.views.utils.searchItem(this.paper2Info(l.nodes[m]));let g=0;for(let m in l.nodes){g+=1;let x;try{x=await d[m]}catch{}this.popupWin.changeLine({text:`[${g}/${u}] Indexing`,progress:100*g/u}),l.nodes[m]._itemID=x?.id}return ztoolkit.log(l),this.popupWin.changeHeadline("[Done] Connected Papers"),this.popupWin.changeLine({text:`[${u}/${u}] Indexing`,type:"success"}),this.popupWin.startCloseTimer(3e3),this.popupWin=void 0,l}initItemsPane(){let r=document.querySelector("#item-tree-main-default"),i=200,l=ztoolkit.UI.createElement(document,"div",{id:"graph-view",styles:{width:"100%",minHeight:`${i}px`,height:Zotero.Prefs.get(`${ve.addonRef}.graphView.height`),display:Zotero.Prefs.get(`${ve.addonRef}.graphView.enable`)?"":"none"}});this.graphContainer=l;let u=this.frame=ztoolkit.UI.createElement(document,"iframe",{namespace:"html"});u.setAttribute("src",`chrome://${ve.addonRef}/content/dist/index.html`),u.style.border="none",u.style.outline="none",u.style.width="100%",u.style.height=l.style.height,u.style.overflow="hidden",u.style.backgroundColor="#ffffff",l.append(u),r.append(l);let d=ztoolkit.UI.createElement(document,"div",{styles:{height:"1px",width:"100%",backgroundColor:"#cecece",cursor:"ns-resize"}});l.insertBefore(d,u);let g=0,m=0,x=0,v=0,I=function(E){u.style.display="none",g=E.clientY,m=E.clientX;let C=l.getBoundingClientRect();x=C.height,v=C.width,document.addEventListener("mousemove",S),document.addEventListener("mouseup",M)},S=E=>{let C=E.clientY-g,B=x-C,$=`${B<=i?i:B}px`;l.style.height=$,u.style.height=$,this.boxAfter.style.height=$,Zotero.Prefs.set(`${ve.addonRef}.graphView.height`,$)},M=()=>{u.style.display="",document.removeEventListener("mousemove",S),document.removeEventListener("mouseup",M)};d.addEventListener("mousedown",I)}paper2Info(r){return{identifiers:{DOI:r.doi,paperID:r.paperId},title:r.title,year:r.year,authors:r.authors?.map(i=>i.name)||[],abstract:r.abstract,primaryVenue:r.venue,source:"connected papers",tags:r.fieldsOfStudy,type:"",_itemID:r._itemID}}async refresh(r){ztoolkit.log("refresh",r);let i=await this.buildGraphData(r);ztoolkit.log(i);let l=this.frame.contentWindow.app;l.graphdata=i,l.$route.params.origin_id=i.start_id||i.start_ids.join("+"),l._paper_to_color=l._paper_to_color||l.paper_to_color,l.paper_to_color=d=>{let g=l._paper_to_color(d);if(this.zoteroColor&&d._itemID){let m="#c22727",x=zd.hsl(g);return x.h=zd.hsl(m).h,x.s=(x.s+2*zd.hsl(m).s)/3,x+""}return g},l.refresh_graph();let u=d=>{let g=document.querySelector(".normal-items"),m=g.querySelector(`.${d}`),x=g.firstChild;g.scrollTo(0,m.offsetTop-x.offsetTop)};return l.graphdata.sim_node_circles.on("click",(d,g)=>{let m=g.paperId;this.setNodeState({state:"selected",paperID:m}),u("selected")}).on("mouseover",(d,g)=>{let m=g.paperId;this.setNodeState({state:"hover",paperID:m}),u("hover")}).on("mouseout",(d,g)=>{this.setNodeState({state:"hover",paperID:""})}),i}};async function R7(){await Promise.all([Zotero.initializationPromise,Zotero.unlockPromise,Zotero.uiReadyPromise]),await Fv(window)}async function Fv(t){Hy(),await Promise.all([Zotero.initializationPromise,Zotero.unlockPromise,Zotero.uiReadyPromise]);let r=ztoolkit.ProgressWindow.prototype.show;ztoolkit.ProgressWindow.prototype.show=function(){return Zotero.ProgressWindowSet.closeAll(),r.call(this,...arguments)};let i=new La;await i.onInit(),Zotero[ve.addonInstance].views=i;let l=Zotero.Prefs.get(`${ve.addonRef}.notAutoRefreshItemTypes`),u=Zotero.Prefs.get("sync.server.username");["polygon","wddxg_","ZJY_Anes","Zx-Josh","Cccccc_kx","yzayea","gkottawl","w2802653181","magicdroidx","wang13078455274","lygwsw","pkaixin99","pez0108","erniao-0412","Freedom1615","SRW790314","lynnyl_6969","pengershuaii","haha_lfl","loverourself","fangyuanalex","Hydrogen_X","lf15598111761","ASHINEPX","licheng1148951981","raykr","zhufengyi810@live.com","tens.arroyos_0j@icloud.com","528946911@qq.com","1053029438@qq.com","JingkeWu","llity@outlook.com"].find(d=>l.indexOf(d)>=0||u==d)&&await new Ka(i).init()}async function F7(t){ztoolkit.unregisterAll(),addon.data.dialog?.window?.close()}function B7(){ztoolkit.unregisterAll(),document.querySelectorAll("#zotero-reference-show-hide-graph-view").forEach(t=>t.remove()),addon.data.alive=!1,addon.data.dialog?.window?.close(),delete Zotero[ve.addonInstance]}async function z7(t,r){switch(t){case"load":$y(r.window);break;default:return}}var Bv={onStartup:R7,onShutdown:B7,onPrefsEvent:z7,onMainWindowLoad:Fv,onMainWindowUnload:F7};var l2=Uy(s2());function c2(){let t=new l2.default;return h9(t),t}function h9(t){let r="production";t.basicOptions.log.prefix=`[${ve.addonName}]`,t.basicOptions.log.disableConsole=r==="production",t.UI.basicOptions.ui.enableElementJSONLog=!1,t.UI.basicOptions.ui.enableElementDOMLog=!1,t.basicOptions.debug.disableDebugBridgePassword=!1,t.basicOptions.api.pluginID=ve.addonID,t.ProgressWindow.setIconURI("default",`chrome://${ve.addonRef}/content/icons/favicon.png`),t.ProgressWindow.setIconURI("connectedpapers",`chrome://${ve.addonRef}/content/icons/connectedpapers.png`)}var up=class{constructor(){this.data={alive:!0,env:"production",ztoolkit:c2()},this.hooks=Bv,this.api={}}},u2=up;var fp=new f2.BasicTool;fp.getGlobal("Zotero")[ve.addonInstance]||(_globalThis.Zotero=fp.getGlobal("Zotero"),Qa("window"),Qa("document"),Qa("ZoteroPane"),Qa("Zotero_Tabs"),_globalThis.addon=new u2,Qa("ztoolkit",()=>_globalThis.addon.data.ztoolkit),Zotero[ve.addonInstance]=addon,addon.hooks.onStartup());function Qa(t,r){Object.defineProperty(_globalThis,t,{get(){return r?r():fp.getGlobal(t)}})}})();
/*! Bundled license information:

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

buffer/index.js:
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)

sax/lib/sax.js:
  (*! http://mths.be/fromcodepoint v0.1.0 by @mathias *)
*/
